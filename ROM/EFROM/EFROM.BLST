187)   0000 00 00 00 00 		PARS DEFS 100H	;
187)   0004 00 00 00 00 		PARS DEFS 100H	;
187)   0008 00 00 00 00 		PARS DEFS 100H	;
187)   000C 00 00 00 00 		PARS DEFS 100H	;
187)   0010 00 00 00 00 		PARS DEFS 100H	;
187)   0014 00 00 00 00 		PARS DEFS 100H	;
187)   0018 00 00 00 00 		PARS DEFS 100H	;
187)   001C 00 00 00 00 		PARS DEFS 100H	;
187)   0020 00 00 00 00 		PARS DEFS 100H	;
187)   0024 00 00 00 00 		PARS DEFS 100H	;
187)   0028 00 00 00 00 		PARS DEFS 100H	;
187)   002C 00 00 00 00 		PARS DEFS 100H	;
187)   0030 00 00 00 00 		PARS DEFS 100H	;
187)   0034 00 00 00 00 		PARS DEFS 100H	;
187)   0038 00 00 00 00 		PARS DEFS 100H	;
187)   003C 00 00 00 00 		PARS DEFS 100H	;
187)   0040 00 00 00 00 		PARS DEFS 100H	;
187)   0044 00 00 00 00 		PARS DEFS 100H	;
187)   0048 00 00 00 00 		PARS DEFS 100H	;
187)   004C 00 00 00 00 		PARS DEFS 100H	;
187)   0050 00 00 00 00 		PARS DEFS 100H	;
187)   0054 00 00 00 00 		PARS DEFS 100H	;
187)   0058 00 00 00 00 		PARS DEFS 100H	;
187)   005C 00 00 00 00 		PARS DEFS 100H	;
187)   0060 00 00 00 00 		PARS DEFS 100H	;
187)   0064 00 00 00 00 		PARS DEFS 100H	;
187)   0068 00 00 00 00 		PARS DEFS 100H	;
187)   006C 00 00 00 00 		PARS DEFS 100H	;
187)   0070 00 00 00 00 		PARS DEFS 100H	;
187)   0074 00 00 00 00 		PARS DEFS 100H	;
187)   0078 00 00 00 00 		PARS DEFS 100H	;
187)   007C 00 00 00 00 		PARS DEFS 100H	;
187)   0080 00 00 00 00 		PARS DEFS 100H	;
187)   0084 00 00 00 00 		PARS DEFS 100H	;
187)   0088 00 00 00 00 		PARS DEFS 100H	;
187)   008C 00 00 00 00 		PARS DEFS 100H	;
187)   0090 00 00 00 00 		PARS DEFS 100H	;
187)   0094 00 00 00 00 		PARS DEFS 100H	;
187)   0098 00 00 00 00 		PARS DEFS 100H	;
187)   009C 00 00 00 00 		PARS DEFS 100H	;
187)   00A0 00 00 00 00 		PARS DEFS 100H	;
187)   00A4 00 00 00 00 		PARS DEFS 100H	;
187)   00A8 00 00 00 00 		PARS DEFS 100H	;
187)   00AC 00 00 00 00 		PARS DEFS 100H	;
187)   00B0 00 00 00 00 		PARS DEFS 100H	;
187)   00B4 00 00 00 00 		PARS DEFS 100H	;
187)   00B8 00 00 00 00 		PARS DEFS 100H	;
187)   00BC 00 00 00 00 		PARS DEFS 100H	;
187)   00C0 00 00 00 00 		PARS DEFS 100H	;
187)   00C4 00 00 00 00 		PARS DEFS 100H	;
187)   00C8 00 00 00 00 		PARS DEFS 100H	;
187)   00CC 00 00 00 00 		PARS DEFS 100H	;
187)   00D0 00 00 00 00 		PARS DEFS 100H	;
187)   00D4 00 00 00 00 		PARS DEFS 100H	;
187)   00D8 00 00 00 00 		PARS DEFS 100H	;
187)   00DC 00 00 00 00 		PARS DEFS 100H	;
187)   00E0 00 00 00 00 		PARS DEFS 100H	;
187)   00E4 00 00 00 00 		PARS DEFS 100H	;
187)   00E8 00 00 00 00 		PARS DEFS 100H	;
187)   00EC 00 00 00 00 		PARS DEFS 100H	;
187)   00F0 00 00 00 00 		PARS DEFS 100H	;
187)   00F4 00 00 00 00 		PARS DEFS 100H	;
187)   00F8 00 00 00 00 		PARS DEFS 100H	;
187)   00FC 00 00 00 00 		PARS DEFS 100H	;
188)   0100 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0104 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0108 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   010C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0110 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0114 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0118 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   011C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0120 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0124 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0128 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   012C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0130 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0134 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0138 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   013C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0140 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0144 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0148 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   014C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0150 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0154 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0158 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   015C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0160 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0164 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0168 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   016C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0170 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0174 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0178 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   017C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0180 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0184 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0188 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   018C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0190 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0194 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   0198 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
188)   019C 00 00 00 00 		FPRAM DEFS 160 ;make rm for MAT3CF	;make rm for MAT3CF
189)   01A0 00 00 00 00 		STKRAM DEFS 200	;
189)   01A4 00 00 00 00 		STKRAM DEFS 200	;
189)   01A8 00 00 00 00 		STKRAM DEFS 200	;
189)   01AC 00 00 00 00 		STKRAM DEFS 200	;
189)   01B0 00 00 00 00 		STKRAM DEFS 200	;
189)   01B4 00 00 00 00 		STKRAM DEFS 200	;
189)   01B8 00 00 00 00 		STKRAM DEFS 200	;
189)   01BC 00 00 00 00 		STKRAM DEFS 200	;
189)   01C0 00 00 00 00 		STKRAM DEFS 200	;
189)   01C4 00 00 00 00 		STKRAM DEFS 200	;
189)   01C8 00 00 00 00 		STKRAM DEFS 200	;
189)   01CC 00 00 00 00 		STKRAM DEFS 200	;
189)   01D0 00 00 00 00 		STKRAM DEFS 200	;
189)   01D4 00 00 00 00 		STKRAM DEFS 200	;
189)   01D8 00 00 00 00 		STKRAM DEFS 200	;
189)   01DC 00 00 00 00 		STKRAM DEFS 200	;
189)   01E0 00 00 00 00 		STKRAM DEFS 200	;
189)   01E4 00 00 00 00 		STKRAM DEFS 200	;
189)   01E8 00 00 00 00 		STKRAM DEFS 200	;
189)   01EC 00 00 00 00 		STKRAM DEFS 200	;
189)   01F0 00 00 00 00 		STKRAM DEFS 200	;
189)   01F4 00 00 00 00 		STKRAM DEFS 200	;
189)   01F8 00 00 00 00 		STKRAM DEFS 200	;
189)   01FC 00 00 00 00 		STKRAM DEFS 200	;
189)   0200 00 00 00 00 		STKRAM DEFS 200	;
189)   0204 00 00 00 00 		STKRAM DEFS 200	;
189)   0208 00 00 00 00 		STKRAM DEFS 200	;
189)   020C 00 00 00 00 		STKRAM DEFS 200	;
189)   0210 00 00 00 00 		STKRAM DEFS 200	;
189)   0214 00 00 00 00 		STKRAM DEFS 200	;
189)   0218 00 00 00 00 		STKRAM DEFS 200	;
189)   021C 00 00 00 00 		STKRAM DEFS 200	;
189)   0220 00 00 00 00 		STKRAM DEFS 200	;
189)   0224 00 00 00 00 		STKRAM DEFS 200	;
189)   0228 00 00 00 00 		STKRAM DEFS 200	;
189)   022C 00 00 00 00 		STKRAM DEFS 200	;
189)   0230 00 00 00 00 		STKRAM DEFS 200	;
189)   0234 00 00 00 00 		STKRAM DEFS 200	;
189)   0238 00 00 00 00 		STKRAM DEFS 200	;
189)   023C 00 00 00 00 		STKRAM DEFS 200	;
189)   0240 00 00 00 00 		STKRAM DEFS 200	;
189)   0244 00 00 00 00 		STKRAM DEFS 200	;
189)   0248 00 00 00 00 		STKRAM DEFS 200	;
189)   024C 00 00 00 00 		STKRAM DEFS 200	;
189)   0250 00 00 00 00 		STKRAM DEFS 200	;
189)   0254 00 00 00 00 		STKRAM DEFS 200	;
189)   0258 00 00 00 00 		STKRAM DEFS 200	;
189)   025C 00 00 00 00 		STKRAM DEFS 200	;
189)   0260 00 00 00 00 		STKRAM DEFS 200	;
189)   0264 00 00 00 00 		STKRAM DEFS 200	;
194)   E000 C3 03 E0    		POWERUP JP POWERUP+3	;
195)   E003 ED 56       		 IM 1	;
196)   E005 3E A2       		 LD A TVOFF+PTRDMSK+V24DMSK	;
197)   E007 D3 07       		 OUT (ENREG),A	;
198)   E009 DB 14       		PWAIT IN A (STREG)	;
199)   E00B CB 4F       		 BIT POWTEST A	;
200)   E00D 20 FA       		 JR NZ PWAIT	;
201)   E00F 11 00 80    		 LD DE ENDRAM	;
202)   E012 AF          		 XOR A	;
203)   E013 47          		RT LD B A	;
204)   E014 2F          		 CPL	;
205)   E015 4F          		 LD C A	;
206)   E016 21 00 00    		 LD HL RAM	;
207)   E019 70          		LOOP1 LD (HL) B	;
208)   E01A 23          		 INC HL	;
209)   E01B 71          		 LD (HL) C	;
210)   E01C 23          		 INC HL	;
211)   E01D B7          		 OR A	;
212)   E01E ED 52       		 SBC HL DE	;
213)   E020 28 03       		 JR Z OUT	;
214)   E022 19          		 ADD HL DE	;
215)   E023 18 F4       		 JR LOOP1	;
216)   E025 21 00 00    		OUT LD HL RAM	;
217)   E028 7E          		LOOP2 LD A (HL)	;
218)   E029 B8          		 CP B	;
219)   E02A 20 0D       		 JR NZ FAIL1	;
220)   E02C 23          		 INC HL	;
221)   E02D 7E          		 LD A (HL)	;
222)   E02E B9          		 CP C	;
223)   E02F 20 09       		 JR NZ FAIL2	;
224)   E031 23          		 INC HL	;
225)   E032 ED 52       		 SBC HL DE	;
226)   E034 28 07       		 JR Z NEXT	;
227)   E036 19          		 ADD HL DE	;
228)   E037 18 EF       		 JR LOOP2	;
229)   E039 2B          		FAIL1 DEC HL	;
230)   E03A 2B          		FAIL2 DEC HL	;
231)   E03B 54          		 LD D H	;
232)   E03C 5D          		 LD E L	;
233)   E03D AF          		NEXT XOR A	;
234)   E03E B8          		 CP B	;
235)   E03F 3E 55       		 LD A 55H	;
236)   E041 28 D0       		 JR Z RT	;
237)   E043 B8          		 CP B	;
238)   E044 79          		 LD A C	;
239)   E045 28 CC       		 JR Z RT	;
240)   E047 B7          		 OR A	;
241)   E048 3E FF       		 LD A 0FFH	;
242)   E04A 20 C7       		 JR NZ RT	;
247)   E04C 31 68 02    		 LD SP,STACK	;
248)   E04F D5          		 PUSH DE	;
249)   E050 21 95 E0    		 LD HL,INITVALS	;
250)   E053 11 00 00    		 LD DE,PARS	;
251)   E056 01 74 00    		 LD BC PARCNT	;
252)   E059 ED B0       		 LDIR	;
253)   E05B E1          		 POP HL	;
254)   E05C 22 06 00    		 LD (B4) HL	;
255)   E05F DB 14       		 IN A,(STREG)	;
256)   E061 CB 47       		 BIT EXTEST A	;
257)   E063 28 05       		 JR Z EXIS4	;
258)   E065 3E 18       		 LD A 24	;
259)   E067 32 0C 00    		 LD (EXCESS) A	;
260)   E06A 3E 52       		EXIS4 LD A 52H ;TO GIVE TS & RS = 1	;TO GIVE TS & RS = 1
261)   E06C D3 07       		 OUT (ENREG) A	;
262)   E06E DB 14       		 IN A (STREG) ;To get MP, TVC~ and 40/80~	;To get MP, TVC~ and 40/80~
263)   E070 E6 07       		 AND 07H	;
264)   E072 47          		 LD B A	;
265)   E073 FE 04       		 CP 4	;
266)   E075 28 05       		 JR Z DPSLOK ;if TVC~ = 0, 40/80~ = 0 & MP = 1	;if TVC~ = 0, 40/80~ = 0 & MP = 1
267)   E077 3E 00       		 LD A,0	;
268)   E079 32 36 00    		 LD (DPSL) A	;
269)   E07C 78          		DPSLOK LD A B	;
270)   E07D E6 06       		 AND 6	;
271)   E07F FE 04       		 CP 4	;
272)   E081 28 05       		 JR Z DEV0OK	;
273)   E083 3E 03       		 LD A 3 ;if TVC~ = 1  or  MP = 0	;if TVC~ = 1  or  MP = 0
274)   E085 32 0B 00    		 LD (DEV0) A	;
275)   E088 3A 00 A0    		DEV0OK LD A (EXROM)	;
276)   E08B CB 7F       		 BIT 7 A	;
277)   E08D CA 01 A0    		 JP Z EXROM+1 ;if there is a rom at EXROM	;if there is a rom at EXROM
278)   E090 FB          		 EI	;
279)   E091 2A 26 00    		 LD HL,(UP)	;
280)   E094 E9          		CALLHL: JP (HL)	;
285)   E095 F3          		 DI	;
288)   E096 C3 7D E1    		 JP PONINT	;
290)   E099 68 02       		 DEFW RAMLO	;
292)   E09B 00 00       		 DEFB 0,0	;
295)   E09D C3 00 00    		 JP 0	;
297)   E0A0 00          		 DEFB 0	;
302)   E0A1 04          		 DEFB 4	;
304)   E0A2 00          		 DEFB 0	;
306)   E0A3 00          		 DEFB 0	;
308)   E0A4 00          		 DEFB 0	;
311)   E0A5 C3 85 A0    		 JP PCLRTN	;
313)   E0A8 01          		 DEFB 1	;
315)   E0A9 00 00       		 DEFW 0	;
317)   E0AB 00 00       		 DEFW 0	;
320)   E0AD C3 BC A0    		 JP PCLRNC	;
322)   E0B0 00          		 DEFB 0	;
324)   E0B1 00          		 DEFB 0	;
326)   E0B2 00          		 DEFB 0	;
328)   E0B3 00 00       		 DEFW 0	;
331)   E0B5 C3 E7 A0    		 JP POSRTN	;
333)   E0B8 00          		 DEFB 0	;
338)   E0B9 A2          		 DEFB TVOFF+PTRDMSK+V24DMSK	;
342)   E0BA 00          		 DEFB 0	;
344)   E0BB E4 C0       		 DEFW BASIC	;
347)   E0BD C3 BF A0    		 JP POSRNC	;
349)   E0C0 00          		 DEFB 0	;
351)   E0C1 98 DB       		 DEFW MKSPC	;
353)   E0C3 D1 DB       		 DEFW RETSPC	;
356)   E0C5 C3 00 00    		 JP 0	;
358)   E0C8 00          		 DEFB 0	;
360)   E0C9 4C E3       		 DEFW TPSTR	;
362)   E0CB 03 00       		 DEFW TPSTRE-TPSTR	;
365)   E0CD C3 9B E1    		 JP INTRPT	;
370)   E0D0 A0          		 DEFB DISPCOM	;
372)   E0D1 20          		 DEFB 32 ;i.e READY	;i.e READY
374)   E0D2 00          		 DEFB 0	;
376)   E0D3 20 20 20 20 		 DEFB 20H,20H,20H,20H	;
377)   E0D7 20 20 20 20 		 DEFB 20H,20H,20H,20H	;
378)   E0DB 20 20 20 20 		 DEFB 20H,20H,20H,20H	;
379)   E0DF 20 20 20 20 		 DEFB 20H,20H,20H,20H	;
382)   E0E3 40 ED       		 DEFW PDNTIM	;
384)   E0E5 00 00       		 DEFW 0	;
386)   E0E7 00 00 00 00 		 DEFW 0,0	;
392)   E0EB 68 02       		 DEFW RAMLO	;
394)   E0ED 2B B7       		 DEFW PADT	;
396)   E0EF 00 00       		 DEFW 0	;
398)   E0F1 00 00       		 DEFW 0	;
400)   E0F3 00 00       		 DEFW 0	;
402)   E0F5 00 00       		 DEFW 0	;
404)   E0F7 68 02       		 DEFW RAMLO	;
406)   E0F9 68 02       		 DEFW RAMLO	;
409)   E0FB C3 F5 E2    		 JP NMIRST	;
412)   E0FE 00 00 00    		 DEFB 0,0,0	;
417)   E101 02          		 DEFB 2	;
419)   E102 02          		 DEFB 2	;
421)   E103 C3 4F E3    		 JP IOP1	;
423)   E106 C3 5F E3    		 JP IOP2	;
431)   E109 2A 2C 00    		SPACE: LD HL,(GSPR)	;
432)   E10C CD 28 E1    		 CALL UPRC	;
433)   E10F 3E 64       		 LD A,NOROOM	;
434)   E111 D8          		 RET C	;
435)   E112 2A 04 00    		 LD HL,(B3PRM)	;
436)   E115 09          		 ADD HL,BC	;
437)   E116 18 0C       		 JR GSP1	;
439)   E118 2A 2E 00    		GSPCBK: LD HL,(RSPR)	;
440)   E11B CD 28 E1    		 CALL UPRC	;
441)   E11E B7          		 OR A	;
442)   E11F 2A 04 00    		 LD HL,(B3PRM)	;
443)   E122 ED 42       		 SBC HL,BC	;
444)   E124 22 04 00    		GSP1: LD (B3PRM),HL	;
445)   E127 C9          		 RET	;
451)   E128 DD E5       		 PUSH IX	;
452)   E12A FD E5       		 PUSH IY	;
453)   E12C CD 43 E1    		 CALL RESIRS	;
454)   E12F CD 94 E0    		 CALL CALLHL	;
455)   E132 CD 3A E1    		 CALL SAVIRS	;
456)   E135 FD E1       		 POP IY	;
457)   E137 DD E1       		 POP IX	;
458)   E139 C9          		 RET	;
461)   E13A DD 22 14 00 		 LD (SAVE2),IX	;
462)   E13E FD 22 16 00 		 LD (SAVE3),IY	;
463)   E142 C9          		 RET	;
466)   E143 DD 2A 14 00 		 LD IX,(SAVE2)	;
467)   E147 FD 2A 16 00 		 LD IY,(SAVE3)	;
468)   E14B C9          		 RET	;
473)   E14C DD E5       		GETKEY PUSH IX  ;AFBCDEHL destroyed	;AFBCDEHL destroyed
474)   E14E FD E5       		 PUSH IY	;
475)   E150 CD 8C E1    		 CALL IMMKEY ;CLEAR KDATA	;CLEAR KDATA
476)   E153 F3          		WTLP DI	;
477)   E154 21 3C 00    		 LD HL COPST	;
478)   E157 CB 76       		 BIT KDATA (HL)	;
479)   E159 20 2B       		 JR NZ GOTIT	;
480)   E15B 3A 24 00    		 LD A (ENREGMAP)	;
481)   E15E CB 5F       		 BIT IOPOWER A	;
482)   E160 20 21       		 JR NZ WAIT1 ;IF IOPOWER UP	;IF IOPOWER UP
483)   E162 CB 6E       		 BIT READY (HL) ;ELSE POWERDOWN Z80	;ELSE POWERDOWN Z80
484)   E164 28 11       		 JR Z WAITI ;IF COP NOT READY	;IF COP NOT READY
485)   E166 CB 66       		 BIT TIMEOUT (HL)	;
486)   E168 20 0D       		 JR NZ WAITI ;IF TIMING OUT COP	;IF TIMING OUT COP
487)   E16A CB E6       		 SET TIMEOUT (HL) ;ELSE SET UP COP TIMEOUT	;ELSE SET UP COP TIMEOUT
488)   E16C CB AE       		 RES READY (HL)	;
489)   E16E 2B          		 DEC HL	;
490)   E16F 36 B8       		 LD (HL) TIMCOM+8 ;SUPPRESS REGULAR INTRPT.	;SUPPRESS REGULAR INTRPT.
491)   E171 21 40 ED    		 LD HL PDNTIM	;
492)   E174 22 4E 00    		 LD (TIMBUFF) HL	;
493)   E177 ED 73 1E 00 		WAITI LD (SAVE1) SP ;SAVE STACK PTR.	;SAVE STACK PTR.
494)   E17B FB          		POFF EI	;
495)   E17C 76          		 HALT  ;POWERDOWN (OR NOT)	;POWERDOWN (OR NOT)
496)   E17D ED 56       		PONINT IM 1  ;HERE ON POWERUP OR IF UNHALTED	;HERE ON POWERUP OR IF UNHALTED
497)   E17F ED 7B 1E 00 		 LD SP (SAVE1)	;
498)   E183 FB          		WAIT1 EI	;
499)   E184 18 CD       		 JR WTLP	;
501)   E186 FD E1       		GOTIT POP IY	;
502)   E188 DD E1       		 POP IX	;
503)   E18A CB A6       		 RES TIMEOUT (HL)	;
504)   E18C 21 3C 00    		IMMKEY LD HL COPST ;DESTROYS HL	;DESTROYS HL
505)   E18F F3          		 DI	;
506)   E190 CB 76       		 BIT KDATA (HL)	;
507)   E192 CB B6       		 RES KDATA (HL)	;
508)   E194 23          		 INC HL	;
509)   E195 7E          		 LD A (HL)	;
510)   E196 FB          		 EI	;
511)   E197 37          		 SCF	;
512)   E198 C8          		 RET Z	;
513)   E199 B7          		 OR A	;
514)   E19A C9          		 RET	;
519)   E19B F5          		INTRPT PUSH AF	;
520)   E19C DB 14       		 IN A (STREG)	;
521)   E19E E5          		 PUSH HL	;
522)   E19F D5          		 PUSH DE	;
523)   E1A0 C5          		 PUSH BC	;
524)   E1A1 CD AB E1    		 CALL INTSER	;
525)   E1A4 C1          		 POP BC	;
526)   E1A5 D1          		 POP DE	;
527)   E1A6 E1          		 POP HL	;
528)   E1A7 F1          		 POP AF	;
529)   E1A8 FB          		 EI	;
530)   E1A9 ED 4D       		 RETI	;
533)   E1AB CB 7F       		INTSER BIT COPINTBAR,A	;
534)   E1AD 28 76       		 JR Z COPIS	;
535)   E1AF CB 6F       		 BIT CLKINTBAR A	;
538)   E1B1 C0          		 RET NZ	;
539)   E1B2 3E 01       		FRINT LD A CLRCLK ;FRAME INTRPT	;FRAME INTRPT
540)   E1B4 D3 04       		 OUT (INTCON) A ;to clear CLK int.	;to clear CLK int.
541)   E1B6 21 6B 00    		 LD HL FICLKL ;to increment clock	;to increment clock
542)   E1B9 34          		 INC (HL)	;
543)   E1BA 20 06       		 JR NZ CLKEND	;
544)   E1BC 2B          		 DEC HL	;
545)   E1BD 34          		 INC (HL)	;
546)   E1BE 20 02       		 JR NZ CLKEND	;
547)   E1C0 2B          		 DEC HL	;
548)   E1C1 34          		 INC (HL)	;
549)   E1C2 21 33 00    		CLKEND LD HL BUFLG	;
550)   E1C5 CB 46       		 BIT 0 (HL)	;
551)   E1C7 20 53       		 JR NZ NOVID	;
552)   E1C9 21 0D 00    		 LD HL TV0	;
553)   E1CC 34          		 INC (HL)	;
554)   E1CD 4E          		 LD C (HL)	;
555)   E1CE 23          		 INC HL	;
556)   E1CF CB 66       		 BIT 4 (HL)	;
557)   E1D1 CB A6       		 RES 4 (HL)	;
558)   E1D3 20 47       		 JR NZ NOVID	;
559)   E1D5 CB 7E       		 BIT 7 (HL)	;
560)   E1D7 28 43       		 JR Z NOVID	;
561)   E1D9 CB 76       		 BIT 6 (HL)	;
562)   E1DB 28 18       		 JR Z NOCUR	;
563)   E1DD 46          		 LD B (HL)	;
564)   E1DE 23          		 INC HL	;
565)   E1DF CB 61       		 BIT 4 C	;
566)   E1E1 7E          		 LD A (HL)	;
567)   E1E2 28 0D       		 JR Z SHOCHR	;
568)   E1E4 3E 5F       		 LD A UNLIN	;
569)   E1E6 CB 68       		 BIT 5 B	;
570)   E1E8 20 02       		 JR NZ CMPCHR	;
571)   E1EA 3E 7F       		 LD A DOOR	;
572)   E1EC BE          		CMPCHR CP (HL)	;
573)   E1ED 20 02       		 JR NZ SHOCHR	;
574)   E1EF 3E 20       		 LD A SPCE	;
575)   E1F1 2A 5A 00    		SHOCHR LD HL (TVCUR)	;
576)   E1F4 77          		 LD (HL) A	;
577)   E1F5 FB          		NOCUR EI	;
578)   E1F6 DD E5       		 PUSH IX	;
579)   E1F8 CD BB ED    		 CALL SETFRM ;TO PICK UP BC	;TO PICK UP BC
580)   E1FB DD E1       		 POP IX	;
581)   E1FD 79          		 LD A C	;
582)   E1FE 17          		 RLA	;
583)   E1FF 78          		 LD A B	;
584)   E200 17          		 RLA	;
585)   E201 F3          		 DI	;
586)   E202 D3 09       		 OUT (TVLL) A	;
587)   E204 CB 71       		 BIT 6 C	;
588)   E206 28 02       		 JR Z LOWADD	;
589)   E208 D3 08       		 OUT (TVLATCH) A	;
590)   E20A 3A 0C 00    		LOWADD LD A (EXCESS)	;
591)   E20D FE 18       		 CP 24 ;JUMPS 'OUT' IF EXCESS = 24	;JUMPS 'OUT' IF EXCESS = 24
592)   E20F 28 04       		 JR Z TVPON	;
593)   E211 3E 01       		 LD A 1 ;TVD	;TVD
594)   E213 ED 79       		 OUT (C) A	;
595)   E215 21 24 00    		TVPON: LD HL,ENREGMAP	;
596)   E218 CB D6       		 SET VIDEO,(HL) ;Turns on scan	;Turns on scan
597)   E21A 18 05       		 JR LDENREG	;
599)   E21C 21 24 00    		NOVID LD HL ENREGMAP	;
600)   E21F CB 96       		 RES VIDEO (HL)	;
601)   E221 7E          		LDENREG:LD A (HL)	;
602)   E222 D3 07       		 OUT (ENREG) A	;
603)   E224 C9          		 RET	;
609)   E225 0E 06       		 LD C,COP	;
610)   E227 ED 78       		 IN A,(C) ;GET INTRPT VECTOR	;GET INTRPT VECTOR
611)   E229 21 3B 00    		 LD HL,COPCTL	;
612)   E22C 56          		 LD D,(HL) ; POINT HL AT ACK. WORD	; POINT HL AT ACK. WORD
613)   E22D ED 51       		 OUT (C),D ; AND SEND IT TO COP	; AND SEND IT TO COP
614)   E22F 23          		 INC HL ; POINT HL AT COPSTATUS	; POINT HL AT COPSTATUS
615)   E230 06 10       		 LD B,10H ;BRANCH ACCORDING TO BITS	;BRANCH ACCORDING TO BITS
616)   E232 90          		 SUB B ;4-6 OF VECTOR, WILL ARRIVE	;4-6 OF VECTOR, WILL ARRIVE
617)   E233 38 63       		 JR C REGINT ;CODE 0XH	;CODE 0XH
618)   E235 90          		 SUB B	;
619)   E236 38 2C       		 JR C CASSERR ;CODE 1XH	;CODE 1XH
620)   E238 90          		 SUB B	;
621)   E239 38 10       		 JR C CASSIN ;CODE 2XH	;CODE 2XH
622)   E23B 90          		 SUB B	;
623)   E23C 38 3A       		 JR C KBD ;CODE 3XH	;CODE 3XH
624)   E23E 90          		 SUB B	;
625)   E23F D0          		 RET NC	;
630)   E240 CD 6D E2    		 CALL CASSVR	;
631)   E243 06 3B       		 LD B CODEL ;	;
632)   E245 10 FE       		CODLP DJNZ CODLP ;	;
633)   E247 7E          		 LD A (HL) ;	;
634)   E248 ED 79       		 OUT (C) A ;put char. out to COP	;put char. out to COP
635)   E24A C9          		 RET	;
637)   E24B 1F          		CASSIN RRA ;	;
638)   E24C 38 0B       		 JR C SCHBIT-$ ;bottom bit indicates	;bottom bit indicates
639)   E24E CD 6D E2    		 CALL CASSVR	;
640)   E251 06 52       		 LD B CIDEL ;	;
641)   E253 10 FE       		CIDLP DJNZ CIDLP ;	;
642)   E255 ED 78       		 IN A (C) ;gets char. from COP	;gets char. from COP
643)   E257 77          		 LD (HL) A	;
644)   E258 C9          		 RET	;
646)   E259 1F          		SCHBIT RRA ;ASSUMES CBRK = BIT 0 HERE	;ASSUMES CBRK = BIT 0 HERE
647)   E25A D0          		 RET NC	;
648)   E25B 3A 23 00    		 LD A (BRKBUF)	;
649)   E25E B7          		 OR A	;
650)   E25F C0          		 RET NZ	;
651)   E260 CB DE       		 SET BRKOK (HL)	;
652)   E262 AF          		 XOR A	;
653)   E263 01          		 DEFB 01H ;op-code for LD BC,nn-i.e. skip	;op-code for LD BC,nn-i.e. skip
655)   E264 3E 82       		 LD A DROPOUTERR	;
656)   E266 CB EE       		 SET READY (HL)	;
657)   E268 CB E6       		 SET CERR (HL)	;
658)   E26A 23          		 INC HL	;
659)   E26B 77          		 LD (HL) A	;
660)   E26C C9          		 RET	;
662)   E26D 3A 24 00    		CASSVR: LD A,(ENREGMAP)	;
663)   E270 CB 97       		 RES VIDEO,A	;
664)   E272 D3 07       		 OUT (ENREG),A	;
665)   E274 CB EE       		 SET READY,(HL)	;
666)   E276 23          		 INC HL	;
667)   E277 C9          		 RET	;
670)   E278 CD 13 80    		 CALL $8013 ;RS_KEYRD      ;CHECK IF KEY AVAIL CDESP ADD 3 BYTES	;RS_KEYRD      ;CHECK IF KEY AVAIL CDESP ADD 3 BYTES
671)   E27B 28 1B       		 JR Z,REGINT      ;NO KEY AVAL TREAT AS REGULAR INT CDESP ADD 2 BYTES	;NO KEY AVAL TREAT AS REGULAR INT CDESP ADD 2 BYTES
676)   E27D 00          		 NOP	;
677)   E27E CB F6       		 SET KDATA (HL)	;
678)   E280 CD 04 80    		KBDLP CALL $8004 ;GTKEY ;CDESP CHANGE THIS FOR MY KEYBOARD SUPPORT A SHOULD HAVE THE KEY NB STYLE	;GTKEY ;CDESP CHANGE THIS FOR MY KEYBOARD SUPPORT A SHOULD HAVE THE KEY NB STYLE
679)   E283 00          		 NOP	;
680)   E284 00          		 NOP	;
681)   E285 00          		 NOP	;
682)   E286 00          		 NOP	;
687)   E287 23          		 INC HL	;
688)   E288 77          		 LD (HL),A	;
689)   E289 2B          		 DEC HL	;
690)   E28A E6 3F       		 AND 3FH	;
691)   E28C FE 18       		 CP 18H ;* KEY	;* KEY
692)   E28E 20 05       		 JR NZ PREND	;
693)   E290 CB 5E       		 BIT BRKOK (HL)	;
694)   E292 C8          		 RET Z	;
695)   E293 CB B6       		 RES KDATA (HL)	;
696)   E295 CB 9E       		PREND RES BRKOK (HL)	;
697)   E297 C9          		 RET	;
700)   E298 E6 07       		 AND 07H ;COPY BITS 0-2 (TIMER0,BATTLOW	;COPY BITS 0-2 (TIMER0,BATTLOW
701)   E29A B6          		 OR (HL) ;BRK,RESP) TO COPST	;BRK,RESP) TO COPST
702)   E29B 77          		 LD (HL),A	;
703)   E29C CB EE       		 SET READY,(HL)	;
704)   E29E 2B          		 DEC HL ;POINT BACK AT COPCTL	;POINT BACK AT COPCTL
705)   E29F 36 D0       		 LD (HL),NULLCOM	;
706)   E2A1 7A          		 LD A,D ;OLD COMMAND CODE	;OLD COMMAND CODE
707)   E2A2 E6 F0       		 AND 0F0H ;MASK OFF CONTROL BITS	;MASK OFF CONTROL BITS
708)   E2A4 16 12       		 LD D,18	;
709)   E2A6 23          		 INC HL ;Now HL->COPST = OUTBUFF-2	;Now HL->COPST = OUTBUFF-2
710)   E2A7 FE A0       		 CP DISPCOM	;
711)   E2A9 28 0D       		 JR Z URAM	;
712)   E2AB FE D0       		 CP NULLCOM 	;
713)   E2AD 28 2D       		 JR Z PDN?	;
714)   E2AF FE B0       		 CP TIMCOM	;
715)   E2B1 20 1E       		 JR NZ UCLACK	;
716)   E2B3 21 4C 00    		 LD HL,TIMBUFF-2	;
717)   E2B6 16 06       		 LD D,6	;
718)   E2B8 06 50       		URAM: LD B,SYNCDEL	;
719)   E2BA DB 14       		SYNDLP IN A (STREG) ;was just DJNZ SYNDLP	;was just DJNZ SYNDLP
720)   E2BC CB 7F       		 BIT COPINTBAR,A	;
721)   E2BE 20 FA       		 JR NZ SYNDLP	;
722)   E2C0 CB 6F       		 BIT CLKINTBAR,A	;
723)   E2C2 20 F6       		 JR NZ SYNDLP	;
724)   E2C4 42          		 LD B,D	;
725)   E2C5 ED A3       		OUTLP OUTI ;WRITE 1 BYTE EVERY 20 MUSECS	;WRITE 1 BYTE EVERY 20 MUSECS
726)   E2C7 DD E5       		 PUSH IX	;
727)   E2C9 DD E1       		 POP IX	;
728)   E2CB 00          		 NOP	;
729)   E2CC 00          		 NOP	;
730)   E2CD 7E          		 LD A,(HL)	;
731)   E2CE 7E          		 LD A,(HL)	;
732)   E2CF 20 F4       		 JR NZ OUTLP	;
733)   E2D1 06 04       		UCLACK LD B,4	;
734)   E2D3 21 52 00    		 LD HL,CLACK	;
735)   E2D6 34          		UCLKLP INC (HL)	;
736)   E2D7 23          		 INC HL	;
737)   E2D8 C0          		 RET NZ	;
738)   E2D9 10 FB       		 DJNZ UCLKLP	;
739)   E2DB C9          		 RET	;
741)   E2DC CB 46       		PDN? BIT TIMER0,(HL)	;
742)   E2DE CB 86       		 RES TIMER0,(HL)	;
743)   E2E0 28 EF       		 JR Z UCLACK	;
744)   E2E2 CB 66       		 BIT TIMEOUT,(HL)	;
745)   E2E4 28 EB       		 JR Z UCLACK	;
746)   E2E6 3E C0       		 LD A,PDNCOM	;
747)   E2E8 ED 79       		 OUT (C),A	;
748)   E2EA CB A6       		 RES TIMEOUT,(HL)	;
749)   E2EC 2B          		 DEC HL	;
750)   E2ED 36 A0       		 LD (HL),DISPCOM	;
751)   E2EF 21 7B E1    		 LD HL POFF	;
752)   E2F2 E5          		 PUSH HL	;
753)   E2F3 ED 4D       		 RETI	;
759)   E2F5 31 68 02    		NMIRST: LD SP,STACK	;
760)   E2F8 CD 43 E1    		 CALL RESIRS	;
761)   E2FB 21 0E C1    		 LD HL,BREADY	;
762)   E2FE E5          		 PUSH HL	;
763)   E2FF FB          		 EI	;
764)   E300 ED 45       		 RETN	;
768)   E302 E5          		RDKEY PUSH HL	;
769)   E303 D5          		 PUSH DE	;
770)   E304 C5          		 PUSH BC	;
771)   E305 E7 38       		CSET DEFW ZGETKEY	;
772)   E307 E7 3A       		 DEFW ZKLOOK	;
773)   E309 30 05       		 JR NC CNSET	;
774)   E30B 20 F8       		 JR NZ CSET	;
775)   E30D 77          		 LD (HL) A	;
776)   E30E 18 F5       		 JR CSET	;
777)   E310 C1          		CNSET POP BC	;
778)   E311 D1          		 POP DE	;
779)   E312 E1          		 POP HL	;
780)   E313 C9          		 RET	;
784)   E314 21 07 FF    		FPID2: LD HL,CPID2	;
785)   E317 C3 8B F5    		 JP FSTO	;
787)   E31A 00          		 DEFB 0 ;filler	;filler
798)   E31B 3A 23 00    		 LD A (BRKBUF)	;
799)   E31E B7          		 OR A	;
800)   E31F C0          		 RET NZ	;
801)   E320 E5          		 PUSH HL	;
802)   E321 21 3C 00    		 LD HL,COPST	;
803)   E324 CB 56       		 BIT BRKKEY,(HL)	;
804)   E326 CB 96       		 RES BRKKEY,(HL)	;
805)   E328 E1          		 POP HL	;
806)   E329 C8          		 RET Z	;
807)   E32A AF          		 XOR A	;
808)   E32B 37          		 SCF 	;
809)   E32C C9          		 RET	;
811)   E32D 21 60 FE    		STKTST LD HL -STKRAM	;
812)   E330 39          		 ADD HL SP	;
813)   E331 B7          		 OR A	;
814)   E332 ED 42       		 SBC HL BC	;
815)   E334 C9          		 RET	;
824)   E335 2B          		 DEC HL	;
825)   E336 0C          		 INC C	;
826)   E337 23          		RDNSP2 INC HL	;
827)   E338 0D          		 DEC C	;
828)   E339 C8          		 RET Z	;
829)   E33A CD 6D E3    		 CALL HLTTCAPS	;
830)   E33D FE 20       		 CP ' '	;
831)   E33F C0          		 RET NZ	;
832)   E340 18 F5       		 JR RDNSP2	;
836)   E342 C5          		SHLREG: PUSH BC	;
837)   E343 06 06       		 LD B,6	;
838)   E345 CB 16       		SHLLP RL (HL)	;
839)   E347 2D          		 DEC L	;
840)   E348 10 FB       		 DJNZ SHLLP	;
841)   E34A C1          		 POP BC	;
842)   E34B C9          		 RET	;
846)   E34C 4C 32 34    		TPSTR DEFM 'L24'	;
852)   E34F E5          		IOP1 PUSH HL	;
853)   E350 21 24 00    		 LD HL ENREGMAP	;
854)   E353 F3          		 DI	;
855)   E354 CB DE       		 SET IOPOWER (HL)	;
856)   E356 7E          		 LD A (HL)	;
857)   E357 D3 07       		 OUT (ENREG) A	;
858)   E359 FB          		 EI	;
859)   E35A 23          		 INC HL ;point at use count	;point at use count
860)   E35B 34          		 INC (HL)	;
861)   E35C B7          		 OR A ;clears CY	;clears CY
862)   E35D E1          		 POP HL	;
863)   E35E C9          		 RET	;
865)   E35F 21 25 00    		IOP2 LD HL IOPUC ;should preserve C-flag	;should preserve C-flag
866)   E362 35          		 DEC (HL)	;
867)   E363 C0          		 RET NZ	;
868)   E364 2B          		 DEC HL ;point at ENREGMAP	;point at ENREGMAP
869)   E365 F3          		 DI	;
870)   E366 CB 9E       		 RES IOPOWER (HL)	;
871)   E368 7E          		 LD A (HL)	;
872)   E369 D3 07       		 OUT (ENREG) A	;
873)   E36B FB          		 EI	;
874)   E36C C9          		 RET	;
879)   E36D 7E          		HLTTCAPS: LD A,(HL)	;
880)   E36E FE 61       		TTCAPS CP 61H	;
881)   E370 D8          		 RET C	;
882)   E371 FE 7B       		 CP 7BH	;
883)   E373 D0          		 RET NC	;
884)   E374 D6 20       		 SUB 20H	;
885)   E376 C9          		 RET	;
887)   E377 FE 30       		RDIGIT CP 30H	;
888)   E379 D8          		 RET C	;
889)   E37A FE 3A       		 CP 3AH	;
890)   E37C 3F          		 CCF	;
891)   E37D D8          		 RET C	;
892)   E37E D6 30       		 SUB 30H	;
893)   E380 C9          		 RET	;
900)   E381 D5          		 PUSH DE	;
901)   E382 CD 8B E3    		 CALL RDINT	;
902)   E385 3E 00       		 LD A,0	;
903)   E387 9A          		 SBC A,D ;set CY if already set or	;set CY if already set or
904)   E388 7B          		 LD A,E ;if ans>255	;if ans>255
905)   E389 D1          		 POP DE	;
906)   E38A C9          		 RET	;
921)   E38B C5          		 PUSH BC	;
922)   E38C E5          		 PUSH HL	;
923)   E38D 11 00 00    		 LD DE,0	;
924)   E390 43          		 LD B,E ;flag not yet found digit	;flag not yet found digit
925)   E391 2B          		 DEC HL	;
926)   E392 0C          		 INC C	;
927)   E393 23          		RDILP: INC HL ;pt at nxt char	;pt at nxt char
928)   E394 0D          		 DEC C	;
929)   E395 37          		 SCF	;
930)   E396 7E          		 LD A,(HL)	;
931)   E397 C4 77 E3    		 CALL NZ RDIGIT ;if another char.	;if another char.
932)   E39A 30 08       		 JR NC RDI1 ;if a digit	;if a digit
933)   E39C 05          		 DEC B	;
934)   E39D 20 17       		 JR NZ RDI2 ;if havn't found integer	;if havn't found integer
935)   E39F F1          		 POP AF	;
936)   E3A0 F1          		 POP AF ;restore B	;restore B
937)   E3A1 47          		 LD B,A	;
938)   E3A2 B7          		 OR A	;
939)   E3A3 C9          		 RET	;
941)   E3A4 06 01       		RDI1: LD B,1 ;flag digit found	;flag digit found
942)   E3A6 E5          		 PUSH HL	;
943)   E3A7 6F          		 LD L,A ;Multiply total so far by	;Multiply total so far by
944)   E3A8 26 00       		 LD H,0 ;10 and add in A.	;10 and add in A.
945)   E3AA 3E 0A       		 LD A,10	;
946)   E3AC 19          		RDILP1: ADD HL,DE	;
947)   E3AD 38 04       		 JR C RDI15 ;if overflow	;if overflow
948)   E3AF 3D          		 DEC A	;
949)   E3B0 20 FA       		 JR NZ RDILP1	;
950)   E3B2 EB          		 EX DE,HL	;
951)   E3B3 E1          		RDI15: POP HL	;
952)   E3B4 30 DD       		 JR NC RDILP ;unless overflow	;unless overflow
953)   E3B6 E1          		RDI2: POP HL ;error exit	;error exit
954)   E3B7 C1          		 POP BC	;
955)   E3B8 C9          		 RET	;
 59)   E3B9 AF          		 XOR A	;
 60)   E3BA 92          		 SUB D	;
 61)   E3BB 3E 79       		 LD A,WPTERR	;
 62)   E3BD D8          		 RET C ;if not port 0	;if not port 0
 63)   E3BE 90          		 SUB B	;
 64)   E3BF 38 25       		 JR C RBRPS7 ;if len(brps)>255	;if len(brps)>255
 65)   E3C1 91          		 SUB C	;
 66)   E3C2 28 09       		 JR Z RBRPS1 ;if len(brps)=0	;if len(brps)=0
 67)   E3C4 CD 6D E3    		 CALL HLTTCAPS	;
 68)   E3C7 FE 54       		 CP 'T'	;
 69)   E3C9 20 02       		 JR NZ RBRPS1 ;if no leading T	;if no leading T
 70)   E3CB 23          		 INC HL ;else advance instream	;else advance instream
 71)   E3CC 0D          		 DEC C	;
 72)   E3CD CD E9 E3    		RBRPS1: CALL RDBRI ;read tx brp	;read tx brp
 73)   E3D0 47          		 LD B,A ;tx brp to B	;tx brp to B
 74)   E3D1 79          		 LD A,C	;
 75)   E3D2 B7          		 OR A	;
 76)   E3D3 28 0A       		 JR Z RBRPS2 ;if len(remaining brps)=0	;if len(remaining brps)=0
 77)   E3D5 CD 6D E3    		 CALL HLTTCAPS	;
 78)   E3D8 FE 52       		 CP 'R'	;
 79)   E3DA 37          		 SCF	;
 80)   E3DB 20 09       		 JR NZ RBRPS7 ;if no R	;if no R
 81)   E3DD 23          		 INC HL	;
 82)   E3DE 0D          		 DEC C	;
 83)   E3DF CD E9 E3    		RBRPS2: CALL RDBRI ;read rx brp	;read rx brp
 84)   E3E2 57          		 LD D,A ;save in D	;save in D
 85)   E3E3 AF          		 XOR A ;Set CY iff	;Set CY iff
 86)   E3E4 91          		 SUB C ;len(remaining brp) non-zero	;len(remaining brp) non-zero
 87)   E3E5 4A          		 LD C,D ;rx brp to C	;rx brp to C
 88)   E3E6 3E 78       		RBRPS7: LD A,BRPERR	;
 89)   E3E8 C9          		 RET	;
 98)   E3E9 D5          		 PUSH DE	;
 99)   E3EA CD 8B E3    		 CALL RDINT	;
100)   E3ED 3E 02       		 LD A,DFLTBRP	;
101)   E3EF 38 0E       		 JR C RDBI8	;
102)   E3F1 AF          		 XOR A	;
103)   E3F2 E5          		 PUSH HL	;
104)   E3F3 21 00 4B    		 LD HL,MAXBR	;
105)   E3F6 ED 52       		RDBILP: SBC HL,DE	;
106)   E3F8 3C          		 INC A	;
107)   E3F9 28 02       		 JR Z RDBI2 ;if answer>255	;if answer>255
108)   E3FB 30 F9       		 JR NC RDBILP ;if division not over	;if division not over
109)   E3FD 3D          		RDBI2: DEC A	;
110)   E3FE E1          		 POP HL	;
111)   E3FF B7          		RDBI8: OR A ;clear CY, test A	;clear CY, test A
112)   E400 D1          		 POP DE	;
113)   E401 C0          		 RET NZ	;
114)   E402 3C          		 INC A	;
115)   E403 C9          		 RET ;make sure non-zero ans.	;make sure non-zero ans.
117)   E404 CD B9 E3    		SOPN CALL RDBRPS	;
118)   E407 C5          		 PUSH BC	;
119)   E408 01 04 00    		 LD BC 4	;
120)   E40B EF 37       		 DEFW WMKBUFF	;
121)   E40D C1          		 POP BC	;
122)   E40E D8          		 RET C	;
123)   E40F 71          		 LD (HL),C ;rx brp	;rx brp
124)   E410 23          		 INC HL	;
125)   E411 36 50       		 LD (HL),LILEN	;
126)   E413 23          		 INC HL	;
127)   E414 36 00       		 LD (HL),0 ;print head position	;print head position
128)   E416 23          		 INC HL	;
129)   E417 70          		 LD (HL),B ;tx brp	;tx brp
130)   E418 C9          		 RET	;
133)   E419 04          		DUMMY DEFB 4	;
134)   E41A 39          		 DEFB UPOC-$	;
135)   E41B 38          		 DEFB UPOC-$	;
136)   E41C 37          		 DEFB UPOC-$	;
137)   E41D 36          		 DEFB UPOC-$	;
138)   E41E 35          		 DEFB UPOC-$	;
140)   E41F 04          		UPIO DEFB 4	;
141)   E420 33          		 DEFB UPOC-$	;
142)   E421 32          		 DEFB UPOC-$	;
143)   E422 03          		 DEFB UPIN-$	;
144)   E423 07          		 DEFB UPOUT-$	;
145)   E424 2F          		 DEFB UPOC-$	;
147)   E425 4A          		UPIN LD C,D	;
148)   E426 ED 78       		 IN A,(C)	;
149)   E428 B7          		 OR A	;
150)   E429 C9          		 RET	;
152)   E42A 4A          		UPOUT LD C,D	;
153)   E42B ED 79       		 OUT (C),A	;
154)   E42D B7          		 OR A	;
155)   E42E C9          		 RET	;
157)   E42F 04          		JGIO DEFB 4	;
158)   E430 05          		 DEFB JGOP-$	;
159)   E431 04          		 DEFB JGOP-$	;
160)   E432 B2          		 DEFB MJIN-$	;
161)   E433 67          		 DEFB JGOUT-$	;
162)   E434 1F          		 DEFB UPOC-$	;
164)   E435 CD 04 E4    		JGOP CALL SOPN	;
165)   E438 1E 30       		 LD E,V24DMSK+CTSMSK	;
166)   E43A 18 0B       		 JR LPO1	;
168)   E43C 04          		LPIO DEFB 4	;
169)   E43D 05          		 DEFB LPOPOU-$	;
170)   E43E 04          		 DEFB LPOPOU-$	;
171)   E43F 00          		 DEFB 0	;
172)   E440 17          		 DEFB LPOUT-$	;
173)   E441 12          		 DEFB UPOC-$	;
175)   E442 CD 04 E4    		LPOPOU CALL SOPN	;
176)   E445 1E 90       		 LD E,PTRDMSK+CTSMSK	;
177)   E447 D8          		LPO1: RET C	;
178)   E448 F3          		 DI	;
179)   E449 3A 24 00    		 LD A (ENREGMAP)	;
180)   E44C B3          		 OR E	;
181)   E44D D3 07       		 OUT (ENREG) A	;
182)   E44F 32 24 00    		 LD (ENREGMAP) A	;
183)   E452 FB          		 EI	;
184)   E453 AF          		UPOC: XOR A	;
185)   E454 47          		 LD B A	;
186)   E455 4F          		 LD C A	;
187)   E456 C9          		 RET	;
190)   E457 23          		LPOUT: INC HL ;pt at line length	;pt at line length
191)   E458 11 80 80    		 LD DE,(PTRSMSK.SHL.8)+PTRDMSK	;
192)   E45B FE 20       		 CP SPACE	;
193)   E45D 38 10       		 JR C ISCODE	;
194)   E45F F5          		 PUSH AF	;
195)   E460 7E          		 LD A,(HL) ;line length	;line length
196)   E461 23          		 INC HL ;pt at print hed posn	;pt at print hed posn
197)   E462 AE          		 XOR (HL) ;set Z if equal, clear CY	;set Z if equal, clear CY
198)   E463 CC 8B E4    		 CALL Z NEWLIN	;
199)   E466 C1          		 POP BC	;
200)   E467 D8          		 RET C	;
201)   E468 78          		 LD A B	;
202)   E469 CD 9F E4    		 CALL LPWRT	;
203)   E46C D8          		 RET C	;
204)   E46D 34          		 INC (HL)	;
205)   E46E C9          		 RET	;
207)   E46F FE 09       		ISCODE CP TAB	;
208)   E471 20 13       		 JR NZ NOTTAB	;
209)   E473 7E          		GOTTAB LD A,(HL) ;Here for tab char	;Here for tab char
210)   E474 23          		 INC HL	;
211)   E475 BE          		 CP (HL)	;
212)   E476 28 13       		 JR Z NEWLIN	;
213)   E478 3E 20       		 LD A SPACE	;
214)   E47A CD 9F E4    		 CALL LPWRT	;
215)   E47D D8          		 RET C	;
216)   E47E 34          		 INC (HL)	;
217)   E47F 3E 07       		 LD A 7	;
218)   E481 A6          		 AND (HL)	;
219)   E482 2B          		 DEC HL	;
220)   E483 20 EE       		 JR NZ GOTTAB	;
221)   E485 C9          		 RET	;
223)   E486 23          		NOTTAB: INC HL ;pt at print head posn	;pt at print head posn
224)   E487 FE 0D       		 CP CR	;
225)   E489 20 14       		 JR NZ LPWRT	;
226)   E48B 3E 0D       		NEWLIN LD A CR	;
227)   E48D CD 9F E4    		 CALL LPWRT	;
228)   E490 D8          		 RET C	;
229)   E491 3E 0A       		 LD A LF	;
230)   E493 CD 9F E4    		 CALL LPWRT	;
231)   E496 D8          		 RET C	;
232)   E497 36 00       		 LD (HL) 0	;
233)   E499 C9          		 RET	;
236)   E49A 11 20 02    		JGOUT: LD DE,(V24SMSK.SHL.8)+V24DMSK	;
237)   E49D 23          		 INC HL	;
238)   E49E 23          		 INC HL	;
239)   E49F 4F          		LPWRT LD C A	;
240)   E4A0 FB          		CHECK EI	;
241)   E4A1 CD 1B E3    		 CALL BRKTST	;
242)   E4A4 D8          		 RET C	;
243)   E4A5 F3          		 DI	;
244)   E4A6 DB 16       		 IN A (USRPT)	;
245)   E4A8 A2          		 AND D ;Test ready for sending bit	;Test ready for sending bit
246)   E4A9 20 F5       		 JR NZ CHECK	;
247)   E4AB E5          		 PUSH HL	;
248)   E4AC CD 1C E2    		 CALL NOVID	;
249)   E4AF E1          		 POP HL	;
250)   E4B0 23          		 INC HL ;pt at tx brp	;pt at tx brp
251)   E4B1 06 0B       		 LD B,11 ;two stop bits	;two stop bits
252)   E4B3 B7          		 OR A ;Start bit low	;Start bit low
253)   E4B4 3A 24 00    		SENDLP LD A (ENREGMAP)	;
254)   E4B7 38 04       		 JR C SEND1 ;if want high	;if want high
255)   E4B9 B3          		 OR E	;
256)   E4BA AB          		 XOR E ;reset approp. bit	;reset approp. bit
257)   E4BB 18 04       		 JR SEND2	;
259)   E4BD B3          		SEND1: OR E	;
260)   E4BE B7          		 OR A ;to delay	;to delay
261)   E4BF 38 FE       		 JR C 0 ; "   "	; "   "
262)   E4C1 D3 07       		SEND2: OUT (ENREG) A	;
263)   E4C3 C5          		 PUSH BC	;
264)   E4C4 4E          		 LD C (HL)	;
265)   E4C5 0D          		DELAY DEC C	;
266)   E4C6 28 09       		 JR Z NOCOUNT	;
267)   E4C8 06 0C       		 LD B 12	;
268)   E4CA 10 FE       		DELAY1 DJNZ DELAY1	;
269)   E4CC C5          		 PUSH BC ;These three stmts to delay	;These three stmts to delay
270)   E4CD 03          		 INC BC	;
271)   E4CE C1          		 POP BC	;
272)   E4CF 18 F4       		 JR DELAY	;
274)   E4D1 06 06       		NOCOUNT LD B,6	;
275)   E4D3 10 FE       		DELAY2 DJNZ DELAY2	;
276)   E4D5 37          		 SCF	;
277)   E4D6 37          		 SCF	;
278)   E4D7 37          		 SCF	;
279)   E4D8 C1          		 POP BC	;
280)   E4D9 CB 19       		 RR C	;
281)   E4DB 10 D7       		 DJNZ SENDLP	;
282)   E4DD CD 48 E5    		 CALL STOPTV	;
283)   E4E0 FB          		 EI	;
284)   E4E1 2B          		 DEC HL	;
285)   E4E2 B7          		 OR A	;
286)   E4E3 C9          		 RET	;
289)   E4E4 4E          		MJIN LD C (HL)	;
290)   E4E5 1E 0A       		 LD E 10	;
291)   E4E7 F3          		 DI	;
292)   E4E8 21 24 00    		 LD HL ENREGMAP	;
293)   E4EB CB 96       		 RES VIDEO (HL)	;
294)   E4ED 7E          		 LD A (HL)	;
295)   E4EE CB A7       		 RES CTS A	;
296)   E4F0 D3 07       		 OUT (ENREG) A	;
297)   E4F2 CD 22 E5    		MJIN2 CALL MWAIT	;
298)   E4F5 3A 24 00    		MJIN3 LD A (ENREGMAP)	;
299)   E4F8 D3 07       		 OUT (ENREG) A	;
300)   E4FA 51          		 LD D,C	;
301)   E4FB 06 01       		 LD B 1	;
302)   E4FD 10 FE       		MJIN4 DJNZ MJIN4	;
303)   E4FF 0D          		 DEC C	;
304)   E500 06 07       		 LD B,7	;
305)   E502 20 F9       		 JR NZ MJIN4	;
306)   E504 DB 16       		MJIN5 IN A (USRPT)	;
307)   E506 4A          		 LD C D	;
308)   E507 1F          		 RRA	;
309)   E508 1D          		 DEC E ;count bits in	;count bits in
310)   E509 28 10       		 JR Z GOTCHR ;tenth was STOP bit - discard	;tenth was STOP bit - discard
311)   E50B CB 1C       		 RR H ;data bits into H	;data bits into H
312)   E50D 06 09       		 LD B,9	;
313)   E50F 00          		MJIN6 NOP	;
314)   E510 10 FD       		 DJNZ MJIN6	;
315)   E512 0D          		MJIN7 DEC C	;
316)   E513 28 EF       		 JR Z MJIN5	;
317)   E515 06 0E       		 LD B 14	;
318)   E517 10 FE       		MJIN8 DJNZ MJIN8	;
319)   E519 18 F7       		 JR MJIN7	;
321)   E51B CD 48 E5    		GOTCHR CALL STOPTV	;
322)   E51E FB          		 EI	;
323)   E51F 7C          		 LD A H	;
324)   E520 B7          		 OR A	;
325)   E521 C9          		 RET	;
327)   E522 21 00 64    		MWAIT: LD HL 25600	;
329)   E525 DB 16       		MWAIT2 IN A (USRPT)	;
330)   E527 1F          		 RRA ;check d0 ('DATA')	;check d0 ('DATA')
331)   E528 D0          		 RET NC	;
332)   E529 10 FA       		 DJNZ MWAIT2	;
333)   E52B DB 16       		 IN A (USRPT)	;
334)   E52D 1F          		 RRA ;check d0 ('DATA')	;check d0 ('DATA')
335)   E52E D0          		 RET NC	;
336)   E52F 2D          		 DEC L	;
337)   E530 DB 16       		 IN A (USRPT)	;
338)   E532 1F          		 RRA ;check d0 ('DATA')	;check d0 ('DATA')
339)   E533 D0          		 RET NC	;
340)   E534 C2 25 E5    		 JP NZ MWAIT2	;
341)   E537 DB 16       		 IN A (USRPT)	;
342)   E539 1F          		 RRA ;check d0 ('DATA')	;check d0 ('DATA')
343)   E53A D0          		 RET NC	;
344)   E53B 25          		 DEC H	;
345)   E53C DB 16       		 IN A (USRPT)	;
346)   E53E 1F          		 RRA	;
347)   E53F D0          		 RET NC	;
348)   E540 C2 25 E5    		 JP NZ MWAIT2	;
349)   E543 F1          		 POP AF	;
350)   E544 3E C8       		 LD A 200 ;TIMEOUT ERROR	;TIMEOUT ERROR
351)   E546 37          		 SCF	;
352)   E547 C9          		 RET	;
354)   E548 E5          		STOPTV PUSH HL	;
355)   E549 21 0E 00    		 LD HL TV2	;
356)   E54C CB E6       		 SET 4 (HL)	;
357)   E54E E1          		 POP HL	;
358)   E54F C9          		 RET	;
118)   E550 CD 6D E3    		SYNCHK CALL HLTTCAPS	;
119)   E553 FE 53       		 CP 'S'	;
120)   E555 28 06       		 JR Z SLCHK	;
121)   E557 FE 4C       		 CP 'L'	;
122)   E559 20 05       		 JR NZ SHORT	;
123)   E55B 06 50       		 LD B 80	;
124)   E55D 0D          		SLCHK DEC C	;
125)   E55E 23          		 INC HL	;
126)   E55F C8          		 RET Z	;
127)   E560 CD 81 E3    		SHORT CALL RDBYTE	;
128)   E563 D8          		 RET C	;
129)   E564 B7          		 OR A	;
130)   E565 37          		 SCF	;
131)   E566 C8          		 RET Z	;
132)   E567 3F          		 CCF	;
133)   E568 57          		 LD D A	;
134)   E569 C9          		 RET	;
136)   E56A 1E 20       		SETCNS LD E 20H ;CNSFLG	;CNSFLG
137)   E56C 3E 0A       		 LD A 10	;
138)   E56E 32 1D 00    		 LD (PZLEN) A	;
139)   E571 78          		 LD A B	;
140)   E572 32 1B 00    		 LD (PLLEN) A	;
141)   E575 FE 50       		 CP 80	;
142)   E577 D8          		 RET C	;
143)   E578 3E 11       		 LD A 17	;
144)   E57A 32 1D 00    		 LD (PZLEN) A	;
145)   E57D C9          		 RET	;
147)   E57E E5          		CALFILE PUSH HL	;
148)   E57F DD E1       		 POP IX	;
149)   E581 7D          		 LD A L	;
150)   E582 CB C7       		 SET 0 A	;
151)   E584 DD CB 06 5E 		 BIT 3 (IX+EL)	;
152)   E588 20 0A       		 JR NZ CF1	;
153)   E58A 3E 6D       		 LD A 6DH	;
154)   E58C DD CB 05 76 		 BIT 6 (IX+LL)	;
155)   E590 28 02       		 JR Z CF1	;
156)   E592 3E 6F       		 LD A 6FH	;
157)   E594 95          		CF1 SUB L	;
158)   E595 E6 7F       		 AND 7FH	;
159)   E597 C6 10       		 ADD A 10H	;
160)   E599 C9          		 RET	;
162)   E59A CD 7E E5    		RESET1 CALL CALFILE	;
163)   E59D 5F          		 LD E A	;
164)   E59E 96          		 SUB (HL) ;NEW DISP-OLD DISP	;NEW DISP-OLD DISP
165)   E59F C8          		 RET Z ;SAME ANSWER AS BEFORE	;SAME ANSWER AS BEFORE
166)   E5A0 F5          		 PUSH AF	;
167)   E5A1 E5          		 PUSH HL	;
168)   E5A2 E5          		 PUSH HL	;
169)   E5A3 DD E1       		 POP IX	;
170)   E5A5 DD 7E 06    		 LD A (IX+EL)	;
171)   E5A8 DD 56 03    		 LD D (IX+ORIGDEP)	;
172)   E5AB CD A7 EC    		 CALL BACAL ;D*A INTO BC	;D*A INTO BC
173)   E5AE 21 09 00    		 LD HL 9 ;4 REGS & 1 FLAG & 4 ENDS!	;4 REGS & 1 FLAG & 4 ENDS!
174)   E5B1 09          		 ADD HL BC	;
175)   E5B2 4D          		 LD C L	;
176)   E5B3 44          		 LD B H ;BC = NUMBER TO MOVE	;BC = NUMBER TO MOVE
177)   E5B4 E1          		 POP HL	;
178)   E5B5 7E          		 LD A (HL)	;
179)   E5B6 73          		 LD (HL) E ;NEW NUMBER	;NEW NUMBER
180)   E5B7 CD 85 EC    		 CALL ADHLA ;HL > OLD START	;HL > OLD START
181)   E5BA F1          		 POP AF ;A = +/- DISP DIFFERENCE	;A = +/- DISP DIFFERENCE
182)   E5BB 30 09       		 JR NC MOVEUP ;NEW DISP > OLD DISP	;NEW DISP > OLD DISP
183)   E5BD 85          		 ADD A L ;A = -DISP DIFFERENCE	;A = -DISP DIFFERENCE
184)   E5BE 5F          		 LD E A	;
185)   E5BF 7C          		 LD A H	;
186)   E5C0 CE FF       		 ADC A 0FFH ;Basil's modification	;Basil's modification
187)   E5C2 57          		 LD D A ;DE > NEW START	;DE > NEW START
188)   E5C3 ED B0       		 LDIR	;
189)   E5C5 C9          		 RET	;
191)   E5C6 09          		MOVEUP ADD HL BC ;HL > OLD END + 1	;HL > OLD END + 1
192)   E5C7 2B          		 DEC HL ;HL > OLD END	;HL > OLD END
193)   E5C8 85          		 ADD A L	;
194)   E5C9 5F          		 LD E A	;
195)   E5CA 7C          		 LD A H	;
196)   E5CB CE 00       		 ADC A 0	;
197)   E5CD 57          		 LD D A	;
198)   E5CE ED B8       		 LDDR	;
199)   E5D0 C9          		 RET	;
201)   E5D1 DB 14       		TVSYN IN A (STREG)	;
202)   E5D3 CB 57       		 BIT MAINSP A	;
203)   E5D5 3E 6F       		 LD A NOMAINSERR	;
204)   E5D7 37          		 SCF	;
205)   E5D8 C8          		 RET Z	;
206)   E5D9 16 18       		 LD D DEPTH	;
207)   E5DB 78          		 LD A B	;
208)   E5DC B7          		 OR A	;
209)   E5DD 20 66       		 JR NZ ERRET	;
210)   E5DF 06 28       		 LD B TVLEN	;
211)   E5E1 79          		 LD A C	;
212)   E5E2 B7          		 OR A	;
213)   E5E3 C4 50 E5    		 CALL NZ SYNCHK	;
214)   E5E6 38 5D       		 JR C ERRET	;
215)   E5E8 3A 0C 00    		 LD A (EXCESS)	;
216)   E5EB 4F          		 LD C,A	;
217)   E5EC 80          		 ADD A B	;
218)   E5ED CB 70       		 BIT 6 B	;
219)   E5EF 28 01       		 JR Z IS40	;
220)   E5F1 81          		 ADD A,C	;
221)   E5F2 4F          		IS40 LD C A	;
222)   E5F3 D5          		LIOP PUSH DE	;
223)   E5F4 C5          		 PUSH BC	;
224)   E5F5 21 1A 00    		 LD HL 26	;
225)   E5F8 CB 59       		 BIT 3 C	;
226)   E5FA 20 03       		 JR NZ NOTBBC	;
227)   E5FC 21 9A 00    		 LD HL 154	;
228)   E5FF 79          		NOTBBC LD A C	;
229)   E600 CD A7 EC    		 CALL BACAL	;
230)   E603 09          		 ADD HL BC	;
231)   E604 44          		 LD B H	;
232)   E605 4D          		 LD C L	;
233)   E606 E7 37       		NOCAR DEFW ZMKBUFF	;
234)   E608 C1          		 POP BC	;
235)   E609 D1          		 POP DE	;
236)   E60A D8          		 RET C	;
237)   E60B 7B          		 LD A E	;
238)   E60C B7          		 OR A	;
239)   E60D 1E 00       		 LD E 0	;
240)   E60F CC 6A E5    		 CALL Z SETCNS	;
241)   E612 AF          		 XOR A	;
243)   E613 E5          		 PUSH HL	;
244)   E614 23          		 INC HL	;
245)   E615 36 02       		 LD (HL) MD3	;
246)   E617 CB 70       		 BIT 6 B	;
247)   E619 28 02       		 JR Z NOT80	;
248)   E61B CB F6       		 SET 6 (HL)	;
249)   E61D CD A8 F2    		NOT80 CALL LORDEP ;in place of	;in place of
253)   E620 72          		 LD (HL) D ;DEPTH	;DEPTH
254)   E621 23          		 INC HL	;
255)   E622 70          		 LD (HL) B ;LINLEN	;LINLEN
256)   E623 23          		 INC HL	;
257)   E624 71          		 LD (HL) C ;EXLEN	;EXLEN
258)   E625 23          		 INC HL	;
259)   E626 73          		 LD (HL) E ;FLAGS	;FLAGS
260)   E627 06 09       		 LD B 9	;
261)   E629 23          		PUTR1 INC HL	;
262)   E62A 77          		 LD (HL) A	;
263)   E62B 10 FC       		 DJNZ PUTR1	;
264)   E62D E1          		 POP HL	;
265)   E62E CD 7E E5    		 CALL CALFILE	;
266)   E631 77          		 LD (HL) A	;
267)   E632 E5          		GETREG PUSH HL	;
268)   E633 DD E1       		 POP IX	;
269)   E635 F5          		 PUSH AF	;
270)   E636 7E          		 LD A (HL)	;
271)   E637 CD 85 EC    		 CALL ADHLA	;
272)   E63A F1          		 POP AF	;
273)   E63B 01 C4 EC    		 LD BC GETCUR	;
274)   E63E ED 43 09 00 		 LD (RST8) BC	;
275)   E642 C3 AB EF    		 JP LDREGS	;
277)   E645 3E 6E       		ERRET LD A SYNTAXERR	;
278)   E647 37          		 SCF	;
279)   E648 C9          		 RET	;
281)   E649 CD E2 E7    		TVST CALL REMCR0 ;to start TV and remove cursor	;to start TV and remove cursor
282)   E64C 22 5C 00    		TVST1 LD (TVRAM) HL	;
283)   E64F C9          		 RET	;
285)   E650 05          		LIIO DEFB 5	;
286)   E651 06          		 DEFB LIOPIN-$	;
287)   E652 05          		 DEFB LIOPIN-$	;
288)   E653 8A          		 DEFB INP1-$	;
289)   E654 7D          		 DEFB OUT1-$	;
290)   E655 60          		 DEFB LICLS-$	;
291)   E656 34          		 DEFB RESET-$	;
293)   E657 78          		LIOPIN LD A B	;
294)   E658 B7          		 OR A	;
295)   E659 20 EA       		LIOP1 JR NZ ERRET	;
296)   E65B 79          		 LD A C	;
297)   E65C B7          		 OR A	;
298)   E65D 3E 50       		 LD A LILEN	;
299)   E65F C4 81 E3    		 CALL NZ RDBYTE	;
300)   E662 38 E1       		 JR C ERRET	;
301)   E664 FE 10       		 CP 10H	;
302)   E666 38 DD       		 JR C ERRET	;
303)   E668 47          		 LD B A	;
304)   E669 4F          		 LD C A	;
305)   E66A AF          		 XOR A	;
306)   E66B 3C          		 INC A	;
307)   E66C 57          		 LD D A	;
308)   E66D CD F3 E5    		 CALL LIOP	;
309)   E670 D8          		 RET C	;
310)   E671 3E 28       		 LD A 28H	;
311)   E673 18 2B       		 JR OPEN	;
313)   E675 05          		TLIO DEFB 5	;
314)   E676 06          		 DEFB TLOPIN-$	;
315)   E677 05          		 DEFB TLOPIN-$	;
316)   E678 62          		 DEFB TVINP-$	;
317)   E679 55          		 DEFB TVOUT-$	;
318)   E67A 3D          		 DEFB TVCLS-$	;
319)   E67B 0F          		 DEFB RESET-$	;
321)   E67C CD D1 E5    		TLOPIN CALL TVSYN	;
322)   E67F 1E A0       		 LD E 0A0H	;
323)   E681 18 0F       		 JR TVTL	;
325)   E683 05          		TVIO DEFB 5	;
326)   E684 09          		 DEFB TVOPIN-$	;
327)   E685 08          		 DEFB TVOPIN-$	;
328)   E686 54          		 DEFB TVINP-$	;
329)   E687 47          		 DEFB TVOUT-$	;
330)   E688 2F          		 DEFB TVCLS-$	;
331)   E689 01          		 DEFB RESET-$	;
333)   E68A C3 9A E5    		RESET JP RESET1	;
335)   E68D CD D1 E5    		TVOPIN CALL TVSYN	;
336)   E690 1E 80       		 LD E 80H	;
337)   E692 D8          		TVTL RET C	;
338)   E693 CD 6E 00    		 CALL IOPON	;
339)   E696 DD 7E 04    		 LD A (IX+DEP)	;
340)   E699 FE 01       		 CP 1	;
341)   E69B 20 02       		 JR NZ TVTL1	;
342)   E69D CB DB       		 SET OLFLG E	;
343)   E69F 7B          		TVTL1 LD A E	;
344)   E6A0 77          		OPEN LD (HL) A	;
345)   E6A1 3E 1F       		 LD A CLEAR	;
346)   E6A3 CD D4 E6    		 CALL OUT2	;
347)   E6A6 DD 7E 04    		 LD A (IX+DEP)	;
348)   E6A9 CD C8 EC    		 CALL GETCR0	;
349)   E6AC 71          		 LD (HL) C	;
350)   E6AD 23          		 INC HL	;
351)   E6AE 71          		 LD (HL) C	;
352)   E6AF 23          		 INC HL	;
353)   E6B0 36 20       		 LD (HL) BLANK	;
354)   E6B2 23          		 INC HL	;
355)   E6B3 36 20       		 LD (HL) BLANK	;
356)   E6B5 AF          		LICLS: XOR A	;
357)   E6B6 C9          		 RET	;
359)   E6B7 ED 4B 5C 00 		TVCLS LD BC (TVRAM)	;
360)   E6BB AF          		 XOR A	;
361)   E6BC ED 42       		 SBC HL BC	;
362)   E6BE 20 0A       		 JR NZ TVCLS1	;
363)   E6C0 32 0E 00    		 LD (TV2) A	;
364)   E6C3 21 24 00    		 LD HL,ENREGMAP	;
365)   E6C6 CB 56       		WTBLNK: BIT VIDEO,(HL)	;
366)   E6C8 20 FC       		 JR NZ WTBLNK ;wait for video to blank	;wait for video to blank
367)   E6CA B7          		TVCLS1 OR A	;
368)   E6CB C3 71 00    		 JP IOPOFF	;
370)   E6CE CD 49 E6    		TVOUT CALL TVST	;
371)   E6D1 CD 32 E6    		OUT1 CALL GETREG	;
372)   E6D4 CD 84 E7    		OUT2 CALL OUT	;
373)   E6D7 C3 59 E7    		 JP INEND	;
375)   E6DA CD 49 E6    		TVINP CALL TVST	;
376)   E6DD CD 32 E6    		INP1 CALL GETREG	;
377)   E6E0 DD 7E 08    		 LD A (IX+EXFLGS)	;
378)   E6E3 17          		 RLA	;
379)   E6E4 30 06       		 JR NC NOTCC	;
380)   E6E6 CD 7B E7    		SENDCC CALL RESEX	;
381)   E6E9 CF          		 DEFB ZGETCUR	;
382)   E6EA B7          		 OR A	;
383)   E6EB C9          		 RET	;
385)   E6EC 17          		NOTCC RLA	;
386)   E6ED 30 15       		 JR NC LINP	;
387)   E6EF 17          		SENDXY RLA	;
388)   E6F0 38 08       		 JR C SENDY	;
389)   E6F2 DD CB 08 EE 		 SET SNDYFLG (IX+EXFLGS)	;
390)   E6F6 79          		 LD A C	;
391)   E6F7 3C          		 INC A	;
392)   E6F8 B7          		 OR A	;
393)   E6F9 C9          		 RET	;
395)   E6FA CD 7B E7    		SENDY CALL RESEX	;
396)   E6FD DD 7E 09    		 LD A (IX+LN)	;
397)   E700 80          		 ADD A B	;
398)   E701 3C          		 INC A	;
399)   E702 B7          		 OR A	;
400)   E703 C9          		 RET	;
402)   E704 CB E6       		LINP SET INPFLG (HL) ;comment	;comment
403)   E706 DD CB 07 9E 		 RES XYFLG (IX+FLAGS)	;
404)   E70A DD CB 07 96 		 RES YFLG (IX+FLAGS)	;
405)   E70E CB 76       		 BIT CHRFLG (HL) ;	;
406)   E710 20 1F       		 JR NZ GOTCHS-$ ;	;
407)   E712 DD 70 0C    		NOTVST LD (IX+INPB) B	;
408)   E715 DD 71 0D    		 LD (IX+INPC) C	;
409)   E718 78          		 LD A B	;
410)   E719 B1          		 OR C	;
411)   E71A 28 02       		 JR Z RDLP	;
412)   E71C CB CE       		 SET HLDFLG (HL)	;
413)   E71E CD F8 E7    		RDLP: CALL SHOCUR	;
414)   E721 CD 02 E3    		 CALL RDKEY ;	;
415)   E724 CD DA E7    		 CALL REMCUR	;
416)   E727 CD D6 E8    		 CALL EDITA	;
417)   E72A CB 76       		 BIT CHRFLG (HL)	;
418)   E72C 28 F0       		 JR Z RDLP	;
419)   E72E CD D2 EA    		 CALL HOLD	;
420)   E731 CB 86       		GOTCHS RES CRFLG (HL)	;
421)   E733 AF          		 XOR A	;
422)   E734 DD 77 0C    		 LD (IX+INPB) A	;
423)   E737 DD 77 0D    		 LD (IX+INPC) A	;
425)   E73A CD 93 ED    		 CALL CPDB	;
426)   E73D 38 32       		 JR C MORE	;
427)   E73F CD 9D EA    		NOMORE CALL INLINE ;sets CR flags in XEDIT	;sets CR flags in XEDIT
428)   E742 3E 0A       		 LD A LF	;
429)   E744 CD 9D E7    		 CALL OUTR	;
430)   E747 CB 56       		 BIT PGEFLG (HL)	;
431)   E749 28 0C       		 JR Z LOADCR	;
432)   E74B CB F6       		 SET CHRFLG (HL)	;
433)   E74D DD 7E 09    		 LD A (IX+LN)	;
434)   E750 B7          		 OR A	;
435)   E751 20 04       		 JR NZ LOADCR	;
436)   E753 CB B6       		 RES CHRFLG (HL)	;
437)   E755 CB 96       		 RES PGEFLG (HL)	;
438)   E757 3E 0D       		LOADCR LD A CR ;	;
440)   E759 F5          		INEND PUSH AF	;
441)   E75A DD CB 07 6E 		 BIT CNSFLG (IX+FLAGS)	;
442)   E75E 28 05       		 JR Z INEND1	;
443)   E760 79          		 LD A C	;
444)   E761 3C          		 INC A	;
445)   E762 32 1C 00    		 LD (PHPOS) A	;
446)   E765 DD CB 08 66 		INEND1 BIT CURSHOFLG (IX+EXFLGS)	;
447)   E769 C4 F8 E7    		 CALL NZ SHOCUR	;
448)   E76C F1          		 POP AF	;
449)   E76D B7          		 OR A	;
450)   E76E C3 EE EE    		 JP STREGS	;
452)   E771 E5          		MORE PUSH HL	;
453)   E772 CF          		 DEFB ZGETCUR	;
454)   E773 E1          		 POP HL	;
455)   E774 F5          		 PUSH AF	;
456)   E775 CD 3B EA    		 CALL CURRT	;
457)   E778 F1          		 POP AF	;
458)   E779 18 DE       		 JR INEND	;
460)   E77B DD 7E 08    		RESEX LD A (IX+EXFLGS)	;
461)   E77E E6 1F       		 AND 1FH	;
462)   E780 DD 77 08    		 LD (IX+EXFLGS) A	;
463)   E783 C9          		 RET	;
465)   E784 CB 96       		OUT RES PGEFLG (HL)	;
466)   E786 CB B6       		 RES CHRFLG (HL)	;
467)   E788 F5          		 PUSH AF	;
468)   E789 CD 7B E7    		 CALL RESEX	;
469)   E78C DD 7E 07    		 LD A (IX+FLAGS)	;
470)   E78F E6 0F       		 AND 0FH	;
471)   E791 20 1F       		 JR NZ PNWAIT	;
472)   E793 F1          		 POP AF	;
473)   E794 FE 0D       		 CP CR	;
474)   E796 20 05       		 JR NZ OUTR	;
475)   E798 CD 9D E7    		 CALL OUTR	;
476)   E79B 3E 0A       		 LD A LF	;
477)   E79D CB 5E       		OUTR BIT OLFLG (HL)	;
478)   E79F 28 12       		 JR Z NWAIT	;
479)   E7A1 FE 0A       		 CP LF	;
480)   E7A3 28 19       		 JR Z OLLF	;
481)   E7A5 CB 46       		EDOUT BIT CRFLG (HL) ;	;
482)   E7A7 28 0C       		 JR Z DOEDIT	;
483)   E7A9 FE 0D       		 CP CR ;	;
484)   E7AB C8          		 RET Z	;
485)   E7AC CB 66       		EDOUT1 BIT INPFLG (HL) ;	;
486)   E7AE F5          		 PUSH AF	;
487)   E7AF CC 58 EA    		 CALL Z WAIT	;
488)   E7B2 F1          		PNWAIT POP AF	;
489)   E7B3 CB A6       		NWAIT RES INPFLG (HL) ;	;
490)   E7B5 CD D6 E8    		DOEDIT CALL EDITA ;	;
492)   E7B8 CD 69 E8    		WRNC CALL SETWIN	;
493)   E7BB AF          		 XOR A ;	;
494)   E7BC 18 6E       		 JR WR-$ ;	;
496)   E7BE CB B6       		OLLF RES CHRFLG (HL)	;
497)   E7C0 C9          		 RET	;
499)   E7C1 FE 20       		MODIFY CP 20H	;
500)   E7C3 38 0E       		 JR C UNREC	;
501)   E7C5 FE E4       		 CP 0E4H ;'POUND'	;'POUND'
502)   E7C7 20 03       		 JR NZ MODIF1	;
503)   E7C9 3E 5F       		 LD A 5FH	;
504)   E7CB C9          		 RET	;
505)   E7CC FE 5F       		MODIF1 CP 5FH	;
506)   E7CE 28 03       		 JR Z UNREC	;
507)   E7D0 FE 7B       		 CP 7BH	;
508)   E7D2 D8          		 RET C	;
509)   E7D3 B7          		UNREC OR A	;
510)   E7D4 3E 20       		 LD A BLANK	;
511)   E7D6 C8          		 RET Z	;
512)   E7D7 3E 68       		 LD A UNCHR	;
513)   E7D9 C9          		 RET	;
518)   E7DA F5          		REMCUR: PUSH AF	;
519)   E7DB CD B8 E7    		 CALL WRNC	;
520)   E7DE F1          		 POP AF	;
521)   E7DF CB 7E       		 BIT TVFLG (HL)	;
522)   E7E1 C8          		 RET Z	;
523)   E7E2 F5          		REMCR0 PUSH AF	;
524)   E7E3 E5          		 PUSH HL	;
525)   E7E4 F3          		 DI	;
526)   E7E5 21 0E 00    		 LD HL TV2	;
527)   E7E8 CB 76       		 BIT 6 (HL)	;
528)   E7EA 36 80       		 LD (HL) 80H ;starts TV	;starts TV
529)   E7EC 28 06       		 JR Z REMCR1 ;if cursor not in use	;if cursor not in use
530)   E7EE 23          		 INC HL	;
531)   E7EF 7E          		 LD A (HL)	;
532)   E7F0 2A 5A 00    		 LD HL (TVCUR)	;
533)   E7F3 77          		 LD (HL) A	;
534)   E7F4 FB          		REMCR1 EI	;
535)   E7F5 E1          		 POP HL	;
536)   E7F6 F1          		 POP AF	;
537)   E7F7 C9          		 RET	;
539)   E7F8 CD 24 E8    		SHOCUR: CALL WRC	;
540)   E7FB CB 7E       		 BIT TVFLG (HL)	;
541)   E7FD C8          		 RET Z	;
542)   E7FE E5          		 PUSH HL	;
543)   E7FF 2B          		 DEC HL	;
544)   E800 DD 7E 05    		 LD A (IX+LL)	;
545)   E803 B9          		 CP C	;
546)   E804 28 06       		 JR Z SHOCR1	;
547)   E806 23          		 INC HL	;
548)   E807 3E 01       		 LD A 1	;
549)   E809 A6          		 AND (HL)	;
550)   E80A EE 01       		 XOR 1	;
551)   E80C F5          		SHOCR1 PUSH AF	;
552)   E80D CF          		 DEFB ZGETCUR	;
553)   E80E F3          		 DI	;
554)   E80F 22 5A 00    		 LD (TVCUR) HL	;
555)   E812 21 0F 00    		 LD HL TV1	;
556)   E815 77          		 LD (HL) A	;
557)   E816 2B          		 DEC HL	;
558)   E817 F1          		 POP AF	;
559)   E818 28 02       		 JR Z SHO2	;
560)   E81A CB EE       		 SET 5 (HL)	;
561)   E81C CB F6       		SHO2 SET 6 (HL)	;
562)   E81E 2B          		 DEC HL	;
563)   E81F 36 10       		 LD (HL) 10H	;
564)   E821 FB          		 EI	;
565)   E822 E1          		 POP HL	;
566)   E823 C9          		 RET	;
568)   E824 CD 69 E8    		WRC CALL SETWIN	;
569)   E827 79          		 LD A C	;
570)   E828 DD 96 0B    		 SUB (IX+WIN)	;
571)   E82B 3C          		 INC A	;
572)   E82C E5          		WR PUSH HL	;
573)   E82D D5          		 PUSH DE	;
574)   E82E C5          		 PUSH BC	;
575)   E82F 57          		 LD D A	;
576)   E830 DD 4E 0B    		 LD C (IX+WIN)	;
577)   E833 CF          		 DEFB ZGETCUR	;
578)   E834 4A          		 LD C D	;
580)   E835 11 4D 00    		 LD DE OBFEND	;
581)   E838 06 10       		 LD B,16	;
582)   E83A CD 6D E3    		TRANSLP CALL HLTTCAPS	;
583)   E83D CD C1 E7    		 CALL MODIFY	;
584)   E840 0D          		OK3 DEC C ;	;
585)   E841 20 02       		 JR NZ STDE ;	;
586)   E843 CB FF       		 SET 7 A	;
587)   E845 12          		STDE LD (DE),A	;
588)   E846 23          		 INC HL	;
589)   E847 1B          		 DEC DE	;
590)   E848 10 F0       		 DJNZ TRANSLP	;
591)   E84A 21 3C 00    		WTLP LD HL COPST	;
592)   E84D F3          		 DI	;
593)   E84E CB 6E       		 BIT READY (HL)	;
594)   E850 CB AE       		 RES READY (HL)	;
595)   E852 2B          		 DEC HL ;POINT BACK AT ACKOWLEDGE	;POINT BACK AT ACKOWLEDGE
596)   E853 20 0D       		 JR NZ WRD1	;
597)   E855 3E A0       		 LD A DISPCOM	;
598)   E857 BE          		 CP (HL)	;
599)   E858 28 0A       		 JR Z WRD2	;
600)   E85A 3E D0       		 LD A NULLCOM	;
601)   E85C BE          		 CP (HL)	;
602)   E85D 28 03       		 JR Z WRD1	;
603)   E85F FB          		 EI	;
604)   E860 18 E8       		 JR WTLP	;
605)   E862 36 A0       		WRD1 LD (HL) DISPCOM	;
607)   E864 FB          		WRD2 EI	;
608)   E865 C1          		 POP BC	;
609)   E866 D1          		 POP DE	;
610)   E867 E1          		 POP HL ;	;
611)   E868 C9          		 RET ;	;
613)   E869 CB 6E       		SETWIN BIT LIFLG (HL)	;
614)   E86B 20 02       		 JR NZ SETWN1	;
615)   E86D F1          		 POP AF	;
616)   E86E C9          		 RET	;
617)   E86F 79          		SETWN1 LD A C	;
618)   E870 DD BE 0B    		 CP (IX+WIN)	;
619)   E873 30 04       		 JR NC CHKTOP	;
620)   E875 DD 71 0B    		 LD (IX+WIN) C	;
621)   E878 C9          		 RET	;
622)   E879 DD 7E 0B    		CHKTOP LD A (IX+WIN)	;
623)   E87C C6 10       		 ADD A WLEN	;
624)   E87E B9          		 CP C	;
625)   E87F 28 01       		 JR Z CHANGE	;
626)   E881 D0          		 RET NC	;
627)   E882 79          		CHANGE LD A C	;
628)   E883 DD BE 05    		 CP (IX+LL)	;
629)   E886 F5          		 PUSH AF	;
630)   E887 D6 0F       		 SUB WLEN-1	;
631)   E889 DD 77 0B    		 LD (IX+WIN) A	;
632)   E88C F1          		 POP AF	;
633)   E88D C0          		 RET NZ	;
634)   E88E DD 35 0B    		 DEC (IX+WIN)	;
635)   E891 C9          		 RET	;
109)   E892 01          		 DEFB IL	;
110)   E893 02          		 DEFB DL	;
111)   E894 12          		 DEFB MP	;
112)   E895 13          		 DEFB MS	;
114)   E896 84 EC       		EDADD DEFW NULL	;
115)   E898 19 EC       		 DEFW INSLIN	;
116)   E89A 47 EC       		 DEFW DELLIN	;
117)   E89C 91 EA       		 DEFW PGERET	;
118)   E89E 84 EC       		 DEFW NULL	;
119)   E8A0 9A EA       		 DEFW LNERET	;
120)   E8A2 67 EC       		 DEFW SHOWC	;
121)   E8A4 6C EC       		 DEFW HIDEC	;
122)   E8A6 64 EA       		 DEFW CURLT	;
123)   E8A8 57 EC       		 DEFW DOTAB	;
124)   E8AA EF EA       		 DEFW PLNFD	;
125)   E8AC 60 EB       		 DEFW CURUP	;
126)   E8AE E4 EA       		 DEFW HOME	;
127)   E8B0 9C EA       		 DEFW NLINE	;
128)   E8B2 7B EC       		 DEFW SHFTIN	;
129)   E8B4 80 EC       		 DEFW SHFTOU	;
130)   E8B6 84 EC       		 DEFW NULL	;
131)   E8B8 71 EC       		 DEFW INSMOD	;
132)   E8BA 88 EB       		 DEFW MKPRM	;
133)   E8BC F8 E9       		 DEFW MKSEC	;
134)   E8BE E8 EC       		 DEFW CCRET	;
135)   E8C0 F0 EC       		 DEFW XYRET	;
136)   E8C2 F8 EC       		 DEFW XYRQST	;
137)   E8C4 00 ED       		 DEFW TVRQST	;
138)   E8C6 98 EB       		 DEFW DELLT	;
139)   E8C8 AC EB       		 DEFW DEL	;
140)   E8CA 3B EA       		 DEFW CURRT	;
141)   E8CC 76 EC       		 DEFW ESCAPE	;
142)   E8CE CC EA       		 DEFW HOMEL	;
143)   E8D0 EA EA       		 DEFW HOMER	;
144)   E8D2 B5 EA       		 DEFW DLINE	;
145)   E8D4 D9 EA       		 DEFW CLRSCR	;
147)   E8D6 DD 77 0E    		EDITA LD (IX+CHAR) A	;
148)   E8D9 23          		EDITCH INC HL	;
149)   E8DA 7E          		 LD A (HL)	;
150)   E8DB FE 7F       		 CP CONCHR	;
151)   E8DD 20 02       		 JR NZ EDIT1	;
152)   E8DF 36 20       		 LD (HL) BLANK	;
153)   E8E1 2B          		EDIT1 DEC HL	;
154)   E8E2 DD 7E 0E    		 LD A (IX+CHAR)	;
155)   E8E5 CD 21 E9    		 CALL PREDIT ;Goes to 'real edit' here	;Goes to 'real edit' here
156)   E8E8 CD 99 ED    		 CALL DOFRM	;
157)   E8EB E5          		 PUSH HL	;
158)   E8EC CD 03 E9    		 CALL DELZER	;
159)   E8EF C5          		 PUSH BC ;BC = cur. pos. HL > line end	;BC = cur. pos. HL > line end
160)   E8F0 CD 93 ED    		 CALL CPDB ;Is line length >= cursor pos.?	;Is line length >= cursor pos.?
161)   E8F3 30 01       		 JR NC DZ2	;
162)   E8F5 7B          		 LD A E ;No - so use cursor for zero	;No - so use cursor for zero
163)   E8F6 DD BE 05    		DZ2 CP (IX+LL) ;Is line 'full'	;Is line 'full'
164)   E8F9 28 05       		 JR Z DZ3	;
165)   E8FB CD 85 EC    		 CALL ADHLA ;No - so put in zero	;No - so put in zero
166)   E8FE 36 00       		 LD (HL) 0	;
167)   E900 C1          		DZ3 POP BC	;
168)   E901 E1          		 POP HL	;
169)   E902 C9          		 RET	;
172)   E903 C5          		 PUSH BC ;zero in functional line	;zero in functional line
173)   E904 42          		 LD B D	;
174)   E905 0E 00       		 LD C 0	;
175)   E907 CF          		 DEFB ZGETCUR ;HL > line start	;HL > line start
176)   E908 E5          		 PUSH HL	;
177)   E909 DD 7E 05    		 LD A (IX+LL)	;
178)   E90C 93          		 SUB E	;
179)   E90D 28 0F       		 JR Z DZ1 ;If line full	;If line full
180)   E90F 4F          		 LD C A	;
181)   E910 83          		 ADD A E	;
182)   E911 3D          		 DEC A	;
183)   E912 CD 85 EC    		 CALL ADHLA ;HL > line end	;HL > line end
184)   E915 AF          		 XOR A	;
185)   E916 47          		 LD B A	;
186)   E917 ED B9       		 CPDR	;
187)   E919 20 03       		 JR NZ DZ1	;
188)   E91B 23          		 INC HL	;
189)   E91C 36 20       		 LD (HL) BLANK	;
190)   E91E E1          		DZ1 POP HL ;HL > line start	;HL > line start
191)   E91F C1          		 POP BC	;
192)   E920 C9          		 RET	;
194)   E921 CD 71 E9    		PREDIT CALL EDIT	;
195)   E924 CB 86       		 RES CRFLG (HL)	;
196)   E926 C9          		 RET	;
199)   E927 DD CB 07 86 		TVMSET RES TVMFLG (IX+FLAGS)	;
200)   E92B E6 0B       		 AND TVMMSK ;Mask out top two bits	;Mask out top two bits
201)   E92D DD 77 0E    		 LD (IX+CHAR),A	;
202)   E930 DD 7E 01    		 LD A,(IX+TVMD1)	;
203)   E933 E6 F4       		 AND .NOT.TVMMSK	;
204)   E935 DD B6 0E    		 OR (IX+CHAR)	;
205)   E938 DD 77 01    		 LD (IX+TVMD1) A	;
206)   E93B C9          		 RET	;
208)   E93C DD CB 07 56 		SETXY BIT YFLG (IX+FLAGS)	;
209)   E940 20 1C       		 JR NZ SECOND	;
210)   E942 DD CB 07 D6 		 SET YFLG (IX+FLAGS)	;
211)   E946 F5          		 PUSH AF	;
212)   E947 CD E4 EA    		 CALL HOME	;
213)   E94A F1          		 POP AF	;
214)   E94B B7          		 OR A	;
215)   E94C C8          		 RET Z	;
216)   E94D 3D          		 DEC A	;
217)   E94E DD BE 05    		 CP (IX+LL)	;
218)   E951 38 03       		 JR C AOK	;
219)   E953 DD 7E 05    		 LD A (IX+LL)	;
220)   E956 4F          		AOK LD C A	;
221)   E957 B7          		 OR A	;
222)   E958 C0          		 RET NZ	;
223)   E959 78          		 LD A B	;
224)   E95A B7          		 OR A	;
225)   E95B C8          		 RET Z	;
226)   E95C 0C          		 INC C	;
227)   E95D C9          		 RET	;
229)   E95E DD CB 07 9E 		SECOND RES XYFLG (IX+FLAGS)	;
230)   E962 DD CB 07 96 		 RES YFLG (IX+FLAGS)	;
231)   E966 B7          		 OR A	;
232)   E967 C8          		 RET Z	;
233)   E968 DD 35 0E    		TESTA DEC (IX+CHAR)	;
234)   E96B C8          		 RET Z	;
235)   E96C CD F5 EA    		 CALL LNFD	;
236)   E96F 18 F7       		 JR TESTA	;
239)   E971 DD CB 07 5E 		EDIT BIT XYFLG (IX+FLAGS)	;
240)   E975 20 C5       		 JR NZ SETXY	;
241)   E977 DD CB 07 46 		 BIT TVMFLG (IX+FLAGS)	;
242)   E97B 20 AA       		 JR NZ TVMSET	;
243)   E97D DD CB 07 4E 		 BIT ESCFLG (IX+FLAGS)	;
244)   E981 DD CB 07 8E 		 RES ESCFLG (IX+FLAGS)	;
245)   E985 20 3E       		 JR NZ INSERT	;
246)   E987 FE 20       		EDIT2 CP 20H	;
247)   E989 30 3A       		 JR NC INSERT	;
248)   E98B DD CB 07 B6 		 RES IFLG (IX+FLAGS)	;
249)   E98F E5          		 PUSH HL	;
250)   E990 C5          		 PUSH BC	;
251)   E991 CB 4E       		 BIT HLDFLG (HL)	;
252)   E993 20 08       		 JR NZ DECODE	;
253)   E995 FE 1F       		 CP CLEAR	;
254)   E997 28 1B       		 JR Z NOTONE	;
255)   E999 CB 5E       		 BIT OLFLG (HL)	;
256)   E99B 28 17       		 JR Z NOTONE	;
257)   E99D FE 1F       		DECODE CP CLEAR	;
258)   E99F 20 02       		 JR NZ NOTCLR	;
259)   E9A1 3E 1E       		 LD A CLL	;
260)   E9A3 FE 0C       		NOTCLR CP FF	;
261)   E9A5 20 02       		 JR NZ NDC	;
262)   E9A7 3E 1C       		 LD A CHL	;
263)   E9A9 21 92 E8    		NDC LD HL CODES	;
264)   E9AC 01 04 00    		 LD BC EDADD-CODES	;
265)   E9AF ED B1       		 CPIR	;
266)   E9B1 20 01       		 JR NZ NOTONE	;
267)   E9B3 AF          		 XOR A	;
268)   E9B4 DD 77 0E    		NOTONE LD (IX+CHAR) A	;
269)   E9B7 21 96 E8    		 LD HL EDADD	;
270)   E9BA 87          		 ADD A A	;
271)   E9BB CD 85 EC    		 CALL ADHLA	;
272)   E9BE 4E          		 LD C (HL)	;
273)   E9BF 23          		 INC HL	;
274)   E9C0 66          		 LD H (HL)	;
275)   E9C1 69          		 LD L C	;
276)   E9C2 C1          		 POP BC	;
277)   E9C3 E3          		 EX (SP) HL	;
278)   E9C4 C9          		 RET	;
280)   E9C5 3E 80       		INSERT LD A 80H	;
281)   E9C7 DD A6 07    		 AND (IX+FLAGS)	;
282)   E9CA DD AE 0E    		 XOR (IX+CHAR)	;
283)   E9CD DD 77 0E    		 LD (IX+CHAR) A	;
284)   E9D0 C8          		 RET Z	;
285)   E9D1 CD 8A EC    		 CALL TSINP	;
286)   E9D4 D8          		 RET C	;
287)   E9D5 DD CB 07 76 		 BIT IFLG (IX+FLAGS) 	;
288)   E9D9 20 3F       		 JR NZ INSNOW-$ 	;
289)   E9DB CB 46       		 BIT CRFLG (HL) 	;
290)   E9DD C4 B5 EA    		 CALL NZ DLINE	;
292)   E9E0 CD 93 ED    		PUT CALL CPDB	;
293)   E9E3 38 04       		 JR C PUT2	;
294)   E9E5 59          		 LD E C	;
295)   E9E6 CD 08 ED    		PUT1 CALL INCDE	;
296)   E9E9 CD 3B EA    		PUT2 CALL CURRT	;
297)   E9EC CD 64 EA    		 CALL CURLT	;
298)   E9EF E5          		 PUSH HL	;
299)   E9F0 CF          		 DEFB ZGETCUR	;
300)   E9F1 DD 7E 0E    		 LD A (IX+CHAR)	;
301)   E9F4 77          		 LD (HL) A	;
302)   E9F5 E1          		 POP HL	;
303)   E9F6 18 43       		 JR CURRT	;
305)   E9F8 AF          		MKSEC XOR A	;
306)   E9F9 B8          		 CP B	;
307)   E9FA C0          		 RET NZ	;
308)   E9FB DD BE 09    		 CP (IX+LN)	;
309)   E9FE C8          		 RET Z	;
310)   E9FF D5          		 PUSH DE	;
311)   EA00 CD 4E ED    		 CALL SCHUP	;
312)   EA03 CD 42 EB    		 CALL CNTCH	;
313)   EA06 E5          		 PUSH HL	;
314)   EA07 CD 03 E9    		 CALL DELZER	;
315)   EA0A E1          		 POP HL	;
316)   EA0B 7A          		 LD A D	;
317)   EA0C D1          		 POP DE	;
318)   EA0D 3C          		 INC A	;
319)   EA0E F5          		 PUSH AF	;
320)   EA0F 82          		 ADD A D	;
321)   EA10 57          		 LD D A	;
322)   EA11 F1          		 POP AF	;
323)   EA12 80          		 ADD A B	;
324)   EA13 47          		 LD B A	;
325)   EA14 0E 00       		 LD C 0	;
326)   EA16 DD 36 0E 7F 		 LD (IX+CHAR) CONCHR	;
328)   EA1A CD 93 ED    		INSNOW CALL CPDB	;
329)   EA1D 38 01       		 JR C INSN1	;
330)   EA1F 59          		 LD E C	;
331)   EA20 CD 08 ED    		INSN1 CALL INCDE	;
332)   EA23 C5          		 PUSH BC	;
333)   EA24 7A          		 LD A D	;
334)   EA25 90          		 SUB B	;
335)   EA26 28 0F       		 JR Z INSN3	;
336)   EA28 D5          		 PUSH DE	;
337)   EA29 DD 5E 05    		 LD E (IX+LL)	;
338)   EA2C 57          		 LD D A	;
339)   EA2D CD 62 ED    		INSN2 CALL ICIL	;
340)   EA30 0E 01       		 LD C 1	;
341)   EA32 04          		 INC B	;
342)   EA33 15          		 DEC D	;
343)   EA34 20 F7       		 JR NZ INSN2	;
344)   EA36 D1          		 POP DE	;
345)   EA37 CD 62 ED    		INSN3 CALL ICIL	;
346)   EA3A C1          		 POP BC	;
348)   EA3B DD 7E 05    		CURRT LD A (IX+LL)	;
349)   EA3E 3D          		 DEC A	;
350)   EA3F 91          		 SUB C	;
351)   EA40 38 02       		 JR C CURRT1	;
352)   EA42 03          		 INC BC	;
353)   EA43 C0          		 RET NZ	;
354)   EA44 DD 77 0F    		CURRT1 LD (IX+DCHR) A	;
355)   EA47 78          		 LD A B	;
356)   EA48 BA          		 CP D	;
357)   EA49 D0          		 RET NC	;
358)   EA4A 04          		 INC B	;
359)   EA4B AF          		 XOR A	;
360)   EA4C DD 77 0B    		 LD (IX+WIN) A	;
361)   EA4F 3C          		 INC A	;
362)   EA50 DD 96 0F    		 SUB (IX+DCHR)	;
363)   EA53 4F          		 LD C A	;
364)   EA54 C9          		 RET	;
366)   EA55 CD 7B EA    		PWAIT CALL ADJWIN	;
367)   EA58 CD B8 E7    		WAIT CALL WRNC	;
368)   EA5B CD 02 E3    		 CALL RDKEY	;
369)   EA5E D6 0D       		 SUB CR	;
370)   EA60 20 F3       		 JR NZ PWAIT	;
371)   EA62 18 68       		 JR HOMEL-$	;
373)   EA64 CB 6E       		CURLT BIT LIFLG (HL)	;
374)   EA66 20 04       		 JR NZ CURLT2	;
375)   EA68 CD 8A EC    		 CALL TSINP	;
376)   EA6B C8          		 RET Z	;
377)   EA6C 79          		CURLT2 LD A C	;
378)   EA6D B7          		 OR A	;
379)   EA6E C8          		 RET Z	;
380)   EA6F 0D          		 DEC C	;
381)   EA70 C0          		 RET NZ	;
382)   EA71 78          		 LD A B	;
383)   EA72 FE 01       		 CP 1	;
384)   EA74 D8          		 RET C	;
385)   EA75 DD 4E 05    		 LD C (IX+LL)	;
386)   EA78 05          		 DEC B	;
387)   EA79 0D          		 DEC C	;
388)   EA7A C9          		 RET	;
390)   EA7B DD 4E 0B    		ADJWIN LD C (IX+WIN)	;
391)   EA7E FE FB       		 CP BS-CR ;	;
392)   EA80 28 E2       		 JR Z CURLT ;	;
393)   EA82 FE FF       		 CP FF-CR ;	;
394)   EA84 28 46       		 JR Z HOMEL-$ ;	;
395)   EA86 FE 0D       		 CP HT-CR ;	;
396)   EA88 C0          		 RET NZ ;	;
398)   EA89 DD 7E 0B    		WINRT LD A (IX+WIN)	;
399)   EA8C C6 0F       		 ADD A WLEN-1	;
400)   EA8E 4F          		 LD C A	;
401)   EA8F 18 AA       		 JR CURRT	;
403)   EA91 CB 4E       		PGERET BIT HLDFLG (HL)	;
404)   EA93 C0          		 RET NZ	;
405)   EA94 CB D6       		 SET PGEFLG (HL)	;
406)   EA96 AF          		 XOR A	;
407)   EA97 CD 25 EB    		 CALL LNFD2	;
408)   EA9A CB 86       		LNERET RES CRFLG (HL)	;
409)   EA9C F1          		NLINE POP AF	;
410)   EA9D AF          		INLINE XOR A ;used by XIO input	;used by XIO input
411)   EA9E CB 46       		 BIT CRFLG (HL)	;
412)   EAA0 CB C6       		 SET CRFLG (HL)	;
413)   EAA2 CB F6       		 SET CHRFLG (HL)	;
414)   EAA4 CB 8E       		 RES HLDFLG (HL)	;
415)   EAA6 28 0A       		 JR Z NLINE1	;
416)   EAA8 CB 66       		 BIT INPFLG (HL)	;
417)   EAAA 28 09       		 JR Z DLINE	;
418)   EAAC DD 72 0C    		 LD (IX+INPB) D	;
419)   EAAF DD 73 0D    		 LD (IX+INPC) E	;
420)   EAB2 47          		NLINE1 LD B A	;
421)   EAB3 4F          		 LD C A	;
422)   EAB4 C9          		 RET	;
424)   EAB5 CD D2 EA    		DLINE CALL HOLD	;
425)   EAB8 7A          		DLINE1 LD A D	;
426)   EAB9 B8          		 CP B	;
427)   EABA 28 09       		 JR Z DLINE2	;
428)   EABC DD 86 09    		 ADD A (IX+LN)	;
429)   EABF CD E6 EB    		 CALL SCROLL	;
430)   EAC2 15          		 DEC D	;
431)   EAC3 18 F3       		 JR DLINE1	;
432)   EAC5 DD 86 09    		DLINE2 ADD A (IX+LN)	;
433)   EAC8 CD D1 EC    		 CALL WLIN	;
434)   EACB 59          		 LD E C	;
436)   EACC AF          		HOMEL XOR A	;
437)   EACD 47          		 LD B A	;
438)   EACE 4F          		 LD C A	;
439)   EACF CB 6E       		HOMEL1 BIT LIFLG (HL)	;
440)   EAD1 C0          		 RET NZ	;
441)   EAD2 DD 46 0C    		HOLD LD B (IX+INPB)	;
442)   EAD5 DD 4E 0D    		 LD C (IX+INPC)	;
443)   EAD8 C9          		 RET	;
446)   EAD9 AF          		CLRSCR XOR A	;
447)   EADA 4F          		 LD C A	;
448)   EADB CD D1 EC    		CS1 CALL WLIN	;
449)   EADE 3C          		 INC A	;
450)   EADF DD BE 04    		 CP (IX+DEP)	;
451)   EAE2 20 F7       		 JR NZ CS1	;
453)   EAE4 CD 94 EC    		HOME CALL ZERO	;
454)   EAE7 C3 25 EB    		 JP LNFD2	;
456)   EAEA DD 4E 05    		HOMER LD C (IX+LL)	;
457)   EAED 42          		 LD B D	;
458)   EAEE C9          		 RET	;
461)   EAEF CB 76       		PLNFD BIT CHRFLG (HL)	;
462)   EAF1 CB B6       		 RES CHRFLG (HL)	;
463)   EAF3 20 0E       		 JR NZ PLNFD1	;
464)   EAF5 7A          		LNFD LD A D	;
465)   EAF6 B8          		 CP B	;
466)   EAF7 28 0C       		 JR Z LNFD1	;
467)   EAF9 04          		 INC B	;
468)   EAFA 3E 01       		 LD A 1	;
469)   EAFC B8          		 CP B	;
470)   EAFD C0          		 RET NZ	;
471)   EAFE AF          		 XOR A	;
472)   EAFF B9          		 CP C	;
473)   EB00 C0          		 RET NZ	;
474)   EB01 0C          		 INC C	;
475)   EB02 C9          		 RET	;
477)   EB03 F1          		PLNFD1 POP AF	;
478)   EB04 7A          		 LD A D	;
479)   EB05 CB 4E       		LNFD1 BIT HLDFLG (HL)	;
480)   EB07 C0          		 RET NZ	;
481)   EB08 DD 86 09    		 ADD A (IX+LN)	;
482)   EB0B 3C          		 INC A	;
483)   EB0C DD BE 04    		 CP (IX+DEP)	;
484)   EB0F 20 14       		 JR NZ LNFD2	;
485)   EB11 3D          		 DEC A	;
486)   EB12 CB 66       		 BIT INPFLG (HL)	;
487)   EB14 C0          		 RET NZ	;
488)   EB15 CB 46       		 BIT CRFLG (HL)	;
489)   EB17 C8          		 RET Z	;
490)   EB18 CB 56       		 BIT PGEFLG (HL)	;
491)   EB1A 20 C8       		 JR NZ HOME	;
492)   EB1C DD 77 09    		 LD (IX+LN) A	;
493)   EB1F CD 94 EC    		 CALL ZERO	;
494)   EB22 C3 E6 EB    		 JP SCROLL	;
496)   EB25 DD 77 09    		LNFD2 LD (IX+LN) A	;
497)   EB28 AF          		LNFD4 XOR A	;
498)   EB29 B8          		 CP B	;
499)   EB2A 47          		 LD B A	;
500)   EB2B F5          		 PUSH AF	;
501)   EB2C C5          		 PUSH BC	;
502)   EB2D 48          		 LD C B	;
503)   EB2E 50          		 LD D B	;
504)   EB2F 04          		LNFD3 INC B	;
505)   EB30 E5          		 PUSH HL	;
506)   EB31 CF          		 DEFB ZGETCUR	;
507)   EB32 E1          		 POP HL	;
508)   EB33 FE 7F       		 CP CONCHR	;
509)   EB35 28 F8       		 JR Z LNFD3	;
510)   EB37 50          		 LD D B	;
511)   EB38 15          		 DEC D	;
512)   EB39 C1          		 POP BC	;
513)   EB3A F1          		 POP AF	;
514)   EB3B 28 05       		 JR Z CNTCH	;
515)   EB3D 3C          		 INC A	;
516)   EB3E B9          		 CP C	;
517)   EB3F 20 01       		 JR NZ CNTCH	;
518)   EB41 0D          		 DEC C	;
520)   EB42 E5          		CNTCH PUSH HL	;
521)   EB43 C5          		 PUSH BC	;
522)   EB44 42          		 LD B D	;
523)   EB45 DD 5E 05    		 LD E (IX+LL)	;
524)   EB48 4B          		 LD C E	;
525)   EB49 0D          		 DEC C	;
526)   EB4A CF          		 DEFB ZGETCUR	;
527)   EB4B 3E DF       		CNTCH1 LD A 0DFH	;
528)   EB4D A6          		 AND (HL)	;
529)   EB4E 20 0D       		 JR NZ CNTCH2	;
530)   EB50 2B          		 DEC HL	;
531)   EB51 1D          		 DEC E	;
532)   EB52 28 09       		 JR Z CNTCH2	;
533)   EB54 3E 02       		 LD A 2	;
534)   EB56 BB          		 CP E	;
535)   EB57 20 F2       		 JR NZ CNTCH1	;
536)   EB59 7A          		 LD A D	;
537)   EB5A B7          		 OR A	;
538)   EB5B 28 EE       		 JR Z CNTCH1	;
539)   EB5D C1          		CNTCH2 POP BC	;
540)   EB5E E1          		 POP HL	;
541)   EB5F C9          		 RET	;
543)   EB60 AF          		CURUP XOR A	;
544)   EB61 B8          		 CP B	;
545)   EB62 28 0F       		 JR Z CURUP1	;
546)   EB64 05          		 DEC B	;
547)   EB65 CD 8A EC    		 CALL TSINP	;
548)   EB68 DA CF EA    		 JP C HOMEL1	;
549)   EB6B C8          		 RET Z	;
550)   EB6C 78          		 LD A B	;
551)   EB6D B7          		 OR A	;
552)   EB6E C0          		 RET NZ	;
553)   EB6F 0D          		 DEC C	;
554)   EB70 C8          		 RET Z	;
555)   EB71 0C          		 INC C	;
556)   EB72 C9          		 RET	;
557)   EB73 CB 4E       		CURUP1 BIT HLDFLG (HL)	;
558)   EB75 C0          		 RET NZ	;
559)   EB76 DD BE 09    		 CP (IX+LN)	;
560)   EB79 C8          		 RET Z	;
561)   EB7A CD 4E ED    		CURUP2 CALL SCHUP	;
562)   EB7D AF          		 XOR A	;
563)   EB7E 42          		 LD B D	;
564)   EB7F B8          		 CP B	;
565)   EB80 28 C0       		 JR Z CNTCH	;
566)   EB82 B9          		 CP C	;
567)   EB83 20 BD       		 JR NZ CNTCH	;
568)   EB85 0C          		 INC C	;
569)   EB86 18 BA       		 JR CNTCH	;
571)   EB88 78          		MKPRM LD A B	;
572)   EB89 B7          		 OR A	;
573)   EB8A C8          		 RET Z	;
574)   EB8B DD 86 09    		 ADD A (IX+LN)	;
575)   EB8E DD 77 09    		 LD (IX+LN) A	;
576)   EB91 7A          		 LD A D	;
577)   EB92 90          		 SUB B	;
578)   EB93 57          		 LD D A	;
579)   EB94 06 00       		 LD B 0	;
580)   EB96 0E 01       		 LD C 1	;
582)   EB98 CD 8A EC    		DELLT CALL TSINP	;
583)   EB9B C8          		 RET Z	;
584)   EB9C D8          		 RET C	;
585)   EB9D CD DE ED    		 CALL CHKFRM	;
586)   EBA0 CB 7E       		 BIT TVFLG (HL)	;
587)   EBA2 20 05       		 JR NZ DELLT1	;
588)   EBA4 79          		 LD A C	;
589)   EBA5 DD BE 0B    		 CP (IX+WIN)	;
590)   EBA8 C8          		 RET Z	;
591)   EBA9 CD 64 EA    		DELLT1 CALL CURLT	;
592)   EBAC CD 8A EC    		DEL CALL TSINP	;
593)   EBAF D8          		 RET C	;
594)   EBB0 CD 93 ED    		 CALL CPDB	;
595)   EBB3 D0          		 RET NC	;
596)   EBB4 DD 36 0F 20 		 LD (IX+DCHR) BLANK	;
597)   EBB8 D5          		 PUSH DE	;
598)   EBB9 7A          		 LD A D	;
599)   EBBA 90          		 SUB B	;
600)   EBBB 28 10       		 JR Z DELL2	;
601)   EBBD C5          		 PUSH BC	;
602)   EBBE 0E 01       		 LD C 1	;
603)   EBC0 42          		 LD B D	;
604)   EBC1 57          		 LD D A	;
605)   EBC2 CD 7A ED    		DELL1 CALL DCFL	;
606)   EBC5 DD 5E 05    		 LD E (IX+LL)	;
607)   EBC8 05          		 DEC B	;
608)   EBC9 15          		 DEC D	;
609)   EBCA 20 F6       		 JR NZ DELL1	;
610)   EBCC C1          		 POP BC	;
611)   EBCD CD 7A ED    		DELL2 CALL DCFL	;
612)   EBD0 D1          		 POP DE	;
613)   EBD1 1D          		 DEC E	;
614)   EBD2 7B          		 LD A E	;
615)   EBD3 FE 01       		 CP 1	;
616)   EBD5 C0          		 RET NZ	;
617)   EBD6 7A          		 LD A D	;
618)   EBD7 FE 01       		 CP 1	;
619)   EBD9 D8          		 RET C	;
620)   EBDA DD 5E 05    		 LD E (IX+LL)	;
621)   EBDD 15          		 DEC D	;
622)   EBDE B8          		 CP B	;
623)   EBDF 20 02       		 JR NZ DELL5	;
624)   EBE1 4B          		 LD C E	;
625)   EBE2 42          		 LD B D	;
626)   EBE3 DD 86 09    		DELL5 ADD A (IX+LN)	;
628)   EBE6 E5          		SCROLL PUSH HL	;
629)   EBE7 D5          		 PUSH DE	;
630)   EBE8 C5          		 PUSH BC	;
631)   EBE9 F5          		 PUSH AF	;
632)   EBEA E5          		 PUSH HL	;
633)   EBEB CD 9F EC    		SCRLL1 CALL ADLIN	;
634)   EBEE DD 96 04    		 SUB (IX+DEP)	;
635)   EBF1 2F          		 CPL	;
636)   EBF2 CD B3 EC    		 CALL CALIN	;
637)   EBF5 28 15       		 JR Z SCRLL3	;
638)   EBF7 CD 9A EC    		 CALL GETDE	;
642)   EBFA 0B          		 DEC BC	;
643)   EBFB 13          		SCRLLA INC DE	;
644)   EBFC 1A          		 LD A,(DE)	;
645)   EBFD B7          		 OR A	;
646)   EBFE 20 03       		 JR NZ SCRLLB	;
647)   EC00 3E 20       		 LD A,BLANK	;
648)   EC02 12          		 LD (DE),A	;
649)   EC03 1B          		SCRLLB DEC DE	;
650)   EC04 ED A0       		 LDI	;
651)   EC06 EA FB EB    		 JP PE SCRLLA	;
652)   EC09 03          		 INC BC	;
653)   EC0A ED A0       		 LDI	;
655)   EC0C DD 7E 04    		SCRLL3 LD A (IX+DEP)	;
656)   EC0F 3D          		 DEC A	;
657)   EC10 E1          		 POP HL	;
658)   EC11 CD D1 EC    		SCRLL4 CALL WLIN	;
659)   EC14 F1          		 POP AF	;
660)   EC15 C1          		 POP BC	;
661)   EC16 D1          		 POP DE	;
662)   EC17 E1          		 POP HL	;
663)   EC18 C9          		 RET	;
665)   EC19 CD 94 EC    		INSLIN CALL ZERO	;
666)   EC1C DD 7E 09    		 LD A (IX+LN)	;
668)   EC1F E5          		ILIN PUSH HL	;
669)   EC20 D5          		 PUSH DE	;
670)   EC21 C5          		 PUSH BC	;
671)   EC22 F5          		 PUSH AF	;
672)   EC23 E5          		 PUSH HL	;
673)   EC24 DD 56 04    		 LD D (IX+DEP)	;
674)   EC27 92          		 SUB D	;
675)   EC28 ED 44       		 NEG	;
676)   EC2A 20 05       		 JR NZ ILIN1	;
677)   EC2C DD 35 09    		 DEC (IX+LN)	;
678)   EC2F 18 BA       		 JR SCRLL1	;
679)   EC31 3D          		ILIN1 DEC A	;
680)   EC32 CD B3 EC    		 CALL CALIN	;
681)   EC35 28 0B       		 JR Z ILIN2	;
682)   EC37 7A          		 LD A D	;
683)   EC38 3D          		 DEC A	;
684)   EC39 CD A0 EC    		 CALL ADLIN1	;
685)   EC3C CD 9A EC    		 CALL GETDE	;
686)   EC3F EB          		 EX DE HL	;
687)   EC40 ED B8       		 LDDR	;
688)   EC42 E1          		ILIN2 POP HL	;
689)   EC43 F1          		 POP AF	;
690)   EC44 F5          		 PUSH AF	;
691)   EC45 18 CA       		 JR SCRLL4	;
693)   EC47 42          		DELLIN LD B D	;
694)   EC48 04          		 INC B	;
695)   EC49 DD 7E 09    		 LD A (IX+LN)	;
696)   EC4C CD E6 EB    		DELLN1 CALL SCROLL	;
697)   EC4F 10 FB       		 DJNZ DELLN1	;
698)   EC51 CD 94 EC    		 CALL ZERO	;
699)   EC54 C3 28 EB    		 JP LNFD4	;
701)   EC57 79          		DOTAB LD A C	;
702)   EC58 E6 07       		 AND 7	;
703)   EC5A D6 08       		 SUB 8	;
704)   EC5C ED 44       		 NEG	;
705)   EC5E F5          		DT1 PUSH AF	;
706)   EC5F CD 3B EA    		 CALL CURRT	;
707)   EC62 F1          		 POP AF	;
708)   EC63 3D          		 DEC A	;
709)   EC64 20 F8       		 JR NZ DT1	;
710)   EC66 C9          		 RET	;
712)   EC67 DD CB 08 E6 		SHOWC SET CURSHOFLG (IX+EXFLGS)	;
713)   EC6B C9          		 RET	;
715)   EC6C DD CB 08 A6 		HIDEC RES CURSHOFLG (IX+EXFLGS)	;
716)   EC70 C9          		 RET	;
718)   EC71 DD CB 07 F6 		INSMOD SET IFLG (IX+FLAGS) ;	;
719)   EC75 C9          		 RET ;	;
721)   EC76 DD CB 07 CE 		ESCAPE SET ESCFLG (IX+FLAGS)	;
722)   EC7A C9          		 RET	;
724)   EC7B DD CB 07 FE 		SHFTIN SET SFTFLG (IX+FLAGS)	;
725)   EC7F C9          		 RET	;
727)   EC80 DD CB 07 BE 		SHFTOU RES SFTFLG (IX+FLAGS)	;
728)   EC84 C9          		NULL RET	;
730)   EC85 85          		ADHLA ADD A L ;	;
731)   EC86 6F          		 LD L A ;	;
732)   EC87 D0          		 RET NC ;	;
733)   EC88 24          		 INC H ;	;
734)   EC89 C9          		 RET ;	;
736)   EC8A 78          		TSINP LD A B	;
737)   EC8B DD BE 0C    		 CP (IX+INPB)	;
738)   EC8E C0          		 RET NZ	;
739)   EC8F 79          		 LD A C	;
740)   EC90 DD BE 0D    		 CP (IX+INPC)	;
741)   EC93 C9          		 RET	;
743)   EC94 AF          		ZERO XOR A	;
744)   EC95 47          		 LD B A	;
745)   EC96 4F          		 LD C A	;
746)   EC97 57          		 LD D A	;
747)   EC98 5F          		 LD E A	;
748)   EC99 C9          		 RET	;
750)   EC9A 54          		GETDE LD D H	;
751)   EC9B 5D          		 LD E L	;
752)   EC9C 3E 01       		 LD A 1	;
753)   EC9E 2B          		 DEC HL	;
754)   EC9F 23          		ADLIN INC HL	;
755)   ECA0 C5          		ADLIN1 PUSH BC	;
756)   ECA1 CD B3 EC    		 CALL CALIN	;
757)   ECA4 09          		 ADD HL BC	;
758)   ECA5 C1          		 POP BC	;
759)   ECA6 C9          		 RET	;
761)   ECA7 4F          		BACAL LD C A	;
762)   ECA8 AF          		 XOR A	;
763)   ECA9 47          		 LD B A	;
764)   ECAA 81          		CAL1 ADD A C	;
765)   ECAB 30 01       		 JR NC CAL2	;
766)   ECAD 04          		 INC B	;
767)   ECAE 15          		CAL2 DEC D	;
768)   ECAF 20 F9       		 JR NZ CAL1	;
769)   ECB1 4F          		 LD C A	;
770)   ECB2 C9          		 RET	;
772)   ECB3 01 00 00    		CALIN LD BC 0	;
773)   ECB6 B7          		 OR A	;
774)   ECB7 C8          		 RET Z	;
775)   ECB8 D5          		 PUSH DE	;
776)   ECB9 F5          		 PUSH AF	;
777)   ECBA 57          		 LD D A	;
778)   ECBB DD 7E 06    		 LD A (IX+EL)	;
779)   ECBE CD A7 EC    		 CALL BACAL	;
780)   ECC1 F1          		 POP AF	;
781)   ECC2 D1          		 POP DE	;
782)   ECC3 C9          		 RET	;
784)   ECC4 DD 7E 09    		GETCUR LD A (IX+LN)	;
785)   ECC7 80          		 ADD A B	;
786)   ECC8 CD 9F EC    		GETCR0 CALL ADLIN	;
787)   ECCB 79          		 LD A C	;
788)   ECCC CD 85 EC    		 CALL ADHLA	;
789)   ECCF 7E          		 LD A (HL)	;
790)   ECD0 C9          		 RET	;
792)   ECD1 E5          		WLIN PUSH HL	;
793)   ECD2 C5          		 PUSH BC	;
794)   ECD3 F5          		 PUSH AF	;
795)   ECD4 CD C8 EC    		 CALL GETCR0	;
796)   ECD7 DD 7E 06    		 LD A (IX+EL)	;
797)   ECDA 91          		 SUB C	;
798)   ECDB 47          		 LD B A	;
799)   ECDC 36 00       		 LD (HL) 0	;
800)   ECDE CC          		 DEFB 0CCH ;'call z'-flag is nz	;'call z' - flag is nz
801)   ECDF 36 20       		WLIN1 LD (HL) BLANK	;
802)   ECE1 23          		 INC HL	;
803)   ECE2 10 FB       		 DJNZ WLIN1	;
804)   ECE4 F1          		WLIN2 POP AF	;
805)   ECE5 C1          		 POP BC	;
806)   ECE6 E1          		 POP HL	;
807)   ECE7 C9          		 RET	;
809)   ECE8 CB 66       		CCRET BIT INPFLG (HL)	;
810)   ECEA C0          		 RET NZ	;
811)   ECEB DD CB 08 FE 		 SET SNDCCFLG (IX+EXFLGS)	;
812)   ECEF C9          		 RET	;
814)   ECF0 CB 66       		XYRET BIT INPFLG (HL)	;
815)   ECF2 C0          		 RET NZ	;
816)   ECF3 DD CB 08 F6 		 SET SNDXYFLG (IX+EXFLGS)	;
817)   ECF7 C9          		 RET	;
819)   ECF8 CB 4E       		XYRQST BIT HLDFLG (HL)	;
820)   ECFA C0          		 RET NZ	;
821)   ECFB DD CB 07 DE 		 SET XYFLG (IX+FLAGS)	;
822)   ECFF C9          		 RET	;
824)   ED00 CB 7E       		TVRQST BIT TVFLG (HL)	;
825)   ED02 C8          		 RET Z	;
826)   ED03 DD CB 07 C6 		 SET TVMFLG (IX+FLAGS)	;
827)   ED07 C9          		 RET	;
830)   ED08 7B          		INCDE LD A E	;
831)   ED09 DD BE 05    		 CP (IX+LL)	;
832)   ED0C 28 02       		 JR Z INCDE1	;
833)   ED0E 1C          		 INC E	;
834)   ED0F C9          		 RET	;
836)   ED10 7A          		INCDE1 LD A D	;
837)   ED11 3C          		 INC A	;
838)   ED12 DD BE 04    		 CP (IX+DEP)	;
839)   ED15 20 22       		 JR NZ NOSTOP	;
840)   ED17 CB 66       		 BIT INPFLG (HL)	;
841)   ED19 28 02       		 JR Z STPTS1	;
842)   ED1B F1          		 POP AF	;
843)   ED1C C9          		 RET	;
845)   ED1D CB 5E       		STPTS1 BIT OLFLG (HL)	;
846)   ED1F 28 12       		 JR Z STPTS2	;
847)   ED21 F1          		 POP AF	;
848)   ED22 DD 7E 0E    		 LD A (IX+CHAR)	;
849)   ED25 F5          		 PUSH AF	;
850)   ED26 3E 0D       		 LD A CR	;
851)   ED28 CD A5 E7    		 CALL EDOUT	;
852)   ED2B DD CB 07 CE 		 SET ESCFLG (IX+FLAGS)	;
853)   ED2F F1          		 POP AF	;
854)   ED30 C3 AC E7    		 JP EDOUT1	;
856)   ED33 DD 34 09    		STPTS2 INC (IX+LN)	;
857)   ED36 15          		 DEC D	;
858)   ED37 05          		 DEC B	;
859)   ED38 3D          		 DEC A	;
860)   ED39 14          		NOSTOP INC D	;
861)   ED3A DD 86 09    		 ADD A (IX+LN)	;
862)   ED3D CD 1F EC    		 CALL ILIN	;
863)   ED40 E5          		 PUSH HL	;
864)   ED41 7A          		 LD A D	;
865)   ED42 DD 86 09    		 ADD A (IX+LN)	;
866)   ED45 CD 9F EC    		 CALL ADLIN	;
867)   ED48 36 7F       		 LD (HL) CONCHR	;
868)   ED4A E1          		 POP HL	;
869)   ED4B 1E 02       		 LD E 2	;
870)   ED4D C9          		 RET	;
872)   ED4E C5          		SCHUP PUSH BC	;
873)   ED4F 01 00 00    		 LD BC 0	;
874)   ED52 50          		 LD D B	;
875)   ED53 DD 35 09    		SCHUP3 DEC (IX+LN)	;
876)   ED56 E5          		 PUSH HL	;
877)   ED57 CF          		 DEFB ZGETCUR	;
878)   ED58 E1          		 POP HL	;
879)   ED59 FE 7F       		 CP CONCHR	;
880)   ED5B 20 03       		 JR NZ SCHUP4	;
881)   ED5D 14          		 INC D	;
882)   ED5E 18 F3       		 JR SCHUP3	;
883)   ED60 C1          		SCHUP4 POP BC	;
884)   ED61 C9          		 RET	;
886)   ED62 7B          		ICIL LD A E	;
887)   ED63 91          		 SUB C	;
888)   ED64 C8          		 RET Z	;
889)   ED65 D8          		 RET C	;
890)   ED66 E5          		 PUSH HL	;
891)   ED67 C5          		 PUSH BC	;
892)   ED68 F5          		 PUSH AF	;
893)   ED69 CF          		 DEFB ZGETCUR	;
894)   ED6A C1          		 POP BC	;
895)   ED6B DD 4E 0E    		 LD C (IX+CHAR)	;
896)   ED6E 7E          		ICIL1 LD A (HL)	;
897)   ED6F 71          		 LD (HL) C	;
898)   ED70 4F          		 LD C A	;
899)   ED71 23          		 INC HL	;
900)   ED72 10 FA       		 DJNZ ICIL1	;
901)   ED74 DD 71 0E    		 LD (IX+CHAR) C	;
902)   ED77 C1          		 POP BC	;
903)   ED78 E1          		 POP HL	;
904)   ED79 C9          		 RET	;
906)   ED7A 7B          		DCFL LD A E	;
907)   ED7B 91          		 SUB C	;
908)   ED7C C8          		 RET Z	;
909)   ED7D D8          		 RET C	;
910)   ED7E E5          		 PUSH HL	;
911)   ED7F C5          		 PUSH BC	;
912)   ED80 F5          		 PUSH AF	;
913)   ED81 4B          		 LD C E	;
914)   ED82 CF          		 DEFB ZGETCUR	;
915)   ED83 C1          		 POP BC	;
916)   ED84 DD 4E 0F    		 LD C (IX+DCHR)	;
917)   ED87 2B          		DCFL1 DEC HL	;
918)   ED88 7E          		 LD A (HL)	;
919)   ED89 71          		 LD (HL) C	;
920)   ED8A 4F          		 LD C A	;
921)   ED8B 10 FA       		 DJNZ DCFL1	;
922)   ED8D DD 71 0F    		 LD (IX+DCHR) C	;
923)   ED90 C1          		 POP BC	;
924)   ED91 E1          		 POP HL	;
925)   ED92 C9          		 RET	;
927)   ED93 78          		CPDB LD A B	;
928)   ED94 BA          		 CP D	;
929)   ED95 C0          		 RET NZ	;
930)   ED96 79          		 LD A C	;
931)   ED97 BB          		 CP E	;
932)   ED98 C9          		 RET	;
945)   ED99 C5          		 PUSH BC	;
946)   ED9A DD 7E 09    		 LD A,(IX+LN)	;
947)   ED9D 80          		 ADD A,B ;so A= cur line	;so A= cur line
948)   ED9E DD 46 0A    		 LD B,(IX+FRM)	;
949)   EDA1 B8          		 CP B	;
950)   EDA2 38 12       		 JR C DF4 ;if cur lin<FRM	;if cur lin<FRM
951)   EDA4 4F          		 LD C,A ;so C= cur line	;so C= cur line
952)   EDA5 78          		 LD A,B ;so A= FRM	;so A= FRM
953)   EDA6 06 18       		 LD B,FL1-1 ;B= frame length	;B= frame length
954)   EDA8 DD CB 01 5E 		 BIT UCR,(IX+TVMD1)	;
955)   EDAC 28 02       		 JR Z DF1 ;if not "PET display"	;if not "PET display"
956)   EDAE 06 1D       		 LD B,FL2-1	;
957)   EDB0 80          		DF1: ADD A,B ;so A= last displayed line	;so A= last displayed line
958)   EDB1 B9          		 CP C	;
959)   EDB2 79          		 LD A,C ;so A= cur line	;so A= cur line
960)   EDB3 30 04       		 JR NC DF5 ;if last disp line>=cur line	;if last disp line>=cur line
961)   EDB5 90          		 SUB B ;so A= cur line - frame len	;so A= cur line - frame len
962)   EDB6 DD 77 0A    		DF4: LD (IX+FRM),A	;
963)   EDB9 C1          		DF5: POP BC	;
964)   EDBA C9          		 RET	;
967)   EDBB 2A 5C 00    		SETFRM LD HL (TVRAM)	;
968)   EDBE E5          		 PUSH HL	;
969)   EDBF DD E1       		 POP IX	;
970)   EDC1 46          		 LD B (HL)	;
971)   EDC2 23          		 INC HL	;
972)   EDC3 3A 6B 00    		 LD A (FICLKL)	;
973)   EDC6 CB 67       		 BIT 4 A	;
974)   EDC8 7E          		 LD A (HL)	;
975)   EDC9 28 02       		 JR Z STFM1	;
976)   EDCB CB FF       		 SET 7 A	;
977)   EDCD D3 0C       		STFM1 OUT (TVREG) A	;
978)   EDCF 78          		 LD A B	;
979)   EDD0 C6 04       		 ADD A 4	;
980)   EDD2 CD 85 EC    		 CALL ADHLA	;
981)   EDD5 DD 7E 0A    		 LD A (IX+FRM)	;
982)   EDD8 CD A0 EC    		 CALL ADLIN1	;
983)   EDDB 44          		 LD B H	;
984)   EDDC 4D          		 LD C L	;
985)   EDDD C9          		 RET	;
987)   EDDE 79          		CHKFRM LD A C	;
988)   EDDF FE 01       		 CP 1	;
989)   EDE1 C0          		 RET NZ	;
990)   EDE2 78          		 LD A B	;
991)   EDE3 B7          		 OR A	;
992)   EDE4 C8          		 RET Z	;
993)   EDE5 DD 86 09    		 ADD A (IX+LN)	;
994)   EDE8 DD BE 0A    		 CP (IX+FRM)	;
995)   EDEB C0          		 RET NZ	;
996)   EDEC F1          		 POP AF	;
997)   EDED C9          		 RET	;
 58)   EDEE 04          		TP1IO DEFB 4	;
 59)   EDEF 51          		 DEFB TP1OPI-$	;
 60)   EDF0 0E          		 DEFB TP1OPO-$	;
 61)   EDF1 C2          		 DEFB TPINP-$	;
 62)   EDF2 9F          		 DEFB TPOUT-$	;
 63)   EDF3 2C          		 DEFB TPCLS-$	;
 65)   EDF4 04          		TP2IO DEFB 4	;
 66)   EDF5 47          		 DEFB TP2OPI-$	;
 67)   EDF6 04          		 DEFB TP2OPO-$	;
 68)   EDF7 BC          		 DEFB TPINP-$	;
 69)   EDF8 99          		 DEFB TPOUT-$	;
 70)   EDF9 26          		 DEFB TPCLS-$	;
 72)   EDFA 3E 02       		TP2OPO LD A MOTOR2	;
 73)   EDFC 18 02       		 JR TPOPO	;
 75)   EDFE 3E 08       		TP1OPO LD A MOTOR1	;
 76)   EE00 F5          		TPOPO PUSH AF	;
 77)   EE01 CD B4 EF    		 CALL TPSYN	;
 78)   EE04 F1          		 POP AF	;
 79)   EE05 36 80       		 LD (HL) 80H ;out flag	;out flag
 80)   EE07 CD 1A F0    		 CALL BRACKET	;
 81)   EE0A 23          		 INC HL	;
 82)   EE0B 70          		 LD (HL) B	;
 83)   EE0C 23          		 INC HL	;
 84)   EE0D 36 00       		 LD (HL) 0	;
 85)   EE0F 23          		 INC HL	;
 86)   EE10 70          		 LD (HL) B	;
 87)   EE11 23          		 INC HL	;
 88)   EE12 36 00       		 LD (HL) DATATY	;
 89)   EE14 23          		 INC HL	;
 90)   EE15 77          		 LD (HL) A	;
 91)   EE16 EB          		 EX DE HL	;
 92)   EE17 06 00       		 LD B 0	;
 93)   EE19 57          		 LD D A	;
 94)   EE1A 1E 81       		 LD E NAMETY	;
 95)   EE1C C3 F9 EE    		 JP WRBLCK	;
 97)   EE1F 5E          		TPCLS LD E (HL)	;
 98)   EE20 CB 13       		 RL E	;
 99)   EE22 D0          		 RET NC	;
100)   EE23 CD A6 EF    		 CALL LDBUFF	;
101)   EE26 AF          		 XOR A	;
102)   EE27 91          		 SUB C	;
103)   EE28 4F          		 LD C A	;
104)   EE29 DD 7E 01    		 LD A (IX+BSTO)	;
105)   EE2C 98          		 SBC A B	;
106)   EE2D 47          		 LD B A	;
107)   EE2E 7C          		 LD A H	;
108)   EE2F DD 86 01    		 ADD A (IX+BSTO)	;
109)   EE32 67          		 LD H A	;
110)   EE33 AF          		 XOR A	;
111)   EE34 ED 42       		 SBC HL BC	;
112)   EE36 1C          		 INC E	;
113)   EE37 CB F3       		 SET 6 E	;
114)   EE39 C3 F9 EE    		 JP WRBLCK	;
116)   EE3C 3E 02       		TP2OPI LD A MOTOR2	;
117)   EE3E 18 02       		 JR TPOPI	;
119)   EE40 3E 08       		TP1OPI LD A MOTOR1	;
120)   EE42 F5          		TPOPI PUSH AF	;
121)   EE43 CD B4 EF    		 CALL TPSYN	;
122)   EE46 F1          		 POP AF	;
123)   EE47 E5          		 PUSH HL	;
124)   EE48 DD E1       		 POP IX	;
125)   EE4A 36 00       		 LD (HL) 0	;
126)   EE4C CD 1A F0    		 CALL BRACKET	;
127)   EE4F 23          		 INC HL	;
128)   EE50 70          		 LD (HL) B	;
129)   EE51 23          		 INC HL	;
130)   EE52 23          		 INC HL	;
131)   EE53 36 00       		 LD (HL) 0	;
132)   EE55 23          		 INC HL	;
133)   EE56 23          		 INC HL	;
134)   EE57 77          		 LD (HL) A	;
135)   EE58 23          		 INC HL	;
136)   EE59 AF          		TRYAGAIN XOR A	;
137)   EE5A E5          		 PUSH HL	;
138)   EE5B D5          		 PUSH DE	;
139)   EE5C C5          		 PUSH BC	;
140)   EE5D 4F          		 LD C A	;
141)   EE5E DD 56 05    		 LD D (IX+MOTOR)	;
142)   EE61 CD 1F EF    		 CALL RDBLCK	;
143)   EE64 DD 73 04    		 LD (IX+TYPE) E	;
144)   EE67 DD 71 02    		 LD (IX+CTEMP) C	;
145)   EE6A C1          		 POP BC	;
146)   EE6B D1          		 POP DE	;
147)   EE6C E1          		 POP HL	;
148)   EE6D D8          		 RET C	;
149)   EE6E 3E 81       		 LD A NAMETY	;
150)   EE70 DD BE 04    		 CP (IX+TYPE)	;
151)   EE73 20 E4       		 JR NZ TRYAGAIN	;
152)   EE75 79          		 LD A C	;
153)   EE76 B7          		 OR A	;
154)   EE77 28 06       		 JR Z GOTONE	;
155)   EE79 DD BE 02    		 CP (IX+CTEMP)	;
156)   EE7C CC 0A F0    		 CALL Z CPSTRINGS	;
157)   EE7F CD E9 EF    		GOTONE CALL SENDSTRING	;
158)   EE82 20 D5       		 JR NZ TRYAGAIN	;
159)   EE84 DD 36 04 00 		 LD (IX+TYPE) DATATY	;
160)   EE88 DD 4E 02    		 LD C (IX+CTEMP)	;
161)   EE8B AF          		 XOR A	;
162)   EE8C 47          		 LD B A	;
163)   EE8D DD 77 02    		 LD (IX+CTEMP) A	;
164)   EE90 C9          		 RET	;
166)   EE91 CB 7E       		TPOUT BIT 7 (HL)	;
167)   EE93 28 1A       		 JR Z OIER	;
169)   EE95 CD A6 EF    		TPOUT1 CALL LDBUFF	;
170)   EE98 E5          		 PUSH HL ;	;
171)   EE99 09          		 ADD HL BC ;	;
172)   EE9A 2B          		 DEC HL	;
173)   EE9B 77          		 LD (HL) A ;	;
174)   EE9C E1          		 POP HL ;MO	;MO
175)   EE9D CD ED EE    		 CALL DECBC ;	;
176)   EEA0 79          		 LD A C ;	;
177)   EEA1 B0          		 OR B ;	;
178)   EEA2 C0          		 RET NZ ;	;
181)   EEA3 DD 46 01    		 LD B (IX+BSTO)	;
182)   EEA6 4F          		 LD C A	;
183)   EEA7 1C          		 INC E	;
184)   EEA8 CB BB       		 RES 7 E	;
185)   EEAA CD EE EE    		 CALL STREGS ;	;
186)   EEAD 18 4A       		 JR WRBLCK ;	;
188)   EEAF 3E 87       		OIER LD A OUTINERR	;
189)   EEB1 37          		 SCF	;
190)   EEB2 C9          		 RET	;
192)   EEB3 CB 7E       		TPINP BIT 7 (HL)	;
193)   EEB5 20 F8       		 JR NZ OIER	;
194)   EEB7 CD A6 EF    		 CALL LDBUFF	;
195)   EEBA 79          		 LD A C	;
196)   EEBB B0          		 OR B	;
197)   EEBC 20 2A       		 JR NZ TPINP1	;
198)   EEBE 3E 85       		TPINP2 LD A ENDDATAERR	;
199)   EEC0 CB 73       		 BIT 6 E	;
200)   EEC2 37          		 SCF	;
201)   EEC3 C0          		 RET NZ	;
202)   EEC4 E5          		 PUSH HL	;
203)   EEC5 DD 46 01    		 LD B (IX+BSTO)	;
204)   EEC8 0E 00       		 LD C 0	;
205)   EECA CD 1F EF    		 CALL RDBLCK	;
206)   EECD DD 56 05    		 LD D (IX+MOTOR)	;
207)   EED0 E1          		 POP HL	;
208)   EED1 D8          		 RET C	;
209)   EED2 DD 7E 04    		 LD A (IX+TYPE)	;
210)   EED5 3C          		 INC A	;
211)   EED6 CB B7       		 RES 6 A	;
212)   EED8 BB          		 CP E	;
213)   EED9 28 09       		 JR Z TPINP3	;
214)   EEDB CB F7       		 SET 6 A	;
215)   EEDD BB          		 CP E	;
216)   EEDE 37          		 SCF	;
217)   EEDF 28 03       		 JR Z TPINP3	;
218)   EEE1 3E 86       		 LD A SEQUENCERR	;
219)   EEE3 C9          		 RET	;
220)   EEE4 78          		TPINP3 LD A B	;
221)   EEE5 B1          		 OR C	;
222)   EEE6 28 D6       		 JR Z TPINP2	;
223)   EEE8 E5          		TPINP1 PUSH HL	;
224)   EEE9 2B          		 DEC HL	;
225)   EEEA 09          		 ADD HL BC	;
226)   EEEB 7E          		 LD A (HL) ;	;
227)   EEEC E1          		 POP HL ;	;
228)   EEED 0B          		DECBC DEC BC ;	;
229)   EEEE E5          		STREGS PUSH HL ;	;
230)   EEEF 2B          		 DEC HL ;	;
231)   EEF0 72          		 LD (HL) D	;
232)   EEF1 2B          		 DEC HL	;
233)   EEF2 73          		 LD (HL) E ;	;
234)   EEF3 2B          		 DEC HL	;
235)   EEF4 70          		 LD (HL) B	;
236)   EEF5 2B          		 DEC HL	;
237)   EEF6 71          		 LD (HL) C	;
238)   EEF7 E1          		 POP HL ;	;
239)   EEF8 C9          		 RET ;	;
242)   EEF9 3E 80       		 LD A CASSCOM+RECORD	;
243)   EEFB CD 81 EF    		 CALL CASSON ;	;
244)   EEFE 79          		 LD A C ;	;
245)   EEFF CF          		 DEFB ZTCHR ;	;
246)   EF00 78          		 LD A B ;	;
247)   EF01 CF          		 DEFB ZTCHR ;	;
248)   EF02 78          		WRBLLP LD A B ;	;
249)   EF03 B1          		 OR C ;	;
250)   EF04 28 06       		 JR Z WRBEND-$ ;	;
251)   EF06 0B          		 DEC BC ;	;
252)   EF07 7E          		 LD A (HL) ;	;
253)   EF08 23          		 INC HL ;	;
254)   EF09 CF          		 DEFB ZTCHR ;	;
255)   EF0A 18 F6       		 JR WRBLLP ;	;
257)   EF0C 7B          		WRBEND LD A E	;
258)   EF0D CF          		 DEFB ZTCHR	;
259)   EF0E 2A 50 00    		 LD HL (CHKSUM) ;	;
260)   EF11 7D          		 LD A L ;	;
261)   EF12 CF          		 DEFB ZTCHR ;	;
262)   EF13 7C          		 LD A H ;	;
263)   EF14 CF          		 DEFB ZTCHR ;	;
264)   EF15 C5          		 PUSH BC	;
265)   EF16 06 09       		 LD B 9	;
266)   EF18 AF          		WRBD1 XOR A ;	;
267)   EF19 CF          		 DEFB ZTCHR ;	;
268)   EF1A 10 FC       		 DJNZ WRBD1	;
269)   EF1C C1          		 POP BC	;
270)   EF1D 18 50       		 JR NOEREX ;	;
273)   EF1F CD 4D EF    		 CALL PRETRD ;	;
274)   EF22 D8          		 RET C ;	;
275)   EF23 5F          		 LD E A ;	;
276)   EF24 CF          		 DEFB ZTCHR ;	;
277)   EF25 57          		 LD D A ;	;
278)   EF26 E5          		 PUSH HL ;	;
279)   EF27 60          		 LD H B ;	;
280)   EF28 69          		 LD L C ;	;
281)   EF29 ED 52       		 SBC HL DE ;	;
282)   EF2B E1          		 POP HL ;	;
283)   EF2C 42          		 LD B D ;for return information.	;for return information.
284)   EF2D 4B          		 LD C E ;	;
285)   EF2E 3E 83       		 LD A LENGTHERR ;	;
286)   EF30 38 3C       		 JR C ERREX2-$ ;	;
288)   EF32 7A          		RDBLLP LD A D ;	;
289)   EF33 B3          		 OR E ;	;
290)   EF34 28 06       		 JR Z RDBEND-$ ;	;
291)   EF36 1B          		 DEC DE ;	;
292)   EF37 CF          		 DEFB ZTCHR ;	;
293)   EF38 77          		 LD (HL) A ;	;
294)   EF39 23          		 INC HL ;	;
295)   EF3A 18 F6       		 JR RDBLLP ;	;
297)   EF3C CF          		RDBEND DEFB ZTCHR	;
298)   EF3D 5F          		 LD E A	;
299)   EF3E 2A 50 00    		 LD HL (CHKSUM) ;	;
300)   EF41 CF          		 DEFB ZTCHR ;	;
301)   EF42 BD          		 CP L	;
302)   EF43 20 04       		 JR NZ CHKERR	;
303)   EF45 CF          		 DEFB ZTCHR ;	;
304)   EF46 BC          		 CP H	;
305)   EF47 28 26       		 JR Z NOEREX-$ ;	;
306)   EF49 3E 84       		CHKERR LD A CHECKSUMERR ;	;
307)   EF4B 18 21       		 JR ERREX2-$ ;	;
309)   EF4D 3E 84       		PRETRD LD A CASSCOM+PLAYBK	;
310)   EF4F CD 81 EF    		 CALL CASSON ;	;
311)   EF52 CF          		 DEFB ZTCHR ;	;
314)   EF53 E5          		 PUSH HL ;	;
315)   EF54 F3          		 DI ;	;
316)   EF55 21 3D 00    		 LD HL COPBUF ;	;
317)   EF58 77          		 LD (HL) A ;	;
318)   EF59 CD 9A EF    		 CALL WTRDY ;	;
319)   EF5C CB 66       		 BIT CERR (HL) ;	;
320)   EF5E 23          		 INC HL	;
321)   EF5F 7E          		 LD A (HL)	;
322)   EF60 20 0A       		 JR NZ ERREX1-$ ;	;
323)   EF62 2A 50 00    		 LD HL (CHKSUM) ;	;
324)   EF65 F5          		 PUSH AF ;	;
325)   EF66 CD 85 EC    		 CALL ADHLA ;	;
326)   EF69 F1          		 POP AF ;	;
327)   EF6A 18 21       		 JR PUTCS-$ ;	;
329)   EF6C E1          		ERREX1 POP HL ;	;
330)   EF6D E1          		 POP HL ;	;
331)   EF6E 37          		ERREX2 SCF ;	;
333)   EF6F 21 3B 00    		 LD HL COPCTL ;	;
334)   EF72 36 D0       		 LD (HL) NULLCOM ;	;
335)   EF74 CD 9A EF    		 CALL WTRDY ;	;
336)   EF77 CD 9A EF    		 CALL WTRDY	;
337)   EF7A CD 9A EF    		 CALL WTRDY	;
338)   EF7D CB A6       		 RES CERR (HL)	;
339)   EF7F FB          		 EI ;	;
340)   EF80 C9          		 RET ;	;
342)   EF81 82          		CASSON ADD A D ;	;
343)   EF82 CD 85 EF    		 CALL CASRPT ;	;
344)   EF85 E5          		CASRPT PUSH HL ;	;
345)   EF86 CD 9A EF    		 CALL WTRDY ;	;
346)   EF89 36 00       		 LD (HL) 0 ;	;
347)   EF8B 2B          		 DEC HL ;	;
348)   EF8C 77          		 LD (HL) A ;	;
349)   EF8D FB          		PUTCS EI ;	;
350)   EF8E 22 50 00    		 LD (CHKSUM) HL ;	;
351)   EF91 21 53 EF    		 LD HL TCHR	;
352)   EF94 22 09 00    		 LD (RST8) HL	;
353)   EF97 E1          		 POP HL ;	;
354)   EF98 B7          		 OR A ;	;
355)   EF99 C9          		 RET ;	;
357)   EF9A 21 3C 00    		WTRDY LD HL COPST ;	;
358)   EF9D F3          		 DI	;
359)   EF9E CB 6E       		 BIT READY (HL) ;	;
360)   EFA0 CB AE       		 RES READY (HL) ;	;
361)   EFA2 C0          		 RET NZ ;	;
362)   EFA3 FB          		 EI	;
363)   EFA4 18 F4       		 JR WTRDY ;	;
365)   EFA6 E5          		LDBUFF PUSH HL	;
366)   EFA7 DD E1       		 POP IX	;
367)   EFA9 23          		 INC HL	;
368)   EFAA 23          		 INC HL	;
369)   EFAB 4E          		LDREGS LD C (HL) ;	;
370)   EFAC 23          		 INC HL	;
371)   EFAD 46          		 LD B (HL)	;
372)   EFAE 23          		 INC HL	;
373)   EFAF 5E          		 LD E (HL)	;
374)   EFB0 23          		 INC HL	;
375)   EFB1 56          		 LD D (HL)	;
376)   EFB2 23          		 INC HL	;
377)   EFB3 C9          		 RET	;
379)   EFB4 CD C5 EF    		TPSYN CALL TPSYN1	;
380)   EFB7 3E 88       		 LD A SYNTAXERR	;
381)   EFB9 E5          		 PUSH HL	;
382)   EFBA C5          		 PUSH BC	;
383)   EFBB 0E 06       		 LD C 6	;
384)   EFBD EF 37       		 DEFW WMKBUFF	;
385)   EFBF C1          		 POP BC	;
386)   EFC0 D1          		 POP DE	;
387)   EFC1 D0          		 RET NC	;
388)   EFC2 C1          		 POP BC	;
389)   EFC3 C1          		 POP BC	;
390)   EFC4 C9          		 RET	;
392)   EFC5 78          		TPSYN1 LD A B	;
393)   EFC6 B7          		 OR A	;
394)   EFC7 37          		 SCF	;
395)   EFC8 C0          		 RET NZ	;
396)   EFC9 06 04       		 LD B 4	;
397)   EFCB 79          		 LD A C	;
398)   EFCC B7          		 OR A	;
399)   EFCD C8          		 RET Z	;
400)   EFCE 7E          		 LD A (HL)	;
401)   EFCF D6 2A       		 SUB '*'	;
402)   EFD1 B7          		 OR A	;
403)   EFD2 C0          		 RET NZ	;
404)   EFD3 23          		 INC HL	;
405)   EFD4 0D          		 DEC C	;
406)   EFD5 CD 81 E3    		 CALL RDBYTE	;
407)   EFD8 D8          		 RET C	;
408)   EFD9 B7          		 OR A	;
409)   EFDA 3F          		 CCF	;
410)   EFDB C8          		 RET Z	;
411)   EFDC 47          		 LD B A	;
412)   EFDD 79          		 LD A C	;
413)   EFDE B7          		 OR A	;
414)   EFDF C8          		 RET Z	;
415)   EFE0 7E          		 LD A (HL)	;
416)   EFE1 FE 3A       		 CP ':'	;
417)   EFE3 37          		 SCF	;
418)   EFE4 C0          		 RET NZ	;
419)   EFE5 3F          		 CCF	;
420)   EFE6 23          		 INC HL	;
421)   EFE7 0D          		 DEC C	;
422)   EFE8 C9          		 RET	;
427)   EFE9 E5          		SENDSTRING PUSH HL	;
428)   EFEA D5          		 PUSH DE	;
429)   EFEB C5          		 PUSH BC	;
430)   EFEC F5          		 PUSH AF	;
431)   EFED DD CB 00 46 		 BIT 0 (IX+FLAGS)	;
432)   EFF1 20 12       		 JR NZ CANTDO	;
433)   EFF3 AF          		 XOR A	;
434)   EFF4 5F          		 LD E A	;
435)   EFF5 DD 46 02    		 LD B (IX+CTEMP)	;
436)   EFF8 B8          		 CP B	;
437)   EFF9 28 06       		 JR Z SENDNEWLINE	;
438)   EFFB 7E          		SENDAGAIN LD A (HL)	;
439)   EFFC 23          		 INC HL	;
440)   EFFD E7 30       		 DEFW ZOUTPUT	;
441)   EFFF 10 FA       		 DJNZ SENDAGAIN	;
443)   F001 3E 0D       		SENDNEWLINE LD A CR	;
444)   F003 E7 30       		 DEFW ZOUTPUT	;
445)   F005 F1          		CANTDO POP AF	;
446)   F006 C1          		 POP BC	;
447)   F007 D1          		 POP DE	;
448)   F008 E1          		 POP HL	;
449)   F009 C9          		 RET	;
451)   F00A E5          		CPSTRINGS PUSH HL	;
452)   F00B D5          		 PUSH DE	;
453)   F00C C5          		 PUSH BC	;
454)   F00D 1A          		AGAIN LD A (DE)	;
455)   F00E BE          		 CP (HL)	;
456)   F00F 20 05       		 JR NZ LEAVE	;
457)   F011 23          		 INC HL	;
458)   F012 13          		 INC DE	;
459)   F013 0D          		 DEC C	;
460)   F014 20 F7       		 JR NZ AGAIN	;
461)   F016 C1          		LEAVE POP BC	;
462)   F017 D1          		 POP DE	;
463)   F018 E1          		 POP HL	;
464)   F019 C9          		 RET	;
466)   F01A F5          		BRACKET PUSH AF	;
467)   F01B 79          		 LD A C	;
468)   F01C B7          		 OR A	;
469)   F01D 28 09       		 JR Z NOSTRING	;
470)   F01F 1A          		 LD A (DE)	;
471)   F020 FE 29       		 CP ')'	;
472)   F022 20 04       		 JR NZ NOSTRING	;
473)   F024 CB C6       		 SET SUPPRESS (HL)	;
474)   F026 0D          		 DEC C	;
475)   F027 13          		 INC DE	;
476)   F028 F1          		NOSTRING POP AF	;
477)   F029 C9          		 RET	;
 61)   F02A B7          		OPENIN: OR A ;flag "in"	;flag "in"
 62)   F02B 18 01       		 JR OPEN	;
 64)   F02D 37          		OPNOUT: SCF ;flag "out"	;flag "out"
 65)   F02E E5          		OPEN: PUSH HL	;
 66)   F02F C5          		 PUSH BC	;
 67)   F030 F5          		 PUSH AF	;
 68)   F031 CD 3A E1    		 CALL SAVIRS	;
 69)   F034 1C          		 INC E	;
 70)   F035 1D          		 DEC E	;
 71)   F036 20 08       		 JR NZ OPN1 ;if not console	;if not console
 72)   F038 21 1B 00    		 LD HL,PLLEN ;Set print formatting locations	;Set print formatting locations
 73)   F03B 73          		 LD (HL),E ;(PLLEN,PHPOS,PZLEN) to zero.	;(PLLEN,PHPOS,PZLEN) to zero.
 74)   F03C 23          		 INC HL	;
 75)   F03D 73          		 LD (HL),E	;
 76)   F03E 23          		 INC HL	;
 77)   F03F 73          		 LD (HL),E	;
 78)   F040 CD DE F1    		OPN1: CALL FDEV ;see if dvr+port already there	;see if dvr+port already there
 79)   F043 3E 6B       		 LD A,DEVERR	;
 80)   F045 30 38       		 JR NC OPNERR ;if it is	;if it is
 81)   F047 CD C2 F1    		 CALL FSTRM ;stream already there?	;stream already there?
 82)   F04A 3E 6C       		 LD A,STRMERR	;
 83)   F04C 30 31       		 JR NC OPNERR ;if it is	;if it is
 84)   F04E 01 06 00    		 LD BC,6	;
 85)   F051 CD 09 E1    		 CALL SPACE ;space for strm tab entry?	;space for strm tab entry?
 86)   F054 38 29       		 JR C OPNERR ;if none	;if none
 87)   F056 2A 64 00    		 LD HL,(STRTOP) ;loc for strm tab entry	;loc for strm tab entry
 88)   F059 73          		 LD (HL),E ;stream#	;stream#
 89)   F05A 23          		 INC HL	;
 90)   F05B C1          		 POP BC ;dvr# and I/O flag	;dvr# and I/O flag
 91)   F05C 70          		 LD (HL),B ;driver#	;driver#
 92)   F05D 23          		 INC HL	;
 93)   F05E 72          		 LD (HL),D ;port#	;port#
 94)   F05F 23          		 INC HL	;
 95)   F060 AF          		 XOR A ;rest of entry set to 0	;rest of entry set to 0
 96)   F061 77          		 LD (HL),A	;
 97)   F062 23          		 INC HL	;
 98)   F063 77          		 LD (HL),A	;
 99)   F064 23          		 INC HL	;
100)   F065 77          		 LD (HL),A	;
101)   F066 23          		 INC HL	;
102)   F067 22 64 00    		 LD (STRTOP),HL ;new top of strm tab	;new top of strm tab
103)   F06A 3C          		 INC A ;so A is code for "in"	;so A is code for "in"
104)   F06B A1          		 AND C	;
105)   F06C 4F          		 LD C,A ;so C=request code	;so C=request code
106)   F06D CD 9C F1    		 CALL FDE ;find entry for driver rtn	;find entry for driver rtn
107)   F070 C1          		 POP BC ;as on entry	;as on entry
108)   F071 E3          		 EX (SP),HL ;HL as on entry	;HL as on entry
109)   F072 DD E3       		 EX (SP),IX ;rtn addr to IX	;rtn addr to IX
110)   F074 D5          		 PUSH DE ;save strm# in case error	;save strm# in case error
111)   F075 D4 3C F2    		 CALL NC CALLIX ;enter device driver	;enter device driver
112)   F078 D1          		 POP DE	;
113)   F079 DD E1       		 POP IX	;
114)   F07B 38 2C       		 JR C REMOVE ;if error	;if error
115)   F07D 18 04       		 JR OPN9	;
117)   F07F 37          		OPNERR: SCF	;
118)   F080 C1          		 POP BC	;
119)   F081 C1          		 POP BC	;
120)   F082 E1          		 POP HL	;
121)   F083 CD 43 E1    		OPN9: CALL RESIRS	;
122)   F086 C9          		 RET	;
135)   F087 C5          		MOVE: PUSH BC	;
136)   F088 0E 05       		 LD C,5	;
137)   F08A 18 08       		 JR INOUT	;
139)   F08C C5          		INPUT: PUSH BC	;
140)   F08D 0E 02       		 LD C,2 ;Code for input	;Code for input
141)   F08F 18 03       		 JR INOUT	;
143)   F091 C5          		OUTPUT: PUSH BC	;
144)   F092 0E 03       		 LD C,3 ;Code for output	;Code for output
145)   F094 CD 72 F1    		INOUT: CALL IOC	;
146)   F097 C1          		 POP BC	;
147)   F098 C9          		 RET	;
150)   F099 C5          		CLOSE: PUSH BC	;
151)   F09A CD 3A E1    		 CALL SAVIRS	;
152)   F09D 0E 04       		 LD C,4 ;Code for close	;Code for close
153)   F09F CD 72 F1    		 CALL IOC	;
154)   F0A2 C1          		 POP BC	;
155)   F0A3 30 04       		 JR NC REMOVE	;
156)   F0A5 FE 69       		 CP NOSTRM	;
157)   F0A7 C8          		 RET Z  ;Not an error for CLOSE	;Not an error for CLOSE
158)   F0A8 37          		 SCF	;
170)   F0A9 F5          		 PUSH AF	;
171)   F0AA C5          		 PUSH BC	;
172)   F0AB D5          		 PUSH DE	;
173)   F0AC E5          		 PUSH HL	;
174)   F0AD 21 33 00    		 LD HL,BUFLG	;
175)   F0B0 CB C6       		 SET 0,(HL) ;flag buffers in motion	;flag buffers in motion
176)   F0B2 CD C2 F1    		 CALL FSTRM	;
177)   F0B5 38 70       		 JR C RMV9 ;if no stream	;if no stream
178)   F0B7 E5          		 PUSH HL ;str entry ptr to TOS	;str entry ptr to TOS
179)   F0B8 CD 42 F1    		 CALL CHKPBD ;own RAM ptr in bounds?	;own RAM ptr in bounds?
180)   F0BB 38 42       		 JR C RMV8 ;no-so no own RAM to rmv	;no-so no own RAM to rmv
181)   F0BD D5          		 PUSH DE ;own RAM ptr to TOS	;own RAM ptr to TOS
182)   F0BE EB          		 EX DE,HL	;
183)   F0BF CD 4A F1    		RMVLP1: CALL CHKVBD ;str tab ptr in bds?	;str tab ptr in bds?
184)   F0C2 EB          		 EX DE,HL	;
185)   F0C3 38 08       		 JR C RMV3 ;if no	;if no
186)   F0C5 CD 42 F1    		 CALL CHKPBD ;own RAM ptr in bds?	;own RAM ptr in bds?
187)   F0C8 EB          		 EX DE,HL	;
188)   F0C9 38 F4       		 JR C RMVLP1 ;if no- try next entry	;if no- try next entry
189)   F0CB 18 03       		 JR RMV4 ;fnd top of RAM to be rmvd	;fnd top of RAM to be rmvd
191)   F0CD 2A 56 00    		RMV3: LD HL,(STRTAB) ;top of own RAM was (STRTAB)	;top of own RAM was (STRTAB)
192)   F0D0 C1          		RMV4: POP BC  ;base of area to which upper	;base of area to which upper
195)   F0D1 D1          		 POP DE ;top of area to be shifted	;top of area to be shifted
196)   F0D2 C5          		 PUSH BC	;
197)   F0D3 E5          		 PUSH HL ;base of area to be shifted	;base of area to be shifted
198)   F0D4 B7          		 OR A	;
199)   F0D5 ED 42       		 SBC HL,BC	;
200)   F0D7 E3          		 EX (SP),HL ;TOS=size of area to be rmvd	;TOS=size of area to be rmvd
201)   F0D8 EB          		 EX DE,HL ;DE->base of area to be shifted 	;DE->base of area to be shifted
203)   F0D9 CD 34 F1    		 CALL SHFTDN ;shift area-preserves HL	;shift area-preserves HL
204)   F0DC 0E 06       		 LD C,6	;
205)   F0DE 09          		 ADD HL,BC ;so HL->nxt str tab entry	;so HL->nxt str tab entry
206)   F0DF C1          		 POP BC ;size of rmvd area	;size of rmvd area
207)   F0E0 EB          		 EX DE,HL ;so DE-> base of unshifted part	;so DE-> base of unshifted part
210)   F0E1 E3          		 EX (SP),HL ;so HL-> base of rmv'd area	;so HL-> base of rmv'd area
212)   F0E2 D5          		 PUSH DE	;
213)   F0E3 CD 4A F1    		RMVLP2: CALL CHKVBD ;still below (STRTOP)?	;still below (STRTOP)?
214)   F0E6 EB          		 EX DE,HL	;
215)   F0E7 38 0A       		 JR C RMV6 ;if no - all strtab ptrs done	;if no - all strtab ptrs done
216)   F0E9 23          		 INC HL	;
217)   F0EA 23          		 INC HL	;
218)   F0EB 23          		 INC HL	;
219)   F0EC 23          		 INC HL ;pt at own RAM ptr	;pt at own RAM ptr
220)   F0ED CD 5C F1    		 CALL UPDPTR ;update it (if in bds)	;update it (if in bds)
221)   F0F0 EB          		 EX DE,HL	;
222)   F0F1 18 F0       		 JR RMVLP2	;
224)   F0F3 3E 06       		RMV6: LD A,6 ;#fixed ptrs	;#fixed ptrs
225)   F0F5 21 56 00    		 LD HL,STRTAB ;1st ptr - IOSRAM must be last	;1st ptr - IOSRAM must be last
226)   F0F8 CD 5C F1    		RMVLP3: CALL UPDPTR	;
227)   F0FB 3D          		 DEC A	;
228)   F0FC 20 FA       		 JR NZ RMVLP3	;
229)   F0FE E1          		 POP HL ;ptr to unshifted pt of strtab	;ptr to unshifted pt of strtab
230)   F0FF C1          		RMV8: POP BC ;base to which to shift it	;base to which to shift it
231)   F100 EB          		 EX DE,HL	;
232)   F101 2A 64 00    		 LD HL,(STRTOP) ;top of area to shift	;top of area to shift
233)   F104 CD 34 F1    		 CALL SHFTDN	;
234)   F107 ED 53 64 00 		 LD (STRTOP),DE	;
235)   F10B B7          		 OR A	;
236)   F10C ED 52       		 SBC HL,DE	;
237)   F10E 44          		 LD B,H	;
238)   F10F 4D          		 LD C,L ;BC=size of area rmvd	;BC=size of area rmvd
239)   F110 CD 18 E1    		 CALL GSPCBK ;return space to user prog	;return space to user prog
240)   F113 2A 56 00    		 LD HL,(STRTAB) ;Call move rtns for all opn strms	;Call move rtns for all opn strms
241)   F116 54          		RMVLP4: LD D,H ;Now strm tab ptr in DE	;Now strm tab ptr in DE
242)   F117 5D          		 LD E,L	;
243)   F118 CD 3F F1    		 CALL CHKUBD ;<(STRTOP) ?	;<(STRTOP) ?
244)   F11B 38 0A       		 JR C RMV9 ;if not	;if not
245)   F11D 5E          		 LD E,(HL) ;else call move	;else call move
246)   F11E CD 87 F0    		 CALL MOVE ; rtn for this stream	; rtn for this stream
247)   F121 11 06 00    		 LD DE,6	;
248)   F124 19          		 ADD HL,DE ;pt at nxt strtab entry	;pt at nxt strtab entry
249)   F125 18 EF       		 JR RMVLP4	;
251)   F127 21 33 00    		RMV9: LD HL,BUFLG	;
252)   F12A CB 86       		 RES 0,(HL) ;flag buffers not in motion	;flag buffers not in motion
253)   F12C E1          		 POP HL	;
254)   F12D D1          		 POP DE	;
255)   F12E C1          		 POP BC	;
256)   F12F F1          		 POP AF	;
257)   F130 CD 43 E1    		 CALL RESIRS	;
258)   F133 C9          		 RET	;
271)   F134 B7          		 OR A	;
272)   F135 C5          		 PUSH BC	;
273)   F136 ED 52       		 SBC HL,DE	;
274)   F138 E3          		 EX (SP),HL	;
275)   F139 C1          		 POP BC	;
276)   F13A EB          		 EX DE,HL	;
277)   F13B C8          		 RET Z	;
278)   F13C ED B0       		 LDIR	;
279)   F13E C9          		 RET	;
283)   F13F E5          		 PUSH HL	;
284)   F140 18 0C       		 JR CHKP1	;
293)   F142 23          		 INC HL	;
294)   F143 23          		 INC HL	;
295)   F144 23          		 INC HL	;
296)   F145 23          		 INC HL	;
297)   F146 5E          		 LD E,(HL)	;
298)   F147 23          		 INC HL	;
299)   F148 56          		 LD D,(HL)	;
300)   F149 23          		 INC HL	;
303)   F14A E5          		 PUSH HL	;
304)   F14B 2A 62 00    		 LD HL,(IOSRAM)	;
305)   F14E 37          		CHKP1: SCF	;
306)   F14F ED 52       		 SBC HL,DE	;
307)   F151 3F          		 CCF	;
308)   F152 38 06       		 JR C CHKP2	;
309)   F154 2A 64 00    		 LD HL,(STRTOP)	;
310)   F157 37          		 SCF	;
311)   F158 ED 52       		 SBC HL,DE	;
312)   F15A E1          		CHKP2: POP HL	;
313)   F15B C9          		 RET	;
320)   F15C D5          		 PUSH DE	;
321)   F15D 5E          		 LD E,(HL)	;
322)   F15E 23          		 INC HL	;
323)   F15F 56          		 LD D,(HL) ;DE=value of ptr	;DE=value of ptr
324)   F160 E3          		 EX (SP),HL ;HL=lower bound	;HL=lower bound
325)   F161 CD 3F F1    		 CALL CHKUBD	;
326)   F164 38 04       		 JR C UPDPT1	;
327)   F166 EB          		 EX DE,HL	;
328)   F167 ED 42       		 SBC HL,BC	;
329)   F169 EB          		 EX DE,HL	;
330)   F16A E3          		UPDPT1: EX (SP),HL	;
331)   F16B 72          		 LD (HL),D	;
332)   F16C 2B          		 DEC HL	;
333)   F16D 73          		 LD (HL),E	;
334)   F16E 23          		 INC HL	;
335)   F16F 23          		 INC HL	;
336)   F170 D1          		 POP DE	;
337)   F171 C9          		 RET	;
343)   F172 E5          		 PUSH HL	;
344)   F173 D5          		 PUSH DE	;
345)   F174 57          		 LD D,A	;
346)   F175 CD C2 F1    		 CALL FSTRM	;
347)   F178 3E 69       		 LD A,NOSTRM	;
348)   F17A 38 1D       		 JR C IOCEND ;if stream not found	;if stream not found
349)   F17C D5          		 PUSH DE ;byte to stack	;byte to stack
350)   F17D 23          		 INC HL	;
351)   F17E 46          		 LD B,(HL) ;driver#	;driver#
352)   F17F 23          		 INC HL	;
353)   F180 56          		 LD D,(HL) ;port#	;port#
354)   F181 23          		 INC HL	;
355)   F182 23          		 INC HL	;
356)   F183 7E          		 LD A,(HL)	;
357)   F184 23          		 INC HL	;
358)   F185 66          		 LD H,(HL)	;
359)   F186 6F          		 LD L,A ;own RAM addr to HL	;own RAM addr to HL
360)   F187 F1          		 POP AF	;
361)   F188 E5          		 PUSH HL ;thence to stack	;thence to stack
362)   F189 F5          		 PUSH AF ;with byte on top	;with byte on top
363)   F18A CD 9C F1    		 CALL FDE	;
364)   F18D C1          		 POP BC ;byte	;byte
365)   F18E E3          		 EX (SP),HL ;own RAM addr to HL	;own RAM addr to HL
366)   F18F DD E3       		 EX (SP),IX ;driver entry addr to IX	;driver entry addr to IX
367)   F191 38 04       		 JR C IOCE1 ;if driver not found	;if driver not found
368)   F193 78          		 LD A,B ;byte on entry	;byte on entry
369)   F194 CD 3C F2    		 CALL CALLIX ;enter driver	;enter driver
370)   F197 DD E1       		IOCE1: POP IX	;
371)   F199 D1          		IOCEND: POP DE	;
372)   F19A E1          		 POP HL	;
373)   F19B C9          		 RET	;
388)   F19C 2A 58 00    		 LD HL,(DEVTAB)	;
389)   F19F 78          		 LD A,B ;A&B=driver#	;A&B=driver#
390)   F1A0 BE          		 CP (HL) ;driver#>#drivers?	;driver#>#drivers?
391)   F1A1 3E 6A       		 LD A,NODEV	;
392)   F1A3 3F          		 CCF	;
393)   F1A4 D8          		 RET C ;if too large	;if too large
394)   F1A5 23          		 INC HL ;HL->zero'th driver addr	;HL->zero'th driver addr
395)   F1A6 79          		 LD A,C ;request code to A	;request code to A
396)   F1A7 48          		 LD C,B ;driver# to C	;driver# to C
397)   F1A8 06 00       		 LD B,0	;
398)   F1AA 09          		 ADD HL,BC	;
399)   F1AB 09          		 ADD HL,BC ;HL->req'd driver addr	;HL->req'd driver addr
400)   F1AC 4E          		 LD C,(HL)	;
401)   F1AD 23          		 INC HL	;
402)   F1AE 66          		 LD H,(HL)	;
403)   F1AF 69          		 LD L,C ;HL=driver addr	;HL=driver addr
404)   F1B0 4F          		 LD C,A ;C=req. code	;C=req. code
405)   F1B1 7E          		 LD A,(HL) ;A= max. req. permitted	;A= max. req. permitted
406)   F1B2 91          		 SUB C	;
407)   F1B3 38 09       		 JR C GOTREQERR ;since req.>max req.	;since req.>max req.
408)   F1B5 23          		 INC HL ;pt. at displ. for req. 0	;pt. at displ. for req. 0
409)   F1B6 09          		 ADD HL,BC ;add in request code	;add in request code
410)   F1B7 AF          		 XOR A	;
411)   F1B8 B6          		 OR (HL)	;
412)   F1B9 28 03       		 JR Z GOTREQERR ;since invalid req.	;since invalid req.
413)   F1BB 4E          		 LD C,(HL)	;
414)   F1BC 09          		 ADD HL,BC ;add in disp to req rtn	;add in disp to req rtn
415)   F1BD C9          		 RET	;
418)   F1BE 37          		 SCF	;
419)   F1BF 3E 6D       		 LD A REQERR	;
420)   F1C1 C9          		 RET	;
441)   F1C2 C5          		FSTRM: PUSH BC	;
442)   F1C3 F5          		 PUSH AF	;
443)   F1C4 D5          		 PUSH DE	;
444)   F1C5 7B          		 LD A,E ;stream#	;stream#
445)   F1C6 2A 56 00    		 LD HL,(STRTAB) ;HL->zero'th entry	;HL->zero'th entry
446)   F1C9 ED 5B 64 00 		 LD DE,(STRTOP) ;DE->past last entry	;DE->past last entry
447)   F1CD 01 06 00    		 LD BC,6 ;entry length	;entry length
448)   F1D0 E5          		FSTLP: PUSH HL	;
449)   F1D1 B7          		 OR A	;
450)   F1D2 ED 52       		 SBC HL,DE	;
451)   F1D4 E1          		 POP HL	;
452)   F1D5 37          		 SCF ;flag entry not found	;flag entry not found
453)   F1D6 28 2C       		 JR Z FSDE ;if no entry found	;if no entry found
454)   F1D8 BE          		 CP (HL)	;
455)   F1D9 28 29       		 JR Z FSDE ;if match found	;if match found
456)   F1DB 09          		 ADD HL,BC ;go on to next entry	;go on to next entry
457)   F1DC 18 F2       		 JR FSTLP	;
459)   F1DE C5          		FDEV: PUSH BC	;
460)   F1DF F5          		 PUSH AF	;
461)   F1E0 D5          		 PUSH DE ;port# on TOS	;port# on TOS
462)   F1E1 2A 56 00    		 LD HL,(STRTAB) ;HL->zero'th entry	;HL->zero'th entry
463)   F1E4 ED 5B 64 00 		 LD DE,(STRTOP) ;DE->past last entry	;DE->past last entry
464)   F1E8 01 06 00    		 LD BC,6 ;entry length	;entry length
465)   F1EB E5          		FDVLP: PUSH HL	;
466)   F1EC B7          		 OR A	;
467)   F1ED ED 52       		 SBC HL,DE	;
468)   F1EF E1          		 POP HL	;
469)   F1F0 37          		 SCF ;flag entry not found	;flag entry not found
470)   F1F1 28 11       		 JR Z FSDE ;if no entry found	;if no entry found
471)   F1F3 23          		 INC HL ;HL->driver#	;HL->driver#
472)   F1F4 BE          		 CP (HL)	;
473)   F1F5 20 07       		 JR NZ FDVL1 ;if driver# doesn't match	;if driver# doesn't match
474)   F1F7 23          		 INC HL	;
475)   F1F8 7E          		 LD A,(HL) ;port# from entry	;port# from entry
476)   F1F9 E3          		 EX (SP),HL	;
477)   F1FA BC          		 CP H ;port# to match	;port# to match
478)   F1FB E3          		 EX (SP),HL	;
479)   F1FC 2B          		 DEC HL ;HL->driver#	;HL->driver#
480)   F1FD 7E          		 LD A,(HL) ;retore to A (it matched)	;retore to A (it matched)
481)   F1FE 2B          		FDVL1: DEC HL ;so HL-> start of entry	;so HL-> start of entry
482)   F1FF 28 03       		 JR Z FSDE ;if both matched	;if both matched
483)   F201 09          		 ADD HL,BC ;go on to next entry	;go on to next entry
484)   F202 18 E7       		 JR FDVLP	;
486)   F204 D1          		FSDE: POP DE	;
487)   F205 C1          		 POP BC ;restore A without 	;restore A without
488)   F206 78          		 LD A,B ;hurting F	;hurting F
489)   F207 C1          		 POP BC	;
490)   F208 C9          		 RET	;
510)   F209 CD 09 E1    		MKBUFF: CALL SPACE ;check user prog.	;check user prog.
511)   F20C D8          		 RET C ;for availaable space	;for availaable space
512)   F20D D5          		 PUSH DE	;
513)   F20E C5          		 PUSH BC	;
514)   F20F CD C2 F1    		 CALL FSTRM ;point HL at part	;point HL at part
515)   F212 23          		 INC HL ;of stream tab entry	;of stream tab entry
516)   F213 23          		 INC HL ;for own RAM addr	;for own RAM addr
517)   F214 23          		 INC HL	;
518)   F215 23          		 INC HL	;
519)   F216 ED 5B 56 00 		 LD DE,(STRTAB) ;DE will be own RAM addr	;DE will be own RAM addr
520)   F21A 73          		 LD (HL),E	;
521)   F21B 23          		 INC HL	;
522)   F21C 72          		 LD (HL),D	;
523)   F21D D5          		 PUSH DE	;
524)   F21E 60          		 LD H,B	;
525)   F21F 69          		 LD L,C ;now HL = #bytes req'd	;now HL = #bytes req'd
526)   F220 19          		 ADD HL,DE ;HL=addr for strtab	;HL=addr for strtab
527)   F221 22 56 00    		 LD (STRTAB),HL ;moved out to make space	;moved out to make space
528)   F224 2A 64 00    		 LD HL,(STRTOP) ;for own RAM	;for own RAM
529)   F227 E5          		 PUSH HL ;so TOS = source for shift	;so TOS = source for shift
530)   F228 B7          		 OR A ;of strtab + 1	;of strtab + 1
531)   F229 ED 52       		 SBC HL,DE ;HL=#bytes to shift	;HL=#bytes to shift
532)   F22B E3          		 EX (SP),HL ;TOS= "   "     "	;TOS= "   "     "
533)   F22C E5          		 PUSH HL ;source addr+1	;source addr+1
534)   F22D 09          		 ADD HL,BC ;destn addr+1	;destn addr+1
535)   F22E 22 64 00    		 LD (STRTOP),HL	;
536)   F231 EB          		 EX DE,HL	;
537)   F232 1B          		 DEC DE	;
538)   F233 E1          		 POP HL	;
539)   F234 2B          		 DEC HL	;
540)   F235 C1          		 POP BC	;
541)   F236 ED B8       		 LDDR	;
542)   F238 E1          		 POP HL	;
543)   F239 C1          		 POP BC ;CY cleared by	;CY cleared by
544)   F23A D1          		 POP DE ;ADD HL,BC above	;ADD HL,BC above
545)   F23B C9          		 RET	;
549)   F23C DD E9       		CALLIX: JP (IX)	;
 27)   F23E 21 15 01    		 LD HL,XREG+5	;
 28)   F241 06 10       		 LD B,16	;
 29)   F243 AF          		 XOR A	;
 30)   F244 77          		SQCLR LD (HL),A	;
 31)   F245 2D          		 DEC L	;
 32)   F246 10 FC       		 DJNZ SQCLR	;
 34)   F248 6C          		 LD L,H ;MSB mantissa of FACC	;MSB mantissa of FACC
 35)   F249 BE          		 CP (HL)	;
 36)   F24A CA CC F5    		 JP Z STOZ	;
 41)   F24D 2D          		 DEC L	;
 42)   F24E CB 2E       		 SRA (HL)	;
 43)   F250 D8          		 RET C ;if invalid argument	;if invalid argument
 49)   F251 54          		 LD D,H ;so DE points into FPAREA	;so DE points into FPAREA
 50)   F252 5F          		 LD E,A ;so E = 0	;so E = 0
 51)   F253 7E          		 LD A,(HL)	;
 52)   F254 C3 E2 FC    		 JP SQRT2	;
 58)   F257 CD AF F8    		INP1: CALL INP100	;
 59)   F25A 21 64 F2    		 LD HL,INP1A	;
 60)   F25D E5          		 PUSH HL ;to become a return address	;to become a return address
 61)   F25E D8          		 RET C ;if error exit from INP100	;if error exit from INP100
 62)   F25F 14          		 INC D	;
 63)   F260 C8          		 RET Z ;if legal exit	;if legal exit
 64)   F261 C3 D7 F8    		 JP INP1B ;if illegal exit	;if illegal exit
 66)   F264 ED 5B 35 01 		INP1A LD DE (INPTR)	;
 67)   F268 1B          		 DEC DE	;
 68)   F269 C9          		 RET	;
 70)   F26A 7E          		BICML LD A,(HL) ;returns Z set if positive	;returns Z set if positive
 71)   F26B E6 01       		 AND 01H	;
 72)   F26D F5          		 PUSH AF ;sign in 0 bit	;sign in 0 bit
 73)   F26E 7E          		 LD A,(HL)	;
 74)   F26F E6 FE       		 AND 0FEH	;
 75)   F271 C6 02       		 ADD A,2	;
 76)   F273 FE 00       		 CP 0	;
 77)   F275 38 28       		 JR C BICZ	;
 78)   F277 FE 07       		 CP 7	;
 79)   F279 30 21       		 JR NC BICOF ;overflow	;overflow
 80)   F27B F5          		 PUSH AF	;
 81)   F27C 11 07 01    		 LD DE,T1	;
 82)   F27F AF          		 XOR A	;
 83)   F280 12          		 LD (DE),A	;
 84)   F281 13          		 INC DE	;
 85)   F282 12          		 LD (DE),A	;
 86)   F283 13          		 INC DE	;
 87)   F284 12          		 LD (DE),A	;
 88)   F285 13          		 INC DE	;
 89)   F286 01 04 00    		 LD BC,4 ;only need 4 bytes of mantissa	;only need 4 bytes of mantissa
 90)   F289 23          		 INC HL	;
 91)   F28A ED B0       		 LDIR ;so now B = 0	;so now B = 0
 92)   F28C 1E 07       		 LD E,T1 ;so DE = T1	;so DE = T1
 93)   F28E F1          		 POP AF ;A = (exponent byte) + 2	;A = (exponent byte) + 2
 94)   F28F 0F          		 RRCA ;A = exponent + 1	;A = exponent + 1
 95)   F290 4F          		 LD C,A	;
 96)   F291 EB          		 EX DE,HL	;
 97)   F292 09          		 ADD HL,BC ;now HL = T1 + 1 + exponent	;now HL = T1 + 1 + exponent
 98)   F293 56          		 LD D,(HL)	;
 99)   F294 23          		 INC HL	;
100)   F295 5E          		 LD E,(HL)	;
101)   F296 23          		 INC HL	;
102)   F297 46          		 LD B,(HL)	;
103)   F298 23          		 INC HL	;
104)   F299 4E          		 LD C,(HL)	;
105)   F29A 18 08       		 JR BICEXIT	;
107)   F29C AF          		BICOF XOR A	;
108)   F29D 37          		 SCF	;
109)   F29E 1E          		 DEFB 1EH ; LD E,.. ie skip one byte	; LD E,.. ie skip one byte
111)   F29F AF          		BICZ XOR A ;clears CY	;clears CY
112)   F2A0 5F          		 LD E,A	;
113)   F2A1 57          		 LD D,A	;
114)   F2A2 4F          		 LD C,A	;
115)   F2A3 47          		 LD B,A	;
116)   F2A4 E1          		BICEXIT POP HL ;AF was pushed	;AF was pushed
117)   F2A5 CB 44       		 BIT 0,H ;so Z set iff positive	;so Z set iff positive
118)   F2A7 C9          		 RET	;
 50)   F2A8 23          		LORDEP: INC HL	;
 51)   F2A9 77          		 LD (HL),A ;zero	;zero
 52)   F2AA 23          		 INC HL	;
 53)   F2AB 72          		 LD (HL) D ;ORIGDEP	;ORIGDEP
 54)   F2AC 23          		 INC HL	;
 55)   F2AD C9          		 RET	;
 65)   F2AE 3E 02       		 LD A,2 ;input	;input
 66)   F2B0 18 02       		 JR BLKIO	;
 76)   F2B2 3E 03       		 LD A,3 ;output	;output
 77)   F2B4 DD E5       		BLKIO PUSH IX	;
 78)   F2B6 D5          		 PUSH DE	;
 79)   F2B7 E5          		 PUSH HL	;
 80)   F2B8 C5          		 PUSH BC	;
 81)   F2B9 4F          		 LD C,A	;
 82)   F2BA 08          		 EX AF,AF'	;
 83)   F2BB CD C2 F1    		 CALL FSTRM	;
 84)   F2BE 3E 69       		 LD A,NOSTRM	;
 85)   F2C0 38 51       		 JR C BLER4	;
 86)   F2C2 23          		 INC HL	;
 87)   F2C3 46          		 LD B,(HL) ;driver no	;driver no
 88)   F2C4 23          		 INC HL	;
 89)   F2C5 56          		 LD D,(HL) ;port number	;port number
 90)   F2C6 23          		 INC HL	;
 91)   F2C7 23          		 INC HL	;
 92)   F2C8 7E          		 LD A,(HL)	;
 93)   F2C9 23          		 INC HL	;
 94)   F2CA 66          		 LD H,(HL)	;
 95)   F2CB 6F          		 LD L,A ;own RAM address to HL	;own RAM address to HL
 96)   F2CC E5          		 PUSH HL ;thence to stack	;thence to stack
 97)   F2CD CD 9C F1    		 CALL FDE	;
 98)   F2D0 E3          		 EX (SP),HL ;so HL = own RAM again	;so HL = own RAM again
 99)   F2D1 DD E1       		 POP IX ;so IX = driver routine address	;so IX = driver routine address
100)   F2D3 38 3E       		 JR C BLER4	;
101)   F2D5 08          		 EX AF,AF' ;so A = input/output flag	;so A = input/output flag
102)   F2D6 C1          		 POP BC ;byte counter	;byte counter
103)   F2D7 EB          		 EX DE,HL ;DE = RAM, H = port	;DE = RAM, H = port
104)   F2D8 E3          		 EX (SP),HL ;TOS = port & strm, HL=byte pointer	;TOS = port & strm, HL=byte pointer
105)   F2D9 FE 03       		 CP 3	;
106)   F2DB 28 23       		 JR Z BOUT	;
109)   F2DD 78          		 LD A,B	;
110)   F2DE B1          		 OR C	;
111)   F2DF 28 33       		 JR Z BLEND	;
112)   F2E1 E3          		 EX (SP),HL ;TOS=byte pointer,H=port	;TOS=byte pointer,H=port
113)   F2E2 C5          		 PUSH BC ;byte counter	;byte counter
114)   F2E3 DD E5       		 PUSH IX ;entry address	;entry address
115)   F2E5 D5          		 PUSH DE ;RAM pointer	;RAM pointer
116)   F2E6 EB          		 EX DE,HL ;so HL = RAM, D = port	;so HL = RAM, D = port
117)   F2E7 D5          		 PUSH DE	;
118)   F2E8 CD 3C F2    		 CALL CALLIX	;
119)   F2EB E1          		 POP HL	;
120)   F2EC D1          		 POP DE	;
121)   F2ED DD E1       		 POP IX	;
122)   F2EF C1          		 POP BC	;
123)   F2F0 E3          		 EX (SP),HL	;
124)   F2F1 38 21       		 JR C BLEND	;
125)   F2F3 77          		 LD (HL),A	;
126)   F2F4 23          		 INC HL	;
127)   F2F5 0B          		 DEC BC	;
128)   F2F6 18 E5       		 JR BILOOP	;
131)   F2F8 E1          		 POP HL	;
132)   F2F9 D1          		 POP DE	;
133)   F2FA DD E1       		 POP IX	;
134)   F2FC C1          		 POP BC	;
135)   F2FD E3          		 EX (SP),HL	;
136)   F2FE 38 14       		 JR C BLEND	;
137)   F300 79          		BOUT LD A,C	;
138)   F301 B0          		 OR B	;
139)   F302 28 10       		 JR Z BLEND	;
140)   F304 7E          		 LD A,(HL) ;byte to output	;byte to output
141)   F305 23          		 INC HL	;
142)   F306 0B          		 DEC BC	;
143)   F307 E3          		 EX (SP),HL ;TOS=byte pointer,H=port	;TOS=byte pointer,H=port
144)   F308 C5          		 PUSH BC ;byte counter	;byte counter
145)   F309 DD E5       		 PUSH IX ;entry address	;entry address
146)   F30B D5          		 PUSH DE ;RAM pointer	;RAM pointer
147)   F30C EB          		 EX DE,HL ;so HL = RAM, D = port	;so HL = RAM, D = port
148)   F30D D5          		 PUSH DE	;
149)   F30E CD 3C F2    		 CALL CALLIX	;
150)   F311 18 E5       		 JR BOLOOP	;
153)   F313 C1          		BLER4 POP BC	;
154)   F314 D1          		BLEND POP DE	;
155)   F315 D1          		 POP DE	;
156)   F316 DD E1       		 POP IX	;
157)   F318 C9          		 RET	;
170)   F319 E1          		 POP HL ;get immediate return addr	;get immediate return addr
171)   F31A E3          		 EX (SP),HL ;stack that and get s'rtn ret addr	;stack that and get s'rtn ret addr
172)   F31B 5E          		 LD E,(HL) ;so E = n	;so E = n
173)   F31C 23          		 INC HL	;
174)   F31D E3          		 EX (SP),HL ;put back correct ret addr	;put back correct ret addr
175)   F31E DD E5       		 PUSH IX	;
176)   F320 E3          		 EX (SP),HL ;put current ret addr, HL=IX	;put current ret addr, HL=IX
177)   F321 16 00       		 LD D,0	;
178)   F323 19          		 ADD HL,DE ;so HL = IX+n	;so HL = IX+n
179)   F324 C9          		 RET	;
181)   F325 00          		 NOP ;match addresses in well-tested	;match addresses in well-tested
182)   F326 00          		 NOP ;ROMs as closely as possible	;ROMs as closely as possible
198)   F327 E1          		 POP HL ;This routines ret addr	;This routines ret addr
199)   F328 E3          		 EX (SP),HL ;orig ret addr	;orig ret addr
200)   F329 4E          		 LD C,(HL) ; C = m	; C = m
201)   F32A 23          		 INC HL	;
202)   F32B 5E          		 LD E,(HL) ; E = n	; E = n
203)   F32C 23          		 INC HL	;
204)   F32D E3          		 EX (SP),HL ;stack has orig ret addr	;stack has orig ret addr
205)   F32E DD E5       		 PUSH IX ;TOS=IX,HL=this ret addr	;TOS=IX,HL=this ret addr
206)   F330 E3          		 EX (SP),HL ;So this rtn ret addr on stack	;So this rtn ret addr on stack
207)   F331 16 00       		 LD D 0 ;so DE = n	;so DE = n
208)   F333 42          		 LD B D ; so BC = m	; so BC = m
209)   F334 EB          		 EX DE,HL ; HL = n, DE = IX	; HL = n, DE = IX
210)   F335 19          		 ADD HL,DE ; HL = IX + n	; HL = IX + n
211)   F336 EB          		 EX DE,HL ; HL = IX, DE = IX + n	; HL = IX, DE = IX + n
212)   F337 09          		 ADD HL,BC ; HL = IX + m	; HL = IX + m
213)   F338 C9          		 RET	;
218)   F339 CD 19 F3    		 CALL GETP	;
219)   F33C 5E          		 LD E,(HL)	;
220)   F33D 23          		 INC HL	;
221)   F33E 56          		 LD D,(HL)	;
222)   F33F C9          		 RET	;
227)   F340 42          		 LD B,D	;
228)   F341 4B          		 LD C,E	;
229)   F342 CD 19 F3    		 CALL GETP	;
230)   F345 71          		 LD (HL),C	;
231)   F346 23          		 INC HL	;
232)   F347 70          		 LD (HL),B	;
233)   F348 C9          		 RET	;
239)   F349 CD 27 F3    		 CALL GETPARS ;so HL=IX+m, DE=IX+n	;so HL=IX+m, DE=IX+n
240)   F34C 0E 06       		 LD C,6	;
241)   F34E 18 05       		 JR TBM1	;
245)   F350 CD 27 F3    		 CALL GETPARS	;
246)   F353 0E 02       		 LD C 2	;
247)   F355 EB          		TBM1 EX DE,HL	;
248)   F356 ED B0       		 LDIR	;
249)   F358 C9          		 RET	;
254)   F359 CD 27 F3    		 CALL GETPARS ;so HL=IX+m, DE=IX+n	;so HL=IX+m, DE=IX+n
255)   F35C 01 64 0C    		 LD BC,12.SHL.8+100 ;a trick	;a trick
256)   F35F 1A          		SWAPLP LD A (DE)	;
257)   F360 ED A0       		 LDI ;copy from (HL) to (DE)	;copy from (HL) to (DE)
258)   F362 2B          		 DEC HL	;
259)   F363 77          		 LD (HL),A ;copy from (DE) to (HL)	;copy from (DE) to (HL)
260)   F364 23          		 INC HL	;
261)   F365 10 F8       		 DJNZ SWAPLP	;
262)   F367 C9          		 RET	;
270)   F368 CD 27 F3    		 CALL GETPARS ;so HL=IX+m, DE=IX+n	;so HL=IX+m, DE=IX+n
271)   F36B E7 26       		 DEFW ZCOMP ;set flags for (DE)-(HL)	;set flags for (DE)-(HL)
272)   F36D C9          		 RET	;
280)   F36E CD 19 F3    		 CALL GETP ;so HL =IX+n	;so HL =IX+n
281)   F371 E5          		 PUSH HL	;
282)   F372 E7 05       		 DEFW ZFPZERO ;so HL --> 0	;so HL --> 0
283)   F374 D1          		 POP DE ;So DE --> number	;So DE --> number
284)   F375 E7 26       		 DEFW ZCOMP	;
285)   F377 C9          		 RET	;
292)   F378 E7 03       		 DEFW ZFPONE	;
293)   F37A CD 19 F3    		FPADD: CALL GETP	;
294)   F37D EB          		 EX DE,HL	;
295)   F37E E7 16       		 DEFW ZADD	;
296)   F380 C9          		 RET	;
302)   F381 CD 27 F3    		 CALL GETPARS ;so HL points to first,	;so HL points to first,
304)   F384 E5          		 PUSH HL	;
305)   F385 D5          		 PUSH DE	;
306)   F386 E7 2B       		 DEFW ZLDF ;from (IX+m) into FACC	;from (IX+m) into FACC
307)   F388 D1          		 POP DE	;
308)   F389 E7 16       		 DEFW ZADD ;add contents of (IX+n)	;add contents of (IX+n)
309)   F38B E1          		 POP HL	;
310)   F38C E7 2D       		 DEFW ZSTF ;store in (IX+m)	;store in (IX+m)
311)   F38E C9          		 RET	;
313)   F38F CD 19 F3    		FPDIV: CALL GETP	;
314)   F392 EB          		 EX DE,HL	;
315)   F393 E7 19       		 DEFW ZDIV	;
316)   F395 C9          		 RET	;
321)   F396 CD 27 F3    		 CALL GETPARS	;
322)   F399 E5          		 PUSH HL	;
323)   F39A EB          		 EX DE,HL	;
324)   F39B E7 27       		 DEFW ZFIX	;
325)   F39D E1          		 POP HL	;
326)   F39E 73          		 LD (HL),E	;
327)   F39F 23          		 INC HL	;
328)   F3A0 72          		 LD (HL),D	;
329)   F3A1 C9          		 RET	;
331)   F3A2 CD 19 F3    		FPLD: CALL GETP	;
332)   F3A5 E7 2B       		 DEFW ZLDF	;
333)   F3A7 C9          		 RET	;
335)   F3A8 CD 19 F3    		FPMUL: CALL GETP	;
336)   F3AB EB          		 EX DE,HL	;
337)   F3AC E7 18       		 DEFW ZMULT	;
338)   F3AE C9          		 RET	;
 20)   F3AF 21 6B 00    		 LD HL FICLKL	;
 21)   F3B2 7E          		 LD A (HL)	;
 22)   F3B3 BE          		ZC1 CP (HL)	;
 23)   F3B4 28 FD       		 JR Z ZC1	;
 24)   F3B6 AF          		 XOR A	;
 25)   F3B7 F3          		 DI	;
 26)   F3B8 77          		 LD (HL) A	;
 27)   F3B9 2B          		 DEC HL	;
 28)   F3BA 77          		 LD (HL) A	;
 29)   F3BB 2B          		 DEC HL	;
 30)   F3BC 77          		 LD (HL) A	;
 31)   F3BD FB          		 EI	;
 32)   F3BE C9          		 RET	;
 40)   F3BF 7E          		 LD A (HL)	;
 41)   F3C0 2B          		 DEC HL	;
 42)   F3C1 6E          		 LD L (HL)	;
 43)   F3C2 67          		 LD H A	;
 44)   F3C3 E5          		 PUSH HL	;
 45)   F3C4 21 68 00    		 LD HL FICLKE ;PSEUDO EXPONENT BELOW 3 CLOCK BYTES	;PSEUDO EXPONENT BELOW 3 CLOCK BYTES
 46)   F3C7 F3          		 DI	;
 47)   F3C8 CD 09 F6    		 CALL LDF	;
 48)   F3CB FB          		 EI	;
 49)   F3CC 62          		 LD H D	;
 50)   F3CD CD 8E F5    		 CALL STO	;
 51)   F3D0 3E 06       		 LD A 6	;
 52)   F3D2 77          		 LD (HL) A	;
 53)   F3D3 AF          		 XOR A	;
 54)   F3D4 23          		 INC HL	;
 55)   F3D5 23          		 INC HL	;
 56)   F3D6 23          		 INC HL	;
 57)   F3D7 23          		 INC HL	;
 58)   F3D8 77          		 LD (HL) A	;
 59)   F3D9 23          		 INC HL	;
 60)   F3DA 77          		 LD (HL) A	;
 61)   F3DB CD A0 F5    		 CALL NORM	;
 62)   F3DE E1          		 POP HL	;
 63)   F3DF C3 17 F6    		 JP STF	;
  4)   FFFFFFFE 00 00 00    		 DS 0F45BH-76H-$ ;ADD ZEROES UNTIL 0F45BH-76H	;ADD ZEROES UNTIL 0F45BH-76H
 31)   F3E5 2F FE       		 DEFW RND	;
 38)   F3E7 88 F5       		 DEFW PI	;
 45)   F3E9 DC FB       		 DEFW STPOS	;
 52)   F3EB 96 F5       		 DEFW FPONE	;
 59)   F3ED FE F5       		 DEFW FPMONE	;
 66)   F3EF CC F5       		 DEFW FPZERO	;
 76)   F3F1 8E F5       		 DEFW NOP	;
 83)   F3F3 01 F6       		 DEFW NEG	;
 90)   F3F5 EF F4       		 DEFW NOT	;
 97)   F3F7 86 FB       		 DEFW ABS	;
104)   F3F9 4D FD       		 DEFW ATAN	;
111)   F3FB 40 FC       		 DEFW COS	;
118)   F3FD 8A FC       		 DEFW EXP	;
125)   F3FF 56 FB       		 DEFW INT	;
132)   F401 75 FD       		 DEFW LOG	;
139)   F403 8D FB       		 DEFW SIGN	;
146)   F405 43 FC       		 DEFW SIN	;
153)   F407 3E F2       		 DEFW SQRT	;
160)   F409 D7 FE       		 DEFW TAN	;
167)   F40B B9 FE       		 DEFW ASIN	;
174)   F40D BF FE       		 DEFW ACOS	;
181)   F40F D2 FB       		 DEFW PEEK	;
191)   F411 5C F6       		 DEFW ADD	;
198)   F413 61 F6       		 DEFW SUB	;
205)   F415 14 F7       		 DEFW MULT	;
212)   F417 25 F8       		 DEFW DIV	;
219)   F419 E9 FD       		 DEFW RAISE	;
226)   F41B F6 F4       		 DEFW AND	;
233)   F41D EB F4       		 DEFW OR	;
240)   F41F EA F5       		 DEFW NUMEQ	;
247)   F421 DB F5       		 DEFW NUMGT	;
254)   F423 E1 F5       		 DEFW NUMLT	;
261)   F425 E7 F5       		 DEFW NUMNE	;
268)   F427 E4 F5       		 DEFW NUMLE	;
275)   F429 DE F5       		 DEFW NUMGE	;
285)   F42B 71 F4       		 DEFW MATHS	;
292)   F42D 60 F4       		 DEFW INITRAND	;
299)   F42F 5B F4       		 DEFW RANDOM	;
306)   F431 AD F4       		 DEFW COMP	;
313)   F433 A6 FB       		 DEFW FIX	;
320)   F435 E2 FB       		 DEFW FLT	;
327)   F437 BA FB       		 DEFW RUND	;
334)   F439 9C F8       		 DEFW INP	;
341)   F43B 09 F6       		 DEFW LDF	;
348)   F43D 86 F9       		 DEFW OUT	;
355)   F43F 17 F6       		 DEFW STF	;
362)   F441 F5 F5       		 DEFW RELBOO	;
372)   F443 6E E3       		 DEFW TTCAPS	;
379)   F445 91 F0       		 DEFW OUTPUT	;
386)   F447 8C F0       		 DEFW INPUT	;
393)   F449 2A F0       		 DEFW OPENIN	;
400)   F44B 2D F0       		 DEFW OPNOUT	;
407)   F44D 99 F0       		 DEFW CLOSE	;
414)   F44F 2D E3       		 DEFW STKTST	;
421)   F451 1B E3       		 DEFW BRKTST	;
428)   F453 09 F2       		 DEFW MKBUFF	;
435)   F455 4C E1       		 DEFW GETKEY	;
442)   F457 8C E1       		 DEFW IMMKEY	;
449)   F459 44 B7       		 DEFW KLOOK	;
136)   F45B 21 52 00    		RANDOM: LD HL,CLOCK	;
137)   F45E 18 03       		 JR RAND1	;
140)   F460 21 6D F4    		 LD HL,RNDTAB	;
141)   F463 11 37 01    		RAND1: LD DE,RANDNO	;
142)   F466 01 04 00    		 LD BC,4	;
143)   F469 ED B0       		 LDIR	;
144)   F46B B7          		 OR A	;
145)   F46C C9          		 RET	;
147)   F46D ED ED ED ED 		RNDTAB: DEFB 0EDH,0EDH,0EDH,0EDH	;
149)   F471 CB 7F       		MATHS: BIT 7,A	;
150)   F473 20 0E       		 JR NZ MATH1	;
151)   F475 CB 77       		 BIT 6,A	;
152)   F477 20 11       		 JR NZ MATH2	;
153)   F479 01 FA FF    		 LD BC,-6	;
154)   F47C 09          		 ADD HL,BC	;
155)   F47D E5          		 PUSH HL	;
156)   F47E 01 E5 F3    		 LD BC,AR0TAB	;
157)   F481 18 18       		 JR MATH22	;
159)   F483 01 F1 F3    		MATH1: LD BC,AR1TAB	;
160)   F486 CB BF       		 RES 7,A	;
161)   F488 18 0B       		 JR MATH21	;
163)   F48A 54          		MATH2: LD D,H	;
164)   F48B 5D          		 LD E,L	;
165)   F48C 01 06 00    		 LD BC,6	;
166)   F48F 09          		 ADD HL,BC	;
167)   F490 01 11 F4    		 LD BC,AR2TAB	;
168)   F493 CB B7       		 RES 6,A	;
169)   F495 E5          		MATH21: PUSH HL	;
170)   F496 D5          		 PUSH DE	;
171)   F497 CD 09 F6    		 CALL LDF	;
172)   F49A D1          		 POP DE	;
173)   F49B 26 00       		MATH22: LD H,0	;
174)   F49D 6F          		 LD L,A	;
175)   F49E 09          		 ADD HL,BC	;
176)   F49F 7E          		 LD A,(HL)	;
177)   F4A0 23          		 INC HL	;
178)   F4A1 66          		 LD H,(HL)	;
179)   F4A2 6F          		 LD L,A	;
180)   F4A3 CD 94 E0    		 CALL CALLHL	;
181)   F4A6 E1          		 POP HL	;
182)   F4A7 3E 02       		 LD A,2	;
183)   F4A9 D4 17 F6    		 CALL NC STF	;
184)   F4AC C9          		 RET	;
195)   F4AD 23          		 INC HL ;(H,L)=0 ?	;(H,L)=0 ?
196)   F4AE 7E          		 LD A,(HL)	;
197)   F4AF 2B          		 DEC HL	;
198)   F4B0 B7          		 OR A	;
199)   F4B1 13          		 INC DE	;
200)   F4B2 1A          		 LD A,(DE)	;
201)   F4B3 1B          		 DEC DE	;
202)   F4B4 28 0A       		 JR Z,CM1 ;YES	;YES
203)   F4B6 B7          		 OR A ;NO - (D,E)=0 ?	;NO - (D,E)=0 ?
204)   F4B7 20 0E       		 JR NZ,COMP1 ;NO	;NO
205)   F4B9 AF          		 XOR A ;AS (D,E)=0	;AS (D,E)=0
206)   F4BA CB 46       		CM2: BIT 0,(HL)	;
207)   F4BC C0          		 RET NZ	;
208)   F4BD 3C          		 INC A	;
209)   F4BE 3F          		 CCF	;
210)   F4BF C9          		 RET	;
211)   F4C0 B7          		CM1: OR A ;AS(H,L)=0	;AS(H,L)=0
212)   F4C1 C8          		 RET Z ;AS BOTH=0	;AS BOTH=0
213)   F4C2 EB          		 EX DE,HL	;
214)   F4C3 AF          		 XOR A	;
215)   F4C4 37          		 SCF	;
216)   F4C5 18 F3       		 JR CM2	;
217)   F4C7 CB 46       		COMP1: BIT 0,(HL) ;SAME SIGN ?	;SAME SIGN ?
218)   F4C9 EB          		 EX DE,HL	;
219)   F4CA 28 07       		 JR Z,CM3	;
220)   F4CC AF          		 XOR A	;
221)   F4CD CB 46       		 BIT 0,(HL)	;
222)   F4CF 20 07       		 JR NZ,CM4	;
223)   F4D1 3C          		 INC A	;
224)   F4D2 C9          		 RET	;
225)   F4D3 37          		CM3: SCF	;
226)   F4D4 CB 46       		 BIT 0,(HL)	;
227)   F4D6 C0          		 RET NZ ;NO	;NO
228)   F4D7 EB          		 EX DE,HL	;
229)   F4D8 7E          		CM4: LD A,(HL) ;YES - CHK MAGN OF EXP	;YES - CHK MAGN OF EXP
230)   F4D9 C6 80       		 ADD A 80H	;
231)   F4DB 47          		 LD B A	;
232)   F4DC 1A          		 LD A (DE)	;
233)   F4DD C6 80       		 ADD A 80H	;
234)   F4DF B8          		 CP B	;
235)   F4E0 C0          		 RET NZ	;
236)   F4E1 06 05       		CMAN LD B 05H	;
237)   F4E3 23          		CMANT: INC HL ;CHECK MANT	;CHECK MANT
238)   F4E4 13          		 INC DE	;
239)   F4E5 1A          		 LD A,(DE)	;
240)   F4E6 BE          		 CP (HL)	;
241)   F4E7 C0          		 RET NZ ;AS NEQ	;AS NEQ
242)   F4E8 10 F9       		 DJNZ CMANT	;
243)   F4EA C9          		 RET  ;AS EQ	;AS EQ
248)   F4EB 2E B3       		OR LD L 0B3H	;
249)   F4ED 18 09       		 JR LOGIC	;
250)   F4EF 11 E9 FE    		NOT LD DE CE0	;
251)   F4F2 2E 2F       		 LD L 2FH	;
252)   F4F4 18 02       		 JR LOGIC	;
253)   F4F6 2E A3       		AND LD L 0A3H	;
254)   F4F8 26 C9       		LOGIC LD H 0C9H	;
255)   F4FA 22 35 01    		 LD (CODE) HL	;
256)   F4FD D5          		 PUSH DE	;
257)   F4FE CD 24 F5    		 CALL CFIX	;
258)   F501 E1          		 POP HL	;
259)   F502 D8          		 RET C	;
260)   F503 D5          		 PUSH DE	;
261)   F504 CD 09 F6    		 CALL LDF	;
262)   F507 CD 24 F5    		 CALL CFIX	;
263)   F50A E1          		 POP HL	;
264)   F50B D8          		 RET C	;
265)   F50C 7D          		 LD A L	;
266)   F50D CD 35 01    		 CALL CODE	;
267)   F510 47          		 LD B A	;
268)   F511 7C          		 LD A H	;
269)   F512 5A          		 LD E D	;
270)   F513 CD 35 01    		 CALL CODE	;
271)   F516 58          		 LD E B	;
272)   F517 57          		 LD D A	;
273)   F518 CD 35 F5    		 CALL NEGD	;
274)   F51B CD E2 FB    		 CALL FLT	;
275)   F51E 11 15 01    		 LD DE T5	;
276)   F521 C3 61 F6    		 JP SUB	;
278)   F524 21 01 FF    		CFIX LD HL CHALF	;
279)   F527 CD 1F F6    		 CALL PUSHF	;
280)   F52A 1E 15       		 LD E T5-FH	;
281)   F52C 3E 04       		 LD A 04H	;
282)   F52E 12          		 LD (DE) A	;
283)   F52F CD 5C F6    		 CALL ADD	;
284)   F532 CD A6 FB    		 CALL FIX	;
285)   F535 CB 12       		NEGD RL D	;
286)   F537 3F          		 CCF	;
287)   F538 CB 1A       		 RR D	;
288)   F53A C9          		 RET	;
296)   F53B 56          		CKINT: LD D,(HL) ;D=EXP	;D=EXP
297)   F53C 23          		 INC HL	;
298)   F53D 5E          		 LD E,(HL) ;E=MANT (WD 1)	;E=MANT (WD 1)
299)   F53E 7B          		 LD A,E	;
300)   F53F B7          		 OR A	;
301)   F540 C8          		 RET Z ;YES - =0	;YES - =0
302)   F541 7A          		 LD A,D	;
303)   F542 CB 2F       		 SRA A	;
304)   F544 3D          		 DEC A	;
305)   F545 C0          		 RET NZ ;NO - FRAC  POWER	;NO - FRAC  POWER
306)   F546 06 04       		 LD B,4	;
307)   F548 23          		CKI: INC HL	;
308)   F549 B6          		 OR (HL)	;
309)   F54A 10 FC       		 DJNZ CKI	;
310)   F54C C9          		 RET	;
317)   F54D 06 06       		SHRF1: LD B 06H	;
318)   F54F 2C          		SHRF11: INC L	;
319)   F550 4E          		 LD C (HL)	;
320)   F551 77          		 LD (HL) A	;
321)   F552 79          		 LD A C	;
322)   F553 10 FA       		 DJNZ SHRF11	;
323)   F555 C9          		 RET	;
330)   F556 1E 0D       		FLADD: LD E T1+6-FACC	;
331)   F558 2E 06       		FLA2: LD L FACC+6-FACC	;
332)   F55A 06 06       		 LD B,6	;
333)   F55C AF          		FLA3: XOR A ;UNSET CRY	;UNSET CRY
334)   F55D 1A          		FLA1: LD A,(DE) ;(H,L)=(H,L)+(D,E)	;(H,L)=(H,L)+(D,E)
335)   F55E 8E          		 ADC A,(HL)	;
336)   F55F 77          		 LD (HL),A	;
337)   F560 2D          		 DEC L	;
338)   F561 1D          		 DEC E	;
339)   F562 10 F9       		 DJNZ FLA1 ;DO NXT	;DO NXT
340)   F564 C9          		 RET	;
347)   F565 2E 0D       		FLSUB LD L T1+6-FACC	;
348)   F567 1E 06       		 LD E FACC+6-FACC	;
349)   F569 06 06       		 LD B,6	;
350)   F56B AF          		 XOR A ;UNSET CRY	;UNSET CRY
351)   F56C 1A          		FLS1: LD A,(DE) ;(D,E)=(D,E)-(H,L)	;(D,E)=(D,E)-(H,L)
352)   F56D 9E          		 SBC A,(HL)	;
353)   F56E 12          		 LD (DE),A	;
354)   F56F 2D          		 DEC L	;
355)   F570 1D          		 DEC E	;
356)   F571 10 F9       		 DJNZ FLS1	;
357)   F573 C9          		 RET	;
364)   F574 21 06 01    		LOAD: LD HL,T1-1 ;LAST WD OF FACC=0	;LAST WD OF FACC=0
365)   F577 36 00       		 LD (HL),0	;
366)   F579 23          		 INC HL	;
367)   F57A E5          		 PUSH HL	;
368)   F57B EB          		 EX DE,HL	;
369)   F57C CD 22 F6    		 CALL PP1	;
370)   F57F AF          		 XOR A	;
371)   F580 12          		 LD (DE),A	;
372)   F581 E1          		 POP HL	;
373)   F582 C9          		 RET	;
379)   F583 F1          		TROV1 POP AF	;
380)   F584 F1          		TROV2 POP AF	;
381)   F585 37          		OFLO: SCF	;
382)   F586 18 07       		 JR EXIT	;
383)   F588 21 EF FE    		PI: LD HL,FCPI ;LOAD PI TO FACC	;LOAD PI TO FACC
384)   F58B CD 09 F6    		FSTO: CALL LDF	;
386)   F58E AF          		STO: XOR A	;
387)   F58F 21 00 01    		EXIT: LD HL FACC	;
388)   F592 11 15 01    		 LD DE T5	;
389)   F595 C9          		 RET	;
394)   F596 21 E9 FE    		FPONE LD HL CE0	;
395)   F599 18 F0       		 JR FSTO	;
397)   F59B 21 01 FF    		FLPTHF LD HL CHALF	;
398)   F59E 18 EB       		 JR FSTO	;
405)   F5A0 AF          		NORM XOR A	;
406)   F5A1 2E 01       		 LD L 01H	;
407)   F5A3 B6          		 OR (HL)	;
408)   F5A4 28 0A       		 JR Z NEXIT	;
409)   F5A6 2E 06       		 LD L 06H	;
410)   F5A8 CD D2 F5    		 CALL PROWND	;
411)   F5AB CA DC F6    		 JP Z AS0	;
412)   F5AE 18 DE       		 JR STO	;
413)   F5B0 5D          		NEXIT LD E L	;
414)   F5B1 54          		 LD D H	;
415)   F5B2 01 06 06    		 LD BC 0606H	;
416)   F5B5 B6          		NORM1 OR (HL)	;
417)   F5B6 ED A0       		 LDI	;
418)   F5B8 20 02       		 JR NZ NORM2	;
419)   F5BA 1B          		 DEC DE	;
420)   F5BB 03          		 INC BC	;
421)   F5BC 10 F7       		NORM2 DJNZ NORM1	;
422)   F5BE 28 0C       		 JR Z STOZ	;
423)   F5C0 2D          		 DEC L	;
424)   F5C1 41          		 LD B C	;
425)   F5C2 CD DC F7    		 CALL CLFR1	;
426)   F5C5 6F          		 LD L A	;
427)   F5C6 91          		 SUB C	;
428)   F5C7 91          		 SUB C	;
429)   F5C8 86          		 ADD A (HL)	;
430)   F5C9 E2 CF F5    		 JP PO STONZ	;
432)   F5CC CD D7 F7    		STOZ CALL CLRFC	;
433)   F5CF 77          		STONZ LD (HL) A	;
434)   F5D0 18 BC       		 JR STO	;
438)   F5D2 7E          		PROWND LD A (HL)	;
439)   F5D3 17          		 RLA	;
440)   F5D4 D0          		 RET NC	;
441)   F5D5 2D          		ROWND DEC L	;
442)   F5D6 C8          		 RET Z	;
443)   F5D7 34          		 INC (HL)	;
444)   F5D8 28 FB       		 JR Z ROWND	;
445)   F5DA C9          		 RET	;
449)   F5DB 06 01       		NUMGT: LD B,1	;
450)   F5DD 3A          		 DEFB 3AH ;op-code for LD a,(nn)	;op-code for LD a,(nn)
451)   F5DE 06 05       		NUMGE: LD B,5 ;i.e. skip	;i.e. skip
452)   F5E0 3A          		 DEFB 3AH	;
453)   F5E1 06 02       		NUMLT: LD B,2	;
454)   F5E3 3A          		 DEFB 3AH	;
455)   F5E4 06 06       		NUMLE: LD B,6	;
456)   F5E6 3A          		 DEFB 3AH	;
457)   F5E7 06 03       		NUMNE: LD B,3	;
458)   F5E9 3A          		 DEFB 3AH	;
459)   F5EA 06 04       		NUMEQ: LD B,4	;
464)   F5EC 21 00 01    		 LD HL,FACC	;
465)   F5EF C5          		 PUSH BC	;
466)   F5F0 EB          		 EX DE,HL	;
467)   F5F1 CD AD F4    		 CALL COMP	;
468)   F5F4 C1          		 POP BC	;
470)   F5F5 3E 04       		 LD A,4	;
471)   F5F7 28 02       		 JR Z,LNC3 ; if EQ, A=4	; if EQ, A=4
472)   F5F9 CE FD       		 ADC A,-3 ; A := 1 if GT, 2 if LT	; A := 1 if GT, 2 if LT
473)   F5FB A0          		LNC3: AND B	;
474)   F5FC 28 CE       		 JR Z,FPZERO ;yield FALSE if NOT OK	;yield FALSE if NOT OK
478)   F5FE CD 96 F5    		FPMONE CALL FPONE	;
482)   F601 21 00 01    		NEG: LD HL,FACC	;
483)   F604 7E          		 LD A,(HL)	;
484)   F605 EE 01       		 XOR 1	;
485)   F607 77          		 LD (HL),A	;
486)   F608 C9          		 RET	;
492)   F609 C5          		LDF: PUSH BC	;
493)   F60A E5          		 PUSH HL ;SAVE H,L,B,C	;SAVE H,L,B,C
494)   F60B 11 00 01    		 LD DE,FACC	;
495)   F60E CD 22 F6    		LDF1: CALL PP1	;
496)   F611 E1          		 POP HL	;
497)   F612 C1          		 POP BC	;
498)   F613 C9          		 RET	;
499)   F614 21 23 01    		STF4: LD HL,T4	;
500)   F617 C5          		STF: PUSH BC	;
501)   F618 E5          		 PUSH HL	;
502)   F619 EB          		 EX DE,HL	;
503)   F61A 21 00 01    		 LD HL,FACC	;
504)   F61D 18 EF       		 JR LDF1	;
510)   F61F 11 15 01    		PUSHF: LD DE,T5	;
511)   F622 01 06 00    		PP1: LD BC,6	;
512)   F625 ED B0       		 LDIR	;
513)   F627 C9          		 RET	;
519)   F628 E5          		SWIN: PUSH HL	;
520)   F629 2A 35 01    		 LD HL,(INPTR)	;
521)   F62C 7E          		SPCLP: LD A,(HL)	;
522)   F62D 23          		 INC HL	;
523)   F62E FE 20       		 CP ' '	;
524)   F630 28 FA       		 JR Z SPCLP	;
525)   F632 22 35 01    		 LD (INPTR),HL	;
526)   F635 E1          		 POP HL	;
527)   F636 CD 6E E3    		 CALL TTCAPS	;
528)   F639 FE 30       		 CP '0'	;
529)   F63B D8          		 RET C	;
530)   F63C FE 3A       		 CP '9'+1	;
531)   F63E 3F          		 CCF	;
532)   F63F D8          		 RET C	;
533)   F640 D6 30       		 SUB '0'	;
534)   F642 C9          		 RET	;
542)   F643 21 05 01    		DFACC: LD HL,FACC+5 ;SHFT MANT LFT 1	;SHFT MANT LFT 1
543)   F646 CD 09 F8    		 CALL SQSH5	;
544)   F649 DC FD F6    		 CALL C,FLTCRY ;AS MANT OFLO	;AS MANT OFLO
545)   F64C C9          		 RET	;
558)   F64D 11 07 FF    		SBSR1: LD DE,CPID2	;
559)   F650 18 03       		 JR SBSR	;
560)   F652 11 E9 FE    		SBSR2: LD DE,CE0	;
561)   F655 21 00 01    		SBSR: LD HL,FACC ;FACC=-FACC	;FACC=-FACC
562)   F658 7E          		 LD A,(HL)	;
563)   F659 EE 01       		 XOR 1	;
564)   F65B 77          		 LD (HL),A	;
568)   F65C CD 74 F5    		ADD: CALL LOAD	;
569)   F65F 18 07       		 JR ASB	;
570)   F661 CD 74 F5    		SUB: CALL LOAD	;
571)   F664 7E          		 LD A,(HL) ;INVERT SIGN BIT	;INVERT SIGN BIT
572)   F665 EE 01       		 XOR 1	;
573)   F667 77          		 LD (HL),A	;
578)   F668 3A 01 01    		 LD A,(FACC+1)	;
579)   F66B B7          		 OR A	;
580)   F66C CA 8B F5    		 JP Z,FSTO	;
581)   F66F CD 3B F5    		 CALL CKINT ;(D,E)=INTEGER ?	;(D,E)=INTEGER ?
582)   F672 20 22       		 JR NZ,ASA ;NO - NORMAL ADD	;NO - NORMAL ADD
583)   F674 CB 42       		 BIT 0,D ;(D,E)=-VE ?	;(D,E)=-VE ?
584)   F676 20 1E       		 JR NZ,ASA ;YES - NORMAL ADD	;YES - NORMAL ADD
585)   F678 3A 00 01    		 LD A,(FACC) ;EXP IS 1-5 ?	;EXP IS 1-5 ?
586)   F67B CB 2F       		 SRA A	;
587)   F67D 38 17       		 JR C ASA	;
588)   F67F 3D          		 DEC A	;
589)   F680 FE 05       		 CP 5	;
590)   F682 30 12       		 JR NC,ASA ;NO - NORMAL ADD	;NO - NORMAL ADD
592)   F684 3C          		 INC A	;
593)   F685 6F          		 LD L,A	;
594)   F686 AF          		 XOR A	;
595)   F687 7B          		ND3: LD A,E	;
596)   F688 1E 00       		 LD E,0	;
597)   F68A 8E          		 ADC A,(HL)	;
598)   F68B 77          		 LD (HL),A	;
599)   F68C 30 54       		 JR NC,ASTO ;EXIT AS NOT CRY	;EXIT AS NOT CRY
600)   F68E 2D          		 DEC L	;
601)   F68F 20 F6       		 JR NZ ND3	;
602)   F691 CD FD F6    		 CALL FLTCRY ;AS TOP WD OFLO	;AS TOP WD OFLO
603)   F694 18 4C       		 JR ASTO	;
607)   F696 2E 08       		ASA: LD L T1+1-FACC ;T1=0 ?	;T1=0 ?
608)   F698 11 00 01    		 LD DE FACC	;
609)   F69B 7E          		 LD A,(HL)	;
610)   F69C B7          		 OR A	;
611)   F69D CA 8E F5    		 JP Z,STO ;YES - EXIT	;YES - EXIT
612)   F6A0 2B          		 DEC HL ;SUB EXP	;SUB EXP
613)   F6A1 7E          		 LD A,(HL)	;
614)   F6A2 CB 2F       		 SRA A	;
615)   F6A4 47          		 LD B,A	;
616)   F6A5 1A          		 LD A,(DE)	;
617)   F6A6 CB 2F       		 SRA A ;MAKE EXP BINARY	;MAKE EXP BINARY
618)   F6A8 90          		 SUB B ;KEEP FACC SIGN BIT	;KEEP FACC SIGN BIT
619)   F6A9 EB          		 EX DE,HL	;
620)   F6AA 28 24       		 JR Z,AS2 ;=0	;=0
621)   F6AC F2 B6 F6    		 JP P,AS1	;
622)   F6AF ED 44       		 NEG  ;AS -VE	;AS -VE
623)   F6B1 F5          		 PUSH AF	;
624)   F6B2 CD 08 F7    		 CALL EXT1F ;EXCHANGE T1 AND FACC	;EXCHANGE T1 AND FACC
625)   F6B5 F1          		 POP AF	;
626)   F6B6 FE 06       		AS1: CP 6 ;EXP DIF > 5 ?	;EXP DIF > 5 ?
627)   F6B8 30 28       		 JR NC ASTO ;YES - JUST STO FACC	;YES - JUST STO FACC
628)   F6BA 57          		 LD D,A	;
629)   F6BB 3E 06       		 LD A,6 ;NO SH RT	;NO SH RT
630)   F6BD 92          		 SUB D	;
631)   F6BE 4F          		 LD C,A	;
632)   F6BF 06 00       		 LD B,0	;
633)   F6C1 2E 07       		 LD L T1-FACC ;FROM	;FROM
634)   F6C3 09          		 ADD HL,BC	;
635)   F6C4 D5          		 PUSH DE	;
636)   F6C5 11 0D 01    		 LD DE T1+6 ;TO	;TO
637)   F6C8 ED B8       		 LDDR  ;MOVE	;MOVE
638)   F6CA C1          		 POP BC	;
639)   F6CB AF          		 XOR A	;
640)   F6CC 12          		AS4: LD (DE),A ;INSERT LD ZEROS	;INSERT LD ZEROS
641)   F6CD 1B          		 DEC DE	;
642)   F6CE 10 FC       		 DJNZ AS4	;
643)   F6D0 1A          		AS2: LD A,(DE) ;ADD OR SUB ?	;ADD OR SUB ?
644)   F6D1 2E 00       		 LD L FACC-FACC	;
645)   F6D3 AE          		 XOR (HL)	;
646)   F6D4 1F          		 RRA	;
647)   F6D5 38 0D       		 JR C,AS5 ;SUB	;SUB
648)   F6D7 CD 56 F5    		 CALL FLADD ;ADD	;ADD
649)   F6DA 30 1E       		 JR NC,ANORM ;NO	;NO
650)   F6DC CD FD F6    		AS0 CALL FLTCRY ;AS CRY SET	;AS CRY SET
651)   F6DF EA 85 F5    		 JP PE,OFLO ;AS OFLO	;AS OFLO
652)   F6E2 18 16       		ASTO: JR ANORM ;EXIT	;EXIT
654)   F6E4 CD 65 F5    		AS5: CALL FLSUB ;SUB	;SUB
655)   F6E7 30 11       		 JR NC,ANORM	;
656)   F6E9 EB          		 EX DE,HL	;
657)   F6EA 7E          		 LD A,(HL) ;AS ANS NOW -VE	;AS ANS NOW -VE
658)   F6EB EE 01       		 XOR 1 ;INV SIGN BIT	;INV SIGN BIT
659)   F6ED 77          		 LD (HL),A	;
660)   F6EE 23          		 INC HL	;
661)   F6EF 06 06       		 LD B,6 ;ONES COMP MANT	;ONES COMP MANT
662)   F6F1 7E          		AS6: LD A,(HL)	;
663)   F6F2 2F          		 CPL	;
664)   F6F3 77          		 LD (HL),A	;
665)   F6F4 23          		 INC HL	;
666)   F6F5 10 FA       		 DJNZ AS6	;
667)   F6F7 CD D5 F5    		AS7: CALL ROWND ;NOW ADD 1	;NOW ADD 1
668)   F6FA C3 A0 F5    		ANORM: JP NORM ;CRY MUST UNSET SOMETIME	;CRY MUST UNSET SOMETIME
675)   F6FD 3E 01       		FLTCRY: LD A 01H	;
676)   F6FF CD 4D F5    		 CALL SHRF1	;
677)   F702 68          		 LD L B	;
678)   F703 7E          		INCX: LD A,(HL) ;INC EXP	;INC EXP
679)   F704 C6 02       		 ADD A,2	;
680)   F706 77          		 LD (HL),A	;
681)   F707 C9          		 RET	;
689)   F708 06 07       		 LD B,7	;
690)   F70A 4E          		EXG1: LD C,(HL)	;
691)   F70B 1A          		 LD A,(DE)	;
692)   F70C 77          		 LD (HL),A	;
693)   F70D 79          		 LD A,C	;
694)   F70E 12          		 LD (DE),A	;
695)   F70F 13          		 INC DE	;
696)   F710 23          		 INC HL	;
697)   F711 10 F7       		 DJNZ EXG1	;
698)   F713 C9          		 RET	;
705)   F714 21 00 01    		MULT LD HL FACC ;	;
706)   F717 1A          		EXPO LD A (DE) ;	;
707)   F718 47          		 LD B A ;	;
708)   F719 E6 01       		 AND 01H ;	;
709)   F71B AE          		 XOR (HL) ;	;
710)   F71C CB 80       		 RES 0 B ;	;
711)   F71E 80          		 ADD A B ;	;
712)   F71F 77          		 LD (HL) A ;	;
713)   F720 E2 29 F7    		 JP PO TOMM ;	;
714)   F723 FA 85 F5    		TOV: JP M OFLO ;	;
715)   F726 C3 CC F5    		ASTOZ: JP STOZ ;	;
716)   F729 0E 0A       		TOMM LD C 0AH ;	;
717)   F72B CD 3A F7    		 CALL MMULT ;	;
718)   F72E 2C          		 INC L ;	;
719)   F72F B6          		 OR (HL) ;	;
720)   F730 20 05       		 JR NZ JNORM ;	;
721)   F732 2E 07       		 LD L 07H ;	;
722)   F734 CD D2 F5    		 CALL PROWND ;	;
723)   F737 C3 A0 F5    		JNORM JP NORM ;	;
724)   F73A 2E 96       		MMULT LD L TAB-4 ;	;
725)   F73C 13          		 INC DE ;	;
726)   F73D EB          		 EX DE HL ;	;
727)   F73E ED A0       		 LDI ;	;
728)   F740 ED A0       		 LDI ;	;
729)   F742 ED A0       		 LDI ;	;
730)   F744 ED A0       		 LDI ;	;
731)   F746 ED A0       		 LDI ;	;
732)   F748 62          		 LD H D ;	;
733)   F749 69          		LDFA LD L C ;	;
734)   F74A 1E 94       		 LD E TAB-6 ;	;
735)   F74C ED A8       		 LDD ;	;
736)   F74E ED A8       		 LDD ;	;
737)   F750 ED A8       		 LDD ;	;
738)   F752 ED A8       		 LDD ;	;
739)   F754 ED A8       		 LDD ;	;
740)   F756 AF          		 XOR A ;	;
741)   F757 12          		 LD (DE) A ;	;
742)   F758 1D          		 DEC E ;	;
743)   F759 2E 94       		 LD L TAB-6 ;	;
744)   F75B 44          		 LD B H ;	;
745)   F75C 79          		TABLE LD A C ;	;
746)   F75D C6 05       		 ADD A 05H ;	;
747)   F75F 4F          		 LD C A ;	;
748)   F760 0A          		 LD A (BC) ;	;
749)   F761 86          		 ADD A (HL) ;	;
750)   F762 12          		 LD (DE) A ;	;
751)   F763 0D          		 DEC C ;	;
752)   F764 2D          		 DEC L ;	;
753)   F765 1D          		 DEC E ;	;
754)   F766 0A          		 LD A (BC) ;	;
755)   F767 8E          		 ADC A (HL) ;	;
756)   F768 12          		 LD (DE) A ;	;
758)   F769 0D          		 DEC C ;	;
759)   F76A 2D          		 DEC L ;	;
760)   F76B 1D          		 DEC E ;	;
761)   F76C 0A          		 LD A (BC) ;	;
762)   F76D 8E          		 ADC A (HL) ;	;
763)   F76E 12          		 LD (DE) A ;	;
764)   F76F 0D          		 DEC C ;	;
765)   F770 2D          		 DEC L ;	;
766)   F771 1D          		 DEC E ;	;
767)   F772 0A          		 LD A (BC) ;	;
768)   F773 8E          		 ADC A (HL) ;	;
769)   F774 12          		 LD (DE) A ;	;
770)   F775 0D          		 DEC C ;	;
771)   F776 2D          		 DEC L ;	;
772)   F777 1D          		 DEC E ;	;
773)   F778 0A          		 LD A (BC) ;	;
774)   F779 8E          		 ADC A (HL) ;	;
775)   F77A 12          		 LD (DE) A ;	;
776)   F77B 0D          		 DEC C ;	;
777)   F77C 2D          		 DEC L ;	;
778)   F77D 1D          		 DEC E ;	;
779)   F77E 3E 00       		 LD A 00H ;	;
780)   F780 8E          		 ADC A (HL) ;	;
781)   F781 12          		 LD (DE) A ;	;
782)   F782 2D          		 DEC L ;	;
783)   F783 1D          		 DEC E ;	;
784)   F784 3E 3A       		 LD A TAB-60H ;	;
785)   F786 93          		 SUB E ;	;
786)   F787 20 D3       		 JR NZ TABLE ;	;
788)   F789 2E 0A       		 LD L 0AH ;	;
789)   F78B 45          		 LD B L ;	;
790)   F78C 77          		DCLEAR LD (HL) A ;	;
791)   F78D 2D          		 DEC L ;	;
792)   F78E 10 FC       		 DJNZ DCLEAR ;	;
793)   F790 CD 9B F7    		 CALL MADD ;	;
795)   F793 2E 0A       		 LD L 0AH ;	;
796)   F795 45          		 LD B L ;	;
797)   F796 ED 6F       		DSHIFT RLD ;	;
798)   F798 2D          		 DEC L ;	;
799)   F799 10 FB       		 DJNZ DSHIFT ;	;
801)   F79B 01 9B 05    		MADD LD BC 500H+TAB+1;	;
802)   F79E AF          		 XOR A ;	;
803)   F79F 0D          		MADD1 DEC C ;	;
804)   F7A0 69          		 LD L C ;	;
805)   F7A1 ED 6F       		 RLD ;	;
806)   F7A3 28 2E       		 JR Z MADD3 ;	;
807)   F7A5 5F          		 LD E A ;	;
808)   F7A6 87          		 ADD A A ;	;
809)   F7A7 83          		 ADD A E ;	;
810)   F7A8 87          		 ADD A A ;	;
811)   F7A9 D6 9A       		 SUB TAB ;	;
812)   F7AB ED 44       		 NEG ;	;
813)   F7AD 5F          		 LD E A ;	;
814)   F7AE 79          		 LD A C ;	;
815)   F7AF D6 90       		 SUB 90H ;	;
816)   F7B1 6F          		 LD L A ;	;
817)   F7B2 1A          		 LD A (DE) ;	;
818)   F7B3 86          		 ADD A (HL) ;	;
819)   F7B4 77          		 LD (HL) A ;	;
820)   F7B5 1D          		 DEC E ;	;
821)   F7B6 2D          		 DEC L ;	;
822)   F7B7 1A          		 LD A (DE) ;	;
823)   F7B8 8E          		 ADC A (HL) ;	;
824)   F7B9 77          		 LD (HL) A ;	;
825)   F7BA 1D          		 DEC E ;	;
826)   F7BB 2D          		 DEC L ;	;
827)   F7BC 1A          		 LD A (DE) ;	;
828)   F7BD 8E          		 ADC A (HL) ;	;
829)   F7BE 77          		 LD (HL) A ;	;
830)   F7BF 1D          		 DEC E ;	;
831)   F7C0 2D          		 DEC L ;	;
832)   F7C1 1A          		 LD A (DE) ;	;
833)   F7C2 8E          		 ADC A (HL) ;	;
834)   F7C3 77          		 LD (HL) A ;	;
835)   F7C4 1D          		 DEC E ;	;
836)   F7C5 2D          		 DEC L ;	;
837)   F7C6 1A          		 LD A (DE) ;	;
838)   F7C7 8E          		 ADC A (HL) ;	;
839)   F7C8 77          		 LD (HL) A ;	;
840)   F7C9 1D          		 DEC E ;	;
841)   F7CA 2D          		 DEC L ;	;
842)   F7CB 1A          		 LD A (DE) ;	;
843)   F7CC 8E          		MADD2 ADC A (HL) ;	;
844)   F7CD 77          		 LD (HL) A ;	;
845)   F7CE 3E 00       		 LD A 00H ;	;
846)   F7D0 2D          		 DEC L ;	;
847)   F7D1 38 F9       		 JR C MADD2 ;	;
848)   F7D3 10 CA       		MADD3 DJNZ MADD1 ;	;
849)   F7D5 97          		 SUB A ;	;
850)   F7D6 C9          		 RET ;	;
855)   F7D7 21 06 01    		CLRFC: LD HL,FACC+6	;
856)   F7DA 06 06       		CLFR2: LD B,6	;
857)   F7DC AF          		CLFR1: XOR A	;
858)   F7DD 77          		CLFR: LD (HL),A	;
859)   F7DE 2B          		 DEC HL	;
860)   F7DF 10 FC       		 DJNZ CLFR	;
861)   F7E1 C9          		 RET	;
862)   F7E2 06 14       		CL20: LD B,20 ;CLR 20 WDS FROM FACC	;CLR 20 WDS FROM FACC
863)   F7E4 21 13 01    		 LD HL,FACC+19	;
864)   F7E7 18 F3       		 JR CLFR1	;
868)   F7E9 06 06       		SHB: LD B,6	;
869)   F7EB AF          		 XOR A	;
870)   F7EC CB 1E       		SHFB1: RR (HL)	;
871)   F7EE 23          		 INC HL	;
872)   F7EF 10 FB       		 DJNZ SHFB1	;
873)   F7F1 C9          		 RET	;
877)   F7F2 E5          		MORD: PUSH HL ;SAVE H,L B,C A,F	;SAVE H,L B,C A,F
878)   F7F3 C5          		 PUSH BC	;
879)   F7F4 CB 45       		 BIT 0,L	;
880)   F7F6 28 05       		 JR Z,MD1	;
881)   F7F8 CD 25 F8    		 CALL DIV ;DIV	;DIV
882)   F7FB 18 03       		 JR MD2	;
883)   F7FD CD 14 F7    		MD1: CALL MULT ;MULT	;MULT
884)   F800 C1          		MD2: POP BC	;
885)   F801 E1          		 POP HL	;
886)   F802 C9          		 RET	;
890)   F803 AF          		SQSH6: XOR A ;6 BYTES	;6 BYTES
891)   F804 CB 16       		 RL (HL)	;
892)   F806 2D          		 DEC L	;
893)   F807 18 01       		 JR SQSH5A	;
894)   F809 AF          		SQSH5: XOR A ;5 BYTES	;5 BYTES
895)   F80A CB 16       		SQSH5A: RL (HL)	;
896)   F80C 2D          		 DEC L	;
897)   F80D CB 16       		SQSH5B: RL (HL) ;4 BYTES	;4 BYTES
898)   F80F 2D          		 DEC L	;
899)   F810 CB 16       		 RL (HL)	;
900)   F812 2D          		 DEC L	;
901)   F813 CB 16       		 RL (HL)	;
902)   F815 2D          		 DEC L	;
903)   F816 CB 16       		 RL (HL)	;
904)   F818 2D          		 DEC L	;
905)   F819 C9          		 RET	;
913)   F81A CD 14 F6    		RECIP: CALL STF4 ;ST IN T4	;ST IN T4
914)   F81D E5          		 PUSH HL	;
915)   F81E 21 E9 FE    		 LD HL,CE0	;
916)   F821 CD 09 F6    		 CALL LDF	;
917)   F824 D1          		 POP DE	;
924)   F825 CD 74 F5    		DIV: CALL LOAD ;LOAD T1	;LOAD T1
925)   F828 2E 01       		 LD L FACC+1-FH	;
926)   F82A 1E 08       		 LD E T1+1-FACC	;
927)   F82C 1A          		 LD A,(DE)	;
928)   F82D B7          		 OR A	;
929)   F82E CA 85 F5    		 JP Z,OFLO ;YES - ERR	;YES - ERR
930)   F831 7E          		 LD A,(HL)	;
931)   F832 B7          		 OR A	;
932)   F833 CA CC F5    		 JP Z,STOZ ;AS FACC=0	;AS FACC=0
933)   F836 2B          		 DEC HL	;
934)   F837 1B          		 DEC DE	;
935)   F838 1A          		 LD A,(DE) ;SET EXPNT AND SIGN	;SET EXPNT AND SIGN
936)   F839 47          		 LD B,A	;
937)   F83A E6 01       		 AND 1	;
938)   F83C AE          		 XOR (HL)	;
939)   F83D CB 80       		 RES 0,B	;
940)   F83F 90          		 SUB B	;
941)   F840 EA 23 F7    		 JP PE,TOV ;AS OFLO	;AS OFLO
942)   F843 C6 02       		 ADD A,2	;
943)   F845 EA 23 F7    		 JP PE,TOV ;AS OFLO	;AS OFLO
944)   F848 F5          		 PUSH AF	;
945)   F849 2E 14       		 LD L T2+6-FACC ;CLR T2	;CLR T2
946)   F84B CD DA F7    		 CALL CLFR2	;
947)   F84E 68          		 LD L B	;
948)   F84F 36 0F       		 LD (HL) 0FH	;
949)   F851 2C          		 INC L	;
950)   F852 CD E9 F7    		 CALL SHB	;
951)   F855 2C          		 INC L	;
952)   F856 CD E9 F7    		 CALL SHB	;
953)   F859 0E 01       		 LD C,1 ;C=1	;C=1
954)   F85B 2E 08       		D5: LD L T1+1-FH ;BIT 6 OF T1+1	;BIT 6 OF T1+1
955)   F85D CB 76       		 BIT 6,(HL)	;
956)   F85F 20 09       		 JR NZ,D4 ;SET	;SET
957)   F861 2E 0D       		 LD L T1+6-FACC ;UNSET SH LFT 1	;UNSET SH LFT 1
958)   F863 CD 03 F8    		 CALL SQSH6	;
959)   F866 CB 01       		 RLC C ;SH C LFT	;SH C LFT
960)   F868 18 F1       		 JR D5	;
962)   F86A 6F          		D4 LD L A	;
963)   F86B 5D          		D6 LD E L	;
964)   F86C 2C          		 INC L	;
965)   F86D 3E C0       		 LD A 0C0H	;
966)   F86F A6          		 AND (HL)	;
967)   F870 28 11       		 JR Z D8	;
968)   F872 2E 07       		 LD L 07H	;
969)   F874 06 06       		 LD B 06H	;
970)   F876 CD E3 F4    		 CALL CMANT	;
971)   F879 38 08       		 JR C D8	;
972)   F87B CD 65 F5    		 CALL FLSUB	;
973)   F87E EB          		 EX DE HL	;
974)   F87F 6E          		 LD L (HL)	;
975)   F880 7E          		 LD A (HL)	;
976)   F881 81          		 ADD A C	;
977)   F882 77          		 LD (HL) A	;
978)   F883 2E 06       		D8 LD L 06H	;
979)   F885 CD 03 F8    		 CALL SQSH6	;
980)   F888 CB 09       		 RRC C	;
981)   F88A 8E          		 ADC A (HL)	;
982)   F88B 77          		 LD (HL) A	;
983)   F88C FE 15       		 CP 15H	;
984)   F88E 20 DB       		 JR NZ D6	;
985)   F890 F1          		 POP AF	;
986)   F891 77          		 LD (HL) A	;
987)   F892 1E 01       		 LD E 01H	;
988)   F894 2E 0F       		 LD L 0FH	;
989)   F896 CD 22 F6    		 CALL PP1	;
990)   F899 C3 A0 F5    		 JP NORM	;
999)   F89C 21 28 F6    		INP: LD HL,SWIN	;
1000)   F89F 22 09 00    		 LD (RST8),HL	;
1001)   F8A2 ED 53 35 01 		 LD (INPTR),DE	;
1002)   F8A6 37          		 SCF	;
1003)   F8A7 3E C7       		 LD A,199 ;error:"illegal INPTR value"	;error:"illegal INPTR value"
1004)   F8A9 14          		 INC D	;
1005)   F8AA C8          		 RET Z	;
1006)   F8AB C3 57 F2    		 JP INP1	;
1013)   F8AE 00          		 DS 0F8AFH-$   ;ADD ZEROES UNTIL 0F8AFH	;ADD ZEROES UNTIL 0F8AFH
1015)   F8AF CD D7 F7    		INP100: CALL CLRFC ;CLR FACC	;CLR FACC
1016)   F8B2 77          		 LD (HL),A ;(AND EXP)	;(AND EXP)
1017)   F8B3 21 1E 01    		 LD HL,W4	;
1018)   F8B6 77          		 LD (HL),A	;
1019)   F8B7 01 00 00    		 LD BC,0 ;B=C=0	;B=C=0
1020)   F8BA CF          		 RST RST	;
1021)   F8BB 30 21       		 JR NC,IN4	;
1022)   F8BD FE 2D       		 CP 55Q ;- ?	;- ?
1023)   F8BF 20 03       		 JR NZ,IN2	;
1024)   F8C1 34          		 INC (HL) ;YES	;YES
1025)   F8C2 18 04       		 JR NXT	;
1026)   F8C4 FE 2B       		IN2: CP 53Q ;+ ?	;+ ?
1027)   F8C6 20 03       		 JR NZ,IN3	;
1028)   F8C8 CF          		NXT: RST RST	;
1029)   F8C9 30 13       		 JR NC,IN4 ;=DIGIT	;=DIGIT
1030)   F8CB FE 2E       		IN3: CP 56Q ;. ?	;. ?
1031)   F8CD 28 3C       		 JR Z,IN5 ;=.	;=.
1032)   F8CF CB 40       		 BIT 0 B ;NONE - DIGIT YET ?	;NONE - DIGIT YET ?
1033)   F8D1 37          		 SCF	;
1034)   F8D2 C8          		 RET Z ;NO DIGIT - ERROR	;NO DIGIT - ERROR
1035)   F8D3 FE 45       		 CP 105Q	;
1036)   F8D5 28 3C       		 JR Z IN6 ;=E	;=E
1037)   F8D7 79          		INP1B LD A,C ;YES - NEG C	;YES - NEG C
1038)   F8D8 ED 44       		 NEG	;
1039)   F8DA 6F          		 LD L,A	;
1040)   F8DB C3 50 F9    		 JP SEXP	;
1042)   F8DE 11 37 FF    		 LD DE,CE1 ;*10	;*10
1043)   F8E1 C5          		 PUSH BC	;
1044)   F8E2 F5          		 PUSH AF	;
1045)   F8E3 CD 14 F7    		 CALL MULT	;
1046)   F8E6 DA 83 F5    		INERR JP C TROV1	;
1047)   F8E9 F1          		 POP AF	;
1048)   F8EA 21 EE FE    		 LD HL,CE0+5 ;T=1	;T=1
1049)   F8ED 11 13 01    		 LD DE,T2+5	;
1050)   F8F0 01 06 00    		 LD BC,6	;
1051)   F8F3 ED B8       		 LDDR	;
1052)   F8F5 13          		 INC DE	;
1053)   F8F6 13          		 INC DE	;
1054)   F8F7 12          		 LD (DE),A	;
1055)   F8F8 11 0E 01    		 LD DE,T2	;
1056)   F8FB CD 5C F6    		 CALL ADD ;+T2	;+T2
1057)   F8FE DA 84 F5    		 JP C TROV2	;
1058)   F901 C1          		 POP BC	;
1059)   F902 CB C0       		 SET 0 B ;HAD DIGIT	;HAD DIGIT
1060)   F904 CB 48       		 BIT 1 B ;? HAD DP	;? HAD DP
1061)   F906 28 C0       		 JR Z NXT ;NO	;NO
1062)   F908 0C          		 INC C ;YES	;YES
1063)   F909 18 BD       		 JR NXT	;
1065)   F90B CB 48       		IN5: BIT 1 B ;? HAD DP	;? HAD DP
1066)   F90D 37          		 SCF	;
1067)   F90E C0          		 RET NZ ;YES - ERROR	;YES - ERROR
1068)   F90F CB C8       		 SET 1 B	;
1069)   F911 18 B5       		 JR NXT	;
1070)   F913 06 00       		IN6: LD B,0 ;E - DEAL WITH EXP	;E - DEAL WITH EXP
1071)   F915 CF          		 RST RST	;
1072)   F916 30 14       		 JR NC,INE1 ;=DIG	;=DIG
1073)   F918 FE 2B       		 CP 53Q	;
1074)   F91A 28 0E       		 JR Z,NXTE ;AS +	;AS +
1075)   F91C FE 81       		 CP 81H	;
1076)   F91E 28 0A       		 JR Z NXTE ;AS TOKEN +	;AS TOKEN +
1077)   F920 FE 2D       		 CP 55Q ;- ?	;- ?
1078)   F922 28 04       		 JR Z PNXTE	;
1079)   F924 FE 82       		 CP 82H  ;TOKEN -	;TOKEN -
1080)   F926 37          		COFLO: SCF  ;NONE	;NONE
1081)   F927 C0          		 RET NZ	;
1082)   F928 06 01       		PNXTE LD B,1 ;AS -	;AS -
1083)   F92A CF          		NXTE: RST RST	;
1084)   F92B D8          		 RET C	;
1085)   F92C B7          		INE1: OR A	;
1086)   F92D 20 06       		 JR NZ,INE1A	;
1087)   F92F CF          		INE1B: RST RST	;
1088)   F930 38 47       		 JR C,EXI ;AS DONE	;AS DONE
1089)   F932 B7          		 OR A	;
1090)   F933 28 FA       		 JR Z,INE1B ;AS LD ZERO	;AS LD ZERO
1091)   F935 6F          		INE1A: LD L,A	;
1092)   F936 CF          		 RST RST	;
1093)   F937 38 0C       		 JR C,INE2	;
1094)   F939 67          		 LD H,A ;H=NEW CHAR	;H=NEW CHAR
1095)   F93A 7D          		 LD A,L	;
1096)   F93B 07          		 RLCA  ;OLD CHAR * 10	;OLD CHAR * 10
1097)   F93C 07          		 RLCA	;
1098)   F93D 07          		 RLCA	;
1099)   F93E 85          		 ADD A,L	;
1100)   F93F 85          		 ADD A,L	;
1101)   F940 84          		 ADD A,H ;+ NEW CHAR	;+ NEW CHAR
1102)   F941 6F          		 LD L,A	;
1103)   F942 CF          		 RST RST	;
1104)   F943 3F          		BOFLO: CCF  ;AS ANOTHER CHAR	;AS ANOTHER CHAR
1105)   F944 D8          		 RET C	;
1106)   F945 7D          		INE2: LD A,L	;
1107)   F946 CB 40       		 BIT 0,B	;
1108)   F948 28 02       		 JR Z,INE3	;
1109)   F94A ED 44       		 NEG	;
1110)   F94C 91          		INE3: SUB C ;C=DP CNT	;C=DP CNT
1111)   F94D EA 23 F7    		 JP PE,TOV ;AS OFLO	;AS OFLO
1113)   F950 B7          		SEXP: OR A ;EXP=+VE OR -VE ?	;EXP=+VE OR -VE ?
1114)   F951 2E 00       		 LD L,0	;
1115)   F953 F2 59 F9    		 JP P,SEXP3 ;+VE	;+VE
1116)   F956 ED 44       		 NEG  ;-VE	;-VE
1117)   F958 2C          		 INC L	;
1118)   F959 11 2B FF    		SEXP3: LD DE,CE20 ;>20 ?	;>20 ?
1119)   F95C D6 14       		 SUB 20	;
1120)   F95E F2 6F F9    		 JP P,DACT ;AS >20	;AS >20
1121)   F961 1E 31       		 LD E CE4-CON	;
1122)   F963 C6 10       		 ADD A,16	;
1123)   F965 F2 6F F9    		 JP P,DACT ;AS >4	;AS >4
1124)   F968 1E 37       		 LD E CE1-CON	;
1125)   F96A C6 03       		 ADD A,3	;
1126)   F96C FA 79 F9    		 JP M,EXI ;AS=0	;AS=0
1127)   F96F F5          		DACT: PUSH AF	;
1128)   F970 CD F2 F7    		 CALL MORD ;* OR /	;* OR /
1129)   F973 DA 84 F5    		 JP C TROV2	;
1130)   F976 F1          		 POP AF	;
1131)   F977 18 E0       		 JR SEXP3	;
1132)   F979 3A 1E 01    		EXI: LD A,(W4) ;SET SIGN	;SET SIGN
1133)   F97C 21 00 01    		 LD HL,FACC	;
1134)   F97F B6          		 OR (HL)	;
1135)   F980 77          		 LD (HL),A	;
1136)   F981 C9          		 RET	;
1143)   F982 AF          		FREE0 XOR A ;	;
1144)   F983 D5          		 PUSH DE ;	;
1145)   F984 18 05       		 JR FREE00 ;	;
1146)   F986 3A 01 01    		OUT LD A (FACC+1) ;	;
1147)   F989 B7          		 OR A ;	;
1148)   F98A C5          		 PUSH BC ;	;
1149)   F98B F5          		FREE00 PUSH AF ;	;
1150)   F98C CD E3 FD    		 CALL OZTRY ;	;
1151)   F98F CB 46       		 BIT 0 (HL) ;	;
1152)   F991 1E 0B       		 LD E 0BH ;	;
1153)   F993 3E 20       		 LD A 20H ;	;
1154)   F995 28 02       		 JR Z OUT11 ;	;
1155)   F997 C6 0D       		 ADD A 0DH ;	;
1156)   F999 12          		OUT11 LD (DE) A ;	;
1157)   F99A AF          		 XOR A  ;	;
1158)   F99B 06 28       		 LD B 28H ;	;
1159)   F99D 1C          		OUT12 INC E ;	;
1160)   F99E 12          		 LD (DE) A ;	;
1161)   F99F 10 FC       		 DJNZ OUT12 ;	;
1162)   F9A1 F1          		 POP AF ;	;
1163)   F9A2 F5          		 PUSH AF ;	;
1164)   F9A3 4D          		 LD C L ;	;
1165)   F9A4 28 4E       		 JR Z OUT20 ;	;
1166)   F9A6 CB 86       		 RES 0 (HL) ;	;
1167)   F9A8 7E          		OUT18 LD A (HL) ;	;
1168)   F9A9 B7          		 OR A ;	;
1169)   F9AA F2 B0 F9    		 JP P OUT14 ;	;
1170)   F9AD ED 44       		 NEG ;	;
1171)   F9AF 37          		 SCF ;	;
1172)   F9B0 F5          		OUT14 PUSH AF ;	;
1173)   F9B1 11 19 FF    		 LD DE CEM20 ;	;
1174)   F9B4 06 14       		 LD B 14H ;	;
1175)   F9B6 FE 12       		 CP 12H ;	;
1176)   F9B8 30 1E       		 JR NC OUT15 ;	;
1177)   F9BA 1E 1F       		 LD E CEM4-CON ;	;
1178)   F9BC 06 04       		 LD B, 04H ;	;
1179)   F9BE FE 08       		 CP 08H ;	;
1180)   F9C0 30 16       		 JR NC OUT15 ;	;
1181)   F9C2 1E 25       		 LD E CEM1-CON ;	;
1182)   F9C4 06 01       		 LD B 01H ;	;
1183)   F9C6 FE 02       		 CP 02H ;	;
1184)   F9C8 30 0E       		 JR NC OUT15 ;	;
1185)   F9CA F1          		 POP AF ;	;
1186)   F9CB E5          		 PUSH HL ;	;
1187)   F9CC D5          		 PUSH DE ;	;
1188)   F9CD C5          		 PUSH BC ;	;
1189)   F9CE CD AD F4    		 CALL COMP ;	;
1190)   F9D1 C1          		 POP BC ;	;
1191)   F9D2 D1          		 POP DE ;	;
1192)   F9D3 E1          		 POP HL ;	;
1193)   F9D4 38 1E       		 JR C OUT20 ;	;
1194)   F9D6 18 04       		 JR OUT16 ;	;
1195)   F9D8 F1          		OUT15 POP AF ;	;
1196)   F9D9 78          		 LD A B ;	;
1197)   F9DA 30 07       		 JR NC OUT17 ;	;
1198)   F9DC 7B          		OUT16 LD A E ;	;
1199)   F9DD C6 12       		 ADD A 12H ;	;
1200)   F9DF 5F          		 LD E A ;	;
1201)   F9E0 78          		 LD A B ;	;
1202)   F9E1 ED 44       		 NEG ;	;
1203)   F9E3 81          		OUT17 ADD A C ;	;
1204)   F9E4 4F          		 LD C A ;	;
1205)   F9E5 FE 6C       		 CP 108 ;	;
1206)   F9E7 38 04       		 JR C OUT19 ;	;
1207)   F9E9 FE 9A       		 CP 154 ;	;
1208)   F9EB 38 29       		 JR C OUT22 ;	;
1210)   F9ED C5          		 PUSH BC ;	;
1211)   F9EE CD 14 F7    		 CALL MULT ;	;
1212)   F9F1 C1          		 POP BC ;	;
1213)   F9F2 18 B4       		 JR OUT18 ;	;
1214)   F9F4 06 1F       		OUT20 LD B 1FH ;	;
1215)   F9F6 3E 0A       		 LD A 0AH ;	;
1216)   F9F8 11 37 FF    		OUT21 LD DE CE1 ;	;
1217)   F9FB C5          		 PUSH BC ;	;
1218)   F9FC 4F          		 LD C A ;	;
1219)   F9FD CD 3A F7    		 CALL MMULT ;	;
1220)   FA00 C1          		 POP BC ;	;
1221)   FA01 2C          		 INC L ;	;
1222)   FA02 7E          		 LD A (HL) ;	;
1223)   FA03 68          		 LD L B ;	;
1224)   FA04 C6 30       		 ADD A 30H ;make ascii	;make ascii
1225)   FA06 77          		 LD (HL) A ;	;
1226)   FA07 04          		 INC B ;	;
1227)   FA08 04          		 INC B ;	;
1228)   FA09 F1          		 POP AF ;	;
1229)   FA0A D1          		 POP DE ;	;
1230)   FA0B D5          		 PUSH DE ;	;
1231)   FA0C F5          		 PUSH AF ;	;
1232)   FA0D 7B          		 LD A E ;	;
1233)   FA0E 87          		 ADD A A ;	;
1234)   FA0F C6 20       		 ADD A 20H ;	;
1235)   FA11 B8          		 CP B ;	;
1236)   FA12 3E 0B       		 LD A 0BH ;	;
1237)   FA14 30 E2       		 JR NC OUT21 ;	;
1238)   FA16 F1          		OUT22 POP AF ;	;
1239)   FA17 D1          		 POP DE ;	;
1240)   FA18 20 06       		 JR NZ OUT23 ;	;
1241)   FA1A B2          		 OR D ;	;
1242)   FA1B CB 17       		 RL A ;	;
1243)   FA1D 28 01       		 JR Z OUT23 ;	;
1244)   FA1F 0C          		 INC C ;	;
1245)   FA20 7A          		OUT23 LD A D ;	;
1246)   FA21 17          		 RLA ;	;
1247)   FA22 38 52       		 JR C FXPE ;	;
1248)   FA24 17          		 RLA ;	;
1249)   FA25 DA E6 FA    		 JP C FREE ;	;
1256)   FA28 CD D5 FA    		 CALL FXPCAL ;	;
1257)   FA2B CD 3A FB    		 CALL ROUNDA ;	;
1258)   FA2E D4 D5 FA    		 CALL NC FXPCAL ;	;
1259)   FA31 79          		FXPF LD A C ;	;
1260)   FA32 87          		 ADD A A ;	;
1261)   FA33 C6 1E       		 ADD A 1EH ;	;
1262)   FA35 6F          		 LD L A ;	;
1263)   FA36 36 2E       		 LD (HL) 2EH ;	;
1264)   FA38 E5          		 PUSH HL ;	;
1265)   FA39 7B          		 LD A E ;	;
1266)   FA3A 92          		 SUB D ;	;
1267)   FA3B 81          		 ADD A C ;	;
1268)   FA3C 0D          		 DEC C ;	;
1269)   FA3D 87          		 ADD A A ;	;
1270)   FA3E CA DD FA    		 JP Z PFXPW ;	;
1271)   FA41 C6 1E       		 ADD A 1EH ;	;
1272)   FA43 6F          		 LD L A ;	;
1273)   FA44 74          		 LD (HL) H ;	;
1274)   FA45 E1          		 POP HL ;	;
1275)   FA46 0C          		 INC C ;	;
1276)   FA47 41          		 LD B C ;	;
1277)   FA48 F2 B4 FA    		 JP P LOOTA ;	;
1278)   FA4B 2D          		 DEC L ;	;
1279)   FA4C 42          		 LD B D ;	;
1280)   FA4D 7A          		 LD A D ;	;
1281)   FA4E B7          		 OR A ;	;
1282)   FA4F 3E 20       		 LD A 20H ;	;
1283)   FA51 C4 E1 FA    		 CALL NZ ORIN ;	;
1284)   FA54 79          		 LD A C ;	;
1285)   FA55 ED 44       		 NEG ;	;
1286)   FA57 47          		 LD B A ;	;
1287)   FA58 3E 30       		 LD A 30H ;	;
1288)   FA5A 18 5D       		 JR LOOTB ;	;
1292)   FA5C 06 05       		FXPEW LD B 05H ;	;
1293)   FA5E 7B          		FXPW LD A E ;	;
1294)   FA5F BA          		 CP D ;	;
1295)   FA60 20 01       		 JR NZ OOT1 ;	;
1296)   FA62 05          		 DEC B ;	;
1297)   FA63 80          		OOT1 ADD A B ;	;
1298)   FA64 47          		 LD B A ;	;
1299)   FA65 CB 79       		 BIT 7 C ;	;
1300)   FA67 3E 2E       		 LD A 2EH ;	;
1301)   FA69 20 02       		 JR NZ OOT3 ;	;
1302)   FA6B 3E 2A       		 LD A 2AH ;	;
1303)   FA6D 2E 0C       		OOT3 LD L 0CH ;	;
1304)   FA6F 77          		OOT4 LD (HL) A ;	;
1305)   FA70 2C          		 INC L ;	;
1306)   FA71 10 FC       		 DJNZ OOT4 ;	;
1307)   FA73 74          		 LD (HL) H ;	;
1308)   FA74 18 48       		TOLOOT JR LOOT ;	;
1311)   FA76 CB BA       		FXPE RES 7 D ;	;
1312)   FA78 CD 21 FB    		 CALL OCAL ;	;
1313)   FA7B CD 37 FB    		 CALL ROUND ;	;
1314)   FA7E D4 21 FB    		 CALL NC OCAL ;	;
1315)   FA81 79          		FXPEF LD A C ;	;
1316)   FA82 90          		 SUB B ;	;
1317)   FA83 4F          		 LD C A ;	;
1318)   FA84 78          		 LD A B ;	;
1319)   FA85 87          		 ADD A A ;	;
1320)   FA86 C6 1E       		 ADD A 1EH ;	;
1321)   FA88 6F          		 LD L A ;	;
1322)   FA89 36 2E       		 LD (HL) 2EH ;	;
1323)   FA8B 7B          		 LD A E ;	;
1324)   FA8C 92          		 SUB D ;	;
1325)   FA8D 80          		 ADD A B ;	;
1326)   FA8E 87          		 ADD A A ;	;
1327)   FA8F C6 1E       		 ADD A 1EH ;	;
1328)   FA91 6F          		 LD L A ;	;
1329)   FA92 36 45       		 LD (HL) 45H ;	;
1330)   FA94 2C          		 INC L ;	;
1331)   FA95 36 2B       		 LD (HL) 2BH ;	;
1332)   FA97 79          		 LD A C ;	;
1333)   FA98 CB 7F       		 BIT 7 A ;	;
1334)   FA9A 28 04       		 JR Z OUT43 ;	;
1335)   FA9C ED 44       		 NEG ;	;
1336)   FA9E 36 2D       		 LD (HL) 2DH ;	;
1337)   FAA0 2C          		OUT43 INC L ;	;
1338)   FAA1 FE 64       		 CP 100 ;	;
1339)   FAA3 30 B7       		 JR NC FXPEW ;	;
1340)   FAA5 36 30       		 LD (HL) 30H ;	;
1341)   FAA7 D6 0A       		OUT45 SUB 10 ;	;
1342)   FAA9 38 03       		 JR C OUT46 ;	;
1343)   FAAB 34          		 INC (HL) ;	;
1344)   FAAC 18 F9       		 JR OUT45 ;	;
1345)   FAAE C6 3A       		OUT46 ADD A 3AH ;	;
1346)   FAB0 2C          		 INC L ;	;
1347)   FAB1 77          		 LD (HL) A ;	;
1348)   FAB2 2C          		 INC L ;	;
1349)   FAB3 74          		 LD (HL) H ;	;
1350)   FAB4 7A          		LOOTA LD A D ;	;
1351)   FAB5 90          		 SUB B ;	;
1352)   FAB6 47          		 LD B A ;	;
1353)   FAB7 3E 20       		 LD A 20H ;	;
1354)   FAB9 2E 1D       		LOOTB LD L 1DH ;	;
1355)   FABB C4 E1 FA    		 CALL NZ ORIN ;	;
1356)   FABE 2E 0B       		LOOT LD L 0BH ;	;
1357)   FAC0 E5          		 PUSH HL ;can JP UNIOUT here to	;can JP UNIOUT here to
1358)   FAC1 5D          		 LD E L ;1K maths pack.	;1K maths pack.
1359)   FAC2 54          		 LD D H ;	;
1360)   FAC3 2C          		NREM1 INC L ;	;
1361)   FAC4 1C          		NREM2 INC E ;	;
1362)   FAC5 1A          		 LD A (DE) ;	;
1363)   FAC6 B7          		 OR A ;	;
1364)   FAC7 28 FB       		 JR Z NREM2 ;	;
1365)   FAC9 77          		 LD (HL) A ;	;
1366)   FACA BC          		 CP H ;	;
1367)   FACB 20 F6       		 JR NZ NREM1 ;	;
1368)   FACD 36 20       		 LD (HL) 20H ;	;
1369)   FACF 2C          		 INC L ;	;
1370)   FAD0 7D          		 LD A L ;	;
1371)   FAD1 E1          		 POP HL ;	;
1372)   FAD2 95          		 SUB L ;	;
1373)   FAD3 4F          		 LD C A ;	;
1374)   FAD4 C9          		 RET ;	;
1376)   FAD5 7A          		FXPCAL LD A D ;	;
1377)   FAD6 91          		 SUB C ;	;
1378)   FAD7 6F          		 LD L A ;	;
1379)   FAD8 7B          		 LD A E ;	;
1380)   FAD9 95          		 SUB L ;	;
1381)   FADA 06 01       		 LD B 1 ;	;
1382)   FADC D0          		 RET NC ;	;
1383)   FADD F1          		PFXPW POP AF ;	;
1384)   FADE C3 5E FA    		 JP FXPW ;	;
1386)   FAE1 77          		ORIN LD (HL) A ;	;
1387)   FAE2 2D          		 DEC L ;	;
1388)   FAE3 10 FC       		 DJNZ ORIN ;	;
1389)   FAE5 C9          		 RET ;	;
1391)   FAE6 7B          		FREE LD A E ;	;
1392)   FAE7 CD 3A FB    		 CALL ROUNDA ;	;
1393)   FAEA 79          		 LD A C ;	;
1394)   FAEB B7          		 OR A ;	;
1395)   FAEC F2 06 FB    		 JP P FREEP ;	;
1396)   FAEF FE 9E       		 CP -98 ;	;
1397)   FAF1 DA 82 F9    		 JP C FREE0 ;	;
1398)   FAF4 FE FC       		 CP -4 ;	;
1399)   FAF6 38 13       		 JR C FREEE ;	;
1400)   FAF8 16 00       		 LD D 0 ;	;
1401)   FAFA 7B          		FREEF LD A E ;	;
1402)   FAFB 91          		 SUB C ;	;
1403)   FAFC 47          		 LD B A ;	;
1404)   FAFD C4 18 FB    		 CALL NZ ZEREM ;	;
1405)   FB00 78          		 LD A B ;	;
1406)   FB01 82          		 ADD A D ;	;
1407)   FB02 5F          		 LD E A ;	;
1408)   FB03 C3 31 FA    		 JP FXPF ;	;
1409)   FB06 7B          		FREEP LD A E ;	;
1410)   FB07 B9          		 CP C ;	;
1411)   FB08 51          		 LD D C ;	;
1412)   FB09 30 EF       		 JR NC FREEF ;	;
1413)   FB0B 16 01       		FREEE LD D 1 ;	;
1414)   FB0D 43          		 LD B E ;	;
1415)   FB0E 05          		 DEC B ;	;
1416)   FB0F CD 18 FB    		 CALL ZEREM ;	;
1417)   FB12 04          		 INC B ;	;
1418)   FB13 58          		 LD E B ;	;
1419)   FB14 42          		 LD B D ;	;
1420)   FB15 C3 81 FA    		 JP FXPEF ;	;
1427)   FB18 2D          		ZEREM DEC L ;	;
1428)   FB19 2D          		 DEC L ;	;
1429)   FB1A 7E          		 LD A (HL) ;	;
1430)   FB1B FE 30       		 CP 30H ;	;
1431)   FB1D C0          		 RET NZ ;	;
1432)   FB1E 10 F8       		 DJNZ ZEREM ;	;
1433)   FB20 C9          		 RET ;	;
1436)   FB21 69          		 LD L C ;	;
1437)   FB22 AF          		 XOR A ;	;
1438)   FB23 42          		 LD B D ;	;
1439)   FB24 BA          		 CP D ;	;
1440)   FB25 C8          		 RET Z ;	;
1441)   FB26 2D          		 DEC L ;	;
1442)   FB27 78          		 LD A B ;	;
1443)   FB28 F2 2D FB    		 JP P OCAL1 ;	;
1444)   FB2B ED 44       		 NEG ;	;
1445)   FB2D 47          		OCAL1 LD B A ;	;
1446)   FB2E 7D          		 LD A L ;	;
1447)   FB2F 80          		 ADD A B ;	;
1448)   FB30 90          		OCAL2 SUB B ;	;
1449)   FB31 BA          		 CP D ;	;
1450)   FB32 30 FC       		 JR NC OCAL2 ;	;
1451)   FB34 3C          		 INC A ;	;
1452)   FB35 47          		 LD B A ;	;
1453)   FB36 C9          		 RET ;	;
1458)   FB37 7B          		 LD A E ;	;
1459)   FB38 92          		 SUB D ;	;
1460)   FB39 80          		 ADD A B ;	;
1461)   FB3A E5          		ROUNDA PUSH HL ;	;
1462)   FB3B 87          		 ADD A A ;	;
1463)   FB3C C6 1F       		 ADD A 1FH ;	;
1464)   FB3E 6F          		 LD L A ;	;
1465)   FB3F 7E          		 LD A (HL) ;	;
1466)   FB40 FE 35       		 CP 35H ;	;
1467)   FB42 18 05       		 JR OUT38 ;	;
1468)   FB44 2D          		OUT35 DEC L ;	;
1469)   FB45 2D          		 DEC L ;	;
1470)   FB46 7E          		 LD A (HL) ;	;
1471)   FB47 FE 39       		 CP 39H ;	;
1472)   FB49 38 08       		OUT38 JR C OUT36 ;	;
1473)   FB4B 36 30       		 LD (HL) 30H ;	;
1474)   FB4D 3E 1F       		 LD A 1FH ;	;
1475)   FB4F BD          		 CP L ;	;
1476)   FB50 20 F2       		 JR NZ OUT35 ;	;
1477)   FB52 0C          		 INC C ;	;
1478)   FB53 34          		OUT36 INC (HL) ;	;
1479)   FB54 E1          		 POP HL ;	;
1480)   FB55 C9          		 RET ;	;
1491)   FB56 21 00 01    		INT: LD HL,FACC	;
1492)   FB59 7E          		 LD A,(HL)	;
1493)   FB5A CB 2F       		 SRA A	;
1494)   FB5C 47          		 LD B,A	;
1495)   FB5D F2 65 FB    		 JP P,INT3	;
1496)   FB60 CD D7 F7    		 CALL CLRFC ;AS < 1	;AS < 1
1497)   FB63 18 14       		 JR INT4	;
1498)   FB65 3E 05       		INT3: LD A,5 ;CLR FRAC	;CLR FRAC
1499)   FB67 90          		 SUB B	;
1500)   FB68 4F          		 LD C,A	;
1501)   FB69 AF          		 XOR A	;
1502)   FB6A 2E 05       		 LD L FACC+5-FACC	;
1503)   FB6C 0D          		INT1: DEC C	;
1504)   FB6D FA 76 FB    		 JP M,INT2	;
1505)   FB70 B6          		 OR (HL) ;fix submitted by correspondent	;fix submitted by correspondent
1506)   FB71 36 00       		 LD (HL),0	;
1507)   FB73 2B          		 DEC HL	;
1508)   FB74 18 F6       		 JR INT1	;
1509)   FB76 B7          		INT2: OR A	;
1510)   FB77 28 0A       		 JR Z,ASTO1 ;AS INT ALRDY	;AS INT ALRDY
1511)   FB79 11 E9 FE    		INT4: LD DE,CE0	;
1512)   FB7C 2E 00       		 LD L FACC-FACC ;-VE ?	;-VE ?
1513)   FB7E 7E          		 LD A,(HL)	;
1514)   FB7F 0F          		 RRCA	;
1515)   FB80 DA 61 F6    		 JP C,SUB ;YES - SUB 1	;YES - SUB 1
1516)   FB83 C3 8E F5    		ASTO1: JP STO	;
1523)   FB86 21 00 01    		ABS: LD HL,FACC	;
1524)   FB89 AF          		 XOR A	;
1525)   FB8A CB 86       		 RES 0,(HL)	;
1526)   FB8C C9          		 RET	;
1534)   FB8D 21 01 01    		SIGN: LD HL,FACC+1	;
1535)   FB90 7E          		 LD A,(HL)	;
1536)   FB91 B7          		 OR A	;
1537)   FB92 28 EF       		 JR Z,ASTO1	;
1538)   FB94 2B          		 DEC HL	;
1539)   FB95 7E          		 LD A,(HL)	;
1540)   FB96 E6 01       		 AND 1	;
1541)   FB98 F5          		 PUSH AF	;
1542)   FB99 E5          		 PUSH HL	;
1543)   FB9A 21 E9 FE    		 LD HL,CE0 ;FACC=1	;FACC=1
1544)   FB9D CD 09 F6    		 CALL LDF	;
1545)   FBA0 E1          		 POP HL	;
1546)   FBA1 F1          		 POP AF	;
1547)   FBA2 B6          		 OR (HL)	;
1548)   FBA3 77          		 LD (HL),A	;
1549)   FBA4 18 DD       		 JR ASTO1	;
1556)   FBA6 7E          		FIX: LD A,(HL)	;
1557)   FBA7 11 00 00    		 LD DE,0	;
1558)   FBAA CB 2F       		 SRA A	;
1559)   FBAC D8          		 RET C ;EXIT AS -VE	;EXIT AS -VE
1560)   FBAD F8          		 RET M ;<1 SO ZERO	;<1 SO ZERO
1561)   FBAE C8          		 RET Z ;ALSO <1	;ALSO <1
1562)   FBAF FE 03       		 CP 3	;
1563)   FBB1 3F          		 CCF	;
1564)   FBB2 D8          		 RET C ;AS EXP >2	;AS EXP >2
1565)   FBB3 23          		FIX1: INC HL	;
1566)   FBB4 5E          		 LD E,(HL)	;
1567)   FBB5 3D          		 DEC A	;
1568)   FBB6 C8          		 RET Z ;AS EXP=1	;AS EXP=1
1569)   FBB7 53          		 LD D,E	;
1570)   FBB8 18 F9       		 JR FIX1 ;AS EXP=2	;AS EXP=2
1575)   FBBA CD A6 FB    		RUND: CALL FIX	;
1576)   FBBD 38 0B       		 JR C RUND1	;
1577)   FBBF F8          		 RET M	;
1578)   FBC0 23          		 INC HL	;
1579)   FBC1 CB 7E       		 BIT 7,(HL)	;
1580)   FBC3 C8          		 RET Z	;
1581)   FBC4 13          		 INC DE	;
1582)   FBC5 7A          		 LD A,D	;
1583)   FBC6 B3          		 OR E	;
1584)   FBC7 C0          		 RET NZ	;
1585)   FBC8 37          		 SCF	;
1586)   FBC9 C9          		 RET	;
1588)   FBCA B7          		RUND1 OR A	;
1589)   FBCB F8          		 RET M	;
1590)   FBCC 37          		 SCF	;
1591)   FBCD C0          		 RET NZ	;
1592)   FBCE 23          		 INC HL	;
1593)   FBCF 7E          		 LD A (HL)	;
1594)   FBD0 17          		 RLA	;
1595)   FBD1 C9          		 RET	;
1599)   FBD2 21 00 01    		 LD HL,FACC	;
1600)   FBD5 CD A6 FB    		 CALL FIX ;STORE ADDR. TO DE	;STORE ADDR. TO DE
1601)   FBD8 D8          		 RET C ;R.IF FIX ERR (I.E 65535<ADDR.<0)	;R.IF FIX ERR (I.E 65535<ADDR.<0)
1602)   FBD9 1A          		 LD A,(DE)	;
1603)   FBDA 18 03       		 JR LP1	;
1607)   FBDC 3A 1C 00    		 LD A,(PHPOS)	;
1608)   FBDF 5F          		LP1: LD E,A	;
1609)   FBE0 16 00       		 LD D,0	;
1616)   FBE2 CD D7 F7    		FLT: CALL CLRFC ;H,L SET TO FLT(D,E)	;H,L SET TO FLT(D,E)
1617)   FBE5 36 04       		 LD (HL),4	;
1618)   FBE7 23          		 INC HL	;
1619)   FBE8 72          		 LD (HL),D	;
1620)   FBE9 23          		 INC HL	;
1621)   FBEA 73          		 LD (HL),E	;
1622)   FBEB C3 A0 F5    		 JP NORM	;
1627)   FBEE E5          		POLY PUSH HL ;	;
1628)   FBEF CD CC F5    		 CALL STOZ	;
1629)   FBF2 2E 2E       		POLY1 LD L M3+5-FH	;
1630)   FBF4 CD DA F7    		 CALL CLFR2	;
1631)   FBF7 1E 29       		 LD E M3-FH ;	;
1632)   FBF9 E1          		 POP HL ;	;
1633)   FBFA 7E          		 LD A (HL) ;	;
1634)   FBFB CB 2F       		 SRA A ;	;
1635)   FBFD CB 2F       		 SRA A ;	;
1636)   FBFF CB 2F       		 SRA A ;	;
1637)   FC01 12          		 LD (DE) A ;	;
1638)   FC02 1C          		 INC E ;	;
1639)   FC03 7E          		 LD A (HL) ;	;
1640)   FC04 E6 07       		 AND 07H ;	;
1641)   FC06 C8          		 RET Z ;	;
1642)   FC07 4F          		 LD C A ;	;
1643)   FC08 2C          		 INC L ;	;
1644)   FC09 ED B0       		 LDIR ;	;
1645)   FC0B E5          		 PUSH HL ;	;
1646)   FC0C 1E 2F       		 LD E M4-FH	;
1647)   FC0E CD 14 F7    		 CALL MULT	;
1648)   FC11 1E 29       		 LD E M3-FH	;
1649)   FC13 CD 5C F6    		 CALL ADD	;
1650)   FC16 18 DA       		 JR POLY1 ;	;
1654)   FC18 1E 06       		TSPSH LD E 6 ;	;
1655)   FC1A 12          		 LD (DE) A ;	;
1656)   FC1B 57          		 LD D A ;	;
1657)   FC1C 7E          		 LD A (HL) ;	;
1658)   FC1D 5F          		 LD E A ;	;
1659)   FC1E CB 2F       		 SRA A ;	;
1660)   FC20 C8          		 RET Z ;	;
1661)   FC21 F8          		 RET M ;	;
1662)   FC22 FE 04       		 CP 4 ;	;
1663)   FC24 D2 83 F5    		 JP NC TROV1 ;	;
1664)   FC27 47          		SPSH LD B A ;	;
1665)   FC28 2C          		SPSH1 INC L ;	;
1666)   FC29 56          		 LD D (HL) ;	;
1667)   FC2A 36 00       		 LD (HL) 0 ;	;
1668)   FC2C 10 FA       		 DJNZ SPSH1 ;	;
1669)   FC2E D5          		 PUSH DE ;	;
1670)   FC2F CD A0 F5    		 CALL NORM ;	;
1671)   FC32 D1          		 POP DE ;	;
1672)   FC33 3E F8       		 LD A -8 ;	;
1673)   FC35 83          		 ADD A E ;	;
1674)   FC36 BE          		 CP (HL) ;	;
1675)   FC37 C0          		 RET NZ ;	;
1676)   FC38 2C          		 INC L ;	;
1677)   FC39 7E          		 LD A (HL) ;	;
1678)   FC3A FE 04       		 CP 4 ;	;
1679)   FC3C D0          		 RET NC ;	;
1680)   FC3D 36 00       		 LD (HL) 0 ;	;
1681)   FC3F C9          		 RET ;	;
1686)   FC40 37          		COS SCF ;	;
1687)   FC41 18 01       		 JR SIN1 ;	;
1688)   FC43 AF          		SIN XOR A ;	;
1689)   FC44 21 00 01    		SIN1 LD HL FACC	;
1690)   FC47 0E 01       		 LD C 1 ;	;
1691)   FC49 7E          		 LD A (HL) ;	;
1692)   FC4A 38 03       		 JR C SIN2 ;	;
1693)   FC4C A1          		 AND C ;	;
1694)   FC4D 87          		 ADD A A ;	;
1695)   FC4E 4F          		 LD C A ;	;
1696)   FC4F CB 86       		SIN2 RES 0 (HL) ;	;
1697)   FC51 C5          		 PUSH BC ;	;
1698)   FC52 11 F5 FE    		 LD DE C2DPI	;
1699)   FC55 CD 14 F7    		 CALL MULT	;
1700)   FC58 CD 18 FC    		 CALL TSPSH ;	;
1701)   FC5B C1          		 POP BC ;	;
1702)   FC5C 7A          		 LD A D ;	;
1703)   FC5D 81          		 ADD A C ;	;
1704)   FC5E E6 03       		 AND 3 ;	;
1705)   FC60 CB 0F       		 RRC A ;	;
1706)   FC62 F5          		 PUSH AF ;	;
1707)   FC63 11 E9 FE    		 LD DE CE0	;
1708)   FC66 DC 61 F6    		 CALL C SUB	;
1709)   FC69 F1          		 POP AF ;	;
1710)   FC6A E4 01 F6    		 CALL PO NEG	;
1711)   FC6D 11 96 FF    		 LD DE TB3342 ;	;
1713)   FC70 2E 1D       		PREP LD L M1-FH	;
1714)   FC72 D5          		 PUSH DE ;	;
1715)   FC73 CD 17 F6    		 CALL STF	;
1716)   FC76 11 00 01    		 LD DE FACC	;
1717)   FC79 CD 14 F7    		 CALL MULT	;
1718)   FC7C 2E 2F       		 LD L M4-FH	;
1719)   FC7E CD 17 F6    		 CALL STF	;
1720)   FC81 E1          		 POP HL ;	;
1721)   FC82 CD EE FB    		 CALL POLY ;	;
1722)   FC85 1E 1D       		 LD E M1-FH	;
1723)   FC87 C3 14 F7    		 JP MULT	;
1728)   FC8A 21 00 01    		EXP LD HL FACC	;
1729)   FC8D 7E          		 LD A (HL) ;	;
1730)   FC8E CB 86       		 RES 0 (HL) ;	;
1731)   FC90 CB 2F       		 SRA A ;	;
1732)   FC92 F5          		 PUSH AF ;	;
1733)   FC93 FA A0 FC    		 JP M EXP1 ;	;
1734)   FC96 FE 02       		 CP 2 ;	;
1735)   FC98 38 06       		 JR C EXP1 ;	;
1736)   FC9A F1          		 POP AF ;	;
1737)   FC9B 3F          		 CCF ;	;
1738)   FC9C D8          		 RET C ;	;
1739)   FC9D C3 CC F5    		 JP STOZ	;
1740)   FCA0 11 0D FF    		EXP1 LD DE C1DLN2 ;	;
1741)   FCA3 CD 14 F7    		 CALL MULT	;
1742)   FCA6 CD 18 FC    		 CALL TSPSH ;	;
1743)   FCA9 D5          		 PUSH DE ;	;
1744)   FCAA 2E 2F       		 LD L M4-FH	;
1745)   FCAC CD 17 F6    		 CALL STF	;
1746)   FCAF 21 52 FF    		 LD HL TB1044 ;	;
1747)   FCB2 CD EE FB    		 CALL POLY ;	;
1748)   FCB5 21 00 01    		 LD HL FACC	;
1749)   FCB8 D1          		 POP DE ;	;
1750)   FCB9 CB 2B       		 SRA E ;	;
1751)   FCBB FA D9 FC    		 JP M EXP4 ;	;
1752)   FCBE 28 19       		 JR Z EXP4 ;	;
1753)   FCC0 7A          		 LD A D ;	;
1754)   FCC1 E6 07       		 AND 07H ;	;
1755)   FCC3 47          		 LD B A ;	;
1756)   FCC4 28 07       		 JR Z EXP3 ;	;
1757)   FCC6 C5          		EXP2 PUSH BC	;
1758)   FCC7 CD 43 F6    		 CALL DFACC	;
1759)   FCCA C1          		 POP BC	;
1760)   FCCB 10 F9       		 DJNZ EXP2 ;	;
1761)   FCCD 7A          		EXP3 LD A D ;	;
1762)   FCCE CB 2B       		 SRA E ;	;
1763)   FCD0 CB 2B       		 SRA E ;	;
1764)   FCD2 1F          		 RRA ;	;
1765)   FCD3 CB 3F       		 SRL A ;	;
1766)   FCD5 CB 87       		 RES 0 A ;	;
1767)   FCD7 86          		 ADD A (HL) ;	;
1768)   FCD8 77          		 LD (HL) A ;	;
1769)   FCD9 F1          		EXP4 POP AF ;	;
1770)   FCDA DA 1A F8    		 JP C RECIP	;
1771)   FCDD AF          		 XOR A ;	;
1772)   FCDE C9          		 RET ;	;
1777)   FCDF C3 3E F2    		SQRT1: JP SQRT	;
1779)   FCE2 73          		SQRT2 LD (HL),E ;so exponent = 0	;so exponent = 0
1780)   FCE3 2E 09       		 LD L,EXPSTO	;
1781)   FCE5 CB 47       		 BIT 0,A	;
1782)   FCE7 28 02       		 JR Z EXPEVEN	;
1783)   FCE9 3C          		 INC A	;
1784)   FCEA 1D          		 DEC E	;
1785)   FCEB 77          		EXPEVEN LD (HL),A	;
1786)   FCEC 2D          		 DEC L ;point at ARGPTR	;point at ARGPTR
1787)   FCED 73          		 LD (HL),E	;
1788)   FCEE 2D          		 DEC L	;
1789)   FCEF 36 31       		 LD (HL),49 ;initialise bit counter	;initialise bit counter
1790)   FCF1 4C          		 LD C,H ;initial value for Y-register	;initial value for Y-register
1791)   FCF2 06 2F       		 LD B,47 ;loop counter	;loop counter
1794)   FCF4 C5          		 PUSH BC	;
1795)   FCF5 06 02       		 LD B,2	;
1796)   FCF7 B7          		SQSHLP OR A ;clear CY in case JR OVER taken	;clear CY in case JR OVER taken
1797)   FCF8 2E 07       		 LD L,BITCNT ;;so HL ==> bit count	;;so HL ==> bit count
1798)   FCFA 7E          		 LD A,(HL)	;
1799)   FCFB 3D          		 DEC A	;
1800)   FCFC 28 0A       		 JR Z OVER ;if all bits of FACC used up	;if all bits of FACC used up
1801)   FCFE 77          		 LD (HL),A ;replace updated bit count	;replace updated bit count
1802)   FCFF E6 07       		 AND 7	;
1803)   FD01 23          		 INC HL ;so HL ==> ARGPTR	;so HL ==> ARGPTR
1804)   FD02 20 01       		 JR NZ NOTNEXT	;
1805)   FD04 34          		 INC (HL) ;move onto next byte of FACC	;move onto next byte of FACC
1806)   FD05 6E          		NOTNEXT LD L,(HL) ;so HL = pointer to byte of FACC	;so HL = pointer to byte of FACC
1807)   FD06 CB 16       		 RL (HL) ;get next bit to CY	;get next bit to CY
1808)   FD08 2E 15       		OVER LD L,XREG+5	;
1809)   FD0A CD 42 E3    		 CALL SHLREG ;shift left register	;shift left register
1810)   FD0D 10 E8       		 DJNZ SQSHLP ;do it again	;do it again
1813)   FD0F 2E 0F       		 LD L,YREG+5	;
1814)   FD11 CD 42 E3    		 CALL SHLREG	;
1815)   FD14 2E 0F       		 LD L,YREG+5	;
1816)   FD16 7E          		 LD A,(HL)	;
1817)   FD17 E6 F8       		 AND 0F8H	;
1818)   FD19 B1          		 OR C	;
1819)   FD1A 77          		 LD (HL),A	;
1821)   FD1B 2E 10       		 LD L,XREG	;
1822)   FD1D 1E 0A       		 LD E,YREG	;
1823)   FD1F 01 01 06    		 LD BC,6*256+1	;
1824)   FD22 1A          		CPLOOP LD A,(DE)	;
1825)   FD23 BE          		 CP (HL)	;
1826)   FD24 23          		 INC HL ;preserve Z flag	;preserve Z flag
1827)   FD25 13          		 INC DE ;and CY	;and CY
1828)   FD26 38 04       		 JR C GTE	;
1829)   FD28 20 12       		 JR NZ LESS	;
1830)   FD2A 10 F6       		 DJNZ CPLOOP	;
1831)   FD2C 0E 05       		GTE LD C,5 ;desired value in lower three bits	;desired value in lower three bits
1834)   FD2E 2E 0F       		 LD L,YREG+5	;
1835)   FD30 1E 15       		 LD E,XREG+5	;
1836)   FD32 06 06       		 LD B,6	;
1837)   FD34 B7          		 OR A	;
1838)   FD35 1A          		SBLP LD A,(DE)	;
1839)   FD36 9E          		 SBC A,(HL)	;
1840)   FD37 12          		 LD (DE),A	;
1841)   FD38 1D          		 DEC E	;
1842)   FD39 2D          		 DEC L	;
1843)   FD3A 10 F9       		 DJNZ SBLP	;
1844)   FD3C F1          		LESS POP AF	;
1845)   FD3D 47          		 LD B,A	;
1846)   FD3E 10 B4       		 DJNZ SQLOOP	;
1849)   FD40 2E 09       		 LD L,EXPSTO	;
1850)   FD42 1E 00       		 LD E,FACC	;
1851)   FD44 01 07 00    		 LD BC,7	;
1852)   FD47 ED B0       		 LDIR	;
1853)   FD49 C3 A0 F5    		 JP NORM	;
1854)   FD4C 00          		 NOP ;spare byte	;spare byte
1862)   FD4D 21 01 01    		ATAN LD HL FACC+1	;
1863)   FD50 7E          		 LD A (HL) ;	;
1864)   FD51 B7          		 OR A ;	;
1865)   FD52 CA CC F5    		 JP Z STOZ	;
1866)   FD55 2D          		 DEC L ;	;
1867)   FD56 7E          		 LD A (HL) ;	;
1868)   FD57 CB 86       		 RES 0 (HL) ;	;
1869)   FD59 CB 47       		 BIT 0 A ;	;
1870)   FD5B F5          		 PUSH AF ;	;
1871)   FD5C D6 02       		 SUB 2 ;	;
1872)   FD5E FE 7E       		 CP 7EH ;	;
1873)   FD60 F5          		 PUSH AF ;	;
1874)   FD61 DC 1A F8    		 CALL C RECIP	;
1875)   FD64 11 B8 FF    		 LD DE TB4995 ;	;
1876)   FD67 CD 70 FC    		 CALL PREP ;	;
1877)   FD6A F1          		 POP AF ;	;
1878)   FD6B DC 4D F6    		 CALL C SBSR1	;
1879)   FD6E F1          		 POP AF ;	;
1880)   FD6F C4 01 F6    		 CALL NZ NEG	;
1881)   FD72 C3 8E F5    		 JP STO	;
1885)   FD75 21 01 01    		LOG LD HL FACC+1 ;	;
1886)   FD78 7E          		 LD A (HL) ;	;
1887)   FD79 95          		 SUB L ;	;
1888)   FD7A D8          		 RET C ;	;
1889)   FD7B 2D          		 DEC L ;	;
1890)   FD7C AF          		 XOR A ;	;
1891)   FD7D 5E          		 LD E (HL) ;	;
1892)   FD7E 77          		 LD (HL) A ;	;
1893)   FD7F CB 2B       		 SRA E ;	;
1894)   FD81 D8          		 RET C ;	;
1895)   FD82 CB 23       		 SLA E ;	;
1896)   FD84 9D          		 SBC A L ;	;
1897)   FD85 57          		 LD D A ;	;
1898)   FD86 D5          		 PUSH DE ;	;
1899)   FD87 5D          		 LD E L ;	;
1900)   FD88 55          		 LD D L ;	;
1901)   FD89 2C          		LOG1 INC L ;	;
1902)   FD8A CB 7E       		 BIT 7 (HL) ;	;
1903)   FD8C 20 06       		 JR NZ LOG2 ;	;
1904)   FD8E CD 43 F6    		 CALL DFACC	;
1905)   FD91 1C          		 INC E ;	;
1906)   FD92 18 F5       		 JR LOG1 ;	;
1908)   FD94 D5          		LOG2 PUSH DE ;	;
1909)   FD95 CD 14 F6    		 CALL STF4	;
1910)   FD98 11 13 FF    		 LD DE C1DSR2 ;	;
1911)   FD9B D5          		 PUSH DE ;	;
1912)   FD9C CD 5C F6    		 CALL ADD	;
1913)   FD9F 1E 23       		 LD E T4-FH	;
1914)   FDA1 CD 08 F7    		 CALL EXT1F	;
1915)   FDA4 D1          		 POP DE ;	;
1916)   FDA5 CD 61 F6    		 CALL SUB	;
1917)   FDA8 1E 23       		 LD E T4-FH	;
1918)   FDAA CD 25 F8    		 CALL DIV	;
1919)   FDAD 11 80 FF    		 LD DE TB2663 ;	;
1920)   FDB0 CD 70 FC    		 CALL PREP ;	;
1921)   FDB3 CD 14 F6    		 CALL STF4	;
1922)   FDB6 D1          		 POP DE ;	;
1923)   FDB7 E1          		 POP HL ;	;
1924)   FDB8 29          		 ADD HL HL ;	;
1925)   FDB9 29          		 ADD HL HL ;	;
1926)   FDBA AF          		 XOR A ;	;
1927)   FDBB ED 52       		 SBC HL DE ;	;
1928)   FDBD F5          		 PUSH AF ;	;
1929)   FDBE F2 C7 FD    		 JP P LOG3 ;	;
1930)   FDC1 AF          		 XOR A ;	;
1931)   FDC2 EB          		 EX DE HL ;	;
1932)   FDC3 67          		 LD H A ;	;
1933)   FDC4 6F          		 LD L A ;	;
1934)   FDC5 ED 52       		 SBC HL DE ;	;
1935)   FDC7 EB          		LOG3 EX DE HL ;	;
1936)   FDC8 CD E2 FB    		 CALL FLT	;
1937)   FDCB F1          		 POP AF ;	;
1938)   FDCC FC 01 F6    		 CALL M NEG	;
1939)   FDCF 11 01 FF    		 LD DE CHALF	;
1940)   FDD2 CD 61 F6    		 CALL SUB	;
1941)   FDD5 11 FB FE    		 LD DE CLN2	;
1942)   FDD8 CD 14 F7    		 CALL MULT	;
1943)   FDDB 1E 23       		 LD E T4-FH	;
1944)   FDDD CD 5C F6    		 CALL ADD	;
1945)   FDE0 7E          		 LD A (HL) ;	;
1946)   FDE1 FE F8       		 CP 0F8H ;	;
1947)   FDE3 CA CC F5    		OZTRY JP Z STOZ	;
1948)   FDE6 C3 8E F5    		 JP STO ;	;
1953)   FDE9 D5          		RAISE: PUSH DE	;
1954)   FDEA EB          		 EX DE,HL ;POWER ?	;POWER ?
1955)   FDEB CD 3B F5    		 CALL CKINT ;INTEGER ?	;INTEGER ?
1956)   FDEE 20 20       		 JR NZ,RS2 ;NO	;NO
1957)   FDF0 7B          		 LD A,E	;
1958)   FDF1 FE 20       		 CP 32 ;YES - <32 ?	;YES - <32 ?
1959)   FDF3 30 1B       		 JR NC,RS2 ;NO	;NO
1960)   FDF5 42          		RS3: LD B,D ;YES	;YES
1961)   FDF6 4B          		 LD C,E	;
1962)   FDF7 CD 14 F6    		 CALL STF4	;
1963)   FDFA E5          		 PUSH HL	;
1964)   FDFB 21 E9 FE    		 LD HL,CE0 ;FACC=1	;FACC=1
1965)   FDFE CD 09 F6    		 CALL LDF	;
1966)   FE01 D1          		 POP DE	;
1967)   FE02 E1          		 POP HL ;D,E=(ARG)	;D,E=(ARG)
1968)   FE03 0D          		RS5: DEC C ;DONE ?	;DONE ?
1969)   FE04 FA 8E F5    		 JP M,STO ;YES - EXIT	;YES - EXIT
1970)   FE07 D5          		 PUSH DE	;
1971)   FE08 68          		 LD L,B	;
1972)   FE09 CD F2 F7    		 CALL MORD ;* OR /	;* OR /
1973)   FE0C D1          		 POP DE	;
1974)   FE0D D8          		 RET C	;
1975)   FE0E 18 F3       		 JR RS5 ;DO NXT	;DO NXT
1976)   FE10 21 01 01    		RS2: LD HL,FACC+1 ;MUST DO BY LOG-EXP	;MUST DO BY LOG-EXP
1977)   FE13 7E          		 LD A,(HL)	;
1978)   FE14 B7          		 OR A	;
1979)   FE15 2B          		 DEC HL	;
1980)   FE16 D1          		 POP DE	;
1981)   FE17 CA CC F5    		 JP Z,STOZ	;
1982)   FE1A D5          		 PUSH DE	;
1983)   FE1B CD 75 FD    		 CALL LOG ;LOG	;LOG
1984)   FE1E D1          		 POP DE	;
1985)   FE1F D8          		 RET C ;AS OFLO	;AS OFLO
1986)   FE20 CD 14 F7    		 CALL MULT ;*POWER	;*POWER
1987)   FE23 D8          		 RET C ;AS OFLO	;AS OFLO
1988)   FE24 C3 8A FC    		 JP EXP ;EXP AND EXIT	;EXP AND EXIT
1993)   FE27 12          		RA: DEFB 18	;
1994)   FE28 B9          		 DEFB 185	;
1995)   FE29 B0          		 DEFB 176	;
1996)   FE2A B5          		 DEFB 181	;
1998)   FE2B 36          		FRC: DEFB 54	;
1999)   FE2C 19          		 DEFB 25	;
2000)   FE2D 62          		 DEFB 98	;
2001)   FE2E E9          		 DEFB 233	;
2003)   FE2F CD E2 F7    		RND: CALL CL20 ;CLR FACC,T1	;CLR FACC,T1
2004)   FE32 11 08 01    		 LD DE,T1+1 ;LAST RND TO T1	;LAST RND TO T1
2005)   FE35 21 37 01    		 LD HL,RANDNO	;
2006)   FE38 E5          		 PUSH HL	;
2007)   FE39 01 04 00    		 LD BC,4	;
2008)   FE3C C5          		 PUSH BC	;
2009)   FE3D ED B0       		 LDIR	;
2010)   FE3F 21 27 FE    		 LD HL,RA ;NOW MULT BY RA	;NOW MULT BY RA
2011)   FE42 0E 04       		 LD C,4 ;4 BYTES	;4 BYTES
2012)   FE44 E5          		RND2: PUSH HL	;
2013)   FE45 7E          		 LD A,(HL)	;
2014)   FE46 06 08       		 LD B,8 ;8 BITS / BYTE	;8 BITS / BYTE
2015)   FE48 C5          		RND1: PUSH BC	;
2016)   FE49 F5          		 PUSH AF	;
2017)   FE4A 21 04 01    		 LD HL,FACC+4	;
2018)   FE4D AF          		 XOR A	;
2019)   FE4E CD 0D F8    		 CALL SQSH5B	;
2020)   FE51 F1          		 POP AF ;ADD ?	;ADD ?
2021)   FE52 07          		 RLCA	;
2022)   FE53 F5          		 PUSH AF	;
2023)   FE54 DC 56 F5    		 CALL C,FLADD ;YES	;YES
2024)   FE57 F1          		 POP AF	;
2025)   FE58 C1          		 POP BC	;
2026)   FE59 10 ED       		 DJNZ RND1 ;DO NXT BIT	;DO NXT BIT
2027)   FE5B E1          		 POP HL	;
2028)   FE5C 23          		 INC HL	;
2029)   FE5D 0D          		 DEC C	;
2030)   FE5E 20 E4       		 JR NZ,RND2 ;DO NXT BYTE	;DO NXT BYTE
2031)   FE60 21 04 01    		 LD HL,FACC+4 ;NOW ADD RC	;NOW ADD RC
2032)   FE63 11 2E FE    		 LD DE,FRC+3	;
2033)   FE66 06 04       		 LD B,4	;
2034)   FE68 CD 5C F5    		 CALL FLA3	;
2035)   FE6B 23          		 INC HL ;STO IN RAND NO	;STO IN RAND NO
2036)   FE6C C1          		 POP BC	;
2037)   FE6D D1          		 POP DE	;
2038)   FE6E ED B0       		 LDIR	;
2039)   FE70 C3 A0 F5    		 JP NORM ;NORMALISE	;NORMALISE
2047)   FE73 21 00 01    		CAL1: LD HL,FACC	;
2048)   FE76 4E          		 LD C,(HL)	;
2049)   FE77 C5          		 PUSH BC	;
2050)   FE78 CB 86       		 RES 0,(HL) ;MAKE +VE	;MAKE +VE
2051)   FE7A E5          		 PUSH HL	;
2052)   FE7B CD 14 F6    		 CALL STF4 ;STO IN T4	;STO IN T4
2053)   FE7E D1          		 POP DE	;
2054)   FE7F CD 14 F7    		 CALL MULT ;*	;*
2055)   FE82 D4 52 F6    		 CALL NC SBSR2 ;1-	;1-
2056)   FE85 D4 3E F2    		 CALL NC SQRT ;SQRT	;SQRT
2057)   FE88 C1          		 POP BC ;AS C= ORIG SIGN	;AS C= ORIG SIGN
2058)   FE89 C9          		 RET	;
2062)   FE8A C5          		CAL2: PUSH BC	;
2063)   FE8B 11 23 01    		 LD DE,T4 ;Y/X	;Y/X
2064)   FE8E CD 25 F8    		 CALL DIV ;	;
2065)   FE91 23          		 INC HL ;ARG=0 ?	;ARG=0 ?
2066)   FE92 30 05       		 JR NC,CAL2B ;	;
2067)   FE94 36 00       		 LD (HL),0 ;YES	;YES
2068)   FE96 2B          		 DEC HL	;
2069)   FE97 18 11       		 JR CAL2A	;
2070)   FE99 7E          		CAL2B: LD A,(HL) ;ARG=1 ?	;ARG=1 ?
2071)   FE9A B7          		 OR A	;
2072)   FE9B 2B          		 DEC HL	;
2073)   FE9C 28 09       		 JR Z,CAL2C	;
2074)   FE9E 7E          		 LD A,(HL) ;X < Y ?	;X < Y ?
2075)   FE9F D6 02       		 SUB 2	;
2076)   FEA1 F2 B1 FE    		 JP P,XLY ;YES	;YES
2077)   FEA4 CD 4D FD    		 CALL ATAN ;NO - ATAN(Y/X)	;NO - ATAN(Y/X)
2078)   FEA7 CD 4D F6    		CAL2C: CALL SBSR1 ;FACC=PI/2-FACC	;FACC=PI/2-FACC
2079)   FEAA C1          		CAL2A: POP BC ;SIGN OF ORIG NUM	;SIGN OF ORIG NUM
2080)   FEAB 79          		 LD A,C	;
2081)   FEAC E6 01       		 AND 1 ;-VE - INV FACC	;-VE - INV FACC
2082)   FEAE AE          		 XOR (HL)	;
2083)   FEAF 77          		 LD (HL),A	;
2084)   FEB0 C9          		 RET	;
2085)   FEB1 CD 1A F8    		XLY: CALL RECIP ;AS ATAN(X/Y)	;AS ATAN(X/Y)
2086)   FEB4 CD 4D FD    		 CALL ATAN	;
2087)   FEB7 18 F1       		 JR CAL2A	;
2092)   FEB9 CD 73 FE    		ASIN: CALL CAL1	;
2093)   FEBC D8          		 RET C	;
2094)   FEBD 18 CB       		 JR CAL2	;
2098)   FEBF CD 73 FE    		ACOS: CALL CAL1	;
2099)   FEC2 D8          		 RET C	;
2100)   FEC3 C5          		 PUSH BC	;
2101)   FEC4 11 23 01    		 LD DE,T4 ;SWOP T4 AND FACC	;SWOP T4 AND FACC
2102)   FEC7 CD 08 F7    		 CALL EXT1F	;
2103)   FECA C1          		 POP BC	;
2104)   FECB CD 8A FE    		 CALL CAL2	;
2105)   FECE CB 41       		 BIT 0,C ;ORIG NUM ?	;ORIG NUM ?
2106)   FED0 C8          		 RET Z ;+VE	;+VE
2107)   FED1 11 EF FE    		 LD DE,FCPI ;-VE SO ADD PI	;-VE SO ADD PI
2108)   FED4 C3 5C F6    		 JP ADD	;
2112)   FED7 21 00 01    		TAN: LD HL,FACC ;TO T5	;TO T5
2113)   FEDA CD 1F F6    		 CALL PUSHF	;
2114)   FEDD CD 40 FC    		 CALL COS	;
2116)   FEE0 CD 08 F7    		 CALL EXT1F	;
2117)   FEE3 CD 43 FC    		 CALL SIN	;
2119)   FEE6 C3 25 F8    		 JP DIV	;
2124)   FEE9 02 01 00 00 		CE0: DEFB 2,1,0,0,0,0 ;1	;1
2124)   FEED 00 00       		CE0: DEFB 2,1,0,0,0,0 ;1	;1
2125)   FEEF 02 03 24 3F 		FCPI: DEFB 2,3,36,63,106,137 ;PI	;PI
2125)   FEF3 6A 89       		FCPI: DEFB 2,3,36,63,106,137 ;PI	;PI
2126)   FEF5 00 A2 F9 83 		C2DPI: DEFB 0,162,249,131,110,78 ;2/PI	;2/PI
2126)   FEF9 6E 4E       		C2DPI: DEFB 0,162,249,131,110,78 ;2/PI	;2/PI
2127)   FEFB 00 B1 72 17 		CLN2: DEFB 0,177,114,23,247,210 ;LN(2)	;LN(2)
2127)   FEFF F7 D2       		CLN2: DEFB 0,177,114,23,247,210 ;LN(2)	;LN(2)
2128)   FF01 00 80 00 00 		CHALF: DEFB 0,128,0,0,0,0 ;0.5	;0.5
2128)   FF05 00 00       		CHALF: DEFB 0,128,0,0,0,0 ;0.5	;0.5
2129)   FF07 02 01 92 1F 		CPID2: DEFB 2,1,146,31,181,68 ;PI/2	;PI/2
2129)   FF0B B5 44       		CPID2: DEFB 2,1,146,31,181,68 ;PI/2	;PI/2
2130)   FF0D 02 01 71 54 		C1DLN2 DEFB 002H,1,113,84,118,83 ;1/LN2	;1/LN2
2130)   FF11 76 53       		C1DLN2 DEFB 002H,1,113,84,118,83 ;1/LN2	;1/LN2
2131)   FF13 00 B5 04 F3 		C1DSR2 DEFB 000H,181,4,243,51,250 ;2^-.5	;2^-.5
2131)   FF17 33 FA       		C1DSR2 DEFB 000H,181,4,243,51,250 ;2^-.5	;2^-.5
2137)   FF19 F0 2F 39 42 		CEM20 DEFB 0F0H,2FH,39H,42H,19H,26H ;10**-20	;10**-20
2137)   FF1D 19 26       		CEM20 DEFB 0F0H,2FH,39H,42H,19H,26H ;10**-20	;10**-20
2138)   FF1F FE 06 8D B8 		CEM4 DEFB 0FEH,06H,8DH,0B8H,0BAH,0C7H;10**-4	;10**-4
2138)   FF23 BA C7       		CEM4 DEFB 0FEH,06H,8DH,0B8H,0BAH,0C7H;10**-4	;10**-4
2139)   FF25 00 19 99 99 		CEM1 DEFB 00H,19H,99H,99H,99H,99H ;10**-1	;10**-1
2139)   FF29 99 99       		CEM1 DEFB 00H,19H,99H,99H,99H,99H ;10**-1	;10**-1
2140)   FF2B 12 05 6B C7 		CE20: DEFB 18,5,107,199,94,45 ;10**20	;10**20
2140)   FF2F 5E 2D       		CE20: DEFB 18,5,107,199,94,45 ;10**20	;10**20
2141)   FF31 04 27 10 00 		CE4: DEFB 4,39,16,0,0,0 ;10**4	;10**4
2141)   FF35 00 00       		CE4: DEFB 4,39,16,0,0,0 ;10**4	;10**4
2142)   FF37 02 0A 00 00 		CE1: DEFB 2,10,0,0,0,0 ;10**1	;10**1
2142)   FF3B 00 00       		CE1: DEFB 2,10,0,0,0,0 ;10**1	;10**1
2146)   FF3D 0B 1F 18 87 		TB132 DEFB 0BH,31,24,135 ;C4	;C4
2147)   FF41 03 80 44 4A 		 DEFB 03H,128,68,74 ;C3	;C3
2148)   FF45 0B E8 C9 43 		 DEFB 0BH,232,201,67 ;C2	;C2
2149)   FF49 13 01 4C F9 		 DEFB 13H,1,76,249 ;C1	;C1
2150)   FF4D 03 3A A4 55 		 DEFB 03H,58,164,85,0 ;C0	;C0
2150)   FF51 00          		 DEFB 03H,58,164,85,0 ;C0	;C0
2151)   FF52 F4 01 68 B0 		TB1044 DEFB 0F4H,1,104,176,125 ;E7	;E7
2151)   FF56 7D          		TB1044 DEFB 0F4H,1,104,176,125 ;E7	;E7
2152)   FF57 F4 09 67 EB 		 DEFB 0F4H,9,103,235,50 ;E6	;E6
2152)   FF5B 32          		 DEFB 0F4H,9,103,235,50 ;E6	;E6
2153)   FF5C F4 57 F7 71 		 DEFB 0F4H,87,247,113,194 ;E5	;E5
2153)   FF60 C2          		 DEFB 0F4H,87,247,113,194 ;E5	;E5
2154)   FF61 05 02 76 10 		 DEFB 005H,2,118,16,112,166 ;E4	;E4
2154)   FF65 70 A6       		 DEFB 005H,2,118,16,112,166 ;E4	;E4
2155)   FF67 05 0E 35 95 		 DEFB 005H,14,53,149,128,159 ;E3	;E3
2155)   FF6B 80 9F       		 DEFB 005H,14,53,149,128,159 ;E3	;E3
2156)   FF6D 05 3D 7F 79 		 DEFB 005H,61,127,121,241,146 ;E2	;E2
2156)   FF71 F1 92       		 DEFB 005H,61,127,121,241,146 ;E2	;E2
2157)   FF73 05 B1 72 18 		 DEFB 005H,177,114,24,15,139 ;E1	;E1
2157)   FF77 0F 8B       		 DEFB 005H,177,114,24,15,139 ;E1	;E1
2158)   FF79 05 FF FF FF 		 DEFB 005H,255,255,255,255,212,0 ;E0	;E0
2158)   FF7D FF D4 00    		 DEFB 005H,255,255,255,255,212,0 ;E0	;E0
2160)   FF80 03 3C D4 F7 		TB2663 DEFB 003H,60,212,247 ;L4	;L4
2161)   FF84 03 49 06 65 		 DEFB 003H,73,6,101  ;L3	;L3
2162)   FF88 04 66 66 CA 		 DEFB 004H,102,102,202,184 ;L2	;L2
2162)   FF8C B8          		 DEFB 004H,102,102,202,184 ;L2	;L2
2163)   FF8D 05 AA AA AA 		 DEFB 005H,170,170,170,34,234 ;L1	;L1
2163)   FF91 22 EA       		 DEFB 005H,170,170,170,34,234 ;L1	;L1
2164)   FF93 11 02 00    		 DEFB 011H,2,0   ;L0	;L0
2165)   FF96 EB 39 86 8C 		TB3342 DEFB 0EBH,57,134,140 ;S5	;S5
2166)   FF9A F4 0A 80 7F 		 DEFB 0F4H,10,128,127,192 ;S4 	;S4
2166)   FF9E C0          		 DEFB 0F4H,10,128,127,192 ;S4 	;S4
2167)   FF9F 0D 01 32 D1 		 DEFB 00DH,1,50,209,18, 1 ;S3	;S3
2167)   FFA3 12 01       		 DEFB 00DH,1,50,209,18, 1 ;S3	;S3
2168)   FFA5 05 14 66 BB 		 DEFB 005H,20,102,187,252,37 ;S2	;S2
2168)   FFA9 FC 25       		 DEFB 005H,20,102,187,252,37 ;S2	;S2
2169)   FFAB 0D A5 5D E7 		 DEFB 00DH,165,93,231,39,140 ;S1	;S1
2169)   FFAF 27 8C       		 DEFB 00DH,165,93,231,39,140 ;S1	;S1
2170)   FFB1 15 01 92 1F 		 DEFB 015H,1,146,31,181,68,0 ;S0	;S0
2170)   FFB5 B5 44 00    		 DEFB 015H,1,146,31,181,68,0 ;S0	;S0
2171)   FFB8 FC 2C E0 EF 		TB4995 DEFB 0FCH,44,224,239,117 ;A11	;A11
2171)   FFBC 75          		TB4995 DEFB 0FCH,44,224,239,117 ;A11	;A11
2172)   FFBD 05 01 3D E9 		 DEFB 005H,1,61,233,77,234 ;A10	;A10
2172)   FFC1 4D EA       		 DEFB 005H,1,61,233,77,234 ;A10	;A10
2173)   FFC3 0D 04 1F E5 		 DEFB 00DH,4,31,229,128,128 ;A9	;A9
2173)   FFC7 80 80       		 DEFB 00DH,4,31,229,128,128 ;A9	;A9
2174)   FFC9 05 08 C1 F6 		 DEFB 005H,8,193,246,124,164 ;A8	;A8
2174)   FFCD 7C A4       		 DEFB 005H,8,193,246,124,164 ;A8	;A8
2175)   FFCF 0D 0D E5 3C 		 DEFB 00DH,13,229,60,188,1 ;A7	;A7
2175)   FFD3 BC 01       		 DEFB 00DH,13,229,60,188,1 ;A7	;A7
2176)   FFD5 05 12 8C 8E 		 DEFB 005H,18,140,142,9,127 ;A6	;A6
2176)   FFD9 09 7F       		 DEFB 005H,18,140,142,9,127 ;A6	;A6
2177)   FFDB 0D 16 FD 4A 		 DEFB 00DH,22,253,74,47,64 ;A5	;A5
2177)   FFDF 2F 40       		 DEFB 00DH,22,253,74,47,64 ;A5	;A5
2178)   FFE1 05 1C 66 11 		 DEFB 005H,28,102,17,15,182 ;A4	;A4
2178)   FFE5 0F B6       		 DEFB 005H,28,102,17,15,182 ;A4	;A4
2179)   FFE7 0D 24 91 26 		 DEFB 00DH,36,145,38,78,135 ;A3	;A3
2179)   FFEB 4E 87       		 DEFB 00DH,36,145,38,78,135 ;A3	;A3
2180)   FFED 05 33 33 24 		 DEFB 005H,51,51,36,113,218 ;A2	;A2
2180)   FFF1 71 DA       		 DEFB 005H,51,51,36,113,218 ;A2	;A2
2181)   FFF3 0D 55 55 55 		 DEFB 00DH,85,85,85,9,167 ;A1	;A1
2181)   FFF7 09 A7       		 DEFB 00DH,85,85,85,9,167 ;A1	;A1
2182)   FFF9 05 FF FF FF 		 DEFB 005H,255,255,255,255,191,0 ;A0	;A0
2182)   FFFD FF BF 00    		 DEFB 005H,255,255,255,255,191,0 ;A0	;A0
