                GLOBAL GTNBKEY
                GLOBAL NBLOOK


GTNBKEY:	;CALL GTKEY             ;GET A KEY FROM KEYBOARD
		CP 0
		RET Z
		CALL NBLOOKASC
		RET

;A THE ASCII CODE TO TRANSLATE
NBLOOK:		LD HL, NBTAB
		LD B, 0
		LD C, A
		ADD HL, BC
		LD A, (HL)
		CP 0
		RET Z
		LD HL, KEYCTR 							;BIT 6=SHIFT BIT 7=CTRL  BIT 6+7=GRPH
		BIT 5, (HL)
		JR Z, NOGRPH
		LD B, 192 							;SET BIT 6 AND 7
		JR NBLKEX
NOGRPH:		LD C, A
		LD A, (HL)
		AND 11000000
		LD B, A
		LD A, C
NBLKEX:		OR B
		RET
		
NBTAB:		DB 0,0,0,0,0,0,0,0,0,0 						;  0-  9
		DB 0,0,0,36+128,0,0,0,0,0,0 					; 10- 19	0,0,0,TAB
		DB 0,14,9,0,0,0,60,45,46,13 					; 20- 29
		DB 8,0,0,58,59,44,12,6,7,0 					; 30- 39
		DB 0,15,57,43,10,11,5,0,0,52 					; 40- 49
		DB 56,41,42,37,4,0,0,0,53,51 					; 50- 59
		DB 35,3,19,0,0,54,62,36,38,21 					; 60- 69
		DB 20,0,0,55,47,39,40,26,28,0 					; 70- 79
		DB 0,0,67,0,86,27,0,0,0,0 					; 80- 89
		DB 30,0,0,0,0,0,0,0,0,0 					; 90- 99
		DB 0,0,64,0,0,26+128,0,2,63,0 					;100-109  0,0,64,0,0,END
		DB 0,0,61,37+128,34,0,18,50,31,25 				;110-119  0,0,INS,DEL
		DB 0,29,7,28,24,20,0,0,0,0 					;120-129

;NO SHIFT CONTROL GRAPH INFO WE GET AN ASCII AND TRANSLATE IT TO NB
NBLOOKASC:      LD HL, NBRSTAB
		LD B, 0
		LD C, A
		ADD HL, BC
		LD A, (HL)
		RET

;+64 MEANS SHIFT , +128 MEANS CONTROL ,  +192 MEANS GRAPHICS
NBRSTAB:      	DB 0,61,18+64,18,2,0,64,0,64,27+128				;  0-  9
		DB 34,50,0,30,0,0,0,0,0,0					; 10- 19	
		DB 0,0,0,0,0,0,0,31,28+128,29+128				; 20- 29
		DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64	       		; 30- 39  
		DB 22,23,24,29,54,28,55,47,21,9					; 40- 49
		DB 8,7,6,5,4,3,19,20,40+64,40 	        			; 50- 59
		DB 0,27,0,47+64,0,46+64,56+64,58+64,44+64,12+64			; 60- 69
		DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64	; 70- 79
		DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64	; 80- 89
		DB 60+64,22+64,92,23+64,0,0,0,46,56,58				; 90- 99
		DB 44,12,43,42,41,36,51,62,39,53				;100-109  
		DB 52,38,26,14,11,45,10,35,57,13       				;110-119  
		DB 59,37,60,0,0,0,0,0,0,0 	 				;120-129
                DB 0,0,0,0,0,0,0,0,0,0 						;130-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;140-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;150-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;160-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;170-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;180-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;190-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;200-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;210-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;220-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;230-  9
                DB 0,0,0,0,0,0,0,0,0,0 						;240-  9
                DB 0,0,0,0,0,0     						;250-  5
