 37)   007A 00          		 @SERERR DEFS 1       ;SERERR NOT USED BY SERIAL USED BY NBSETLCD	;SERERR NOT USED BY SERIAL USED BY NBSETLCD
 41)   007B 00          		 @LCDCX DEFS 1        ;DISPLAY X POS (0..F  FOR 1..16)	;DISPLAY X POS (0..F  FOR 1..16)
 42)   007C 00          		 @LCDCY DEFS 1        ;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)	;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)
 43)   007D 00          		 @LCD_DSPCTRL DEFS 1       ;LCD I2C 16X2	;LCD I2C 16X2
 44)   007E 00          		 @LCD_DSPMODE DEFS 1       ;LCD I2C 16X2	;LCD I2C 16X2
 45)   007F 00          		 @LCD_STSMASK DEFS 1       ;LCD I2C 16X2  	;LCD I2C 16X2
 47)   0080 00          		 @KEYCTR DEFS 1        ;IN NB SYSTEM VARS	;IN NB SYSTEM VARS
 48)   0081 00          		 @LASTKEY DEFS 1  ;LAST KEY PRESSED	;LAST KEY PRESSED
 50)   0082 00 00 00 00 		 @BANKS DEFS 8        ;8 PAGES FOR THE 8 BANKS 0..7	;8 PAGES FOR THE 8 BANKS 0..7
 50)   0086 00 00 00 00 		 @BANKS DEFS 8        ;8 PAGES FOR THE 8 BANKS 0..7	;8 PAGES FOR THE 8 BANKS 0..7
 52)   008A 00          		 @STRG_STAT DEFS 1       ;STORAGE_NEW STAUS BIT 0=0 NOT CONNECTED,1=CONNECTED,BIT 7 DEVICE EXISTS	;STORAGE_NEW STAUS BIT 0=0 NOT CONNECTED, 1=CONNECTED, BIT 7 DEVICE EXISTS
 53)   008B 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   008F 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   0093 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   0097 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   009B 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   009F 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   00A3 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 53)   00A7 00 00       		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 54)   00A9 	            		 @STRGBUFF EQU CHANCN       ;USED FOR DIRECTORY AND FILENAME	;USED FOR DIRECTORY AND FILENAME
 56)   00A9 	            		 @BUFFER EQU B2DBUF       ; 20 BYTE BUFFER FOR I2C USAGE  	; 20 BYTE BUFFER FOR I2C USAGE
 58)   00A9 00 00       		 @PRGEX DEFS 2        ;ONLY FOR BOOTL	;ONLY FOR BOOTL
 59)   00AB 00          		 TVSTAT DEFS 1	;
 60)   00AC 00 00       		 @LINESTR DEFS 2       ;ADDRESS OF LINEBUF FOR PRINTING ON STRING	;ADDRESS OF LINEBUF FOR PRINTING ON STRING
 61)   00AE 00          		 @LINEPOS DEFS 1	;
 62)   00AF 00 00 00 00 		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 62)   00B3 00 00 00 00 		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 62)   00B7 00 00 00 00 		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 62)   00BB 00          		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 63)   00BC 00 00 00 00 		 @NUMBUF DEFS 7    	;
 63)   00C0 00 00 00    		 @NUMBUF DEFS 7    	;
 64)   00C3 00 00 00 00 		 @B2DINV DEFS 8        ;BINARY NUMBER TO BE CONVERTED	;BINARY NUMBER TO BE CONVERTED
 64)   00C7 00 00 00 00 		 @B2DINV DEFS 8        ;BINARY NUMBER TO BE CONVERTED	;BINARY NUMBER TO BE CONVERTED
 65)   00CB 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 65)   00CF 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 65)   00D3 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 65)   00D7 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 65)   00DB 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 66)   00DF 00          		 @B2DEND DEFS 1        ;0 FOR TERMINATE THE STRING        	;0 FOR TERMINATE THE STRING
 71)   00E0 00 00       		@CHANDATA:     DEFS 2	;
 72)   00E2 00 00       		               DEFS 2	;
 73)   00E4 00 00       		               DEFS 2	;
 74)   00E6 00 00       		               DEFS 2	;
 76)   00E8 00 00       		@CHANDEL:      DEFS 2	;
 77)   00EA 00 00       		               DEFS 2	;
 78)   00EC 00 00       		               DEFS 2	;
 79)   00EE 00 00       		               DEFS 2	;
 81)   00F0 00          		@CHANCN:       DEFS 1	;
 82)   00F1 00          		               DEFS 1	;
 83)   00F2 00          		               DEFS 1	;
 84)   00F3 00          		               DEFS 1	;
 85)   00F4 00          		@CHANST:       DEFS 1    ;CHANNEL STATUS  BITS 0-3 SET MEANS DISABLED     	;CHANNEL STATUS  BITS 0-3 SET MEANS DISABLED
111)   8000 2F          		 CPL         ;ROM IS HERE	;ROM IS HERE
112)   8001 C3 BF 81    		 JP START	;
113)   8004 C3 5F 80    		 JP GETKEY        ;CALL HERE FROM NB ROM TO FIND THE GTNBKEY  $8004	;CALL HERE FROM NB ROM TO FIND THE GTNBKEY  $8004
114)   8007 C3 8F 80    		 JP RSTX        ; CALL HERE FROM NB TO FIND SERIAL TRASMIT  $8007	; CALL HERE FROM NB TO FIND SERIAL TRASMIT  $8007
115)   800A C3 93 80    		 JP RSRX        ; CALL HERE FROM NB TO FIND SERIAL RECEIVE  $800A	; CALL HERE FROM NB TO FIND SERIAL RECEIVE  $800A
116)   800D C3 A9 80    		 JP NBSTLCD        ;CALL HERE FROM NB TO FIND THE NBSETLCD $800D	;CALL HERE FROM NB TO FIND THE NBSETLCD $800D
117)   8010 C3 1B 82    		 JP MENU        ;$8010	;$8010
118)   8013 C3 4F 80    		 JP CHKKEY       ;CALL HERE FROM NB TO FIND THE CHKKEY $8013 RET NZ FOR KEY AVAIL	;CALL HERE FROM NB TO FIND THE CHKKEY $8013 RET NZ FOR KEY AVAIL
123)   8016 CD C2 8B    		@OS_PRINTCHAR: CALL RS_TX	;
124)   8019 C9          		 RET	;
128)   801A 7E          		@OS_PRINTTEXT: LD A, (HL)	;
129)   801B FE 00       		 CP 0	;
130)   801D C8          		 RET Z	;
131)   801E E5          		 PUSH HL	;
132)   801F CD 16 80    		 CALL OS_PRINTCHAR	;
133)   8022 E1          		 POP HL	;
134)   8023 23          		 INC HL	;
135)   8024 18 F4       		 JR OS_PRINTTEXT	;
138)   8026 E1          		@OS_PRINTMSG: POP HL	;
139)   8027 CD 1A 80    		 CALL OS_PRINTTEXT	;
140)   802A 23          		 INC HL	;
141)   802B E5          		 PUSH HL        ;CONTINUE AFTER THE MESG	;CONTINUE AFTER THE MESG
142)   802C C9          		 RET	;
148)   802D DF 3C       		@OS_PRCHSCR: DEFW WPTCHAR	;
149)   802F C9          		 RET	;
153)   8030 7E          		@OS_PRMESSCR:  LD A,(HL)	;
154)   8031 B7          		 OR A	;
155)   8032 C8          		 RET Z	;
156)   8033 DF 3C       		 DEFW WPTCHAR	;
157)   8035 23          		 INC HL	;
158)   8036 18 F8       		 JR OS_PRMESSCR	;
160)   8038 7E          		@OS_PRMESSCRSFE: LD A,(HL)	;
161)   8039 B7          		 OR A	;
162)   803A C8          		 RET Z	;
163)   803B FE 0A       		 CP $0A	;
164)   803D 28 04       		 JR Z,PMS_PRN	;
165)   803F FE 1F       		 CP 31 	;
166)   8041 38 04       		 JR C,PMS_SKP	;
167)   8043 DF 3C       		PMS_PRN: DEFW WPTCHAR	;
168)   8045 18 05       		 JR PMS_CNT	;
169)   8047 E5          		PMS_SKP:       PUSH HL	;
170)   8048 CD F2 80    		 CALL SOUTAS	;
171)   804B E1          		 POP HL	;
172)   804C 23          		PMS_CNT: INC HL	;
173)   804D 18 E9       		 JR OS_PRMESSCRSFE	;
177)   804F 47          		CHKKEY: LD B,A	;
178)   8050 CD 29 8C    		 CALL RS_KEYRD 	;
179)   8053 20 04       		 JR NZ, CK_EX       ;ZF SET IF NO KEY ON SERIAL	;ZF SET IF NO KEY ON SERIAL
180)   8055 DB 06       		 IN A,(6)	;
181)   8057 CB 5F       		 BIT 3,A        ;CHECK IF REAL KBD HAS AVAIL KEY, ZF SET IF NO KEY ON REAL KBD	;CHECK IF REAL KBD HAS AVAIL KEY, ZF SET IF NO KEY ON REAL KBD
182)   8059 78          		CK_EX: LD A,B	;
183)   805A 16 A0       		 LD D,$A0        ;DISPCOM 	;DISPCOM
184)   805C CB B6       		 RES 6,(HL)       ;KDATA= BIT 6 	;KDATA= BIT 6
185)   805E C9          		 RET	;
187)   805F D5          		GETKEY: PUSH DE	;
188)   8060 C5          		 PUSH BC	;
189)   8061 DD E5       		 PUSH IX	;
190)   8063 E5          		 PUSH HL	;
192)   8064 CD 5A 8A    		 CALL PS2KEYAVAIL       ;ZF=0 IF WE HAVE A KEY ELSE 1	;ZF=0 IF WE HAVE A KEY ELSE 1
193)   8067 20 05       		 JR NZ, KEYAVAIL       ;CHECK FOR SERIAL INPUT	;CHECK FOR SERIAL INPUT
194)   8069 CD 5F 8A    		 CALL READKBCHAR       ;READ KEY FROM PS/2	;READ KEY FROM PS/2
195)   806C 18 10       		 JR RGT        ;NB TRANSLATION AND EXIT	;NB TRANSLATION AND EXIT
197)   806E CD F9 8B    		KEYAVAIL: CALL RS_RX       ;GET A CHAR FROM RS232 OR PS2_KEYB	;GET A CHAR FROM RS232 OR PS2_KEYB
198)   8071 FE FE       		 CP 254        ;BREAK KEY	;BREAK KEY
199)   8073 20 09       		 JR NZ,RGT	;
205)   8075 21 3C 00    		 LD HL,COPST	;
206)   8078 36 66       		 LD (HL),102  ;SIMULATE BREAK	;SIMULATE BREAK
207)   807A 3E 19       		 LD A,$19 	;
208)   807C 18 03       		 JR KAEXIT	;
209)   807E CD A4 88    		RGT: CALL GTNBKEY        ;KEY PRESSED TRANSLATE FOR NB	;KEY PRESSED TRANSLATE FOR NB
218)   8081 E1          		KAEXIT: POP HL  	;
219)   8082 DD E1       		 POP IX	;
220)   8084 C1          		 POP BC	;
221)   8085 D1          		 POP DE 	;
222)   8086 FE 00       		 CP 0         ;CHECK IF INVALID KEY	;CHECK IF INVALID KEY
223)   8088 C0          		 RET NZ	;
224)   8089 CB B6       		 RES KDATA (HL)        ; KEY INVALID RESET KDATA TEST BIT	; KEY INVALID RESET KDATA TEST BIT
225)   808B 23          		 INC HL         ;GET TO THE LAST VALID KEY	;GET TO THE LAST VALID KEY
226)   808C 7E          		 LD A, (HL)	;
227)   808D 2B          		 DEC HL   	;
228)   808E C9          		 RET	;
230)   808F CD C2 8B    		RSTX: CALL RS_TX	;
231)   8092 C9          		 RET	;
233)   8093 CD F9 8B    		RSRX: CALL RS_RX	;
234)   8096 C9          		 RET	;
237)   8097 E5          		LCD16SETCURS:  PUSH HL	;
238)   8098 C5          		 PUSH BC	;
239)   8099 CD DC 94    		 CALL LCD16_SETCURS       ;SET LCD TO LCDCX,LCDCY	;SET LCD TO LCDCX,LCDCY
240)   809C C1          		 POP BC	;
241)   809D E1          		 POP HL	;
242)   809E C9          		 RET	;
244)   809F E5          		LCD16PRCHR: PUSH HL     ;OUTPUT CHAR TO LCD	;OUTPUT CHAR TO LCD
245)   80A0 C5          		 PUSH BC	;
246)   80A1 D5          		 PUSH DE	;
247)   80A2 CD CB 94    		 CALL LCD16_PRCHR	;
248)   80A5 D1          		 POP DE	;
249)   80A6 C1          		 POP BC	;
250)   80A7 E1          		 POP HL	;
251)   80A8 C9          		 RET	;
257)   80A9 D5          		NBSTLCD: PUSH DE	;
258)   80AA F5          		 PUSH AF	;
259)   80AB C5          		 PUSH BC	;
260)   80AC E5          		 PUSH HL	;
261)   80AD 21 7A 00    		 LD HL,SERERR	;
262)   80B0 35          		 DEC (HL)	;
263)   80B1 7E          		 LD A,(HL)	;
264)   80B2 B7          		 OR A	;
265)   80B3 28 05       		 JR Z, NBLSEND	;
266)   80B5 E1          		NBLEXIT:       POP HL	;
267)   80B6 C1          		 POP BC	;
268)   80B7 F1          		 POP AF	;
269)   80B8 D1          		 POP DE  	;
270)   80B9 C9          		 RET	;
272)   80BA 36 03       		NBLSEND: LD (HL),3         ;EVERY 5 TIMES SEND DATA TO LCD  	;EVERY 5 TIMES SEND DATA TO LCD
273)   80BC E1          		 POP HL	;
274)   80BD E5          		 PUSH HL	;
275)   80BE 42          		 LD B, D        ;TOTAL CHARS	;TOTAL CHARS
276)   80BF 05          		 DEC B	;
277)   80C0 05          		 DEC B         ;SKIP 2	;SKIP 2
278)   80C1 11 0F 00    		 LD DE, 15        ;START FROM THE END	;START FROM THE END
279)   80C4 19          		 ADD HL, DE	;
280)   80C5 AF          		 XOR A	;
281)   80C6 11 7B 00    		 LD DE, LCDCX        ;LCD POSITION	;LCD POSITION
282)   80C9 12          		 LD (DE), A	;
283)   80CA 13          		 INC DE	;
284)   80CB 12          		 LD (DE), A	;
286)   80CC D5          		 PUSH DE	;
287)   80CD 57          		 LD D, A	;
288)   80CE 5F          		 LD E, A	;
289)   80CF CD 97 80    		 CALL LCD16SETCURS       ;SET LCD TO LCDCX,LCDCY	;SET LCD TO LCDCX,LCDCY
290)   80D2 D1          		 POP DE	;
291)   80D3 1B          		 DEC DE         ;POSITION ON LCDCX	;POSITION ON LCDCX
292)   80D4 0E 00       		 LD C, 0        ;LCD POSITION COUNT	;LCD POSITION COUNT
293)   80D6 7E          		NBSETLP: LD A, (HL)	;
294)   80D7 CB 7F       		 BIT 7, A        ;CHECK IF CURSOR HERE	;CHECK IF CURSOR HERE
295)   80D9 28 06       		 JR Z, NBNXT	;
296)   80DB F5          		 PUSH AF	;
297)   80DC 79          		 LD A, C	;
298)   80DD 12          		 LD (DE), A        ;POSITION CURSOR	;POSITION CURSOR
299)   80DE F1          		 POP AF	;
300)   80DF CB BF       		 RES 7, A        ;CLEAR CHAR FROM CURSOR INFO	;CLEAR CHAR FROM CURSOR INFO
301)   80E1 CD 9F 80    		NBNXT: CALL LCD16PRCHR       ;OUTPUT CHAR TO LCD	;OUTPUT CHAR TO LCD
302)   80E4 2B          		 DEC HL	;
303)   80E5 0C          		 INC C	;
304)   80E6 10 EE       		 DJNZ NBSETLP        ;LOOP NEXT CHAR	;LOOP NEXT CHAR
305)   80E8 1A          		 LD A,(DE)	;
306)   80E9 57          		 LD D, A	;
307)   80EA 1E 00       		 LD E, 0	;
308)   80EC CD DC 94    		 CALL LCD16_SETCURS       ;POSITION CURSOR	;POSITION CURSOR
309)   80EF C3 B5 80    		 JP NBLEXIT	;
313)   80F2 F5          		SOUTAS: PUSH AF        ;SERIAL PRINT ASCII IN DECIMAL	;SERIAL PRINT ASCII IN DECIMAL
314)   80F3 26 00       		 LD H, 0	;
315)   80F5 6F          		 LD L, A	;
316)   80F6 11 AF 00    		 LD DE, MYNUM	;
317)   80F9 CD 5A 9B    		 CALL OUTASC	;
319)   80FC 3E 0A       		 LD A, 10	;
320)   80FE 12          		 LD (DE), A	;
321)   80FF 13          		 INC DE	;
322)   8100 3E 0D       		 LD A, 13	;
323)   8102 12          		 LD (DE), A	;
324)   8103 13          		 INC DE	;
325)   8104 AF          		 XOR A	;
326)   8105 12          		 LD (DE), A	;
328)   8106 21 AF 00    		 LD HL, MYNUM	;
329)   8109 CD D1 8B    		 CALL RS_TXT	;
330)   810C F1          		 POP AF	;
331)   810D C9          		 RET	;
334)   810E E5          		TVON: PUSH HL	;
335)   810F 21 AB 00    		 LD HL, TVSTAT	;
336)   8112 CB D6       		 SET 2, (HL)	;
337)   8114 21 24 00    		 LD HL, 36	;
338)   8117 CB D6       		 SET 2, (HL)	;
339)   8119 E1          		 POP HL	;
340)   811A 18 12       		 JR RESTV	;
343)   811C E5          		TVOFF: PUSH HL	;
344)   811D 21 AB 00    		 LD HL, TVSTAT	;
345)   8120 CB 96       		 RES 2, (HL)	;
346)   8122 21 24 00    		 LD HL, 36	;
347)   8125 CB 96       		 RES 2, (HL)	;
348)   8127 E1          		 POP HL	;
349)   8128 18 04       		 JR RESTV	;
352)   812A AF          		TVOFTM: XOR A         ;TV OFF	;TV OFF
353)   812B D3 07       		 OUT (7), A	;
354)   812D C9          		 RET	;
356)   812E E5          		RESTV: PUSH HL	;
357)   812F 21 AB 00    		 LD HL, TVSTAT	;
358)   8132 7E          		 LD A, (HL)	;
359)   8133 D3 07       		 OUT (7), A	;
360)   8135 3E 05       		 LD A, 5	;
361)   8137 D3 09       		 OUT (9), A        ; SET DISPLAY ADDRESS	; SET DISPLAY ADDRESS
362)   8139 E1          		 POP HL	;
363)   813A C9          		 RET	;
366)   813B 5C 43 48 53 		FONTNAME1 DEFM "\CHSET4.CHR"	;
366)   813F 45 54 34 2E 		FONTNAME1 DEFM "\CHSET4.CHR"	;
366)   8143 43 48 52    		FONTNAME1 DEFM "\CHSET4.CHR"	;
367)   8146 00          		 DB 0	;
368)   8147 5C 43 48 53 		FONTNAME2 DEFM "\CHSET2.CHR"	;
368)   814B 45 54 32 2E 		FONTNAME2 DEFM "\CHSET2.CHR"	;
368)   814F 43 48 52    		FONTNAME2 DEFM "\CHSET2.CHR"	;
369)   8152 00          		 DB 0	;
371)   8153 06 02       		LOADFONTS: LD B,2  ;BANK2	;BANK2
372)   8155 3E 08       		 LD A,8   ;VIDEO PAGE FOR FONTS   	;VIDEO PAGE FOR FONTS
373)   8157 CD 7E 8B    		 CALL PUTPGINBANK  	;
374)   815A 21 3B 81    		 LD HL,FONTNAME1	;
375)   815D 01 B8 0B    		 LD BC,3000  ;MAX FILE SIZE	;MAX FILE SIZE
376)   8160 11 00 40    		 LD DE,$4000  ;0000 ON PAGE 8	;0000 ON PAGE 8
377)   8163 CD 5D 8F    		 CALL STRG_LOADFILE	;
378)   8166 30 01       		 JR NC, LFFILOK	;
379)   8168 76          		 HALT   ;STOP EXEC	;STOP EXEC
380)   8169 21 47 81    		LFFILOK: LD HL,FONTNAME2	;
381)   816C 01 B8 0B    		 LD BC,3000  ;MAX FILE SIZE	;MAX FILE SIZE
382)   816F 11 00 50    		 LD DE,$5000  ;1000h ON PAGE 8	;1000h ON PAGE 8
383)   8172 CD 5D 8F    		 CALL STRG_LOADFILE  	;
384)   8175 30 01       		 JR NC, LFFILOK2	;
385)   8177 76          		 HALT   ;STOP EXEC	;STOP EXEC
386)   8178 3E 0E       		LFFILOK2: LD A,14  ;BANK 2 ON NBRAIN RESTORE PAGE 14	;BANK 2 ON NBRAIN RESTORE PAGE 14
387)   817A 06 02       		 LD B,2	;
388)   817C CD 7E 8B    		 CALL PUTPGINBANK	;
389)   817F C9          		 RET 	;
392)   8180 15 02 00 18 		SCRDATA DB        $15,$02,$00,$18,$18,$28,$40,$20	;
392)   8184 18 28 40 20 		SCRDATA DB        $15,$02,$00,$18,$18,$28,$40,$20	;
393)   8188 00 02 00 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
393)   818C 00 00 0A 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
393)   8190 00 00 FF 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
393)   8194 AB 00 00 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
394)   8198 00 B1       		 DB $00,$B1	;
396)   819A 21 80 81    		SETSCRDATA: LD HL,SCRDATA	;
397)   819D 11 68 02    		 LD DE,$268	;
398)   81A0 01 1A 00    		 LD BC,26	;
399)   81A3 ED B0       		 LDIR	;
400)   81A5 21 5C 00    		 LD HL,$5C	;
401)   81A8 36 68       		 LD (HL),$68  ;VIDEO START	;VIDEO START
402)   81AA 23          		 INC HL	;
403)   81AB 36 02       		 LD (HL),$02	;
404)   81AD C9          		 RET	;
407)   81AE E5          		BLPRNMES:   PUSH HL	;
408)   81AF CD D1 8B    		 CALL RS_TXT	;
409)   81B2 E1          		 POP HL	;
410)   81B3 11 F4 00    		 LD DE,CHANST	;
411)   81B6 1A          		 LD A,(DE)	;
412)   81B7 D5          		 PUSH DE	;
413)   81B8 CD DB 84    		 CALL SCPRN	;
414)   81BB D1          		 POP DE	;
415)   81BC EB          		 EX DE,HL	;
416)   81BD 34          		 INC (HL)  	;
417)   81BE C9          		 RET	;
421)   81BF F3          		START: DI	;
423)   81C0 CD 1C 81    		 CALL TVOFF	;
428)   81C3 CD 53 81    		 CALL LOADFONTS       ;LOAD NEWBRAIN FONTS TO VIDEO RAM	;LOAD NEWBRAIN FONTS TO VIDEO RAM
429)   81C6 CD 9A 81    		 CALL SETSCRDATA	;
430)   81C9 CD 9B 84    		 CALL SCCLS        ;CLEAR SCREEN BUFFER  	;CLEAR SCREEN BUFFER
431)   81CC 21 F4 00    		 LD HL,CHANST       ;LINE TO PRINT NEXT	;LINE TO PRINT NEXT
432)   81CF 36 00       		 LD (HL),0  	;
433)   81D1 21 7D 83    		 LD HL, STR02	;
434)   81D4 AF          		 XOR A	;
435)   81D5 CD DB 84    		 CALL SCPRN        ;PRINT WAITING AT SCREEN BUFFER	;PRINT WAITING AT SCREEN BUFFER
437)   81D8 CD 0E 81    		 CALL TVON  	;
440)   81DB 3E 01       		 LD A, 1        ;1=115200 BPS	;1=115200 BPS
441)   81DD CD A9 8B    		 CALL RS_INI        ;RS232 INITIALIZE	;RS232 INITIALIZE
442)   81E0 21 C6 83    		 LD HL, STR_CRIGHT	;
443)   81E3 CD AE 81    		 CALL BLPRNMES    	;
444)   81E6 21 4C 84    		 LD HL, STR_SERIAL	;
445)   81E9 CD AE 81    		 CALL BLPRNMES  	;
447)   81EC CD 54 8A    		 CALL PS2KBINIT  	;
448)   81EF 21 59 84    		 LD HL, STR_KEYB	;
449)   81F2 CD AE 81    		 CALL BLPRNMES  	;
451)   81F5 CD 06 93    		 CALL I2C_INIT	;
452)   81F8 CD E7 95    		 CALL DS1307_INIT       ;	;
453)   81FB 21 66 84    		 LD HL, STR_I2C	;
454)   81FE CD AE 81    		 CALL BLPRNMES  	;
456)   8201 CD 4D 94    		 CALL LCD16_INIT       ;LCD 16x2 Initialized	;LCD 16x2 Initialized
457)   8204 21 6D 83    		 LD HL, STR0	;
458)   8207 CD C1 94    		 CALL LCD16_PRINT	;
459)   820A 21 7A 84    		 LD HL, STR_LCD16	;
460)   820D CD AE 81    		 CALL BLPRNMES  	;
470)   8210 CD 8B 8A    		 CALL PATCHCMDS       ;PATCH CD ROM TO IMPLEMENT OUR OWN COMMANDS	;PATCH CD ROM TO IMPLEMENT OUR OWN COMMANDS
471)   8213 CD 71 88    		 CALL STNEWD        ;SET NEWDRIVERS AND DEFSTORE DEVICE	;SET NEWDRIVERS AND DEFSTORE DEVICE
473)   8216 21 7A 00    		 LD HL,SERERR       ;SERERR NOT USED BY SERIAL	;SERERR NOT USED BY SERIAL
474)   8219 36 05       		 LD (HL),5       ;INIT EVERY 5 TIMES TO PRINT TO LCD	;INIT EVERY 5 TIMES TO PRINT TO LCD
477)   821B 21 F3 83    		 LD HL, STRMN	;
478)   821E CD D1 8B    		 CALL RS_TXT        ;OUTPUT MENU COMMANDS AT RS232	;OUTPUT MENU COMMANDS AT RS232
479)   8221 21 3C 84    		 LD HL, STR01	;
480)   8224 CD D1 8B    		 CALL RS_TXT        ;OUTPUT WAITING AT RS232	;OUTPUT WAITING AT RS232
482)   8227 CD B8 94    		 CALL LCD16_CLR	;
484)   822A 21 7D 83    		 LD HL, STR02	;
485)   822D CD C1 94    		 CALL LCD16_PRINT	;
487)   8230 21 4E 83    		 LD HL, SMENU	;
488)   8233 3E 0A       		 LD A, 10	;
489)   8235 CD DB 84    		 CALL SCPRN	;
491)   8238 CD 57 82    		 CALL GET_KBCHAR       ;TAKE A CHAR FROM RS232 OR PS2 KEYB	;TAKE A CHAR FROM RS232 OR PS2 KEYB
494)   823B FE 55       		 CP 'U'         ;UPLOAD PROGRAM	;UPLOAD PROGRAM
495)   823D CC C4 82    		 CALL Z, UPLOD	;
496)   8240 FE 58       		 CP 'X'	;
497)   8242 CA A7 82    		 JP Z, EXEC	;
498)   8245 FE 53       		 CP 'S'	;
499)   8247 CC 25 83    		 CALL Z, TXTSCR	;
500)   824A FE 4E       		 CP 'N'	;
501)   824C CA 7E 82    		 JP Z, GONB        ;$E090	;$E090
502)   824F FE 44       		 CP 'D'	;
503)   8251 CC 0A 83    		 CALL Z, DNLOD	;
505)   8254 C3 1B 82    		 JP MENU	;
508)   8257 AF          		GET_KBCHAR: XOR A	;
511)   8258 CD 29 8C    		 CALL RS_KEYRD        ;CHAR IN RS232?	;CHAR IN RS232?
512)   825B 28 04       		 JR Z, GT_TST2	;
514)   825D CD F9 8B    		 CALL RS_RX        ; GET THAT CHAR	; GET THAT CHAR
515)   8260 C9          		 RET	;
517)   8261 CD 5A 8A    		GT_TST2: CALL PS2KEYAVAIL      ;ZF=0 IF WE HAVE A KEY ELSE 1	;ZF=0 IF WE HAVE A KEY ELSE 1
518)   8264 20 F1       		 JR NZ, GET_KBCHAR       ;RECHECK	;RECHECK
519)   8266 CD 5F 8A    		 CALL READKBCHAR	;
520)   8269 B7          		 OR A	;
521)   826A CA 57 82    		 JP Z,GET_KBCHAR	;
530)   826D C9          		 RET	;
532)   826E 16 00       		LCDLN1: LD D, 0	;
533)   8270 1E 00       		 LD E, 0	;
534)   8272 CD DC 94    		 CALL LCD16_SETCURS  ; D HAS THE COLUMN E HAS THE ROW	; D HAS THE COLUMN E HAS THE ROW
535)   8275 C9          		 RET	;
537)   8276 16 00       		LCDLN2: LD D, 0	;
538)   8278 1E 01       		 LD E, 1	;
539)   827A CD DC 94    		 CALL LCD16_SETCURS ; D HAS THE COLUMN E HAS THE ROW	; D HAS THE COLUMN E HAS THE ROW
540)   827D C9          		 RET	;
544)   827E 21 E0 00    		GONB: LD HL,DIRNM	;
545)   8281 3E 2F       		 LD A,'/'	;
546)   8283 77          		 LD (HL),A	;
547)   8284 23          		 INC HL	;
548)   8285 36 00       		 LD (HL),0	;
549)   8287 23          		 INC HL	;
550)   8288 36 00       		 LD (HL),0	;
551)   828A CD 76 82    		 CALL LCDLN2	;
552)   828D 21 3D 83    		 LD HL, DSPMES	;
553)   8290 CD C1 94    		 CALL LCD16_PRINT	;
555)   8293 CD F9 94    		 CALL LCD16_CURSON       ;CURSOR On	;CURSOR On
556)   8296 CD 15 95    		 CALL LCD16_BLINKON       ;BLINK ON	;BLINK ON
558)   8299 21 06 00    		 LD HL,6	;
559)   829C 36 FE       		 LD (HL),254	;
560)   829E 23          		 INC HL	;
561)   829F 36 7F       		 LD (HL),127	;
562)   82A1 AF          		 XOR A	;
563)   82A2 D3 E0       		 OUT (INTENB),A       ;ENABLE INTERRUPTS ON NB	;ENABLE INTERRUPTS ON NB
564)   82A4 C3 15 A0    		 JP $A015	;
569)   82A7 CD B8 94    		EXEC: CALL LCD16_CLR	;
570)   82AA CD 76 82    		 CALL LCDLN2	;
571)   82AD 21 A4 83    		 LD HL, SPRGX	;
572)   82B0 CD C1 94    		 CALL LCD16_PRINT	;
573)   82B3 CD 6E 82    		 CALL LCDLN1	;
575)   82B6 3E 05       		 LD A, 5	;
576)   82B8 CD DB 84    		 CALL SCPRN	;
578)   82BB 11 A9 00    		 LD DE, PRGEX	;
579)   82BE 1A          		 LD A, (DE)	;
580)   82BF 6F          		 LD L, A	;
581)   82C0 13          		 INC DE	;
582)   82C1 1A          		 LD A, (DE)	;
583)   82C2 67          		 LD H, A	;
584)   82C3 E9          		 JP (HL)	;
587)   82C4 21 97 83    		UPLOD: LD HL, DATST	;
588)   82C7 CD 76 82    		 CALL LCDLN2	;
589)   82CA CD C1 94    		 CALL LCD16_PRINT	;
591)   82CD CD F9 8B    		 CALL RS_RX        ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
592)   82D0 6F          		 LD L, A	;
593)   82D1 CD F9 8B    		 CALL RS_RX	;
594)   82D4 67          		 LD H, A	;
595)   82D5 CD F9 8B    		 CALL RS_RX        ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
596)   82D8 4F          		 LD C, A	;
597)   82D9 CD F9 8B    		 CALL RS_RX	;
598)   82DC 47          		 LD B, A	;
600)   82DD 11 A9 00    		 LD DE, PRGEX        ;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
601)   82E0 7D          		 LD A, L	;
602)   82E1 12          		 LD (DE), A	;
603)   82E2 13          		 INC DE	;
604)   82E3 7C          		 LD A, H	;
605)   82E4 12          		 LD (DE), A	;
607)   82E5 FE 80       		 CP $80	;
608)   82E7 28 02       		 JR Z, ROMWR	;
609)   82E9 38 02       		 JR C, NORWR	;
611)   82EB D3 7C       		ROMWR: OUT (124), A       ;SET ROM WRITABLE = '0'     	;SET ROM WRITABLE = '0'
613)   82ED E5          		NORWR: PUSH HL	;
614)   82EE CD F9 8B    		NXB: CALL RS_RX	;
615)   82F1 77          		 LD (HL), A	;
616)   82F2 23          		 INC HL	;
617)   82F3 0B          		 DEC BC	;
618)   82F4 78          		 LD A, B	;
619)   82F5 B1          		 OR C	;
620)   82F6 20 F6       		 JR NZ, NXB        ;LOOP ALL BYTES	;LOOP ALL BYTES
622)   82F8 D3 7D       		 OUT (125), A        ;SET ROM NON WRITABLE ='1'	;SET ROM NON WRITABLE ='1'
624)   82FA 21 88 83    		 LD HL, DATTR	;
625)   82FD CD B8 94    		 CALL LCD16_CLR	;
626)   8300 CD C1 94    		 CALL LCD16_PRINT	;
627)   8303 3E 05       		 LD A, 5	;
628)   8305 CD DB 84    		 CALL SCPRN	;
632)   8308 E1          		 POP HL	;
634)   8309 C9          		 RET	;
641)   830A CD F9 8B    		DNLOD: CALL RS_RX        ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
642)   830D 6F          		 LD L, A	;
643)   830E CD F9 8B    		 CALL RS_RX	;
644)   8311 67          		 LD H, A	;
645)   8312 CD F9 8B    		 CALL RS_RX        ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
646)   8315 4F          		 LD C, A	;
647)   8316 CD F9 8B    		 CALL RS_RX	;
648)   8319 47          		 LD B, A	;
650)   831A 7E          		NXB3: LD A, (HL)	;
651)   831B CD C2 8B    		 CALL RS_TX        ;SEND BYTE	;SEND BYTE
652)   831E 23          		 INC HL	;
653)   831F 0B          		 DEC BC	;
654)   8320 78          		 LD A, B	;
655)   8321 B1          		 OR C	;
656)   8322 20 F6       		 JR NZ, NXB3        ;LOOP ALL BYTES   	;LOOP ALL BYTES
657)   8324 C9          		 RET	;
660)   8325 21 B0 83    		TXTSCR: LD HL, TXTMES        ;SCREEN START	;SCREEN START
661)   8328 11 82 02    		 LD DE, TXTRAM	;
662)   832B 01 15 00    		 LD BC, 21	;
663)   832E ED B0       		 LDIR	;
665)   8330 21 B0 83    		 LD HL, TXTMES	;
666)   8333 11 C2 02    		 LD DE, TXTRAM + 64       ;SCREEN START+64 40chars screen +24 excess	;SCREEN START+64 40chars screen +24 excess
667)   8336 01 15 00    		 LD BC, 21	;
668)   8339 ED B0       		 LDIR	;
670)   833B AF          		 XOR A	;
671)   833C C9          		 RET	;
674)   833D 3C 43 44 45 		DSPMES: DEFM "<CDESP 2022-24> "	;
674)   8341 53 50 20 32 		DSPMES: DEFM "<CDESP 2022-24> "	;
674)   8345 30 32 32 2D 		DSPMES: DEFM "<CDESP 2022-24> "	;
674)   8349 32 34 3E 20 		DSPMES: DEFM "<CDESP 2022-24> "	;
675)   834D 00          		 DB 0  	;
677)   834E 55 3A 55 50 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   8352 2C 58 3A 52 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   8356 55 4E 2C 53 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   835A 3A 44 49 53 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   835E 50 2C 4E 3A 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   8362 4E 42 52 4F 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   8366 4D 2C 44 3A 		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
677)   836A 44 4E       		SMENU: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
678)   836C 00          		 DB 0 	;
680)   836D 4C 43 44 20 		STR0: DEFM "LCD INITIALIZED"	;
680)   8371 49 4E 49 54 		STR0: DEFM "LCD INITIALIZED"	;
680)   8375 49 41 4C 49 		STR0: DEFM "LCD INITIALIZED"	;
680)   8379 5A 45 44    		STR0: DEFM "LCD INITIALIZED"	;
681)   837C 00          		 DB 0	;
683)   837D 57 41 49 54 		STR02: DEFM "WAITING..."	;
683)   8381 49 4E 47 2E 		STR02: DEFM "WAITING..."	;
683)   8385 2E 2E       		STR02: DEFM "WAITING..."	;
684)   8387 00          		 DB 0	;
686)   8388 50 52 47 20 		DATTR: DEFM "PRG TRANSFERED"	;
686)   838C 54 52 41 4E 		DATTR: DEFM "PRG TRANSFERED"	;
686)   8390 53 46 45 52 		DATTR: DEFM "PRG TRANSFERED"	;
686)   8394 45 44       		DATTR: DEFM "PRG TRANSFERED"	;
687)   8396 00          		 DB 0	;
689)   8397 52 45 43 45 		DATST: DEFM "RECEIVING..."	;
689)   839B 49 56 49 4E 		DATST: DEFM "RECEIVING..."	;
689)   839F 47 2E 2E 2E 		DATST: DEFM "RECEIVING..."	;
690)   83A3 00          		 DB 0	;
692)   83A4 50 52 47 20 		SPRGX: DEFM "PRG EXECUTE"	;
692)   83A8 45 58 45 43 		SPRGX: DEFM "PRG EXECUTE"	;
692)   83AC 55 54 45    		SPRGX: DEFM "PRG EXECUTE"	;
693)   83AF 00          		 DB 0	;
695)   83B0 4E 45 57 42 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
695)   83B4 52 41 49 4E 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
695)   83B8 20 53 43 52 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
695)   83BC 45 45 4E 20 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
695)   83C0 52 45 41 44 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
695)   83C4 59          		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
696)   83C5 00          		 DB 0	;
698)   83C6 4E 45 57 42 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83CA 52 41 49 4E 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83CE 20 48 41 52 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83D2 44 57 41 52 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83D6 45 20 45 4D 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83DA 55 4C 41 54 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83DE 4F 52 20 43 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83E2 44 65 73 70 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83E6 20 32 30 32 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83EA 32 2D 32 30 		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
698)   83EE 32 34       		STR_CRIGHT DEFM "NEWBRAIN HARDWARE EMULATOR CDesp 2022-2024"	;
699)   83F0 0A 0D 00    		 DB 10,13,0	;
700)   83F3 55 3A 55 50 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   83F7 2C 58 3A 52 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   83FB 55 4E 2C 53 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   83FF 3A 44 49 53 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   8403 50 2C 4E 3A 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   8407 4E 42 52 4F 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   840B 4D 2C 44 3A 		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
700)   840F 44 4E       		STRMN: DEFM "U:UP,X:RUN,S:DISP,N:NBROM,D:DN"	;
701)   8411 0A 0D 00    		 DB 10,13,0	;
703)   8414 4E 45 57 42 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
703)   8418 52 41 49 4E 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
703)   841C 20 42 4F 4F 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
703)   8420 54 45 44 20 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
703)   8424 4F 4B       		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
704)   8426 0A 0D 00    		 DB 10,13,0	;
706)   8429 43 4C 45 41 		STRSCR: DEFM "CLEARING SCREEN."	;
706)   842D 52 49 4E 47 		STRSCR: DEFM "CLEARING SCREEN."	;
706)   8431 20 53 43 52 		STRSCR: DEFM "CLEARING SCREEN."	;
706)   8435 45 45 4E 2E 		STRSCR: DEFM "CLEARING SCREEN."	;
707)   8439 0A 0D 00    		 DB 10,13,0	;
710)   843C 0A 0D       		STR01: DB 10,13	;
711)   843E 57 41 49 54 		 DEFM "WAITING..."	;
711)   8442 49 4E 47 2E 		 DEFM "WAITING..."	;
711)   8446 2E 2E       		 DEFM "WAITING..."	;
712)   8448 0A 0D 00    		 DB 10,13,0	;
713)   844B 00          		 DB 0	;
715)   844C 0A 0D       		STR_SERIAL: DB 10,13	;
716)   844E 52 53 32 33 		 DEFM "RS232 OK"	;
716)   8452 32 20 4F 4B 		 DEFM "RS232 OK"	;
717)   8456 0A 0D 00    		 DB 10,13,0	;
719)   8459 4B 45 59 42 		STR_KEYB DEFM "KEYBORD OK"	;
719)   845D 4F 52 44 20 		STR_KEYB DEFM "KEYBORD OK"	;
719)   8461 4F 4B       		STR_KEYB DEFM "KEYBORD OK"	;
720)   8463 0A 0D 00    		 DB 10,13,0   	;
722)   8466 49 32 43 20 		STR_I2C DEFM "I2C OK"	;
722)   846A 4F 4B       		STR_I2C DEFM "I2C OK"	;
723)   846C 0A 0D 00    		 DB 10,13,0   	;
725)   846F 53 4F 55 4E 		STR_SND DEFM "SOUND OK"	;
725)   8473 44 20 4F 4B 		STR_SND DEFM "SOUND OK"	;
726)   8477 0A 0D 00    		 DB 10,13,0   	;
727)   847A 4C 43 44 20 		STR_LCD16 DEFM "LCD 16x2 OK"	;
727)   847E 31 36 78 32 		STR_LCD16 DEFM "LCD 16x2 OK"	;
727)   8482 20 4F 4B    		STR_LCD16 DEFM "LCD 16x2 OK"	;
728)   8485 0A 0D 00    		 DB 10,13,0   	;
 14)   8488 E5          		SCCLL: PUSH HL	;
 15)   8489 F5          		 PUSH AF	;
 16)   848A 21 FC 84    		 LD HL, STCL4        ;40 LINE CLEAR	;40 LINE CLEAR
 17)   848D CD DE 84    		 CALL SCPRN1	;
 18)   8490 F1          		 POP AF	;
 19)   8491 E1          		 POP HL	;
 20)   8492 C9          		 RET	;
 23)   8493 AF          		 XOR A         ;LINE 0	;LINE 0
 24)   8494 21 09 86    		 LD HL, SCRDY	;
 25)   8497 CD DB 84    		 CALL SCPRN	;
 26)   849A C9          		 RET	;
 30)   849B 06 19       		SCCLS: LD B, 25	;
 31)   849D AF          		 XOR A         ;; PRINT STR0 AT LINE 1	;; PRINT STR0 AT LINE 1
 32)   849E C5          		TSTLP1: PUSH BC	;
 33)   849F CD 88 84    		 CALL SCCLL	;
 34)   84A2 3C          		 INC A         ; NEXT LINE	; NEXT LINE
 35)   84A3 C1          		 POP BC	;
 36)   84A4 10 F8       		 DJNZ TSTLP1	;
 37)   84A6 CD 93 84    		 CALL SCMSG1	;
 38)   84A9 C9          		 RET	;
 43)   84AA F5          		PRNRGA: PUSH AF	;
 44)   84AB 06 08       		 LD B, 8	;
 45)   84AD CB 07       		LPN5: RLC A         ; BIT 7 FIRST	; BIT 7 FIRST
 46)   84AF F5          		 PUSH AF	;
 47)   84B0 3E 00       		 LD A, 0	;
 48)   84B2 30 02       		 JR NC, SKP5	;
 49)   84B4 3E 01       		 LD A, 1	;
 50)   84B6 C6 30       		SKP5:  ADD A, 48	;
 51)   84B8 CD C1 84    		 CALL PRNCL        ; PRINT A AT COL,LINE	; PRINT A AT COL,LINE
 52)   84BB 1C          		 INC E	;
 53)   84BC F1          		 POP AF	;
 54)   84BD 10 EE       		 DJNZ LPN5	;
 55)   84BF F1          		 POP AF	;
 56)   84C0 C9          		 RET	;
 59)   84C1 E5          		PRNCL: PUSH HL	;
 60)   84C2 D5          		 PUSH DE	;
 61)   84C3 F5          		 PUSH AF	;
 62)   84C4 C5          		 PUSH BC	;
 63)   84C5 21 82 02    		 LD HL, TXTRAM	;
 64)   84C8 42          		 LD B, D        ; D HAS THE LINE	; D HAS THE LINE
 65)   84C9 D5          		 PUSH DE	;
 66)   84CA 11 40 00    		 LD DE, 40 + 24        ; FOR 40 COLUMN SCREEN	; FOR 40 COLUMN SCREEN
 67)   84CD 19          		LPN2: ADD HL, DE	;
 68)   84CE 10 FD       		 DJNZ LPN2	;
 69)   84D0 D1          		 POP DE	;
 70)   84D1 43          		 LD B, E        ; E HAS THE COLUMN	; E HAS THE COLUMN
 71)   84D2 23          		LPN3: INC HL	;
 72)   84D3 10 FD       		 DJNZ LPN3	;
 73)   84D5 77          		 LD (HL), A        ; A HAS THE CHAR TO PRINT	; A HAS THE CHAR TO PRINT
 74)   84D6 C1          		 POP BC	;
 75)   84D7 F1          		 POP AF	;
 76)   84D8 D1          		 POP DE	;
 77)   84D9 E1          		 POP HL	;
 78)   84DA C9          		 RET	;
 81)   84DB CD 88 84    		SCPRN: CALL SCCLL        ; CLEAR THE LINE	; CLEAR THE LINE
 82)   84DE E5          		SCPRN1: PUSH HL	;
 83)   84DF 21 82 02    		 LD HL, TXTRAM	;
 84)   84E2 B7          		 OR A	;
 85)   84E3 28 07       		 JR Z, SCSKIP        ;SKIP FOR LINE 0	;SKIP FOR LINE 0
 86)   84E5 47          		 LD B, A	;
 87)   84E6 11 40 00    		 LD DE, 40 + 24        ; FOR 40 COLUMN SCREEN	; FOR 40 COLUMN SCREEN
 88)   84E9 19          		LPN1: ADD HL, DE	;
 89)   84EA 10 FD       		 DJNZ LPN1	;
 90)   84EC EB          		SCSKIP: EX DE, HL	;
 91)   84ED E1          		 POP HL	;
 92)   84EE 7E          		SCLP: LD A, (HL)	;
 93)   84EF B7          		 OR A	;
 94)   84F0 28 09       		 JR Z, SCEXT	;
 95)   84F2 FE 1F       		 CP 31	;
 96)   84F4 38 02       		 JR C,SCLPSKIP	;
 97)   84F6 12          		 LD (DE), A	;
 98)   84F7 13          		 INC DE	;
 99)   84F8 23          		SCLPSKIP: INC HL	;
100)   84F9 18 F3       		 JR SCLP	;
101)   84FB C9          		SCEXT: RET	;
103)   84FC 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8500 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8504 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8508 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   850C 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8510 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8514 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8518 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   851C 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8520 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8524 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8528 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   852C 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8530 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8534 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8538 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   853C 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8540 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8544 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8548 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   854C 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8550 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
103)   8554 20          		STCL4: DEFM "                                                                                         "	;
104)   8555 00          		 DB 0	;
106)   8556 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   855A 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   855E 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8562 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8566 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   856A 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   856E 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8572 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8576 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   857A 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   857E 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8582 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8586 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   858A 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   858E 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8592 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   8596 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   859A 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   859E 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   85A2 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   85A6 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   85AA 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
106)   85AE 20          		STCL8: DEFM "                                                                                         "	;
107)   85AF 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85B3 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85B7 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85BB 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85BF 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85C3 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85C7 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85CB 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85CF 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85D3 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85D7 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85DB 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85DF 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85E3 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85E7 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85EB 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85EF 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85F3 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85F7 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85FB 20 20 20 20 		 DEFM "                                                                                         "	;
107)   85FF 20 20 20 20 		 DEFM "                                                                                         "	;
107)   8603 20 20 20 20 		 DEFM "                                                                                         "	;
107)   8607 20          		 DEFM "                                                                                         "	;
108)   8608 00          		 DB 0	;
110)   8609 53 43 52 45 		SCRDY: DEFM "SCREEN READY!!!"	;
110)   860D 45 4E 20 52 		SCRDY: DEFM "SCREEN READY!!!"	;
110)   8611 45 41 44 59 		SCRDY: DEFM "SCREEN READY!!!"	;
110)   8615 21 21 21    		SCRDY: DEFM "SCREEN READY!!!"	;
111)   8618 00          		 DB 0	;
 16)   8619 	            		 RBR EQU DEVSER+0       ;	;
 17)   8619 	            		 MCR EQU DEVSER+04	;
 18)   8619 	            		 LSR EQU DEVSER+05	;
 34)   8619 04          		 DEFB 4	;
 35)   861A 05          		 DEFB RS2OIN-$        ;OPEN IN	;OPEN IN
 36)   861B 04          		 DEFB RS2OOT-$        ;OPEN OUT	;OPEN OUT
 37)   861C 10          		 DEFB RS2INP-$        ;INPUT BYTE	;INPUT BYTE
 38)   861D 2A          		 DEFB RS2OTP-$        ;OUTPUT BYTE	;OUTPUT BYTE
 39)   861E 0A          		 DEFB RS2CLS-$        ;CLOSE	;CLOSE
 51)   861F C5          		RS2OOT: PUSH BC        ;OPENOUT	;OPENOUT
 52)   8620 01 01 00    		 LD BC, 1        ;NO OF BYTES REQUIRED	;NO OF BYTES REQUIRED
 53)   8623 E7 37       		 DEFW ZMKBUFF        ;	;
 54)   8625 C1          		 POP BC         ;	;
 55)   8626 D8          		 RET C         ;	;
 57)   8627 72          		 LD (HL), D        ;PORT NUMBER	;PORT NUMBER
 58)   8628 AF          		RS2CLS: XOR A         ; CLOSE STREAM	; CLOSE STREAM
 59)   8629 47          		 LD B A         ;	;
 60)   862A 4F          		 LD C A         ;	;
 61)   862B C9          		 RET         ;	;
 71)   862C F3          		RS2INP: DI         ;	;
 72)   862D 21 24 00    		 LD HL ENREGMAP        ;	;
 73)   8630 CB 86       		 RES VIDEO, (HL)       ; NO VIDEO	; NO VIDEO
 74)   8632 7E          		 LD A, (HL)	;
 75)   8633 D3 07       		 OUT (ENREG) A        ;	;
 76)   8635 3E 01       		 LD A, 1	;
 77)   8637 D3 24       		 OUT (MCR), A	;
 78)   8639 CD 57 86    		 CALL MWAIT        ;	;
 79)   863C AF          		 XOR A         ;NOT ready to receive SIGNAL DSR 0	;NOT ready to receive SIGNAL DSR 0
 80)   863D D3 24       		 OUT (MCR), A	;
 81)   863F DB 20       		 IN A, (RBR)        ;GET THE CHAR	;GET THE CHAR
 82)   8641 CD 48 E5    		 CALL STOPTV        ;	;
 83)   8644 FB          		 EI         ;	;
 84)   8645 B7          		 OR A         ;	;
 85)   8646 C9          		 RET	;
 88)   8647 4F          		RS2OTP: LD C, A        ;	;
 94)   8648 F3          		 DI         ;	;
 95)   8649 CD 1C E2    		 CALL $E21C        ;NOVID ;	;NOVID ;
 96)   864C 79          		 LD A, C	;
 97)   864D CD 07 80    		 CALL $8007        ;RSTX   ;SEND CHAR IN A	;RSTX   ;SEND CHAR IN A
 98)   8650 CD 48 E5    		 CALL STOPTV        ;	;
 99)   8653 FB          		 EI         ;	;
100)   8654 2B          		 DEC HL         ;	;
101)   8655 B7          		 OR A         ;	;
102)   8656 C9          		 RET         ;	;
105)   8657 21 00 64    		MWAIT: LD HL 25600	;
107)   865A DB 25       		MWAIT2: IN A, (LSR)	;
108)   865C 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
109)   865D D8          		 RET C	;
110)   865E 10 FA       		 DJNZ MWAIT2	;
111)   8660 DB 25       		 IN A, (LSR)	;
112)   8662 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
113)   8663 D8          		 RET C	;
114)   8664 2D          		 DEC L	;
115)   8665 DB 25       		 IN A, (LSR)	;
116)   8667 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
117)   8668 D8          		 RET C	;
118)   8669 C2 5A 86    		 JP NZ MWAIT2	;
119)   866C DB 25       		 IN A, (LSR)	;
120)   866E 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
121)   866F D8          		 RET C	;
122)   8670 25          		 DEC H	;
123)   8671 DB 25       		 IN A, (LSR)	;
124)   8673 1F          		 RRA	;
125)   8674 D8          		 RET C	;
126)   8675 C2 5A 86    		 JP NZ, MWAIT2	;
127)   8678 F1          		 POP AF         ;POP LAST RETURN ADDRESS FROM STACK	;POP LAST RETURN ADDRESS FROM STACK
128)   8679 3E C8       		 LD A, 200        ;TIMEOUT ERROR	;TIMEOUT ERROR
129)   867B 37          		 SCF	;
130)   867C C9          		 RET         ;RETURN TO BASIC WITH ERROR TIMEOUT	;RETURN TO BASIC WITH ERROR TIMEOUT
 26)   867D 04          		 DEFB 4                                                          ;COUNT OF DISPLACEMENTS-1	;COUNT OF DISPLACEMENTS-1
 27)   867E 18          		 DEFB SG2OIN-$        ;OPEN IN	;OPEN IN
 28)   867F 1B          		 DEFB SG2OOT-$        ;OPEN OUT	;OPEN OUT
 29)   8680 87          		 DEFB SG2INP-$        ;INPUT BYTE	;INPUT BYTE
 30)   8681 F3          		 DEFB SG2OTP-$        ;OUTPUT BYTE	;OUTPUT BYTE
 31)   8682 6A          		 DEFB SG2CLS-$        ;CLOSE	;CLOSE
 34)   8683 11 F0 00    		CPYFNAME:      LD DE,STRGBUFF	;
 35)   8686 ED B0       		               LDIR	;
 36)   8688 C9          		               RET	;
 40)   8689 E5          		MKCAPS:        PUSH HL	;
 41)   868A 7E          		MC_NXT:        LD A,(HL)	;
 42)   868B B7          		               OR A	;
 43)   868C 28 06       		               JR Z,MC_EXIT	;
 44)   868E E7 2F       		               DEFW ZTTCAPS	;
 45)   8690 77          		               LD (HL),A	;
 46)   8691 23          		               INC HL	;
 47)   8692 18 F6       		               JR MC_NXT	;
 48)   8694 E1          		MC_EXIT:       POP HL	;
 49)   8695 C9          		               RET	;
 76)   8696 3E 00       		SG2OIN: LD A,0        ;OPENIN	;OPENIN
 77)   8698 18 02       		               JR SG2OPN	;
 80)   869A 3E 01       		SG2OOT: LD A,1	;
 81)   869C E5          		SG2OPN:        PUSH HL	;
 82)   869D C5          		               PUSH BC        ;OPENOUT	;OPENOUT
 83)   869E F5          		               PUSH AF	;
 84)   869F 01 10 02    		 LD BC, SPCNEED        ;NO OF BYTES REQUIRED	;NO OF BYTES REQUIRED
 85)   86A2 E7 37       		 DEFW ZMKBUFF        ;	;
 86)   86A4 D1          		               POP DE	;
 87)   86A5 C1          		 POP BC                                 	;
 88)   86A6 38 41       		 JR C, ERREXIT                	;
 89)   86A8 E5          		               PUSH HL                                                         ;SAVE START OF STRUCT	;SAVE START OF STRUCT
 90)   86A9 7A          		               LD A,D	;
 92)   86AA 77          		 LD (HL), A        ;OPEN TYPE	;OPEN TYPE
 93)   86AB 23          		               INC HL	;
 94)   86AC 36 00       		               LD (HL),0                                                       ;FILE POS ZERO	;FILE POS ZERO
 95)   86AE 23          		               INC HL	;
 96)   86AF 36 00       		               LD (HL),0	;
 97)   86B1 23          		               INC HL	;
 98)   86B2 36 00       		               LD (HL),0                                                     ;BUF POS 0 	;BUF POS 0
 99)   86B4 23          		               INC HL	;
100)   86B5 36 00       		               LD (HL),0	;
101)   86B7 23          		               INC HL	;
102)   86B8 E5          		               PUSH HL	;
103)   86B9 C5          		               PUSH BC	;
104)   86BA 01 14 00    		               LD BC,BYTREAD-FNAMEIX                                           ;SKIP FILENAME	;SKIP FILENAME
105)   86BD 09          		               ADD HL,BC	;
106)   86BE C1          		               POP BC	;
107)   86BF 36 00       		               LD (HL),0                                                       ;BYTES READ TO 0 	;BYTES READ TO 0
108)   86C1 23          		               INC HL	;
109)   86C2 36 00       		               LD (HL),0                                                     	;
110)   86C4 D1          		               POP DE                                                          ;DE AT FNAMEIX       	;DE AT FNAMEIX
111)   86C5 DD E1       		               POP IX                                                          ;IX THE START OF STRUCT                	;IX THE START OF STRUCT
112)   86C7 E1          		               POP HL                                                          ;HL THE FILE NAME	;HL THE FILE NAME
113)   86C8 D5          		               PUSH DE                                                         ;SAVE THE START OF FILENAME        	;SAVE THE START OF FILENAME
114)   86C9 ED B0       		               LDIR                                                            ;TRANSFER THE FNAME TO OUR STRUCT        	;TRANSFER THE FNAME TO OUR STRUCT
115)   86CB AF          		               XOR A	;
116)   86CC 12          		               LD (DE),A                                                       ;NULL TERMINATED STRING	;NULL TERMINATED STRING
117)   86CD E1          		               POP HL                                                          ;START OF FNAME                	;START OF FNAME
118)   86CE CD 89 86    		               CALL MKCAPS                                                     ;make hl filename caps  	;make hl filename caps
119)   86D1 DD 7E 00    		               LD A,(IX)	;
120)   86D4 FE 00       		               CP 0	;
121)   86D6 20 0F       		               JR NZ,SG2EX                                                      ;IF FILE OPEN OUT EXIT	;IF FILE OPEN OUT EXIT
123)   86D8 01 00 00    		               LD BC,0	;
124)   86DB 13          		               INC DE	;
125)   86DC F3          		               DI	;
126)   86DD CD 00 8D    		               CALL STRG_OPENCDIR ;OPEN UP TO CURRENT DIR  	;OPEN UP TO CURRENT DIR
127)   86E0 CD 5D 8F    		               CALL STRG_LOADFILE	;
128)   86E3 FB          		               EI	;
129)   86E4 3E 96       		               LD A,ERROPF                                                     ;ERROR NO IF FILE ERROR	;ERROR NO IF FILE ERROR
130)   86E6 D8          		               RET C	;
131)   86E7 AF          		SG2EX:         XOR A	;
132)   86E8 C9          		               RET	;
135)   86E9 E1          		ERREXIT:       POP HL	;
136)   86EA 37          		               SCF	;
137)   86EB C9          		               RET	;
139)   86EC 7E          		SG2CLS: LD A,(HL)	;
140)   86ED FE 01       		               CP 1                                                            ;CHECK IF OPENOUT	;CHECK IF OPENOUT
141)   86EF 20 12       		               JR NZ,SCL_EX	;
148)   86F1 DD E5       		               PUSH IX	;
149)   86F3 E5          		               PUSH HL	;
150)   86F4 DD E1       		               POP IX	;
151)   86F6 01 05 00    		               LD BC,FNAMEIX	;
152)   86F9 09          		               ADD HL,BC	;
153)   86FA DD 4E 03    		               LD C,(IX+BUFFOFS)	;
154)   86FD DD 46 04    		               LD B,(IX+BUFFOFS+1)	;
155)   8700 CD A3 87    		               CALL SO_STFILE	;
156)   8703 AF          		SCL_EX:        XOR A         ; CLOSE STREAM	; CLOSE STREAM
157)   8704 47          		 LD B A         ;	;
158)   8705 4F          		 LD C A         ;	;
159)   8706 C9          		 RET         ;	;
166)   8707 DD E5       		SG2INP:        PUSH IX	;
167)   8709 CD 0F 87    		               CALL SG2INP2	;
168)   870C DD E1       		               POP IX	;
169)   870E C9          		               RET	;
171)   870F 7E          		SG2INP2:       LD A,(HL)	;
172)   8710 FE 00       		               CP 0	;
173)   8712 3E 9B       		               LD A,ERRTRA	;
174)   8714 37          		               SCF	;
175)   8715 C0          		               RET NZ                                                          ;IF NOT INPUT THEN ERROR                	;IF NOT INPUT THEN ERROR
176)   8716 CD CE 87    		               CALL SGCHKEOF                                                   ;TEST EOF	;TEST EOF
177)   8719 23          		               INC HL                	;
178)   871A E5          		               PUSH HL                                                         ;SAVE OFFSET POS	;SAVE OFFSET POS
179)   871B 4E          		               LD C,(HL)	;
180)   871C 23          		               INC HL	;
181)   871D 46          		               LD B,(HL)                                                       ;BC THE FILE OFFS	;BC THE FILE OFFS
182)   871E 23          		               INC HL	;
183)   871F 5E          		               LD E,(HL)	;
184)   8720 23          		               INC HL	;
185)   8721 56          		               LD D,(HL)                                                       ;DE THE BUFFER OFFS	;DE THE BUFFER OFFS
186)   8722 23          		               INC HL                                                          ;NOW ON FILENAME OFFS	;NOW ON FILENAME OFFS
188)   8723 3E 97       		               LD A,ERREOF	;
189)   8725 DA E9 86    		               JP C,ERREXIT                                                    ;ON C EOF REACHED                	;ON C EOF REACHED
190)   8728 28 0E       		               JR Z,RDFMFILE                                                   ;ON Z=EOB READ FROM FILE	;ON Z=EOB READ FROM FILE
199)   872A 01 16 00    		RDFMBUFF:      LD BC,FBUFFIX-FNAMEIX                                           ;500 BYTES BUFFER OFFSET	;500 BYTES BUFFER OFFSET
200)   872D 09          		               ADD HL,BC                                                       ;HL ON BUFFER        	;HL ON BUFFER
201)   872E 19          		               ADD HL,DE                                                       ;HL ON NXT BYTE INSIDE BUFFER	;HL ON NXT BYTE INSIDE BUFFER
203)   872F 7E          		               LD A,(HL)                                                       ;READ BYTE TO A                	;READ BYTE TO A
204)   8730 E1          		               POP HL                                                          ;HL AT THE FILE OFFSET	;HL AT THE FILE OFFSET
205)   8731 23          		               INC HL	;
206)   8732 23          		               INC HL                                                          ;AT THE BUFFER OFFSET	;AT THE BUFFER OFFSET
207)   8733 13          		               INC DE                                                          ;POINT TO NEXT BYTE	;POINT TO NEXT BYTE
208)   8734 73          		               LD (HL),E                                                       ;SAVE 	;SAVE
209)   8735 23          		               INC HL	;
210)   8736 72          		               LD (HL),D	;
211)   8737 C9          		               RET	;
212)   8738 E5          		RDFMFILE:      PUSH HL                                                         ;HL FILENAME        	;HL FILENAME
213)   8739 D1          		               POP DE                                                          ;DE FILENAME	;DE FILENAME
214)   873A EB          		               EX DE,HL	;
215)   873B C5          		               PUSH BC	;
216)   873C 01 16 00    		               LD BC,FBUFFIX-FNAMEIX                                           ;500 BYTES BUFFER OFFSET	;500 BYTES BUFFER OFFSET
217)   873F 09          		               ADD HL,BC	;
218)   8740 C1          		               POP BC	;
219)   8741 EB          		               EX DE,HL                                                        ;HL TO FNAME OFFSET, DE TO BUFFER OFFSET	;HL TO FNAME OFFSET, DE TO BUFFER OFFSET
222)   8742 D5          		               PUSH DE                                                         ;BC THE FILE OFFSET TO READ FROM	;BC THE FILE OFFSET TO READ FROM
225)   8743 F3          		               DI                                                                	;
226)   8744 CD 00 8D    		               CALL STRG_OPENCDIR ;OPEN UP TO CURRENT DIR                                                                                	;OPEN UP TO CURRENT DIR
227)   8747 CD DD 8F    		               CALL STRG_READBUFR                                              ;READ 500 BYTES FROM FILE TO BUFFER BC= BYTES READ	;READ 500 BYTES FROM FILE TO BUFFER BC= BYTES READ
228)   874A FB          		               EI	;
229)   874B D1          		               POP DE                                                          ;THE BUFFER TO READ THE BYTE	;THE BUFFER TO READ THE BYTE
230)   874C 3E 98       		               LD A,ERRRDF                                                     ;ERROR CODE CAN'T READ FROM FILE	;ERROR CODE CAN'T READ FROM FILE
231)   874E DA E9 86    		               JP C,ERREXIT	;
233)   8751 E1          		               POP HL                                                          ;GET FILE OFFSET POS ADDR	;GET FILE OFFSET POS ADDR
234)   8752 D5          		               PUSH DE                                                         ;SAVE START OF BUFFER	;SAVE START OF BUFFER
235)   8753 EB          		               EX DE,HL                                                        ;DE THE OFFSET ADDR	;DE THE OFFSET ADDR
236)   8754 1A          		               LD A,(DE)                                                       ;OFFSET OF FILE 	;OFFSET OF FILE
237)   8755 6F          		               LD L,A	;
238)   8756 13          		               INC DE	;
239)   8757 1A          		               LD A,(DE)	;
240)   8758 67          		               LD H,A	;
241)   8759 09          		               ADD HL,BC                                                       ;ADD NEW READ BYTES TO PREVIOUS OFFSET	;ADD NEW READ BYTES TO PREVIOUS OFFSET
242)   875A EB          		               EX DE,HL                                                        ;HL THE OFFSET ADDR, DE THE NEW OFFSET	;HL THE OFFSET ADDR, DE THE NEW OFFSET
243)   875B 72          		               LD (HL),D                                                       ;SAVE BACK	;SAVE BACK
244)   875C 2B          		               DEC HL	;
245)   875D 73          		               LD (HL),E	;
246)   875E 23          		               INC HL	;
247)   875F 23          		               INC HL                                                          ;TO THE BUF OFFSET 	;TO THE BUF OFFSET
248)   8760 3E 01       		               LD A,1	;
249)   8762 77          		               LD (HL),A                                                       ;SET THE BUF OFFS TO 1	;SET THE BUF OFFS TO 1
250)   8763 23          		               INC HL	;
251)   8764 AF          		               XOR A	;
252)   8765 77          		               LD (HL),A     	;
253)   8766 23          		               INC HL                                                  	;
256)   8767 C5          		               PUSH BC	;
257)   8768 01 14 00    		               LD BC,20	;
258)   876B 09          		               ADD HL,BC                                                       ;NOW AT BYTREAD	;NOW AT BYTREAD
259)   876C C1          		               POP BC	;
260)   876D 71          		               LD (HL),C                                                       ;SAVE BYTES READ FROM FILE	;SAVE BYTES READ FROM FILE
261)   876E 23          		               INC HL	;
262)   876F 70          		               LD (HL),B	;
263)   8770 D1          		               POP DE                                                          ;GET START OF BUFFER	;GET START OF BUFFER
264)   8771 AF          		               XOR A                                                           ;CLEAR CARRY FLAG	;CLEAR CARRY FLAG
265)   8772 1A          		               LD A,(DE)                                                       ;READ THE 1ST BYTE TO A	;READ THE 1ST BYTE TO A
266)   8773 C9          		               RET	;
275)   8774 DD E5       		SG2OTP:        PUSH IX	;
276)   8776 E5          		               PUSH HL	;
277)   8777 DD E1       		               POP IX	;
278)   8779 57          		               LD D,A                                                          ;SAVE BYTE TO BE WRITTEN	;SAVE BYTE TO BE WRITTEN
279)   877A 7E          		               LD A,(HL)	;
280)   877B FE 00       		               CP 0	;
281)   877D 3E 9B       		               LD A,ERRTRA	;
282)   877F 37          		               SCF	;
283)   8780 28 47       		               JR Z,SO_EX	;
284)   8782 7A          		               LD A,D                                                          ;RESTORE A BYTE TO WRITE	;RESTORE A BYTE TO WRITE
285)   8783 01 05 00    		               LD BC,FNAMEIX	;
286)   8786 09          		               ADD HL,BC                	;
287)   8787 DD E5       		               PUSH IX	;
288)   8789 D1          		               POP DE	;
289)   878A EB          		               EX DE,HL	;
290)   878B 01 1B 00    		               LD BC,FBUFFIX	;
291)   878E 09          		               ADD HL,BC                	;
292)   878F DD 4E 03    		               LD C,(IX+BUFFOFS)	;
293)   8792 DD 46 04    		               LD B,(IX+BUFFOFS+1)	;
294)   8795 09          		               ADD HL,BC	;
295)   8796 EB          		               EX DE,HL                                	;
296)   8797 12          		               LD (DE),A	;
298)   8798 79          		               LD A,C	;
299)   8799 FE F3       		               CP $F3                                                          ;499 WE START AT 0  	;499 WE START AT 0
300)   879B 20 25       		               JR NZ,SO_BUFFNXT	;
301)   879D 78          		               LD A,B	;
302)   879E FE 01       		               CP $01	;
303)   87A0 20 20       		               JR NZ,SO_BUFFNXT	;
304)   87A2 03          		               INC BC                                                          ;500	;500
312)   87A3 EB          		 SO_STFILE:    EX DE,HL	;
313)   87A4 DD E5       		               PUSH IX	;
314)   87A6 E1          		               POP HL	;
315)   87A7 C5          		               PUSH BC	;
316)   87A8 01 1B 00    		               LD BC,FBUFFIX	;
317)   87AB 09          		               ADD HL,BC	;
318)   87AC C1          		               POP BC	;
319)   87AD EB          		               EX DE,HL	;
322)   87AE CD 00 8D    		               CALL STRG_OPENCDIR ;OPEN UP TO CURRENT DIR	;OPEN UP TO CURRENT DIR
323)   87B1 CD 37 91    		               CALL STRG_WRITEBUFR                             ;WRITES 500 BYTES FROM BUFFER DE TO THE END OF THE FILE	;WRITES 500 BYTES FROM BUFFER DE TO THE END OF THE FILE
324)   87B4 3E 96       		               LD A,ERROPF	;
325)   87B6 38 06       		               JR C,SO_ERROUT	;
326)   87B8 3E 99       		               LD A,ERRWTF	;
327)   87BA 37          		               SCF	;
328)   87BB 20 01       		               JR NZ,SO_ERROUT	;
329)   87BD AF          		               XOR A	;
330)   87BE 01 00 00    		SO_ERROUT:     LD BC,0                                         ;ZERO BUFFER OFFSET	;ZERO BUFFER OFFSET
331)   87C1 16          		               DB $16                                          ;SKIP INC BC LD D,NN	;SKIP INC BC LD D,NN
332)   87C2 03          		SO_BUFFNXT:    INC BC                                          	;
333)   87C3 DD 71 03    		               LD (IX+BUFFOFS),C	;
334)   87C6 DD 70 04    		               LD (IX+BUFFOFS+1),B	;
335)   87C9 DD E1       		SO_EX          POP IX	;
336)   87CB FE 00       		               CP 0	;
337)   87CD C9          		               RET	;
344)   87CE DD E5       		SGCHKEOF:      PUSH IX	;
345)   87D0 D5          		               PUSH DE	;
346)   87D1 C5          		               PUSH BC	;
348)   87D2 E5          		               PUSH HL	;
349)   87D3 DD E1       		               POP IX	;
350)   87D5 DD 5E 03    		               LD E,(IX+BUFFOFS)	;
351)   87D8 DD 56 04    		               LD D,(IX+BUFFOFS+1)	;
352)   87DB DD 4E 19    		               LD C,(IX+BYTREAD)	;
353)   87DE DD 46 1A    		               LD B,(IX+BYTREAD+1)	;
355)   87E1 78          		               LD A,B	;
356)   87E2 B1          		               OR C	;
357)   87E3 3E 03       		               LD A,3	;
358)   87E5 28 1C       		               JR Z, SGEFEXIT                                                  ;Z=EOB	;Z=EOB
359)   87E7 EB          		               EX DE,HL                                                        ;SAVE HL SET HL=DE	;SAVE HL SET HL=DE
360)   87E8 B7          		               OR A	;
361)   87E9 ED 42       		               SBC HL,BC	;
362)   87EB 7C          		               LD A,H	;
363)   87EC B5          		               OR L	;
364)   87ED EB          		               EX DE,HL                                                        ;RESTORE HL	;RESTORE HL
365)   87EE 3E 01       		               LD A,1                                                          ;NO EOF NO EOB = NZ	;NO EOF NO EOB = NZ
366)   87F0 20 11       		               JR NZ,SGEFEXIT	;
368)   87F2 78          		               LD A,B	;
369)   87F3 D6 01       		               SUB $01	;
370)   87F5 20 09       		               JR NZ, SGDOEOF	;
371)   87F7 79          		               LD A,C	;
372)   87F8 D6 F4       		               SUB $F4	;
373)   87FA 20 04       		               JR NZ, SGDOEOF	;
374)   87FC 3E 02       		               LD A,2                                                          ;Z MEANS EOB END OF BUFFER                	;Z MEANS EOB END OF BUFFER
375)   87FE 18 03       		               JR  SGEFEXIT	;
377)   8800 3E 97       		SGDOEOF:       LD A,ERREOF                                                           ;RETURN 0 ON EOF	;RETURN 0 ON EOF
378)   8802 37          		               SCF         	;
379)   8803 C1          		SGEFEXIT:      POP BC	;
380)   8804 D1          		               POP DE	;
381)   8805 DD E1       		               POP IX	;
382)   8807 C9          		               RET	;
385)   8808 E5          		PRNHL:         PUSH HL	;
386)   8809 C5          		               PUSH BC	;
387)   880A D5          		               PUSH DE	;
388)   880B CD F4 9B    		 CALL B2D16	;
389)   880E 21 CB 00    		 LD HL,B2DBUF	;
390)   8811 CD 88 9C    		 CALL SKIPSPC	;
391)   8814 CD D1 8B    		 CALL RS_TXT	;
392)   8817 D1          		               POP DE	;
393)   8818 C1          		               POP BC	;
394)   8819 E1          		               POP HL	;
395)   881A C9          		               RET	;
397)   881B E5          		PRINTDBG:      PUSH HL	;
398)   881C C5          		               PUSH BC	;
399)   881D D5          		               PUSH DE	;
400)   881E F5          		               PUSH AF	;
402)   881F CD 08 88    		               CALL PRNHL	;
403)   8822 D5          		               PUSH DE	;
404)   8823 C5          		               PUSH BC	;
405)   8824 CD 26 80    		 CALL OS_PRINTMSG	;
406)   8827 20 48 4C    		 DEFM " HL"	;
407)   882A 0A 0D 00    		 DB 10,13,0	;
408)   882D C1          		               POP BC	;
409)   882E D1          		               POP DE	;
411)   882F D5          		               PUSH DE	;
412)   8830 E1          		               POP HL	;
413)   8831 CD 08 88    		               CALL PRNHL	;
414)   8834 D5          		               PUSH DE	;
415)   8835 C5          		               PUSH BC	;
416)   8836 CD 26 80    		 CALL OS_PRINTMSG	;
417)   8839 20 44 45    		 DEFM " DE"	;
418)   883C 0A 0D 00    		 DB 10,13,0	;
419)   883F C1          		               POP BC	;
420)   8840 D1          		               POP DE	;
422)   8841 C5          		               PUSH BC	;
423)   8842 E1          		               POP HL	;
424)   8843 CD 08 88    		               CALL PRNHL	;
425)   8846 D5          		               PUSH DE	;
426)   8847 C5          		               PUSH BC	;
427)   8848 CD 26 80    		 CALL OS_PRINTMSG	;
428)   884B 20 42 43    		 DEFM " BC"	;
429)   884E 0A 0D 00    		 DB 10,13,0	;
430)   8851 C1          		               POP BC	;
431)   8852 D1          		               POP DE	;
434)   8853 F1          		               POP AF	;
435)   8854 D1          		               POP DE	;
436)   8855 C1          		               POP BC	;
437)   8856 E1          		               POP HL	;
438)   8857 C9          		               RET	;
442)   8858 F5          		CLRBUFR:       PUSH AF	;
443)   8859 E5          		               PUSH HL	;
444)   885A D5          		               PUSH DE	;
445)   885B C5          		               PUSH BC	;
446)   885C AF          		               XOR A	;
447)   885D 12          		               LD (DE),A	;
448)   885E D5          		               PUSH DE	;
449)   885F E1          		               POP HL	;
450)   8860 13          		               INC DE	;
451)   8861 01 F3 01    		               LD BC,499	;
452)   8864 ED B0       		               LDIR        	;
453)   8866 C1          		               POP BC	;
454)   8867 D1          		               POP DE	;
455)   8868 E1          		               POP HL	;
456)   8869 F1          		               POP AF	;
457)   886A C9          		               RET	;
462)   886B 04          		 DEFB 4                                                          ;COUNT OF DISPLACEMENTS-1	;COUNT OF DISPLACEMENTS-1
463)   886C 2A          		 DEFB SG2OIN-$        ;OPEN IN	;OPEN IN
464)   886D 2D          		 DEFB SG2OOT-$        ;OPEN OUT	;OPEN OUT
465)   886E 99          		 DEFB SG2INP-$        ;INPUT BYTE	;INPUT BYTE
466)   886F 05          		 DEFB SG2OTP-$        ;OUTPUT BYTE	;OUTPUT BYTE
467)   8870 7C          		 DEFB SG2CLS-$        ;CLOSE	;CLOSE
 19)   8871 21 58 00    		STNEWD: LD HL, $58        ;DEVTAB	;DEVTAB
 20)   8874 11 81 88    		 LD DE, DEVTAB        ; NEW TABLE SET	; NEW TABLE SET
 21)   8877 73          		 LD (HL), E	;
 22)   8878 23          		 INC HL	;
 23)   8879 72          		 LD (HL), D	;
 24)   887A 21 13 00    		 LD HL, DEFSTOR	;
 25)   887D 3E 0C       		 LD A, 12        ;DEFAULT STORE DEVICE IS 12 NB STORAGE MODULE	;DEFAULT STORE DEVICE IS 12 NB STORAGE MODULE
 26)   887F 77          		 LD (HL), A	;
 27)   8880 C9          		 RET	;
 31)   8881 11          		DEVTAB: DEFB 17        ;number of entries ;number of entries	;number of entries ;number of entries
 32)   8882 83 E6       		 DEFW TVIO        ;	;
 33)   8884 EE ED       		 DEFW TP1IO        ;	;
 34)   8886 F4 ED       		 DEFW TP2IO        ;	;
 35)   8888 50 E6       		 DEFW LIIO        ;	;
 36)   888A 75 E6       		 DEFW TLIO        ;	;
 37)   888C 36 A1       		 DEFW NKBWIO        ;	;
 38)   888E 1A A1       		 DEFW NKBIIO        ;	;
 39)   8890 1F E4       		 DEFW UPIO        ;	;
 40)   8892 3C E4       		 DEFW LPIO        ;	;
 41)   8894 2F E4       		 DEFW JGIO        ;	;
 42)   8896 19 E4       		 DEFW DUMMY        ;	;
 43)   8898 96 A5       		 DEFW GRAPH        ;  	;
 44)   889A 7D 86       		               DEFW SG2IO        ;MY STORAGE DEVICE 13 BDISCIO BINARY SERIAL	;MY STORAGE DEVICE 13 BDISCIO BINARY SERIAL
 45)   889C 7D 86       		               DEFW SG2IO                                                      ;MY STORAGE DEVICE 14 TDISCIO SAME AS 13 FOR ME	;MY STORAGE DEVICE 14 TDISCIO SAME AS 13 FOR ME
 46)   889E 7D 86       		               DEFW SG2IO                                                      ;MY STORAGE DEVICE 15 RDISCIO RANDOM ACCESS	;MY STORAGE DEVICE 15 RDISCIO RANDOM ACCESS
 47)   88A0 7D 86       		               DEFW SG2IO                                                      ;MY STORAGE DEVICE 16 SDISCIO DIR COMMANDS	;MY STORAGE DEVICE 16 SDISCIO DIR COMMANDS
 48)   88A2 19 86       		               DEFW RS2IO        ;MY SERIAL DEVICE 17	;MY SERIAL DEVICE 17
  6)   88A4 FE 00       		 CP 0	;
  7)   88A6 C8          		 RET Z	;
  8)   88A7 CD 4B 89    		 CALL NBLOOKASC	;
  9)   88AA C9          		 RET	;
 12)   88AB 21 C9 88    		NBLOOK: LD HL, NBTAB	;
 13)   88AE 06 00       		 LD B, 0	;
 14)   88B0 4F          		 LD C, A	;
 15)   88B1 09          		 ADD HL, BC	;
 16)   88B2 7E          		 LD A, (HL)	;
 17)   88B3 FE 00       		 CP 0	;
 18)   88B5 C8          		 RET Z	;
 19)   88B6 21 80 00    		 LD HL, KEYCTR        ;BIT 6=SHIFT BIT 7=CTRL  BIT 6+7=GRPH	;BIT 6=SHIFT BIT 7=CTRL  BIT 6+7=GRPH
 20)   88B9 CB 6E       		 BIT 5, (HL)	;
 21)   88BB 28 04       		 JR Z, NOGRPH	;
 22)   88BD 06 C0       		 LD B, 192        ;SET BIT 6 AND 7	;SET BIT 6 AND 7
 23)   88BF 18 06       		 JR NBLKEX	;
 24)   88C1 4F          		NOGRPH: LD C, A	;
 25)   88C2 7E          		 LD A, (HL)	;
 26)   88C3 E6 C0       		 AND 11000000	;
 27)   88C5 47          		 LD B, A	;
 28)   88C6 79          		 LD A, C	;
 29)   88C7 B0          		NBLKEX: OR B	;
 30)   88C8 C9          		 RET	;
 32)   88C9 00 00 00 00 		NBTAB: DB 0,0,0,0,0,0,0,0,0,0       ;  0-  9	;  0-  9
 32)   88CD 00 00 00 00 		NBTAB: DB 0,0,0,0,0,0,0,0,0,0       ;  0-  9	;  0-  9
 32)   88D1 00 00       		NBTAB: DB 0,0,0,0,0,0,0,0,0,0       ;  0-  9	;  0-  9
 33)   88D3 00 00 00 A4 		 DB 0,0,0,36+128,0,0,0,0,0,0      ; 10- 19 0,0,0,TAB	; 10- 19 0,0,0,TAB
 33)   88D7 00 00 00 00 		 DB 0,0,0,36+128,0,0,0,0,0,0      ; 10- 19 0,0,0,TAB	; 10- 19 0,0,0,TAB
 33)   88DB 00 00       		 DB 0,0,0,36+128,0,0,0,0,0,0      ; 10- 19 0,0,0,TAB	; 10- 19 0,0,0,TAB
 34)   88DD 00 0E 09 00 		 DB 0,14,9,0,0,0,60,45,46,13      ; 20- 29	; 20- 29
 34)   88E1 00 00 3C 2D 		 DB 0,14,9,0,0,0,60,45,46,13      ; 20- 29	; 20- 29
 34)   88E5 2E 0D       		 DB 0,14,9,0,0,0,60,45,46,13      ; 20- 29	; 20- 29
 35)   88E7 08 00 00 3A 		 DB 8,0,0,58,59,44,12,6,7,0      ; 30- 39	; 30- 39
 35)   88EB 3B 2C 0C 06 		 DB 8,0,0,58,59,44,12,6,7,0      ; 30- 39	; 30- 39
 35)   88EF 07 00       		 DB 8,0,0,58,59,44,12,6,7,0      ; 30- 39	; 30- 39
 36)   88F1 00 0F 39 2B 		 DB 0,15,57,43,10,11,5,0,0,52      ; 40- 49	; 40- 49
 36)   88F5 0A 0B 05 00 		 DB 0,15,57,43,10,11,5,0,0,52      ; 40- 49	; 40- 49
 36)   88F9 00 34       		 DB 0,15,57,43,10,11,5,0,0,52      ; 40- 49	; 40- 49
 37)   88FB 38 29 2A 25 		 DB 56,41,42,37,4,0,0,0,53,51      ; 50- 59	; 50- 59
 37)   88FF 04 00 00 00 		 DB 56,41,42,37,4,0,0,0,53,51      ; 50- 59	; 50- 59
 37)   8903 35 33       		 DB 56,41,42,37,4,0,0,0,53,51      ; 50- 59	; 50- 59
 38)   8905 23 03 13 00 		 DB 35,3,19,0,0,54,62,36,38,21      ; 60- 69	; 60- 69
 38)   8909 00 36 3E 24 		 DB 35,3,19,0,0,54,62,36,38,21      ; 60- 69	; 60- 69
 38)   890D 26 15       		 DB 35,3,19,0,0,54,62,36,38,21      ; 60- 69	; 60- 69
 39)   890F 14 00 00 37 		 DB 20,0,0,55,47,39,40,26,28,0      ; 70- 79	; 70- 79
 39)   8913 2F 27 28 1A 		 DB 20,0,0,55,47,39,40,26,28,0      ; 70- 79	; 70- 79
 39)   8917 1C 00       		 DB 20,0,0,55,47,39,40,26,28,0      ; 70- 79	; 70- 79
 40)   8919 00 00 43 00 		 DB 0,0,67,0,86,27,0,0,0,0      ; 80- 89	; 80- 89
 40)   891D 56 1B 00 00 		 DB 0,0,67,0,86,27,0,0,0,0      ; 80- 89	; 80- 89
 40)   8921 00 00       		 DB 0,0,67,0,86,27,0,0,0,0      ; 80- 89	; 80- 89
 41)   8923 1E 00 00 00 		 DB 30,0,0,0,0,0,0,0,0,0      ; 90- 99	; 90- 99
 41)   8927 00 00 00 00 		 DB 30,0,0,0,0,0,0,0,0,0      ; 90- 99	; 90- 99
 41)   892B 00 00       		 DB 30,0,0,0,0,0,0,0,0,0      ; 90- 99	; 90- 99
 42)   892D 00 00 40 00 		 DB 0,0,64,0,0,26+128,0,2,63,0      ;100-109  0,0,64,0,0,END	;100-109  0,0,64,0,0,END
 42)   8931 00 9A 00 02 		 DB 0,0,64,0,0,26+128,0,2,63,0      ;100-109  0,0,64,0,0,END	;100-109  0,0,64,0,0,END
 42)   8935 3F 00       		 DB 0,0,64,0,0,26+128,0,2,63,0      ;100-109  0,0,64,0,0,END	;100-109  0,0,64,0,0,END
 43)   8937 00 00 3D A5 		 DB 0,0,61,37+128,34,0,18,50,31,25     ;110-119  0,0,INS,DEL	;110-119  0,0,INS,DEL
 43)   893B 22 00 12 32 		 DB 0,0,61,37+128,34,0,18,50,31,25     ;110-119  0,0,INS,DEL	;110-119  0,0,INS,DEL
 43)   893F 1F 19       		 DB 0,0,61,37+128,34,0,18,50,31,25     ;110-119  0,0,INS,DEL	;110-119  0,0,INS,DEL
 44)   8941 00 1D 07 1C 		 DB 0,29,7,28,24,20,0,0,0,0      ;120-129	;120-129
 44)   8945 18 14 00 00 		 DB 0,29,7,28,24,20,0,0,0,0      ;120-129	;120-129
 44)   8949 00 00       		 DB 0,29,7,28,24,20,0,0,0,0      ;120-129	;120-129
 47)   894B 21 54 89    		NBLOOKASC:     LD HL, NBRSTAB	;
 48)   894E 06 00       		 LD B, 0	;
 49)   8950 4F          		 LD C, A	;
 50)   8951 09          		 ADD HL, BC	;
 51)   8952 7E          		 LD A, (HL)	;
 52)   8953 C9          		 RET	;
 55)   8954 00 3D 52 12 		NBRSTAB:      DB 0,61,18+64,18,2,0,64,0,64,27+128    ;  0-  9	;  0-  9
 55)   8958 02 00 40 00 		NBRSTAB:      DB 0,61,18+64,18,2,0,64,0,64,27+128    ;  0-  9	;  0-  9
 55)   895C 40 9B       		NBRSTAB:      DB 0,61,18+64,18,2,0,64,0,64,27+128    ;  0-  9	;  0-  9
 56)   895E 22 32 00 1E 		 DB 34,50,0,30,0,0,0,0,0,0     ; 10- 19 	; 10- 19
 56)   8962 00 00 00 00 		 DB 34,50,0,30,0,0,0,0,0,0     ; 10- 19 	; 10- 19
 56)   8966 00 00       		 DB 34,50,0,30,0,0,0,0,0,0     ; 10- 19 	; 10- 19
 57)   8968 00 00 00 00 		 DB 0,0,0,0,0,0,0,31,28+128,29+128    ; 20- 29	; 20- 29
 57)   896C 00 00 00 1F 		 DB 0,0,0,0,0,0,0,31,28+128,29+128    ; 20- 29	; 20- 29
 57)   8970 9C 9D       		 DB 0,0,0,0,0,0,0,31,28+128,29+128    ; 20- 29	; 20- 29
 58)   8972 00 00 0F 49 		 DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64          ; 30- 39  	; 30- 39
 58)   8976 48 47 46 45 		 DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64          ; 30- 39  	; 30- 39
 58)   897A 00 43       		 DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64          ; 30- 39  	; 30- 39
 59)   897C 16 17 18 1D 		 DB 22,23,24,29,54,28,55,47,21,9     ; 40- 49	; 40- 49
 59)   8980 36 1C 37 2F 		 DB 22,23,24,29,54,28,55,47,21,9     ; 40- 49	; 40- 49
 59)   8984 15 09       		 DB 22,23,24,29,54,28,55,47,21,9     ; 40- 49	; 40- 49
 60)   8986 08 07 06 05 		 DB 8,7,6,5,4,3,19,20,40+64,40             ; 50- 59	; 50- 59
 60)   898A 04 03 13 14 		 DB 8,7,6,5,4,3,19,20,40+64,40             ; 50- 59	; 50- 59
 60)   898E 68 28       		 DB 8,7,6,5,4,3,19,20,40+64,40             ; 50- 59	; 50- 59
 61)   8990 76 1B 77 6F 		 DB 54+64,27,55+64,47+64,0,46+64,56+64,58+64,44+64,12+64  ; 60- 69	; 60- 69
 61)   8994 00 6E 78 7A 		 DB 54+64,27,55+64,47+64,0,46+64,56+64,58+64,44+64,12+64  ; 60- 69	; 60- 69
 61)   8998 6C 4C       		 DB 54+64,27,55+64,47+64,0,46+64,56+64,58+64,44+64,12+64  ; 60- 69	; 60- 69
 62)   899A 6B 6A 69 64 		 DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64 ; 70- 79	; 70- 79
 62)   899E 73 7E 67 75 		 DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64 ; 70- 79	; 70- 79
 62)   89A2 74 66       		 DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64 ; 70- 79	; 70- 79
 63)   89A4 5A 4E 4B 6D 		 DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64 ; 80- 89	; 80- 89
 63)   89A8 4A 63 79 4D 		 DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64 ; 80- 89	; 80- 89
 63)   89AC 7B 65       		 DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64 ; 80- 89	; 80- 89
 64)   89AE 7C 56 5C 57 		 DB 60+64,22+64,92,23+64,29+64,0,0,46,56,58   ; 90- 99	; 90- 99
 64)   89B2 5D 00 00 2E 		 DB 60+64,22+64,92,23+64,29+64,0,0,46,56,58   ; 90- 99	; 90- 99
 64)   89B6 38 3A       		 DB 60+64,22+64,92,23+64,29+64,0,0,46,56,58   ; 90- 99	; 90- 99
 65)   89B8 2C 0C 2B 2A 		 DB 44,12,43,42,41,36,51,62,39,53    ;100-109  	;100-109
 65)   89BC 29 24 33 3E 		 DB 44,12,43,42,41,36,51,62,39,53    ;100-109  	;100-109
 65)   89C0 27 35       		 DB 44,12,43,42,41,36,51,62,39,53    ;100-109  	;100-109
 66)   89C2 34 26 1A 0E 		 DB 52,38,26,14,11,45,10,35,57,13           ;110-119  	;110-119
 66)   89C6 0B 2D 0A 23 		 DB 52,38,26,14,11,45,10,35,57,13           ;110-119  	;110-119
 66)   89CA 39 0D       		 DB 52,38,26,14,11,45,10,35,57,13           ;110-119  	;110-119
 67)   89CC 3B 25 3C 00 		 DB 59,37,60,0,0,0,0,0,0,0       ;120-129	;120-129
 67)   89D0 00 00 00 00 		 DB 59,37,60,0,0,0,0,0,0,0       ;120-129	;120-129
 67)   89D4 00 00       		 DB 59,37,60,0,0,0,0,0,0,0       ;120-129	;120-129
 68)   89D6 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;130-  9	;130-  9
 68)   89DA 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;130-  9	;130-  9
 68)   89DE 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;130-  9	;130-  9
 69)   89E0 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;140-  9	;140-  9
 69)   89E4 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;140-  9	;140-  9
 69)   89E8 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;140-  9	;140-  9
 70)   89EA 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;150-  9	;150-  9
 70)   89EE 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;150-  9	;150-  9
 70)   89F2 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;150-  9	;150-  9
 71)   89F4 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;160-  9	;160-  9
 71)   89F8 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;160-  9	;160-  9
 71)   89FC 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;160-  9	;160-  9
 72)   89FE 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;170-  9	;170-  9
 72)   8A02 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;170-  9	;170-  9
 72)   8A06 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;170-  9	;170-  9
 73)   8A08 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;180-  9	;180-  9
 73)   8A0C 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;180-  9	;180-  9
 73)   8A10 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;180-  9	;180-  9
 74)   8A12 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;190-  9	;190-  9
 74)   8A16 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;190-  9	;190-  9
 74)   8A1A 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;190-  9	;190-  9
 75)   8A1C 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;200-  9	;200-  9
 75)   8A20 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;200-  9	;200-  9
 75)   8A24 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;200-  9	;200-  9
 76)   8A26 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;210-  9	;210-  9
 76)   8A2A 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;210-  9	;210-  9
 76)   8A2E 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;210-  9	;210-  9
 77)   8A30 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;220-  9	;220-  9
 77)   8A34 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;220-  9	;220-  9
 77)   8A38 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;220-  9	;220-  9
 78)   8A3A 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;230-  9	;230-  9
 78)   8A3E 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;230-  9	;230-  9
 78)   8A42 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;230-  9	;230-  9
 79)   8A44 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;240-  9	;240-  9
 79)   8A48 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;240-  9	;240-  9
 79)   8A4C 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;240-  9	;240-  9
 80)   8A4E 00 00 00 00 		               DB 0,0,0,0,0,0           ;250-  5	;250-  5
 80)   8A52 00 00       		               DB 0,0,0,0,0,0           ;250-  5	;250-  5
  7)   8A54 21 80 00    		@PS2KBINIT: LD HL,KEYCTR	;
  8)   8A57 36 00       		 LD (HL),0	;
  9)   8A59 C9          		 RET	;
 12)   8A5A DB 06       		@PS2KEYAVAIL: IN A,(6)	;
 13)   8A5C FE 38       		 CP 56  ;38H =0011 1000  0011 IS 3 MEANS KBD INPUT 1000 MEANS REAL KEYBOARD	;38H =0011 1000  0011 IS 3 MEANS KBD INPUT 1000 MEANS REAL KEYBOARD
 14)   8A5E C9          		 RET	;
 16)   8A5F CD 6B 8A    		@READKBCHAR: CALL GETKBKEY ;GET HARDWARE KEY WITH CHECKS ON SHIFT...	;GET HARDWARE KEY WITH CHECKS ON SHIFT...
 17)   8A62 B7          		 OR A ;	;
 18)   8A63 C8          		 RET Z	;
 19)   8A64 32 81 00    		 LD (LASTKEY),A	;
 20)   8A67 CD 68 99    		 CALL PS2LOK  ;RETURN ASCII CHAR	;RETURN ASCII CHAR
 21)   8A6A C9          		 RET	;
 24)   8A6B CD 74 8A    		GETKBKEY: CALL GETPS2HWKEY ;GET SCANCODE FROM PS/2 KEYB	;GET SCANCODE FROM PS/2 KEYB
 25)   8A6E B7          		 OR A 	;
 26)   8A6F C8          		 RET Z   ;IF KEYBRD KEY IS ZERO	;IF KEYBRD KEY IS ZERO
 27)   8A70 CD A7 98    		 CALL CHECKEXT  ;CHECKEXT SHIFTS CTRL ALT CAPS	;CHECKEXT SHIFTS CTRL ALT CAPS
 28)   8A73 C9          		 RET	;
 32)   8A74 F3          		GETPS2HWKEY: DI	;
 33)   8A75 DB 48       		 IN A,(DEVKBI)  	;
 34)   8A77 4F          		 LD C,A	;
 35)   8A78 CD 83 8A    		 CALL KBENABLE	;
 36)   8A7B 79          		 LD A,C	;
 37)   8A7C FB          		 EI	;
 38)   8A7D C9          		 RET	;
 40)   8A7E 3E 02       		@KBDISABLE: LD A, 2	;
 41)   8A80 D3 48       		 OUT (DEVKBI), A	;
 42)   8A82 C9          		 RET	;
 44)   8A83 AF          		@KBENABLE: XOR A	;
 45)   8A84 D3 48       		 OUT (DEVKBI), A	;
 46)   8A86 D3 48       		 OUT (DEVKBI), A	;
 47)   8A88 D3 48       		 OUT (DEVKBI), A	;
 48)   8A8A C9          		 RET	;
 35)   8A8B 3E 03       		PATCHCMDS: LD A,11b ;DISABLE INTS & DISABLE NB=RAM WRITABLE	;DISABLE INTS & DISABLE NB=RAM WRITABLE
 36)   8A8D D3 E0       		 OUT (INTENB),A	;
 37)   8A8F 21 F9 A2    		 LD HL,$A2F9	;
 38)   8A92 36 CD       		 LD (HL),$CD ;CALL	;CALL
 39)   8A94 11 CB 8A    		 LD DE,CHKNEWCMD	;
 40)   8A97 23          		 INC HL	;
 41)   8A98 73          		 LD (HL),E	;
 42)   8A99 23          		 INC HL	;
 43)   8A9A 72          		 LD (HL),D	;
 44)   8A9B 21 85 A4    		 LD HL,$A485  ;PXCL3	;PXCL3
 45)   8A9E 36 C3       		 LD (HL),$C3 ;JP	;JP
 46)   8AA0 11 AF 8A    		 LD DE,OSXCL3	;
 47)   8AA3 23          		 INC HL	;
 48)   8AA4 73          		 LD (HL),E	;
 49)   8AA5 23          		 INC HL	;
 50)   8AA6 72          		 LD (HL),D	;
 51)   8AA7 3E 01       		 LD A,01b  ;DISABLE INTS & ENABLE NB=RAM NON WRITABLE	;DISABLE INTS & ENABLE NB=RAM NON WRITABLE
 52)   8AA9 D3 E0       		 OUT (INTENB),A  	;
 53)   8AAB C9          		 RET	;
 57)   8AAC 01          		 TOS DEFB 1	;
 58)   8AAD 4F          		 DEFM 'O'	;
 59)   8AAE D3          		 DEFB 'S'+80H	;
 62)   8AAF 01 14 DD    		OSXCL3: LD BC,XTABLE	;
 63)   8AB2 FA 35 C3    		 JP M,ENTER	;
 64)   8AB5 01 00 DE    		 LD BC,XTABL2	;
 65)   8AB8 FE 56       		 CP LPCODE	;
 66)   8ABA DA 35 C3    		 JP C,ENTER       ;IF <$56 GOTO TAB2 	;IF <$56 GOTO TAB2
 67)   8ABD 01 43 A4    		 LD BC,XTABL3	;
 68)   8AC0 FE 62       		 CP OSCODE	;
 69)   8AC2 DA 35 C3    		 JP C,ENTER ;IF <$62 GOTO TAB3	;IF <$62 GOTO TAB3
 70)   8AC5 01 96 8A    		 LD BC,XTABL4 ;ELSE  OUR TAB4	;ELSE  OUR TAB4
 71)   8AC8 C3 35 C3    		 JP ENTER	;
 74)   8ACB DD E5       		 PUSH IX	;
 75)   8ACD FD E5       		 PUSH IY	;
 76)   8ACF D5          		 PUSH DE	;
 77)   8AD0 21 AC 8A    		 LD HL,TOS	;
 78)   8AD3 CD D4 A2    		 CALL PSCAN	;
 79)   8AD6 D4 E2 8A    		 CALL NC, COSCMD	;
 80)   8AD9 D1          		 POP DE	;
 81)   8ADA FD E1       		 POP IY	;
 82)   8ADC DD E1       		 POP IX	;
 84)   8ADE 21 5A A3    		 LD HL,TPLOT	;
 85)   8AE1 C9          		 RET	;
 88)   8AE2 21 02 8B    		COSCMD: LD HL,OSLST	;
 89)   8AE5 CD D4 A2    		 CALL PSCAN ;check for any of the OS COMMAND-list	;check for any of the OS COMMAND-list
 90)   8AE8 D8          		 RET C	;
 91)   8AE9 61          		 LD H,C  ;THE OS LIST COMMAND ID ON C	;THE OS LIST COMMAND ID ON C
 92)   8AEA 2E B1       		 LD L,YOSCMD ;THE OS COMMAND	;THE OS COMMAND
 93)   8AEC D7 01       		 DEFW ZCM2HL	;
 94)   8AEE 05          		 DEC B  ;CHECK FOR ARGS	;CHECK FOR ARGS
 95)   8AEF C8          		 RET Z	;
 99)   8AF0 DF 18       		 DEFW WEXPN	;
100)   8AF2 D8          		 RET C	;
108)   8AF3 C9          		 RET	;
111)   8AF4 0C 8B       		OSCMDTBL: DEFW CMD_DIR	;
112)   8AF6 24 8B       		 DEFW CMD_CD	;
125)   8AF8 FA 8A       		       DEFW XOSCMD	;
127)   8AFA 7E          		XOSCMD: LD A,(HL) ;GET SUB COMMAND 0=DIR 1=CD	;GET SUB COMMAND 0=DIR 1=CD
128)   8AFB B7          		 OR A	;
129)   8AFC 28 0E       		 JR Z,CMD_DIR	;
130)   8AFE 3D          		 DEC A	;
131)   8AFF 28 23       		 JR Z,CMD_CD	;
133)   8B01 C9          		 RET	;
135)   8B02 02          		OSLST: DEFB 2 ;no of sub-commands	;no of sub-commands
137)   8B03 44 49       		 DEFM 'DI' 	;
138)   8B05 D2 00 01    		 DEFB 'R'+80H,CDIR,1 ;+1 OF ARGS	;+1 OF ARGS
140)   8B08 43          		 DEFM 'C' 	;
141)   8B09 C4 01 02    		 DEFB 'D'+80H,CCD,2	;
145)   8B0C D7 39       		CMD_DIR: DEFW ZPTMSG ;	;
146)   8B0E 11          		 DEFB 17	;
147)   8B0F 0D          		 DEFB $0D	;
148)   8B10 2D 2D 2D 5B 		 DEFM "---[DIR INFO]--"	;
148)   8B14 44 49 52 20 		 DEFM "---[DIR INFO]--"	;
148)   8B18 49 4E 46 4F 		 DEFM "---[DIR INFO]--"	;
148)   8B1C 5D 2D 2D    		 DEFM "---[DIR INFO]--"	;
149)   8B1F 0D          		 DEFB $0D	;
150)   8B20 CD CE 8C    		 CALL STRG_DIRLIST  ;PRINT DIR	;PRINT DIR
151)   8B23 C9          		 RET	;
153)   8B24 CD 36 DC    		CMD_CD: CALL GUSTP   ;SETS HL FROM IX+11,12 USRTOP	;SETS HL FROM IX+11,12 USRTOP
154)   8B27 CD 7D 8D    		 CALL STRG_DIRCHG	;
155)   8B2A 38 09       		 JR C, CD_ERR	;
156)   8B2C 3E 96       		 LD A,150   ;ERROR MISSING FILE	;ERROR MISSING FILE
157)   8B2E 28 05       		 JR Z,CD_ERR	;
164)   8B30 CD 1F 8D    		 CALL STRG_DIRNMCHG	;
165)   8B33 18 0F       		 JR CD_CONT	;
167)   8B35 E5          		 PUSH HL	;
168)   8B36 F5          		 PUSH AF  	;
169)   8B37 D7 39       		 DEFW ZPTMSG ;	;
170)   8B39 05          		 DEFB 5	;
171)   8B3A 45 52 52 5F 		 DEFM "ERR_R"	;
171)   8B3E 52          		 DEFM "ERR_R"	;
172)   8B3F F1          		 POP AF  	;
173)   8B40 CD F2 80    		 CALL SOUTAS  	;
174)   8B43 E1          		 POP HL  	;
175)   8B44 F5          		CD_CONT: PUSH AF   ;SAVE FLAGS  	;SAVE FLAGS
177)   8B45 54          		 LD D,H	;
178)   8B46 5D          		 LD E,L	;
179)   8B47 1A          		CD_AGN: LD A,(DE)	;
180)   8B48 FE 00       		 CP 0	;
181)   8B4A 3E 00       		 LD A,0	;
182)   8B4C 12          		 LD (DE),A    ;ZERO THIS	;ZERO THIS
183)   8B4D 13          		 INC DE	;
184)   8B4E 20 F7       		 JR NZ,CD_AGN	;
185)   8B50 06 04       		 LD B,4	;
186)   8B52 12          		CD_AGN2: LD (DE),A	;
187)   8B53 13          		 INC DE	;
188)   8B54 10 FC       		 DJNZ CD_AGN2	;
190)   8B56 E5          		 PUSH HL	;
191)   8B57 D5          		 PUSH DE	;
192)   8B58 21 E0 00    		 LD HL,DIRNM	;
193)   8B5B 7E          		NXTCHR: LD A,(HL)	;
194)   8B5C B7          		 OR A 	;
195)   8B5D 28 05       		 JR Z,NXTPATH	;
196)   8B5F DF 3C       		 DEFW WPTCHAR	;
197)   8B61 23          		 INC HL	;
198)   8B62 18 F7       		 JR NXTCHR	;
199)   8B64 23          		NXTPATH: INC HL	;
200)   8B65 7E          		 LD A,(HL)	;
201)   8B66 B7          		 OR A	;
202)   8B67 20 F2       		 JR NZ,NXTCHR	;
203)   8B69 D1          		 POP DE	;
204)   8B6A E1          		 POP HL	;
205)   8B6B EB          		 EX DE,HL	;
206)   8B6C CD 8C C5    		 CALL LDUSTP	;
210)   8B6F F1          		 POP AF  ;REST FLAGS  	;REST FLAGS
211)   8B70 AF          		 XOR A	;
212)   8B71 C9          		 RET	;
 10)   8B72 21 82 00    		INITMMU:       LD HL,BANKS	;
 11)   8B75 06 08       		               LD B,8	;
 12)   8B77 AF          		               XOR A	;
 13)   8B78 77          		INM_AGN:       LD (HL),A	;
 14)   8B79 3C          		               INC A	;
 15)   8B7A 23          		 INC HL	;
 16)   8B7B 10 FB       		               DJNZ INM_AGN	;
 17)   8B7D C9          		               RET                	;
 23)   8B7E 4F          		PUTPGINBANK: LD C, A       ;SAVE PAGE	;SAVE PAGE
 24)   8B7F 78          		 LD A, B                                                         ;BANK IN A	;BANK IN A
 25)   8B80 FE 02       		 CP 2	;
 26)   8B82 D8          		 RET C         ;BANK 0,1 WILL NEVER CHANGE	;BANK 0,1 WILL NEVER CHANGE
 27)   8B83 FE 07       		 CP 7	;
 28)   8B85 C8          		 RET Z         ;BANK 7 WILL NEVER CHANGE	;BANK 7 WILL NEVER CHANGE
 29)   8B86 21 82 00    		 LD HL, BANKS	;
 30)   8B89 16 00       		 LD D, 0	;
 31)   8B8B 5F          		 LD E, A	;
 32)   8B8C 19          		 ADD HL, DE	;
 33)   8B8D 79          		 LD A, C        ;RESTORE PAGE	;RESTORE PAGE
 34)   8B8E 77          		 LD (HL), A        ;SAVE PG IN BANK B MEMORY	;SAVE PG IN BANK B MEMORY
 35)   8B8F 0E 00       		 LD C, DEVMMU	;
 36)   8B91 58          		 LD E,B	;
 37)   8B92 CB 20       		 SLA B         ;SHIFT BANK TO A15..A13 FROM A2..A0 WE USE THESE PINS ON THE CPLD FOR BANK INPUT	;SHIFT BANK TO A15..A13 FROM A2..A0 WE USE THESE PINS ON THE CPLD FOR BANK INPUT
 38)   8B94 CB 20       		 SLA B	;
 39)   8B96 CB 20       		 SLA B	;
 40)   8B98 CB 20       		 SLA B	;
 41)   8B9A CB 20       		 SLA B         ;SET TO A15,A14,A13	;SET TO A15,A14,A13
 42)   8B9C ED 79       		 OUT (C), A	;
 43)   8B9E 43          		 LD B,E	;
 44)   8B9F C9          		 RET	;
 49)   8BA0 21 82 00    		GETPGINBANK:   LD HL,BANKS	;
 50)   8BA3 16 00       		               LD D,0	;
 51)   8BA5 58          		               LD E,B	;
 52)   8BA6 19          		               ADD HL,DE	;
 53)   8BA7 7E          		               LD A,(HL)	;
 54)   8BA8 C9          		               RET	;
 17)   8BA9 	            		 RBR EQU DEVSER+0      ;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)	;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)
 18)   8BA9 	            		 THR EQU DEVSER+0      ;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)	;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)
 19)   8BA9 	            		 IER EQU DEVSER+1      ;INTERRUPT ENABLE REGISTER (DLAB = 0)	;INTERRUPT ENABLE REGISTER (DLAB = 0)
 24)   8BA9 	            		 IIR EQU DEVSER+2      ;INTERRUPT IDENT. REGISTER (READ ONLY)	;INTERRUPT IDENT. REGISTER (READ ONLY)
 29)   8BA9 	            		 FCR EQU DEVSER+2      ;FIFO CONTROL REGISTER (WRITE ONLY)	;FIFO CONTROL REGISTER (WRITE ONLY)
 37)   8BA9 	            		 LCR EQU DEVSER+3      ;LINE CONTROL REGISTER	;LINE CONTROL REGISTER
 45)   8BA9 	            		 MCR EQU DEVSER+4      ;MODEM CONTROL REGISTER	;MODEM CONTROL REGISTER
 46)   8BA9 	            		 LSR EQU DEVSER+5      ;LINE STATUS REGISTER	;LINE STATUS REGISTER
 55)   8BA9 	            		 MSR EQU DEVSER+6      ;MODEM STATUS REGISTER	;MODEM STATUS REGISTER
 56)   8BA9 	            		 SCR EQU DEVSER+7      ;SCRATCH REGISTER	;SCRATCH REGISTER
 57)   8BA9 	            		 DLL EQU DEVSER+0      ;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)
 58)   8BA9 	            		 DLM EQU DEVSER+1      ;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)
 64)   8BA9 F5          		RS_INI: PUSH AF	;
 65)   8BAA 3E 80       		 LD A, $80        ; Mask to set DLAB on	; Mask to set DLAB on
 66)   8BAC D3 23       		 OUT (LCR), A        ; Send to LINe Control Register	; Send to LINe Control Register
 75)   8BAE F1          		 POP AF	;
 76)   8BAF D3 20       		 OUT (DLL), A        ; Set LSB of divisor	; Set LSB of divisor
 77)   8BB1 3E 00       		 LD A, 00        ; This will be the MSB of the divisior	; This will be the MSB of the divisior
 78)   8BB3 D3 21       		 OUT (DLM), A        ; Send to the MSB register	; Send to the MSB register
 79)   8BB5 3E 03       		 LD A, $03        ; 8 bits, 1 stop, no parity (and clear DLAB)	; 8 bits, 1 stop, no parity (and clear DLAB)
 80)   8BB7 D3 23       		 OUT (LCR), A        ; Write new value to LCR	; Write new value to LCR
 82)   8BB9 3E 00       		 LD A, 0	;
 83)   8BBB D3 22       		 OUT (FCR), A        ;//was commented	;//was commented
 84)   8BBD 3E 00       		 LD A, $00        ; 5 A=0 Disable all INterrupts	; 5 A=0 Disable all INterrupts
 85)   8BBF D3 21       		 OUT (IER), A        ; Send to INterrupt Enable Register	; Send to INterrupt Enable Register
 86)   8BC1 C9          		 RET	;
 89)   8BC2 CD C8 8B    		RS_TX: CALL RSTXRD	;
 90)   8BC5 D3 20       		 OUT (THR), A	;
 92)   8BC7 C9          		 RET	;
 95)   8BC8 F5          		RSTXRD: PUSH AF	;
 96)   8BC9 DB 25       		RSTXLP: IN A, (LSR)        ; fetch the control register	; fetch the control register
 97)   8BCB CB 6F       		 BIT 5, A        ; bit will be set if UART is ready	; bit will be set if UART is ready
 98)   8BCD 28 FA       		 JR Z, RSTXLP	;
 99)   8BCF F1          		 POP AF	;
100)   8BD0 C9          		 RET	;
104)   8BD1 7E          		RS_TXT: LD A, (HL)	;
105)   8BD2 23          		 INC HL	;
106)   8BD3 FE 00       		 CP 0	;
107)   8BD5 C8          		 RET Z	;
108)   8BD6 CD C2 8B    		 CALL RS_TX	;
109)   8BD9 18 F6       		 JR RS_TXT	;
113)   8BDB E5          		RS_MESG: PUSH HL	;
114)   8BDC C5          		 PUSH BC	;
115)   8BDD D5          		 PUSH DE	;
116)   8BDE F5          		 PUSH AF	;
117)   8BDF 21 09 00    		 LD HL,9 ;POINTS TO RET ADDRESS +10 FROM SP = OUR STRING	;POINTS TO RET ADDRESS +10 FROM SP = OUR STRING
118)   8BE2 39          		 ADD HL,SP	;
119)   8BE3 46          		 LD B,(HL)    	;
120)   8BE4 2B          		 DEC HL	;
121)   8BE5 4E          		 LD C,(HL)	;
122)   8BE6 60          		 LD H,B	;
123)   8BE7 69          		 LD L,C	;
124)   8BE8 CD D1 8B    		 CALL RS_TXT	;
125)   8BEB F1          		 POP AF	;
126)   8BEC D1          		 POP DE	;
127)   8BED 44          		 LD B,H  ;NEW RET ADDRESS	;NEW RET ADDRESS
128)   8BEE 4D          		 LD C,L	;
129)   8BEF 21 05 00    		 LD HL,5 ;POINTS TO RET ADDRESS +6 FROM SP	;POINTS TO RET ADDRESS +6 FROM SP
130)   8BF2 39          		 ADD HL,SP  	;
131)   8BF3 70          		 LD (HL),B	;
132)   8BF4 2B          		 DEC HL	;
133)   8BF5 71          		 LD (HL),C  	;
134)   8BF6 C1          		 POP BC	;
135)   8BF7 E1          		 POP HL	;
136)   8BF8 C9          		 RET 	;
143)   8BF9 ED 57       		RS_RX: LD A,I        ;SETS PV IF INTS ARE ENABLED	;SETS PV IF INTS ARE ENABLED
144)   8BFB F5          		 PUSH AF	;
145)   8BFC D1          		 POP DE	;
146)   8BFD F3          		 DI	;
147)   8BFE 3E 01       		 LD A, 1        ;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
148)   8C00 D3 24       		 OUT (MCR), A	;
149)   8C02 CD 20 8C    		 CALL RSRXRD	;
150)   8C05 AF          		RS_GTCH: XOR A        ;NOT ready to receive SIGNAL DSR 0	;NOT ready to receive SIGNAL DSR 0
151)   8C06 D3 24       		 OUT (MCR), A	;
153)   8C08 DB 20       		 IN A, (RBR)  	;
154)   8C0A D5          		 PUSH DE	;
155)   8C0B 57          		 LD D,A	;
156)   8C0C F1          		 POP AF	;
157)   8C0D 7A          		 LD A,D	;
158)   8C0E E0          		 RET PO  	;
159)   8C0F FB          		 EI	;
160)   8C10 C9          		 RET	;
162)   8C11 3E 01       		RS_RXNW: LD A, 1       ;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
163)   8C13 D3 24       		 OUT (MCR), A	;
164)   8C15 DB 25       		 IN A, (LSR)        ; fetch the conrtol register	; fetch the conrtol register
165)   8C17 CB 47       		 BIT 0, A	;
166)   8C19 28 03       		 JR Z, RS_NOCHAR	;
167)   8C1B F3          		 DI	;
168)   8C1C 18 E7       		 JR RS_GTCH	;
169)   8C1E AF          		RS_NOCHAR: XOR A        ;RETURN ZERO	;RETURN ZERO
170)   8C1F C9          		 RET	;
178)   8C20 F5          		 PUSH AF	;
184)   8C21 DB 25       		 IN A, (LSR)        ; fetch the control register	; fetch the control register
185)   8C23 CB 47       		 BIT 0, A        ; bit will be set if UART has data	; bit will be set if UART has data
186)   8C25 28 FA       		 JR Z, RSRXLP	;
188)   8C27 F1          		 POP AF	;
190)   8C28 C9          		 RET	;
194)   8C29 DB 25       		RS_KEYRD: IN A, (LSR)       ; fetch the conrtol register	; fetch the conrtol register
195)   8C2B CB 47       		 BIT 0, A        ; bit will be set if UART has data	; bit will be set if UART has data
196)   8C2D C9          		 RET	;
198)   8C2E F5          		SHLCD: PUSH AF	;
200)   8C2F F1          		 POP AF	;
202)   8C30 C9          		 RET	;
204)   8C31 F5          		RS_NEWLINE: PUSH AF	;
205)   8C32 3E 0D       		 LD A,13	;
206)   8C34 CD C2 8B    		 CALL RS_TX	;
207)   8C37 3E 0A       		 LD A,10	;
208)   8C39 CD C2 8B    		 CALL RS_TX	;
209)   8C3C F1          		 POP AF	;
210)   8C3D C9          		 RET  	;
213)   8C3E F5          		CHKERR: PUSH AF	;
214)   8C3F E5          		 PUSH HL	;
215)   8C40 C5          		 PUSH BC	;
216)   8C41 DB 25       		 IN A, (LSR)        ;FETCH LINE STATUS REGISTER	;FETCH LINE STATUS REGISTER
217)   8C43 CB 67       		 BIT 4, A	;
218)   8C45 28 04       		 JR Z, LBLPE	;
219)   8C47 3E 42       		 LD A, 'B'       ;$20  ;BREAK	;$20  ;BREAK
220)   8C49 18 1A       		 JR EXIT	;
221)   8C4B CB 57       		LBLPE: BIT 2, A	;
222)   8C4D 28 04       		 JR Z, LBLFE	;
223)   8C4F 3E 50       		 LD A, 'P'       ;$40  ;PARITY	;$40  ;PARITY
224)   8C51 18 12       		 JR EXIT	;
225)   8C53 CB 5F       		LBLFE: BIT 3, A	;
226)   8C55 28 04       		 JR Z, LBLOE	;
227)   8C57 3E 46       		 LD A, 'F'       ;$60  ;FRAME	;$60  ;FRAME
228)   8C59 18 0A       		 JR EXIT	;
229)   8C5B CB 4F       		LBLOE: BIT 1, A	;
230)   8C5D 28 04       		 JR Z, LBLNE	;
231)   8C5F 3E 4F       		 LD A, 'O'        ;$80  ;OVERRUN	;$80  ;OVERRUN
232)   8C61 18 02       		 JR EXIT	;
233)   8C63 3E 4E       		LBLNE: LD A, 'N'        ;NO ERROR	;NO ERROR
234)   8C65 21 7A 00    		EXIT: LD HL, SERERR	;
235)   8C68 77          		 LD (HL), A	;
237)   8C69 C1          		 POP BC	;
238)   8C6A E1          		 POP HL	;
239)   8C6B F1          		 POP AF	;
240)   8C6C C9          		 RET	;
 32)   8C6D 	            		@CH376_ERROR EQU RS_MESG	;
 42)   8C6D 57          		STRG_INIT: LD D,A	;
 43)   8C6E AF          		 XOR A  	;
 44)   8C6F 32 8A 00    		 LD (STRG_STAT),A  ;NOT CONNECTED, NOT EXISTS	;NOT CONNECTED, NOT EXISTS
 45)   8C72 CD 4A 92    		 CALL CH376_INIT	;
 46)   8C75 20 06       		 JR NZ,INIERR	;
 47)   8C77 7A          		 LD A,D   ;SELECT USB DEVICE 3 FOR SDCARD, 6 FOR FLASH	;SELECT USB DEVICE 3 FOR SDCARD, 6 FOR FLASH
 48)   8C78 CD 5F 92    		 CALL CH376_SETUSB	;
 49)   8C7B 28 03       		 JR Z,INIOK	;
 50)   8C7D 3E 00       		INIERR: LD A,0  	;
 51)   8C7F C9          		 RET	;
 52)   8C80 CD 3F 92    		INIOK: CALL CH376_VERSION	;
 53)   8C83 BF          		 CP A  ;SET ZF	;SET ZF
 54)   8C84 3E 80       		 LD A, $80  ;BIT 7 MEANS EXISTS	;BIT 7 MEANS EXISTS
 55)   8C86 32 8A 00    		 LD (STRG_STAT),A  ;	;
 56)   8C89 C9          		 RET	;
 59)   8C8A 3A 8A 00    		STRG_EXISTS: LD A,(STRG_STAT)	;
 60)   8C8D CB 7F       		 BIT 7,A	;
 61)   8C8F C9          		 RET	;
 67)   8C90 CD 8A 8C    		STRG_CHECK: CALL STRG_EXISTS	;
 68)   8C93 37          		 SCF	;
 69)   8C94 C8          		 RET Z    ;Z MEANS NOT EXISTS	;Z MEANS NOT EXISTS
 70)   8C95 06 05       		 LD B,5	;
 71)   8C97 CD 8F 92    		SC_AGN1: CALL CH376_CONNECT 	;
 72)   8C9A 28 06       		 JR Z,DOCON	;
 73)   8C9C 30 1C       		 JR NC,DODISC	;
 74)   8C9E 10 F7       		 DJNZ SC_AGN1    	;
 78)   8CA0 AF          		 XOR A   	;
 79)   8CA1 C9          		 RET   ;TIMEOUT	;TIMEOUT
 81)   8CA2 AF          		DOCON: XOR A    ;CLCF	;CLCF
 82)   8CA3 3A 8A 00    		 LD A,(STRG_STAT)	;
 83)   8CA6 CB 47       		 BIT 0,A	;
 84)   8CA8 C0          		 RET NZ    ;ALREADY MOUNTED THE DRIVE	;ALREADY MOUNTED THE DRIVE
 88)   8CA9 CD 9A 92    		 CALL CH376_MOUNT   ;MOUNT THE DRIVE	;MOUNT THE DRIVE
 89)   8CAC 20 0C       		 JR NZ, DONOMNT	;
 93)   8CAE 3A 8A 00    		 LD A,(STRG_STAT)	;
 94)   8CB1 CB C7       		 SET 0,A	;
 95)   8CB3 32 8A 00    		 LD (STRG_STAT),A	;
 96)   8CB6 AF          		 XOR A    ;CLEAR CARRY FLAG MEANS WE ARE OK	;CLEAR CARRY FLAG MEANS WE ARE OK
 97)   8CB7 3E 01       		 LD A,1    ;A=1 IS JUST CONNECTED	;A=1 IS JUST CONNECTED
 98)   8CB9 C9          		 RET	;
106)   8CBA AF          		 XOR A 	;
107)   8CBB 3A 8A 00    		 LD A,(STRG_STAT)  	;
108)   8CBE CB 47       		 BIT 0,A	;
109)   8CC0 C8          		 RET Z    ;ALREADY DISCONNECTED	;ALREADY DISCONNECTED
110)   8CC1 CB 87       		 RES 0,A    ;SET BIT 0 TO 0=DISCONNECTED	;SET BIT 0 TO 0=DISCONNECTED
111)   8CC3 32 8A 00    		 LD (STRG_STAT),A  	;
112)   8CC6 3E 02       		 LD A,2    ;A=2 IS JUST DISCONNECTED	;A=2 IS JUST DISCONNECTED
113)   8CC8 C9          		 RET	;
119)   8CC9 C3 A3 92    		STRG_OPENCRD:  JP CH376_MOUNTDEV  	;
122)   8CCC 2A 00       		SDIRTP  DEFB '*',0	;
124)   8CCE CD 00 8D    		STRG_DIRLIST: CALL STRG_OPENCDIR ;OPEN CURRENT DIR	;OPEN CURRENT DIR
125)   8CD1 21 CC 8C    		 LD HL,SDIRTP	;
126)   8CD4 CD 7D 8D    		 CALL STRG_OPENFD	;
127)   8CD7 C8          		DL_NXTFILE: RET Z   ;NO  MORE FILES	;NO  MORE FILES
128)   8CD8 3E 27       		 LD A,CMD_RDUSB_DATA0	;
129)   8CDA CD 29 92    		 CALL CH376_COMMD	;
130)   8CDD CD 68 91    		 CALL CH376_GETDATA ;DATA ON USBBUF A=BYTES TO READ	;DATA ON USBBUF A=BYTES TO READ
131)   8CE0 3E 00       		 LD A,0	;
132)   8CE2 12          		 LD (DE),A   ;ZT STRING	;ZT STRING
134)   8CE3 21 8B 00    		 LD HL,USBBUF	;
135)   8CE6 CD 38 80    		 CALL OS_PRMESSCRSFE	;
136)   8CE9 3E 0D       		 LD A,$0D	;
137)   8CEB CD 2D 80    		 CALL OS_PRCHSCR	;
139)   8CEE 3E 33       		 LD A, CMD_FILEENUM_GO	;
140)   8CF0 CD 29 92    		 CALL CH376_COMMD	;
141)   8CF3 CD BA 91    		 CALL CH376_WTCMDEND	;
142)   8CF6 FE 42       		 CP ERR_MISS_FILE	;
143)   8CF8 18 DD       		 JR DL_NXTFILE	;
147)   8CFA 7E          		NEXTDIR: LD A,(HL)	;
148)   8CFB 23          		 INC HL	;
149)   8CFC B7          		 OR A	;
150)   8CFD C8          		 RET Z	;
151)   8CFE 18 FA       		 JR NEXTDIR	;
157)   8D00 E5          		STRG_OPENCDIR: PUSH HL	;
158)   8D01 D5          		 PUSH DE	;
159)   8D02 C5          		 PUSH BC  	;
160)   8D03 21 E0 00    		 LD HL,DIRNM	;
161)   8D06 CD 0D 8D    		 CALL STRG_OPENCDIR2	;
162)   8D09 C1          		        POP BC	;
163)   8D0A D1          		 POP DE	;
164)   8D0B E1          		 POP HL	;
165)   8D0C C9          		 RET	;
167)   8D0D 7E          		STRG_OPENCDIR2: LD A,(HL)	;
168)   8D0E B7          		 OR A	;
169)   8D0F C8          		 RET Z  ;WHEN ZERO MEANS NO MORE DIR TO OPEN	;WHEN ZERO MEANS NO MORE DIR TO OPEN
173)   8D10 E5          		 PUSH HL	;
174)   8D11 CD 7D 8D    		 CALL STRG_OPENFD	;
175)   8D14 E1          		 POP HL	;
176)   8D15 D8          		 RET C  ;ERROR	;ERROR
177)   8D16 37          		 SCF	;
178)   8D17 3E 96       		 LD A,150 ;MISSING FILENAME	;MISSING FILENAME
179)   8D19 C8          		 RET Z  ;FILE MISSING	;FILE MISSING
181)   8D1A CD FA 8C    		 CALL NEXTDIR	;
182)   8D1D 18 EE       		 JR STRG_OPENCDIR2	;
186)   8D1F E5          		STRG_DIRNMCHG: PUSH HL 	;
187)   8D20 7E          		 LD A,(HL)	;
188)   8D21 FE 5C       		 CP '\'        ;changed from '/' on 18/2/2024	;changed from '/' on 18/2/2024
189)   8D23 28 0E       		 JR Z,DNC_RESET	;
190)   8D25 FE 2F       		 CP '/'        ; 25/2/2024	; 25/2/2024
191)   8D27 28 0A       		 JR Z,DNC_RESET  	;
192)   8D29 FE 2E       		 CP '.'	;
193)   8D2B 20 2D       		 JR NZ, DNC_ADD	;
194)   8D2D FE 2E       		 CP '.'	;
195)   8D2F 28 0F       		 JR Z,DNC_RMV	;
196)   8D31 E1          		 POP HL	;
197)   8D32 C9          		 RET ;DO NOTHING IF . OR .\ OR .<x>	;DO NOTHING IF . OR .\ OR .<x>
198)   8D33 21 E0 00    		DNC_RESET: LD HL,DIRNM	;
199)   8D36 36 5C       		 LD (HL),'\'	;
200)   8D38 23          		 INC HL	;
201)   8D39 36 00       		 LD (HL),0	;
202)   8D3B 23          		 INC HL	;
203)   8D3C 36 00       		 LD (HL),0	;
204)   8D3E E1          		 POP HL	;
205)   8D3F C9          		 RET	;
207)   8D40 21 E0 00    		DNC_RMV: LD HL,DIRNM	;
208)   8D43 CD FA 8C    		 CALL NEXTDIR	;
209)   8D46 7E          		 LD A,(HL)	;
210)   8D47 B7          		 OR A	;
211)   8D48 EB          		 EX DE,HL ;DE THE NEXT DIR	;DE THE NEXT DIR
212)   8D49 E1          		 POP HL	;
213)   8D4A C8          		 RET Z ;RET IF WE ARE ON 1ST DIRECTORY  	;RET IF WE ARE ON 1ST DIRECTORY
214)   8D4B E5          		 PUSH HL	;
215)   8D4C EB          		 EX DE,HL ;HL THE NEXT DIR	;HL THE NEXT DIR
216)   8D4D 44          		RMV_NXT: LD B,H	;
217)   8D4E 4D          		 LD C,L	;
218)   8D4F CD FA 8C    		 CALL NEXTDIR	;
219)   8D52 7E          		 LD A,(HL)	;
220)   8D53 B7          		 OR A	;
221)   8D54 20 F7       		 JR NZ,RMV_NXT ;GO TO NEXT DIR 	;GO TO NEXT DIR
224)   8D56 AF          		 XOR A	;
225)   8D57 02          		 LD (BC),A	;
226)   8D58 E1          		 POP HL	;
227)   8D59 C9          		 RET	;
228)   8D5A EB          		DNC_ADD: EX DE,HL ;DE THE NEW FILE	;DE THE NEW FILE
229)   8D5B 21 E0 00    		 LD HL,DIRNM	;
230)   8D5E CD FA 8C    		ADDNXT: CALL NEXTDIR	;
231)   8D61 7E          		 LD A,(HL)	;
232)   8D62 B7          		 OR A	;
233)   8D63 20 F9       		 JR NZ,ADDNXT	;
235)   8D65 EB          		 EX DE,HL	;
237)   8D66 7E          		ADDNXT2: LD A,(HL)	;
238)   8D67 12          		 LD (DE),A	;
239)   8D68 23          		 INC HL	;
240)   8D69 13          		 INC DE	;
241)   8D6A B7          		 OR A	;
242)   8D6B 20 F9       		 JR NZ,ADDNXT2	;
244)   8D6D EB          		 EX DE,HL	;
245)   8D6E 36 00       		 LD (HL),0 ;SIGNAL END OF DIRECTORIES WITH A SECOND ZERO	;SIGNAL END OF DIRECTORIES WITH A SECOND ZERO
246)   8D70 E1          		 POP HL	;
247)   8D71 C9          		 RET	;
251)   8D72 F5          		TEMPPRMSG: PUSH AF	;
252)   8D73 CD 30 80    		 CALL OS_PRMESSCR	;
253)   8D76 3E 0A       		 LD A,$0A	;
254)   8D78 CD 2D 80    		 CALL OS_PRCHSCR	;
255)   8D7B F1          		 POP AF	;
256)   8D7C C9          		 RET	;
265)   8D7D E5          		STRG_DIRCHG: PUSH HL	;
269)   8D7E 3E 2F       		 LD A, CMD_SETFILENAME	;
270)   8D80 CD 29 92    		     CALL CH376_COMMD  	;
271)   8D83 CD DE 92    		     CALL CH376_WRSTRING	;
272)   8D86 20 0E       		 JR NZ,DC_WSERR  	;
273)   8D88 3E 32       		 LD A, CMD_FILE_OPEN	;
274)   8D8A CD 29 92    		 CALL CH376_COMMD	;
275)   8D8D CD BA 91    		 CALL CH376_WTCMDEND   	;
276)   8D90 E1          		 POP HL	;
277)   8D91 FE 42       		 CP ERR_MISS_FILE	;
278)   8D93 C8          		 RET Z	;
279)   8D94 B7          		 OR A  ;CLEAR CARRY	;CLEAR CARRY
280)   8D95 C9          		 RET	;
282)   8D96 E1          		DC_WSERR: POP HL	;
283)   8D97 37          		 SCF	;
284)   8D98 C9          		 RET  	;
286)   8D99 C9          		STRG_TPFILE: RET	;
287)   8D9A C9          		STRG_GETPOS: RET	;
291)   8D9B D5          		STRG_SETPOS16: PUSH DE	;
292)   8D9C 11 00 00    		 LD DE,0	;
293)   8D9F CD A4 8D    		 CALL STRG_SETPOS 	;
294)   8DA2 D1          		 POP DE	;
295)   8DA3 C9          		 RET	;
297)   8DA4 3E 39       		STRG_SETPOS: LD A,CMD_BYTE_LOCATE	;
298)   8DA6 CD 29 92    		 CALL CH376_COMMD	;
299)   8DA9 79          		 LD A,C                             ; 4 BYTES TO SET THE OFFSET LOW IN FRONT	; 4 BYTES TO SET THE OFFSET LOW IN FRONT
300)   8DAA CD 2D 92    		     CALL CH376_DATAWR	;
301)   8DAD 78          		 LD A,B	;
302)   8DAE CD 2D 92    		 CALL CH376_DATAWR	;
303)   8DB1 7B          		 LD A,E	;
304)   8DB2 CD 2D 92    		 CALL CH376_DATAWR            ;LAST 2 BYTES 0 MAX 65535 SKIP	;LAST 2 BYTES 0 MAX 65535 SKIP
305)   8DB5 7A          		 LD A,D	;
306)   8DB6 CD 2D 92    		 CALL CH376_DATAWR	;
307)   8DB9 CD BA 91    		     CALL CH376_WTCMDEND	;
308)   8DBC C9          		 RET	;
311)   8DBD C9          		STRG_GETSIZE: RET	;
312)   8DBE C9          		STRG_GETEOF: RET	;
319)   8DBF 3E 27       		STRG_PRDRVINFO: LD A,CMD_RDUSB_DATA0	;
320)   8DC1 CD 29 92    		 CALL CH376_COMMD	;
321)   8DC4 CD 68 91    		 CALL CH376_GETDATA	;
322)   8DC7 F5          		 PUSH AF	;
323)   8DC8 D6 08       		 SUB 8  	;
324)   8DCA 47          		 LD B,A	;
325)   8DCB F1          		 POP AF   	;
326)   8DCC 21 93 00    		 LD HL,USBBUF+8  ;SKIP 8 BYTES	;SKIP 8 BYTES
327)   8DCF 7E          		PDI_NXT: LD A,(HL)	;
328)   8DD0 E5          		 PUSH HL	;
329)   8DD1 C5          		 PUSH BC	;
330)   8DD2 CD 16 80    		 CALL OS_PRINTCHAR	;
331)   8DD5 C1          		 POP BC	;
332)   8DD6 E1          		 POP HL	;
333)   8DD7 23          		 INC HL	;
334)   8DD8 10 F5       		 DJNZ PDI_NXT  	;
335)   8DDA CD 31 8C    		 CALL RS_NEWLINE	;
337)   8DDD 3E 3F       		 LD A,CMD_DISK_QUERY   	;
338)   8DDF CD 29 92    		 CALL CH376_COMMD	;
339)   8DE2 CD BA 91    		 CALL CH376_WTCMDEND	;
340)   8DE5 C0          		 RET NZ	;
341)   8DE6 3E 27       		 LD A,CMD_RDUSB_DATA0	;
342)   8DE8 CD 29 92    		 CALL CH376_COMMD  	;
343)   8DEB CD 68 91    		 CALL CH376_GETDATA	;
345)   8DEE DD 21 8B 00 		 LD IX,USBBUF 	;
346)   8DF2 DD E5       		 PUSH IX   	;
347)   8DF4 DD 56 03    		 LD D,(IX+3)	;
348)   8DF7 DD 5E 02    		 LD E,(IX+2)	;
349)   8DFA DD 66 01    		 LD H,(IX+1)	;
350)   8DFD DD 6E 00    		 LD L,(IX+0)	;
351)   8E00 CD F8 9B    		 CALL B2D32    ;DE:HL RES ON B2DBUF	;DE:HL RES ON B2DBUF
352)   8E03 21 CB 00    		 LD HL,B2DBUF	;
353)   8E06 CD 88 9C    		 CALL SKIPSPC	;
354)   8E09 CD 1A 80    		 CALL OS_PRINTTEXT	;
355)   8E0C CD 26 80    		 CALL OS_PRINTMSG	;
356)   8E0F 20 53 45 43 		 DEFM " SECTORS"	;
356)   8E13 54 4F 52 53 		 DEFM " SECTORS"	;
357)   8E17 0A 0D 00    		 DB 10,13 0	;
358)   8E1A DD E1       		 POP IX	;
360)   8E1C DD E5       		 PUSH IX     	;
361)   8E1E DD 56 07    		 LD D,(IX+7)	;
362)   8E21 DD 5E 06    		 LD E,(IX+6)	;
363)   8E24 DD 66 05    		 LD H,(IX+5)	;
364)   8E27 DD 6E 04    		 LD L,(IX+4)  	;
365)   8E2A CD F8 9B    		 CALL B2D32  ;DE:HL RES ON B2DBUF	;DE:HL RES ON B2DBUF
366)   8E2D 21 CB 00    		 LD HL,B2DBUF	;
367)   8E30 CD 88 9C    		 CALL SKIPSPC	;
368)   8E33 CD 1A 80    		 CALL OS_PRINTTEXT	;
369)   8E36 CD 26 80    		 CALL OS_PRINTMSG	;
370)   8E39 20 53 45 43 		 DEFM " SECTORS FREE   "	;
370)   8E3D 54 4F 52 53 		 DEFM " SECTORS FREE   "	;
370)   8E41 20 46 52 45 		 DEFM " SECTORS FREE   "	;
370)   8E45 45 20 20 20 		 DEFM " SECTORS FREE   "	;
371)   8E49 0A 0D 00    		 DB 10,13,0   	;
372)   8E4C DD E1       		 POP IX	;
374)   8E4E DD 7E 08    		FILESYSTEM: LD A,(IX+8) ;1-FAT12,2-FAT16,3-FAT32	;1-FAT12,2-FAT16,3-FAT32
375)   8E51 3D          		 DEC A	;
376)   8E52 28 08       		 JR Z,PDI_NXT0	;
377)   8E54 3D          		 DEC A	;
378)   8E55 28 18       		 JR Z,PDI_NXT1	;
379)   8E57 3D          		 DEC A	;
380)   8E58 28 28       		 JR Z,PDI_NXT2	;
381)   8E5A 18 39       		 JR PDI_NXT3	;
383)   8E5C CD 26 80    		PDI_NXT0: CALL OS_PRINTMSG	;
384)   8E5F 46 53 20 49 		 DEFM "FS IS FAT-12"	;
384)   8E63 53 20 46 41 		 DEFM "FS IS FAT-12"	;
384)   8E67 54 2D 31 32 		 DEFM "FS IS FAT-12"	;
385)   8E6B 0A 0D 00    		 DB 10,13,0	;
386)   8E6E C9          		 RET	;
387)   8E6F CD 26 80    		PDI_NXT1: CALL OS_PRINTMSG	;
388)   8E72 46 53 20 49 		 DEFM "FS IS FAT-16"	;
388)   8E76 53 20 46 41 		 DEFM "FS IS FAT-16"	;
388)   8E7A 54 2D 31 36 		 DEFM "FS IS FAT-16"	;
389)   8E7E 0A 0D 00    		 DB 10,13,0	;
390)   8E81 C9          		 RET	;
391)   8E82 CD 26 80    		PDI_NXT2: CALL OS_PRINTMSG	;
392)   8E85 46 53 20 49 		 DEFM "FS IS FAT-32"	;
392)   8E89 53 20 46 41 		 DEFM "FS IS FAT-32"	;
392)   8E8D 54 2D 33 32 		 DEFM "FS IS FAT-32"	;
393)   8E91 0A 0D 00    		 DB 10,13,0	;
394)   8E94 C9          		 RET	;
395)   8E95 CD 26 80    		PDI_NXT3: CALL OS_PRINTMSG	;
396)   8E98 55 4E 4B 4E 		 DEFM "UNKNOWN FS"	;
396)   8E9C 4F 57 4E 20 		 DEFM "UNKNOWN FS"	;
396)   8EA0 46 53       		 DEFM "UNKNOWN FS"	;
397)   8EA2 0A 0D 00    		 DB 10,13,0	;
398)   8EA5 DD 7E 08    		 LD A,(IX+8)  ;TO BE PRINTED MAYBE	;TO BE PRINTED MAYBE
399)   8EA8 C9          		 RET	;
404)   8EA9 F5          		STRG_OPNFILE: PUSH AF	;
405)   8EAA 3E 2F       		 LD A, CMD_SETFILENAME	;
406)   8EAC CD 29 92    		     CALL CH376_COMMD	;
407)   8EAF 21 F0 00    		 LD HL, STRGBUFF	;
408)   8EB2 CD DE 92    		     CALL CH376_WRSTRING	;
409)   8EB5 28 1E       		 JR Z,OF_WSOK	;
410)   8EB7 F1          		 POP AF	;
411)   8EB8 CD 26 80    		 CALL OS_PRINTMSG	;
412)   8EBB 45 52 52 4F 		 DEFM "ERROR SETTING FILENAME"	;
412)   8EBF 52 20 53 45 		 DEFM "ERROR SETTING FILENAME"	;
412)   8EC3 54 54 49 4E 		 DEFM "ERROR SETTING FILENAME"	;
412)   8EC7 47 20 46 49 		 DEFM "ERROR SETTING FILENAME"	;
412)   8ECB 4C 45 4E 41 		 DEFM "ERROR SETTING FILENAME"	;
412)   8ECF 4D 45       		 DEFM "ERROR SETTING FILENAME"	;
413)   8ED1 0A 0D 00    		 DB 10,13,0  	;
414)   8ED4 C9          		 RET	;
415)   8ED5 F1          		OF_WSOK: POP AF	;
419)   8ED6 B7          		 OR A  ;0 READ	;0 READ
420)   8ED7 28 0C       		 JR Z,OF_OPEN	;
421)   8ED9 D6 01       		 SUB 1  ;1 WRITE	;1 WRITE
422)   8EDB 28 08       		 JR Z,OF_OPEN	;
423)   8EDD D6 01       		 SUB 1  ;2 READ/WRITE	;2 READ/WRITE
424)   8EDF 28 04       		 JR Z,OF_OPEN	;
434)   8EE1 3E 34       		 LD A, CMD_FILE_CREATE  	;
435)   8EE3 18 02       		 JR OF_EXEC	;
440)   8EE5 3E 32       		 LD A, CMD_FILE_OPEN	;
444)   8EE7 CD 29 92    		 CALL CH376_COMMD	;
445)   8EEA CD BA 91    		 CALL CH376_WTCMDEND	;
446)   8EED C9          		 RET	;
448)   8EEE 3E 36       		STRG_CLSFILE: LD A, CMD_FILE_CLOSE	;
449)   8EF0 CD 29 92    		     CALL CH376_COMMD	;
450)   8EF3 3E 01       		     LD A, 1                             ; 1 = update file size if necessary	; 1 = update file size if necessary
451)   8EF5 CD 2D 92    		     CALL CH376_DATAWR	;
452)   8EF8 CD BA 91    		     CALL CH376_WTCMDEND	;
453)   8EFB C9          		     RET	;
459)   8EFC D5          		STRG_BLKREAD: PUSH DE	;
460)   8EFD 3E 3A       		 LD A, CMD_BYTE_READ	;
461)   8EFF CD 29 92    		     CALL CH376_COMMD	;
462)   8F02 79          		     LD A, C                           ; BYTES REQUEST ON BC	; BYTES REQUEST ON BC
463)   8F03 CD 2D 92    		     CALL CH376_DATAWR	;
464)   8F06 78          		     LD A, B	;
465)   8F07 CD 2D 92    		     CALL CH376_DATAWR	;
466)   8F0A 2F          		 CPL	;
467)   8F0B 2F          		 CPL    	;
471)   8F0C D1          		 POP DE	;
472)   8F0D 21 00 00    		 LD HL,0      ;BYTE RECEIVE COUNTER	;BYTE RECEIVE COUNTER
473)   8F10 E5          		STBR_DOREST: PUSH HL	;
474)   8F11 D5          		 PUSH DE	;
475)   8F12 CD BA 91    		 CALL CH376_WTCMDEND	;
476)   8F15 D1          		 POP DE	;
477)   8F16 E1          		 POP HL	;
478)   8F17 28 1C       		 JR Z, FR_DONE   ;Z=NO MORE OR CANNOT READ	;Z=NO MORE OR CANNOT READ
479)   8F19 FE 1D       		 CP USB_INT_DISK_READ                    	;
480)   8F1B 20 1C       		     JR NZ, FR_ERROR	;
482)   8F1D 3E 27       		 LD A,CMD_RDUSB_DATA0	;
483)   8F1F CD 29 92    		 CALL CH376_COMMD 	;
484)   8F22 CD 3C 92    		 CALL CH376_DATARD  ;A= BYTES TO READ TO BUFFER	;A= BYTES TO READ TO BUFFER
485)   8F25 47          		 LD B,A	;
498)   8F26 CD 3C 92    		STBR_NXT1: CALL CH376_DATARD ;READ THE BYTES TO BUFFER	;READ THE BYTES TO BUFFER
499)   8F29 12          		 LD (DE),A	;
500)   8F2A 13          		 INC DE	;
501)   8F2B 23          		 INC HL    ;TOTAL BYTES READ COUNTER	;TOTAL BYTES READ COUNTER
502)   8F2C 10 F8       		 DJNZ STBR_NXT1  	;
503)   8F2E 3E 3B       		 LD A, CMD_BYTE_RD_GO 	;
504)   8F30 CD 29 92    		 CALL CH376_COMMD 	;
505)   8F33 18 DB       		 JR STBR_DOREST	;
511)   8F35 44          		 LD B,H	;
512)   8F36 4D          		 LD C,L	;
513)   8F37 AF          		 XOR A	;
514)   8F38 C9          		 RET	;
515)   8F39 F5          		FR_ERROR: PUSH AF	;
516)   8F3A CD 81 9D    		 CALL PRINTNUM	;
517)   8F3D CD 26 80    		 CALL OS_PRINTMSG	;
518)   8F40 45 52 52 4F 		 DEFM "ERROR READING BLOCK!!! "	;
518)   8F44 52 20 52 45 		 DEFM "ERROR READING BLOCK!!! "	;
518)   8F48 41 44 49 4E 		 DEFM "ERROR READING BLOCK!!! "	;
518)   8F4C 47 20 42 4C 		 DEFM "ERROR READING BLOCK!!! "	;
518)   8F50 4F 43 4B 21 		 DEFM "ERROR READING BLOCK!!! "	;
518)   8F54 21 21 20    		 DEFM "ERROR READING BLOCK!!! "	;
519)   8F57 00          		 DB 0 	;
520)   8F58 F1          		 POP AF	;
521)   8F59 06 02       		 LD B,2	;
522)   8F5B 05          		 DEC B	;
523)   8F5C C9          		 RET  	;
530)   8F5D D5          		STRG_LOADFILE: PUSH DE	;
531)   8F5E C5          		 PUSH BC	;
537)   8F5F CD B6 9D    		 CALL COPYFNAME	;
538)   8F62 AF          		 XOR A   ;READ ONLY 	;READ ONLY
539)   8F63 CD A9 8E    		 CALL STRG_OPNFILE  	;
540)   8F66 20 4B       		 JR NZ, FOPENERR	;
545)   8F68 C1          		 POP BC  ;BYTECOUNT	;BYTECOUNT
546)   8F69 D1          		 POP DE  ;DEST BUFFER	;DEST BUFFER
547)   8F6A CD FC 8E    		 CALL STRG_BLKREAD	;
548)   8F6D 28 20       		 JR Z, FREADOK	;
549)   8F6F CD 81 9D    		 CALL PRINTNUM	;
550)   8F72 CD 26 80    		 CALL OS_PRINTMSG	;
551)   8F75 20 45 52 52 		 DEFM " ERROR READING FILE"	;
551)   8F79 4F 52 20 52 		 DEFM " ERROR READING FILE"	;
551)   8F7D 45 41 44 49 		 DEFM " ERROR READING FILE"	;
551)   8F81 4E 47 20 46 		 DEFM " ERROR READING FILE"	;
551)   8F85 49 4C 45    		 DEFM " ERROR READING FILE"	;
552)   8F88 0A 0D 00    		 DB 10,13,0	;
553)   8F8B D5          		 PUSH DE	;
554)   8F8C C5          		 PUSH BC	;
555)   8F8D 18 24       		 JR FOPENERR	;
556)   8F8F C5          		FREADOK: PUSH BC	;
557)   8F90 CD F4 9B    		 CALL B2D16	;
558)   8F93 21 CB 00    		 LD HL,B2DBUF	;
559)   8F96 CD 88 9C    		 CALL SKIPSPC	;
560)   8F99 CD D1 8B    		 CALL RS_TXT	;
561)   8F9C CD 26 80    		 CALL OS_PRINTMSG	;
562)   8F9F 20 42 59 54 		 DEFM " BYTES READ"	;
562)   8FA3 45 53 20 52 		 DEFM " BYTES READ"	;
562)   8FA7 45 41 44    		 DEFM " BYTES READ"	;
563)   8FAA 0A 0D 00    		 DB 10,13,0	;
564)   8FAD CD EE 8E    		 CALL STRG_CLSFILE	;
565)   8FB0 C1          		 POP BC   ;BYTES LOADED TO BUFFER	;BYTES LOADED TO BUFFER
566)   8FB1 AF          		 XOR A	;
567)   8FB2 C9          		 RET	;
568)   8FB3 C1          		FOPENERR: POP BC	;
569)   8FB4 D1          		 POP DE	;
570)   8FB5 CD 81 9D    		 CALL PRINTNUM	;
571)   8FB8 CD 26 80    		 CALL OS_PRINTMSG	;
572)   8FBB 2D 2D 3E 45 		 DEFM "-->ERROR AT LOADFILE"	;
572)   8FBF 52 52 4F 52 		 DEFM "-->ERROR AT LOADFILE"	;
572)   8FC3 20 41 54 20 		 DEFM "-->ERROR AT LOADFILE"	;
572)   8FC7 4C 4F 41 44 		 DEFM "-->ERROR AT LOADFILE"	;
572)   8FCB 46 49 4C 45 		 DEFM "-->ERROR AT LOADFILE"	;
573)   8FCF 0A 0D 00    		 DB 10,13,0	;
574)   8FD2 21 F0 00    		 LD HL,STRGBUFF	;
575)   8FD5 CD D1 8B    		 CALL RS_TXT	;
576)   8FD8 CD 31 8C    		 CALL RS_NEWLINE	;
577)   8FDB 37          		 SCF	;
578)   8FDC C9          		 RET	;
586)   8FDD D5          		STRG_READBUFR: PUSH DE	;
587)   8FDE C5          		 PUSH BC	;
593)   8FDF CD B6 9D    		 CALL COPYFNAME	;
594)   8FE2 AF          		 XOR A   ;READ ONLY 	;READ ONLY
595)   8FE3 CD A9 8E    		 CALL STRG_OPNFILE  	;
596)   8FE6 20 32       		 JR NZ, RB_FOPENERR	;
601)   8FE8 C1          		 POP BC  ;BYTE OFFSET	;BYTE OFFSET
602)   8FE9 CD 9B 8D    		 CALL STRG_SETPOS16	;
603)   8FEC 01 F4 01    		 LD BC, 500 ;READ 500 BYTES  	;READ 500 BYTES
604)   8FEF D1          		 POP DE  ;DEST BUFFER	;DEST BUFFER
605)   8FF0 CD FC 8E    		 CALL STRG_BLKREAD	;
606)   8FF3 28 1E       		 JR Z, RB_FREADOK	;
607)   8FF5 CD 81 9D    		 CALL PRINTNUM	;
608)   8FF8 CD 26 80    		 CALL OS_PRINTMSG	;
609)   8FFB 20 45 52 52 		 DEFM " ERROR READING FILE"	;
609)   8FFF 4F 52 20 52 		 DEFM " ERROR READING FILE"	;
609)   9003 45 41 44 49 		 DEFM " ERROR READING FILE"	;
609)   9007 4E 47 20 46 		 DEFM " ERROR READING FILE"	;
609)   900B 49 4C 45    		 DEFM " ERROR READING FILE"	;
610)   900E 0A 0D 00    		 DB 10,13,0	;
611)   9011 18 09       		 JR RB_FOPENERR2	;
612)   9013 C5          		RB_FREADOK: PUSH BC	;
620)   9014 CD EE 8E    		 CALL STRG_CLSFILE	;
621)   9017 C1          		 POP BC   ;BYTES LOADED TO BUFFER	;BYTES LOADED TO BUFFER
622)   9018 AF          		 XOR A	;
623)   9019 C9          		 RET	;
624)   901A C1          		RB_FOPENERR: POP BC	;
625)   901B D1          		 POP DE	;
626)   901C CD 81 9D    		RB_FOPENERR2: CALL PRINTNUM	;
627)   901F CD 26 80    		 CALL OS_PRINTMSG	;
628)   9022 2D 2D 3E 45 		 DEFM "-->ERROR OPENING FILE"	;
628)   9026 52 52 4F 52 		 DEFM "-->ERROR OPENING FILE"	;
628)   902A 20 4F 50 45 		 DEFM "-->ERROR OPENING FILE"	;
628)   902E 4E 49 4E 47 		 DEFM "-->ERROR OPENING FILE"	;
628)   9032 20 46 49 4C 		 DEFM "-->ERROR OPENING FILE"	;
628)   9036 45          		 DEFM "-->ERROR OPENING FILE"	;
629)   9037 0A 0D 00    		 DB 10,13,0	;
630)   903A 21 F0 00    		 LD HL,STRGBUFF	;
631)   903D CD D1 8B    		 CALL RS_TXT	;
632)   9040 CD 31 8C    		 CALL RS_NEWLINE	;
633)   9043 37          		 SCF	;
634)   9044 C9          		 RET	;
639)   9045 D5          		STRG_BLKWRITE: PUSH DE	;
640)   9046 3E 3C       		 LD A, CMD_BYTE_WRITE	;
641)   9048 CD 29 92    		     CALL CH376_COMMD	;
642)   904B 79          		     LD A, C                           ; BYTES REQUEST ON BC	; BYTES REQUEST ON BC
643)   904C CD 2D 92    		     CALL CH376_DATAWR	;
644)   904F 78          		     LD A, B	;
645)   9050 CD 2D 92    		     CALL CH376_DATAWR    	;
649)   9053 E1          		 POP HL	;
650)   9054 CD BA 91    		STBW_DOREST: CALL CH376_WTCMDEND 	;
651)   9057 28 1B       		 JR Z, WFR_DONE   ;Z=NO MORE OR CANNOT READ	;Z=NO MORE OR CANNOT READ
652)   9059 FE 1E       		 CP USB_INT_DISK_WRITE                    	;
653)   905B 20 19       		     JR NZ, WFR_ERROR	;
654)   905D 3E 2D       		 LD A,CMD_WR_REQ_DATA	;
655)   905F CD 29 92    		 CALL CH376_COMMD 	;
657)   9062 CD 3C 92    		 CALL CH376_DATARD ;READ BYTE COUNT UP TO 255 BYTES	;READ BYTE COUNT UP TO 255 BYTES
658)   9065 47          		 LD B,A   	;
660)   9066 7E          		STBW_NXT1: LD A,(HL)	;
661)   9067 CD 2D 92    		 CALL CH376_DATAWR	;
662)   906A 23          		 INC HL	;
663)   906B 10 F9       		 DJNZ STBW_NXT1	;
664)   906D 3E 3D       		 LD A, CMD_BYTE_WR_GO 	;
665)   906F CD 29 92    		 CALL CH376_COMMD 	;
666)   9072 18 E0       		 JR STBW_DOREST	;
672)   9074 B7          		 OR A	;
673)   9075 C9          		 RET	;
674)   9076 F5          		WFR_ERROR: PUSH AF	;
675)   9077 CD 81 9D    		 CALL PRINTNUM	;
676)   907A CD 26 80    		 CALL OS_PRINTMSG	;
677)   907D 45 52 52 4F 		 DEFM "ERROR WRITING BLOCK!!! "	;
677)   9081 52 20 57 52 		 DEFM "ERROR WRITING BLOCK!!! "	;
677)   9085 49 54 49 4E 		 DEFM "ERROR WRITING BLOCK!!! "	;
677)   9089 47 20 42 4C 		 DEFM "ERROR WRITING BLOCK!!! "	;
677)   908D 4F 43 4B 21 		 DEFM "ERROR WRITING BLOCK!!! "	;
677)   9091 21 21 20    		 DEFM "ERROR WRITING BLOCK!!! "	;
678)   9094 0D 0A 00    		 DB 13,10,0 	;
679)   9097 F1          		 POP AF	;
680)   9098 06 02       		 LD B,2	;
681)   909A 05          		 DEC B	;
682)   909B C9          		 RET  	;
690)   909C D5          		STRG_SAVEFILE: PUSH DE	;
691)   909D C5          		 PUSH BC	;
692)   909E E5          		 PUSH HL  	;
693)   909F CD 26 80    		 CALL OS_PRINTMSG	;
694)   90A2 0A 0D       		 DB 10,13	;
695)   90A4 53 41 56 45 		 DEFM "SAVE FILE"	;
695)   90A8 20 46 49 4C 		 DEFM "SAVE FILE"	;
695)   90AC 45          		 DEFM "SAVE FILE"	;
696)   90AD 0A 0D 0A 0D 		 DB 10,13,10,13,0	;
696)   90B1 00          		 DB 10,13,10,13,0	;
697)   90B2 E1          		 POP HL	;
698)   90B3 CD B6 9D    		 CALL COPYFNAME	;
699)   90B6 3E 04       		 LD A,4   ;CREATE THE FILE	;CREATE THE FILE
700)   90B8 CD A9 8E    		 CALL STRG_OPNFILE  	;
701)   90BB 20 4E       		 JR NZ, FSAVEERR	;
702)   90BD CD 26 80    		 CALL OS_PRINTMSG	;
703)   90C0 0A 0D       		 DB 10,13	;
704)   90C2 46 49 4C 45 		 DEFM "FILE CREATED OK"	;
704)   90C6 20 43 52 45 		 DEFM "FILE CREATED OK"	;
704)   90CA 41 54 45 44 		 DEFM "FILE CREATED OK"	;
704)   90CE 20 4F 4B    		 DEFM "FILE CREATED OK"	;
705)   90D1 0A 0D 00    		 DB 10,13,0	;
706)   90D4 C1          		 POP BC  ;BYTECOUNT	;BYTECOUNT
707)   90D5 D1          		 POP DE  ;SOURCE BUFFER	;SOURCE BUFFER
708)   90D6 CD 45 90    		 CALL STRG_BLKWRITE	;
709)   90D9 28 19       		 JR Z, FWRITEOK	;
711)   90DB CD 26 80    		 CALL OS_PRINTMSG	;
712)   90DE 20 45 52 52 		 DEFM " ERROR WRITING FILE"	;
712)   90E2 4F 52 20 57 		 DEFM " ERROR WRITING FILE"	;
712)   90E6 52 49 54 49 		 DEFM " ERROR WRITING FILE"	;
712)   90EA 4E 47 20 46 		 DEFM " ERROR WRITING FILE"	;
712)   90EE 49 4C 45    		 DEFM " ERROR WRITING FILE"	;
713)   90F1 0A 0D 00    		 DB 10,13,0	;
714)   90F4 CD 26 80    		FWRITEOK: CALL OS_PRINTMSG	;
715)   90F7 42 59 54 45 		 DEFM "BYTE WRITTEN"	;
715)   90FB 20 57 52 49 		 DEFM "BYTE WRITTEN"	;
715)   90FF 54 54 45 4E 		 DEFM "BYTE WRITTEN"	;
716)   9103 0A 0D 00    		 DB 10,13,0	;
717)   9106 CD EE 8E    		 CALL STRG_CLSFILE	;
718)   9109 AF          		 XOR A	;
719)   910A C9          		 RET	;
720)   910B C1          		FSAVEERR: POP BC	;
721)   910C D1          		 POP DE	;
722)   910D CD 81 9D    		 CALL PRINTNUM	;
723)   9110 CD 26 80    		 CALL OS_PRINTMSG	;
724)   9113 2D 2D 3E 45 		 DEFM "-->ERROR CREATING FILE"	;
724)   9117 52 52 4F 52 		 DEFM "-->ERROR CREATING FILE"	;
724)   911B 20 43 52 45 		 DEFM "-->ERROR CREATING FILE"	;
724)   911F 41 54 49 4E 		 DEFM "-->ERROR CREATING FILE"	;
724)   9123 47 20 46 49 		 DEFM "-->ERROR CREATING FILE"	;
724)   9127 4C 45       		 DEFM "-->ERROR CREATING FILE"	;
725)   9129 0A 0D 00    		 DB 10,13,0	;
726)   912C 21 F0 00    		 LD HL,STRGBUFF	;
727)   912F CD D1 8B    		 CALL RS_TXT	;
728)   9132 CD 31 8C    		 CALL RS_NEWLINE	;
729)   9135 37          		 SCF	;
730)   9136 C9          		 RET	;
740)   9137 C5          		STRG_WRITEBUFR: PUSH BC	;
741)   9138 D5          		 PUSH DE	;
742)   9139 CD B6 9D    		 CALL COPYFNAME   ;HL NOT NEEDED AFTER THIS	;HL NOT NEEDED AFTER THIS
743)   913C 3E 01       		 LD A,1    ;OPEN THE FILE FOR W	;OPEN THE FILE FOR W
744)   913E CD A9 8E    		 CALL STRG_OPNFILE  	;
745)   9141 20 0B       		 JR NZ,SWB_CREATE  ;ON ERROR TRY TO CREATE THE FILE	;ON ERROR TRY TO CREATE THE FILE
747)   9143 01 FF FF    		 LD BC,$FFFF	;
748)   9146 11 FF FF    		 LD DE,$FFFF 	;
749)   9149 CD A4 8D    		 CALL STRG_SETPOS  ;GOTO EOF	;GOTO EOF
750)   914C 18 09       		 JR SWB_WRITEBUF	;
752)   914E 3E 04       		 LD A,4	;
753)   9150 CD A9 8E    		 CALL STRG_OPNFILE  	;
754)   9153 3E 97       		 LD A,151   ;ERROR NUMBER	;ERROR NUMBER
755)   9155 20 0D       		 JR NZ, SWB_ERR	;
756)   9157 D1          		SWB_WRITEBUF: POP DE	;
757)   9158 C1          		 POP BC    ;THE BYTE COUNT  	;THE BYTE COUNT
758)   9159 CD 45 90    		 CALL STRG_BLKWRITE  	;
759)   915C F5          		 PUSH AF	;
760)   915D CD EE 8E    		 CALL STRG_CLSFILE  ;ALWAYS CLOSE FILE	;ALWAYS CLOSE FILE
761)   9160 F1          		 POP AF	;
762)   9161 C0          		 RET NZ    ;NZ IF ERROR	;NZ IF ERROR
763)   9162 AF          		 XOR A	;
764)   9163 C9          		 RET	;
765)   9164 D1          		SWB_ERR: POP DE	;
766)   9165 C1          		 POP BC  	;
767)   9166 37          		 SCF	;
768)   9167 C9          		 RET  	;
  3)   9168 	            		INT376CMD EQU DEV376+1	;
  4)   9168 	            		INT376DAT EQU DEV376	;
 90)   9168 CD 3C 92    		CH376_GETDATA: CALL CH376_DATARD	;
 91)   916B FE 00       		 CP 0	;
 92)   916D C8          		 RET Z   ;NO DATA AVAILABLE	;NO DATA AVAILABLE
 99)   916E F5          		               PUSH AF	;
100)   916F 11 8B 00    		 LD DE,USBBUF	;
101)   9172 47          		 LD B,A	;
102)   9173 CD 3C 92    		UDC_NXT1: CALL CH376_DATARD	;
104)   9176 12          		 LD (DE),A	;
105)   9177 13          		 INC DE	;
109)   9178 10 F9       		 DJNZ UDC_NXT1 	;
110)   917A F1          		               POP AF	;
111)   917B C9          		 RET	;
114)   917C F5          		DISKERROR: PUSH AF	;
115)   917D CD DB 8B    		 CALL RS_MESG	;
116)   9180 46 41 54 41 		 DEFM "FATAL ERROR:" 	;
116)   9184 4C 20 45 52 		 DEFM "FATAL ERROR:" 	;
116)   9188 52 4F 52 3A 		 DEFM "FATAL ERROR:" 	;
117)   918C 00          		 DB 0  	;
118)   918D F1          		 POP AF	;
119)   918E CD 81 9D    		 CALL PRINTNUM	;
120)   9191 21 9D 91    		 LD HL,ERR_PART	;
121)   9194 FE 92       		 CP ERR_TYPE_ERROR	;
122)   9196 28 01       		 JR Z,PRNMES	;
123)   9198 C9          		 RET	;
124)   9199 CD D1 8B    		PRNMES: CALL RS_TXT 	;
125)   919C C9          		 RET	;
127)   919D 50 41 52 54 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91A1 49 54 49 4F 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91A5 4E 2E 4E 4F 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91A9 54 2E 53 55 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91AD 50 50 4F 52 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91B1 54 45 44 21 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91B5 21 21       		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
128)   91B7 0A 0D 00    		 DB 10,13,0	;
138)   91BA E5          		CH376_WTCMDEND: PUSH HL	;
139)   91BB CD C8 91    		 CALL CH376_WAITINT	;
140)   91BE E1          		 POP HL	;
141)   91BF C0          		               RET NZ	;
142)   91C0 D8          		 RET C	;
143)   91C1 AF          		 XOR A	;
144)   91C2 CD E7 91    		 CALL CH376_GETSTAT	;
145)   91C5 FE 14       		 CP USB_INT_SUCCESS  	;
146)   91C7 C9          		 RET  ;NZ FLAG MEANS ERROR USUALLY	;NZ FLAG MEANS ERROR USUALLY
152)   91C8 AF          		CH376_WAITINT: XOR A	;
153)   91C9 01 32 00    		 LD BC,50	;
154)   91CC CD 39 92    		C3AGN2: CALL CH376_INSTAT	;
155)   91CF CB 7F       		 BIT 7,A	;
156)   91D1 C8          		 RET Z	;
157)   91D2 F5          		 PUSH AF	;
158)   91D3 C5          		 PUSH BC	;
159)   91D4 06 04       		 LD B,20/5	;
160)   91D6 CD 24 9B    		 CALL DELAY5MICS	;
161)   91D9 C1          		 POP BC	;
162)   91DA F1          		 POP AF	;
163)   91DB 0B          		 DEC BC	;
164)   91DC 5F          		 LD E,A	;
165)   91DD 78          		 LD A,B	;
166)   91DE B1          		 OR C	;
167)   91DF 7B          		 LD A,E	;
168)   91E0 20 EA       		 JR NZ, C3AGN2  	;
173)   91E2 37          		 SCF ;TIMEOUT       	;TIMEOUT
174)   91E3 06 02       		 LD B,2	;
175)   91E5 05          		 DEC B  ;NZ FLAG	;NZ FLAG
176)   91E6 C9          		 RET	;
178)   91E7 3E 22       		CH376_GETSTAT: LD A,CMD_GET_STATUS	;
179)   91E9 CD 29 92    		 CALL CH376_COMMD	;
180)   91EC CD 3C 92    		 CALL CH376_DATARD	;
181)   91EF C9          		 RET	;
189)   91F0 01 C4 09    		CH376_CHOK: LD BC,2500	;
190)   91F3 CD 39 92    		C3AGN: CALL CH376_INSTAT	;
191)   91F6 CB 67       		 BIT 4,A   ;CHECK BUSY	;CHECK BUSY
192)   91F8 C8          		 RET Z   	;
193)   91F9 C5          		 PUSH BC	;
194)   91FA F5          		 PUSH AF	;
195)   91FB 06 0A       		 LD B,50/5	;
196)   91FD CD 24 9B    		 CALL DELAY5MICS	;
197)   9200 F1          		 POP AF	;
198)   9201 C1          		 POP BC	;
199)   9202 0B          		 DEC BC	;
200)   9203 5F          		 LD E,A	;
201)   9204 78          		 LD A,B	;
202)   9205 B1          		 OR C	;
203)   9206 7B          		 LD A,E	;
204)   9207 20 EA       		 JR NZ,C3AGN	;
205)   9209 F5          		 PUSH AF  	;
206)   920A CD 81 9D    		 CALL PRINTNUM  	;
207)   920D F1          		 POP AF	;
208)   920E CD DB 8B    		 CALL RS_MESG	;
209)   9211 2A 2A 2A 43 		 DEFM "***CMD TIMEOUT***"	;
209)   9215 4D 44 20 54 		 DEFM "***CMD TIMEOUT***"	;
209)   9219 49 4D 45 4F 		 DEFM "***CMD TIMEOUT***"	;
209)   921D 55 54 2A 2A 		 DEFM "***CMD TIMEOUT***"	;
209)   9221 2A          		 DEFM "***CMD TIMEOUT***"	;
210)   9222 0A 0D 00    		 DB 10,13,0       	;
211)   9225 06 02       		 LD B,2	;
212)   9227 05          		 DEC B  ;NZ FLAG	;NZ FLAG
213)   9228 C9          		 RET	;
219)   9229 D3 31       		CH376_COMMD: OUT (INT376CMD),A	;
220)   922B 18 02       		 JR C3D_CONT	;
223)   922D D3 30       		CH376_DATAWR: OUT (INT376DAT),A 	;
224)   922F C5          		C3D_CONT: PUSH BC	;
225)   9230 D5          		 PUSH DE	;
226)   9231 E5          		 PUSH HL	;
227)   9232 CD F0 91    		 CALL CH376_CHOK  ;CHECK NOT BUSY	;CHECK NOT BUSY
228)   9235 E1          		 POP HL	;
229)   9236 D1          		 POP DE	;
230)   9237 C1          		 POP BC	;
231)   9238 C9          		 RET	;
233)   9239 DB 31       		CH376_INSTAT: IN A,(INT376CMD)	;
235)   923B C9          		 RET	;
238)   923C DB 30       		CH376_DATARD: IN A,(INT376DAT)	;
243)   923E C9          		 RET	;
246)   923F 3E 01       		CH376_VERSION: LD A,CMD_GET_IC_VER 	;
247)   9241 CD 29 92    		 CALL CH376_COMMD	;
248)   9244 CD 3C 92    		 CALL CH376_DATARD	;
249)   9247 E6 0F       		 AND 00001111B	;
250)   9249 C9          		               RET	;
252)   924A 3E 05       		CH376_INIT:    LD A,CMD_RESET_ALL	;
253)   924C CD 29 92    		 CALL CH376_COMMD  	;
254)   924F 3E 06       		 LD A,CMD_CHECK_EXIST 	;
255)   9251 CD 29 92    		 CALL CH376_COMMD	;
256)   9254 3E 57       		 LD A,87	;
257)   9256 CD 2D 92    		 CALL CH376_DATAWR	;
258)   9259 CD 3C 92    		 CALL CH376_DATARD	;
259)   925C FE A8       		 CP 255 - 87 	;
260)   925E C9          		               RET               	;
264)   925F F5          		CH376_SETUSB: PUSH AF	;
265)   9260 3E 15       		               LD A,CMD_SETUSB_MODE	;
266)   9262 CD 29 92    		 CALL CH376_COMMD	;
267)   9265 F1          		               POP AF	;
268)   9266 CD 2D 92    		 CALL CH376_DATAWR	;
270)   9269 06 04       		 LD B,20/5	;
271)   926B CD 24 9B    		 CALL DELAY5MICS     ;WAIT A BIT	;WAIT A BIT
276)   926E CD E7 91    		 CALL CH376_GETSTAT	;
277)   9271 FE 15       		 CP USB_INT_CONNECT	;
278)   9273 C8          		 RET Z	;
280)   9274 F5          		 PUSH AF	;
281)   9275 CD DB 8B    		 CALL CH376_ERROR	;
282)   9278 45 52 52 3A 		 DEFM "ERR: SETUSBMODE"	;
282)   927C 20 53 45 54 		 DEFM "ERR: SETUSBMODE"	;
282)   9280 55 53 42 4D 		 DEFM "ERR: SETUSBMODE"	;
282)   9284 4F 44 45    		 DEFM "ERR: SETUSBMODE"	;
283)   9287 0A 0D 00    		 DB 10,13,0	;
284)   928A F1          		 POP AF	;
285)   928B CD 81 9D    		 CALL PRINTNUM	;
286)   928E C9          		               RET	;
291)   928F 3E 30       		CH376_CONNECT: LD A, CMD_DISK_CONNECT	;
292)   9291 CD 29 92    		     CALL CH376_COMMD	;
293)   9294 CD BA 91    		 CALL CH376_WTCMDEND	;
295)   9297 D8          		 RET C ;TIMEOUT	;TIMEOUT
296)   9298 C8          		 RET Z ;CONNECT OK	;CONNECT OK
301)   9299 C9          		 RET ;NZ HERE	;NZ HERE
311)   929A 3E 31       		CH376_MOUNT:   LD A,CMD_DISK_MOUNT  	;
312)   929C CD 29 92    		 CALL CH376_COMMD	;
313)   929F CD BA 91    		 CALL CH376_WTCMDEND  	;
314)   92A2 C9          		 RET	;
319)   92A3 06 0A       		CH376_MOUNTDEV:   LD B,10  ;TRY TO MOUNT 10 TIMES	;TRY TO MOUNT 10 TIMES
320)   92A5 C5          		CM_AGN1: PUSH BC	;
321)   92A6 CD 5F 92    		 CALL CH376_SETUSB	;
322)   92A9 20 10       		 JR NZ,CM_ERROR	;
323)   92AB CD 8F 92    		 CALL CH376_CONNECT	;
324)   92AE 20 0B       		 JR NZ,CM_ERROR	;
325)   92B0 3E 31       		        LD A,CMD_DISK_MOUNT  	;
326)   92B2 CD 29 92    		 CALL CH376_COMMD	;
327)   92B5 CD BA 91    		 CALL CH376_WTCMDEND	;
328)   92B8 C1          		 POP BC	;
329)   92B9 C8          		 RET Z	;
330)   92BA C5          		 PUSH BC	;
331)   92BB 06 64       		CM_ERROR: LD B,100	;
332)   92BD CD 37 9B    		 CALL DELAYMILI     ;WAIT A BIT	;WAIT A BIT
333)   92C0 C1          		 POP BC	;
334)   92C1 10 E2       		 DJNZ CM_AGN1  	;
335)   92C3 06 02       		 LD B,2	;
336)   92C5 05          		 DEC B  ;NZ  	;NZ
337)   92C6 F5          		 PUSH AF	;
338)   92C7 CD DB 8B    		 CALL CH376_ERROR	;
339)   92CA 45 52 52 3A 		 DEFM "ERR: MOUNT DISK"	;
339)   92CE 20 4D 4F 55 		 DEFM "ERR: MOUNT DISK"	;
339)   92D2 4E 54 20 44 		 DEFM "ERR: MOUNT DISK"	;
339)   92D6 49 53 4B    		 DEFM "ERR: MOUNT DISK"	;
340)   92D9 0A 0D 00    		 DB 10,13,0	;
341)   92DC F1          		     POP AF	;
342)   92DD C9          		               RET	;
345)   92DE 7E          		CH376_WRSTRING: LD A,(HL)	;
351)   92DF CD 2D 92    		 CALL CH376_DATAWR	;
352)   92E2 C0          		 RET NZ	;
353)   92E3 7E          		 LD A,(HL)	;
354)   92E4 B7          		 OR A	;
355)   92E5 C8          		 RET Z	;
356)   92E6 23          		 INC HL	;
357)   92E7 18 F5       		 JR CH376_WRSTRING	;
  7)   92E9 	            		 DI2C_STA EQU DEVI2C+0      ;00 A0=LOW A1=LOW READONLY  DEF $F8	;00 A0=LOW A1=LOW READONLY  DEF $F8
  8)   92E9 	            		 DI2C_INDPTR EQU DEVI2C+0     ;00 A0=LOW A1=LOW WRITEONLY DEF $00	;00 A0=LOW A1=LOW WRITEONLY DEF $00
  9)   92E9 	            		 DI2C_DAT EQU DEVI2C+1      ;01 A0=HIGH A1=LOW R/W   DEF $00	;01 A0=HIGH A1=LOW R/W   DEF $00
 10)   92E9 	            		 DI2C_CON EQU DEVI2C+3      ;11 A0=HIGH A1=HIGH R/W  DEF $00	;11 A0=HIGH A1=HIGH R/W  DEF $00
 11)   92E9 	            		 DI2C_INDIR EQU DEVI2C+2     ;10 A0=LOW A1=HIGH R/W  DEF $00	;10 A0=LOW A1=HIGH R/W  DEF $00
 56)   92E9 C5          		I2C_RDSTAT_WT: PUSH BC	;
 57)   92EA 01 00 20    		 LD BC, $2000	;
 58)   92ED DB 73       		I2CRWT_AGN: IN A, (DI2C_CON)      ;READ CONTROL REGISTER BIT 3 IS SI	;READ CONTROL REGISTER BIT 3 IS SI
 59)   92EF CB 5F       		 BIT 3, A        ;CHECK BIT 3 SI	;CHECK BIT 3 SI
 60)   92F1 20 05       		 JR NZ, I2CRWT_OK       ;BIT 3 SHOULD BE SET IF VALID STATUS	;BIT 3 SHOULD BE SET IF VALID STATUS
 61)   92F3 0B          		 DEC BC	;
 62)   92F4 78          		 LD A, B	;
 63)   92F5 B1          		 OR C	;
 64)   92F6 20 F5       		 JR NZ, I2CRWT_AGN	;
 65)   92F8 C1          		I2CRWT_OK: POP BC	;
 66)   92F9 DB 70       		 IN A, (DI2C_STA)       ;VALID HERE	;VALID HERE
 67)   92FB C9          		 RET	;
 69)   92FC DB 73       		I2C_RDSTAT_NW: IN A, (DI2C_CON)      ;READ CONTROL REGISTER BIT 3 IS SI	;READ CONTROL REGISTER BIT 3 IS SI
 70)   92FE CB 5F       		 BIT 3, A        ;CHECK BIT 3 SI	;CHECK BIT 3 SI
 71)   9300 3E FF       		 LD A, $FF        ;$FF=INVALID STATUS	;$FF=INVALID STATUS
 72)   9302 C8          		 RET Z         ;BIT 3 SHOULD BE SET IF VALID STATUS	;BIT 3 SHOULD BE SET IF VALID STATUS
 73)   9303 DB 70       		 IN A, (DI2C_STA)       ;VALID HERE	;VALID HERE
 74)   9305 C9          		 RET	;
 77)   9306 3E 01       		I2C_INIT: LD A, I2CADR	;
 78)   9308 D3 70       		 OUT (DI2C_INDPTR), A	;
 79)   930A 3E E0       		 LD A, $E0	;
 80)   930C D3 72       		 OUT (DI2C_INDIR), A       ;SET MY SLAVE ADDR	;SET MY SLAVE ADDR
 82)   930E 3E 40       		 LD A, $40        ;INIT	;INIT
 83)   9310 D3 73       		 OUT (DI2C_CON), A      ;	;
 84)   9312 06 64       		 LD B, 500/5	;
 85)   9314 CD 24 9B    		 CALL DELAY5MICS	;
 92)   9317 3E 06       		 LD A, I2CMODE	;
 93)   9319 D3 70       		 OUT (DI2C_INDPTR), A      ;SELECT I2CMODE REGISTER	;SELECT I2CMODE REGISTER
 94)   931B 3E 00       		 LD A, 0        ;SELECT MODE 0	;SELECT MODE 0
 95)   931D D3 72       		 OUT (DI2C_INDIR), A	;
 96)   931F 3E 02       		 LD A, I2CSCLL	;
 97)   9321 D3 70       		 OUT (DI2C_INDPTR), A      ;SELECT I2CMODE REGISTER	;SELECT I2CMODE REGISTER
 98)   9323 3E 9D       		 LD A, $9D        ;SELECT CLK L	;SELECT CLK L
 99)   9325 D3 72       		 OUT (DI2C_INDIR), A	;
100)   9327 3E 03       		 LD A, I2CSCLH	;
101)   9329 D3 70       		 OUT (DI2C_INDPTR), A      ;SELECT I2CMODE REGISTER	;SELECT I2CMODE REGISTER
102)   932B 3E 86       		 LD A, $86        ;SELECT CLK H	;SELECT CLK H
103)   932D D3 72       		 OUT (DI2C_INDIR), A	;
105)   932F C9          		 RET	;
112)   9330 3E 60       		I2C_WR_BYTE: LD A, $60       ;START	;START
113)   9332 D3 73       		 OUT (DI2C_CON), A	;
114)   9334 CD E9 92    		WRB_LP1: CALL I2C_RDSTAT_WT      ;WAIT FOR INTERRUPT SI=1	;WAIT FOR INTERRUPT SI=1
115)   9337 5F          		 LD E, A        ;SAVE STATUS	;SAVE STATUS
116)   9338 FE 08       		 CP MASTER_START_TXed      ;A HAS THE STATUS	;A HAS THE STATUS
117)   933A 28 21       		 JR Z, WRB_S1	;
118)   933C FE 10       		 CP MASTER_RESTART_TXed	;
119)   933E 28 1D       		 JR Z, WRB_S1	;
120)   9340 FE 28       		 CP MASTER_DATA_W_ACK	;
121)   9342 28 26       		 JR Z, WRB_S2	;
122)   9344 FE 18       		 CP MASTER_SLA_W_ACK	;
123)   9346 28 23       		 JR Z, WRB_S3	;
124)   9348 FE 20       		 CP MASTER_SLA_W_NAK	;
125)   934A 28 2D       		 JR Z, WRB_EXIT	;
126)   934C FE 30       		 CP MASTER_DATA_W_NAK	;
127)   934E 28 29       		 JR Z, WRB_EXIT	;
128)   9350 FE 38       		 CP MASTER_ARB_LOST	;
129)   9352 C8          		 RET Z	;
130)   9353 FE B0       		 CP SLAVE_AL_ADDRESSED_R	;
131)   9355 C8          		 RET Z	;
132)   9356 FE 68       		 CP SLAVE_AL_ADDRESSED_W	;
133)   9358 C8          		 RET Z	;
134)   9359 FE D8       		 CP SLAVE_GENERALCALL_AL	;
135)   935B C8          		 RET Z	;
136)   935C C9          		 RET	;
138)   935D 7A          		WRB_S1: LD A, D        ;DEVICE ADDR	;DEVICE ADDR
139)   935E CB 27       		 SLA A	;
140)   9360 E6 FE       		 AND $FE        ;ADDR+WRITE ON D0=0	;ADDR+WRITE ON D0=0
141)   9362 D3 71       		 OUT (DI2C_DAT), A	;
142)   9364 3E 40       		 LD A, $40	;
143)   9366 D3 73       		 OUT (DI2C_CON), A	;
144)   9368 18 CA       		 JR WRB_LP1	;
145)   936A 0B          		WRB_S2: DEC BC	;
146)   936B 78          		WRB_S3: LD A, B	;
147)   936C B1          		 OR C	;
148)   936D 28 0A       		 JR Z, WRB_EXIT	;
149)   936F 7E          		 LD A, (HL)	;
150)   9370 23          		 INC HL	;
151)   9371 D3 71       		 OUT (DI2C_DAT), A	;
152)   9373 3E 40       		 LD A, $40	;
153)   9375 D3 73       		 OUT (DI2C_CON), A	;
154)   9377 18 BB       		 JR WRB_LP1	;
156)   9379 3E 50       		WRB_EXIT: LD A, $50       ;STOP	;STOP
157)   937B D3 73       		 OUT (DI2C_CON), A	;
158)   937D 78          		 LD A, B	;
159)   937E B1          		 OR C	;
160)   937F C9          		 RET         ;IF A NOT ZERO THEN ERROR	;IF A NOT ZERO THEN ERROR
166)   9380 78          		I2C_RD_BYTE: LD A, B	;
167)   9381 B1          		 OR C	;
168)   9382 C8          		 RET Z        ;RETURN IF ZERO BYTE COUNT	;RETURN IF ZERO BYTE COUNT
169)   9383 3E 60       		 LD A, $60	;
170)   9385 D3 73       		 OUT (DI2C_CON), A	;
171)   9387 CD E9 92    		RDB_LP1: CALL I2C_RDSTAT_WT      ;WAIT FOR INTERRUPT SI=1	;WAIT FOR INTERRUPT SI=1
172)   938A 1E 00       		 LD E, 0	;
173)   938C FE 08       		 CP MASTER_START_TXed	;
174)   938E 28 1F       		 JR Z, RDB_S1	;
176)   9390 28 1D       		 JR Z, RDB_S1	;
177)   9392 FE 58       		 CP MASTER_DATA_R_NAK	;
178)   9394 28 26       		 JR Z, RDB_S2	;
179)   9396 FE 50       		 CP MASTER_DATA_R_ACK	;
180)   9398 28 24       		 JR Z, RDB_S3	;
181)   939A FE 40       		 CP MASTER_SLA_R_ACK	;
182)   939C 28 25       		 JR Z, RDB_S4	;
183)   939E FE 48       		 CP MASTER_SLA_R_NAK	;
184)   93A0 28 38       		 JR Z, RDB_EXIT	;
185)   93A2 FE 38       		 CP MASTER_ARB_LOST	;
186)   93A4 C8          		 RET Z	;
187)   93A5 FE B0       		 CP SLAVE_AL_ADDRESSED_R	;
188)   93A7 C8          		 RET Z	;
189)   93A8 FE 68       		 CP SLAVE_AL_ADDRESSED_W	;
190)   93AA C8          		 RET Z	;
191)   93AB FE D8       		 CP SLAVE_GENERALCALL_AL	;
192)   93AD C8          		 RET Z	;
193)   93AE C9          		 RET	;
196)   93AF 7A          		RDB_S1: LD A, D        ;DEVICE ADDR	;DEVICE ADDR
197)   93B0 CB 27       		 SLA A	;
198)   93B2 F6 01       		 OR $01         ;ADDR + READ COMMAND	;ADDR + READ COMMAND
199)   93B4 D3 71       		 OUT (DI2C_DAT), A	;
200)   93B6 3E 40       		 LD A, $40	;
201)   93B8 D3 73       		 OUT (DI2C_CON), A	;
202)   93BA 18 CB       		 JR RDB_LP1	;
203)   93BC 1E 01       		RDB_S2: LD E, 1        ;MEANS WE EXIT	;MEANS WE EXIT
204)   93BE DB 71       		RDB_S3: IN A, (DI2C_DAT)       ;READ DATA	;READ DATA
205)   93C0 77          		 LD (HL), A	;
206)   93C1 23          		 INC HL	;
207)   93C2 0B          		 DEC BC	;
208)   93C3 78          		RDB_S4: LD A, B        ; IS LENGTH 0	; IS LENGTH 0
209)   93C4 B1          		 OR C	;
210)   93C5 28 13       		 JR Z, RDB_EXIT	;
211)   93C7 7B          		 LD A, E	;
212)   93C8 FE 01       		 CP 1	;
213)   93CA 28 0E       		 JR Z, RDB_EXIT	;
214)   93CC 78          		 LD A, B	;
215)   93CD 81          		 ADD C	;
216)   93CE FE 01       		 CP 1	;
217)   93D0 3E 40       		 LD A, $40	;
218)   93D2 28 02       		 JR Z, RDB_NXT1	;
219)   93D4 3E C0       		 LD A, $C0	;
220)   93D6 D3 73       		RDB_NXT1: OUT (DI2C_CON), A      ;WRITE $40 IF BYTE COUNT BC=1 ELSE WRITE $C0	;WRITE $40 IF BYTE COUNT BC=1 ELSE WRITE $C0
221)   93D8 18 AD       		 JR RDB_LP1	;
223)   93DA 3E 50       		RDB_EXIT: LD A, $50	;
224)   93DC D3 73       		 OUT (DI2C_CON), A	;
225)   93DE 78          		 LD A, B	;
226)   93DF B1          		 OR C	;
227)   93E0 C9          		 RET         ;IF A NOT ZERO THEN ERROR	;IF A NOT ZERO THEN ERROR
113)   93E1 16 00       		LCD16_WR4BITS: LD D, 0       ;PIN MAP VALUES FRO 8574 BIT 0-7	;PIN MAP VALUES FRO 8574 BIT 0-7
115)   93E3 0F          		 RRCA         ;D4 = D0,D5=D1,D6=D2,D7=D3	;D4 = D0,D5=D1,D6=D2,D7=D3
116)   93E4 30 02       		 JR NC, LWNXT1        ;BIT 0 NOT SET JR	;BIT 0 NOT SET JR
117)   93E6 CB E2       		 SET D4, D	;
118)   93E8 0F          		LWNXT1: RRCA	;
119)   93E9 30 02       		 JR NC, LWNXT2        ;BIT 1 NOT SET JR	;BIT 1 NOT SET JR
120)   93EB CB EA       		 SET D5, D	;
121)   93ED 0F          		LWNXT2: RRCA	;
122)   93EE 30 02       		 JR NC, LWNXT3        ;BIT 2 NOT SET JR	;BIT 2 NOT SET JR
123)   93F0 CB F2       		 SET D6, D	;
124)   93F2 0F          		LWNXT3: RRCA	;
125)   93F3 30 02       		 JR NC, LWNXT4        ;BIT 3 NOT SET JR	;BIT 3 NOT SET JR
126)   93F5 CB FA       		 SET D7, D	;
127)   93F7 7B          		LWNXT4: LD A, E	;
128)   93F8 0F          		 RRCA	;
129)   93F9 30 02       		 JR NC, LWNXT5	;
130)   93FB CB C2       		 SET RS, D	;
132)   93FD 3A 7F 00    		 LD A,(LCD_STSMASK)       ;ADD THE BACKLIGHT MASKS  	;ADD THE BACKLIGHT MASKS
133)   9400 B2          		 OR D	;
134)   9401 57          		 LD D,A	;
136)   9402 CB D2       		 SET EN, D        ;EN=HIGH	;EN=HIGH
137)   9404 7A          		 LD A, D	;
138)   9405 CD 0F 94    		 CALL LCD16_I2CSEND	;
139)   9408 CB 92       		 RES EN, D        ;EN=LOW	;EN=LOW
140)   940A 7A          		 LD A, D	;
141)   940B CD 0F 94    		 CALL LCD16_I2CSEND	;
142)   940E C9          		 RET	;
146)   940F D5          		LCD16_I2CSEND: PUSH DE	;
147)   9410 E5          		 PUSH HL	;
148)   9411 21 CB 00    		 LD HL, BUFFER	;
149)   9414 77          		 LD (HL), A	;
150)   9415 16 27       		 LD D, LCDADDR	;
151)   9417 01 01 00    		 LD BC, 1	;
152)   941A CD 30 93    		 CALL I2C_WRITE	;
153)   941D E1          		 POP HL	;
154)   941E D1          		 POP DE	;
155)   941F C9          		 RET	;
158)   9420 1E 00       		LCD16_COMMD: LD E, COMMAND	;
159)   9422 18 02       		 JR LCD16_SEND	;
162)   9424 1E 01       		LCD16_DATA: LD E, LCD_DATA 	;
165)   9426 57          		LCD16_SEND: LD D, A       ;SAVE A FOR LATER USE	;SAVE A FOR LATER USE
166)   9427 7B          		 LD A, E	;
167)   9428 0F          		 RRCA	;
168)   9429 38 07       		 JR C, ISCMDDATA	;
169)   942B 0F          		 RRCA	;
170)   942C 30 04       		 JR NC, ISCMDDATA	;
172)   942E 1E 00       		 LD E, COMMAND        ;SEND 4 BITS AS COMMAND E=0	;SEND 4 BITS AS COMMAND E=0
173)   9430 18 0E       		 JR LCSD_4BIT	;
174)   9432 7A          		ISCMDDATA: LD A, D	;
175)   9433 CB 3F       		 SRL A	;
176)   9435 CB 3F       		 SRL A	;
177)   9437 CB 3F       		 SRL A	;
178)   9439 CB 3F       		 SRL A	;
179)   943B D5          		 PUSH DE	;
180)   943C CD E1 93    		 CALL LCD16_WR4BITS      ;HIGH 4 BITS FIRST	;HIGH 4 BITS FIRST
181)   943F D1          		 POP DE	;
182)   9440 7A          		LCSD_4BIT: LD A, D	;
183)   9441 E6 0F       		 AND $0F	;
184)   9443 CD E1 93    		 CALL LCD16_WR4BITS      ;LOW 4 BITS NEXT	;LOW 4 BITS NEXT
185)   9446 C9          		 RET	;
187)   9447 06 04       		PAUSE: LD B,4	;
188)   9449 CD 37 9B    		 CALL DELAYMILI	;
189)   944C C9          		 RET	;
191)   944D 3E 03       		@LCD16_INIT: LD A, 3       ;SET LCD TO 4BIT MODE	;SET LCD TO 4BIT MODE
192)   944F 1E 02       		 LD E, FOUR_BITS	;
193)   9451 CD 26 94    		 CALL LCD16_SEND	;
194)   9454 CD 47 94    		 CALL PAUSE        ;DELAY 4,5ms	;DELAY 4,5ms
195)   9457 3E 03       		 LD A, 3	;
196)   9459 1E 02       		 LD E, FOUR_BITS	;
197)   945B CD 26 94    		 CALL LCD16_SEND	;
198)   945E CD 47 94    		 CALL PAUSE        ;DELAY 4,5ms	;DELAY 4,5ms
199)   9461 3E 03       		 LD A, 3	;
200)   9463 1E 02       		 LD E, FOUR_BITS	;
201)   9465 CD 26 94    		 CALL LCD16_SEND	;
202)   9468 CD 47 94    		 CALL PAUSE        ;DELAY 4,5ms	;DELAY 4,5ms
203)   946B 3E 02       		 LD A, 2        ;PUT 4 BIT MODE	;PUT 4 BIT MODE
204)   946D 1E 02       		 LD E, FOUR_BITS	;
205)   946F CD 26 94    		 CALL LCD16_SEND	;
206)   9472 CD 47 94    		 CALL PAUSE        ;DELAY 4,5ms	;DELAY 4,5ms
208)   9475 3E 28       		 LD A, LCD_FUNCTIONSET OR LCD_2LINE	;
209)   9477 CD 20 94    		 CALL LCD16_COMMD	;
210)   947A 3E 02       		 LD A, LCD_DISPLAYON OR LCD_CURSOROFF OR LCD_BLINKOFF	;
211)   947C 32 7D 00    		 LD (LCD_DSPCTRL), A	;
212)   947F CD A4 94    		 CALL LCD16_DISP	;
213)   9482 CD B8 94    		 CALL LCD16_CLR	;
214)   9485 3E 02       		 LD A, LCD_ENTRYLEFT OR LCD_ENTRYSHIFTDECREMENT	;
215)   9487 32 7E 00    		 LD (LCD_DSPMODE), A	;
216)   948A F6 04       		 OR LCD_ENTRYMODESET	;
217)   948C CD 20 94    		 CALL LCD16_COMMD	;
218)   948F CD 47 94    		 CALL PAUSE        ;DELAY 4,5ms	;DELAY 4,5ms
219)   9492 CD 3B 95    		 CALL LCD16_BKLTON      ;BACKLIGHT ON BY DEFAULT	;BACKLIGHT ON BY DEFAULT
220)   9495 C9          		 RET	;
222)   9496 3A 7D 00    		@LCD16_NODISP: LD A, (LCD_DSPCTRL)	;
223)   9499 CB 97       		 RES LCD_DISPLAYON, A	;
224)   949B 32 7D 00    		 LD (LCD_DSPCTRL), A	;
225)   949E F6 08       		 OR LCD_DISPLAYCONTROL	;
226)   94A0 CD 20 94    		 CALL LCD16_COMMD	;
227)   94A3 C9          		 RET	;
228)   94A4 3A 7D 00    		@LCD16_DISP: LD A, (LCD_DSPCTRL)	;
229)   94A7 CB D7       		 SET LCD_DISPLAYON, A	;
230)   94A9 32 7D 00    		 LD (LCD_DSPCTRL), A	;
231)   94AC F6 08       		 OR LCD_DISPLAYCONTROL	;
232)   94AE CD 20 94    		 CALL LCD16_COMMD	;
233)   94B1 C9          		 RET	;
235)   94B2 06 02       		LCDDELAY: LD B, HOME_CLEAR_EXEC	;
236)   94B4 CD 37 9B    		LCLR_AGN1: CALL DELAYMILI 	;
237)   94B7 C9          		 RET	;
239)   94B8 3E 01       		@LCD16_CLR: LD A, LCD_CLEARDISPLAY      ;clear display, set cursor position to zero	;clear display, set cursor position to zero
240)   94BA CD 20 94    		 CALL LCD16_COMMD	;
241)   94BD CD B2 94    		 CALL LCDDELAY	;
242)   94C0 C9          		 RET	;
245)   94C1 7E          		@LCD16_PRINT: LD A, (HL)	;
246)   94C2 FE 00       		 CP 0	;
247)   94C4 C8          		 RET Z	;
248)   94C5 CD 24 94    		 CALL LCD16_DATA	;
249)   94C8 23          		 INC HL	;
250)   94C9 18 F6       		 JR LCD16_PRINT	;
253)   94CB CD 24 94    		@LCD16_PRCHR: CALL LCD16_DATA	;
254)   94CE C9          		 RET	;
256)   94CF 3E 02       		@LCD16_HOME: LD A, LCD_RETURNHOME	;
257)   94D1 CD 20 94    		 CALL LCD16_COMMD	;
258)   94D4 CD B2 94    		 CALL LCDDELAY	;
259)   94D7 C9          		 RET	;
262)   94D8 00 40 14 54 		ROWOFFSET: DB $00,$40,$14,$54	;
263)   94DC 06 00       		@LCD16_SETCURS: LD B, 0	;
264)   94DE 4B          		 LD C, E	;
265)   94DF 21 D8 94    		 LD HL, ROWOFFSET	;
266)   94E2 09          		 ADD HL, BC	;
267)   94E3 7E          		 LD A, (HL)	;
268)   94E4 82          		 ADD D	;
269)   94E5 F6 80       		 OR LCD_SETDDRAMADDR	;
270)   94E7 CD 20 94    		 CALL LCD16_COMMD	;
271)   94EA C9          		 RET	;
273)   94EB 3A 7D 00    		@LCD16_CURSOFF: LD A, (LCD_DSPCTRL)	;
274)   94EE CB 8F       		 RES LCD_CURSORON, A	;
275)   94F0 32 7D 00    		 LD (LCD_DSPCTRL), A	;
276)   94F3 F6 08       		 OR LCD_DISPLAYCONTROL	;
277)   94F5 CD 20 94    		 CALL LCD16_COMMD	;
278)   94F8 C9          		 RET	;
281)   94F9 3A 7D 00    		@LCD16_CURSON: LD A, (LCD_DSPCTRL)	;
282)   94FC CB CF       		 SET LCD_CURSORON, A	;
283)   94FE 32 7D 00    		 LD (LCD_DSPCTRL), A	;
284)   9501 F6 08       		 OR LCD_DISPLAYCONTROL	;
285)   9503 CD 20 94    		 CALL LCD16_COMMD	;
286)   9506 C9          		 RET	;
288)   9507 3A 7D 00    		@LCD16_BLINKOFF: LD A, (LCD_DSPCTRL)	;
289)   950A CB 87       		 RES LCD_BLINKON, A	;
290)   950C 32 7D 00    		 LD (LCD_DSPCTRL), A	;
291)   950F F6 08       		 OR LCD_DISPLAYCONTROL	;
292)   9511 CD 20 94    		 CALL LCD16_COMMD	;
293)   9514 C9          		 RET	;
296)   9515 3A 7D 00    		@LCD16_BLINKON: LD A, (LCD_DSPCTRL)	;
297)   9518 CB C7       		 SET LCD_BLINKON, A	;
298)   951A 32 7D 00    		 LD (LCD_DSPCTRL), A	;
299)   951D F6 08       		 OR LCD_DISPLAYCONTROL	;
300)   951F CD 20 94    		 CALL LCD16_COMMD	;
301)   9522 C9          		 RET	;
303)   9523 3E 18       		@LCD16_SCRLEFT: LD A, LCD_CURSORSHIFT OR LCD_DISPLAYMOVE OR LCD_MOVELEFT	;
304)   9525 CD 20 94    		 CALL LCD16_COMMD	;
305)   9528 C9          		 RET	;
307)   9529 3E 1C       		@LCD16_SCRRIGHT: LD A, LCD_CURSORSHIFT OR LCD_DISPLAYMOVE OR LCD_MOVERIGHT	;
308)   952B CD 20 94    		 CALL LCD16_COMMD	;
309)   952E C9          		 RET	;
311)   952F 3E 10       		@LCD16_MOVLEFT: LD A, LCD_CURSORSHIFT OR LCD_CURSORMOVE OR LCD_MOVELEFT	;
312)   9531 CD 20 94    		 CALL LCD16_COMMD	;
313)   9534 C9          		 RET	;
315)   9535 3E 14       		@LCD16_MOVRIGHT: LD A, LCD_CURSORSHIFT OR LCD_CURSORMOVE OR LCD_MOVERIGHT	;
316)   9537 CD 20 94    		 CALL LCD16_COMMD	;
317)   953A C9          		 RET	;
320)   953B 3E 08       		@LCD16_BKLTON: LD A, BACKLIGHTPINMASK AND LCD_BACKLIGHT	;
321)   953D 32 7F 00    		 LD (LCD_STSMASK),A	;
322)   9540 CD 0F 94    		 CALL LCD16_I2CSEND	;
323)   9543 C9          		 RET	;
325)   9544 3E 00       		@LCD16_BKLTOFF: LD A, BACKLIGHTPINMASK AND LCD_NOBACKLIGHT	;
326)   9546 32 7F 00    		 LD (LCD_STSMASK),A	;
327)   9549 CD 0F 94    		 CALL LCD16_I2CSEND	;
328)   954C C9          		 RET	;
 29)   954D 53 75 6E 64 		 SUN DEFM  "Sunday"	;
 29)   9551 61 79       		 SUN DEFM  "Sunday"	;
 30)   9553 00          		 DB 0	;
 31)   9554 4D 6F 6E 64 		 MON DEFM  "Monday"	;
 31)   9558 61 79       		 MON DEFM  "Monday"	;
 32)   955A 00          		 DB 0	;
 33)   955B 54 75 65 73 		 TUE DEFM  "Tuesday"	;
 33)   955F 64 61 79    		 TUE DEFM  "Tuesday"	;
 34)   9562 00          		 DB 0	;
 35)   9563 57 65 64 6E 		 WED DEFM  "Wednesday"	;
 35)   9567 65 73 64 61 		 WED DEFM  "Wednesday"	;
 35)   956B 79          		 WED DEFM  "Wednesday"	;
 36)   956C 00          		 DB 0	;
 37)   956D 54 68 75 72 		 THU DEFM  "Thursday"	;
 37)   9571 73 64 61 79 		 THU DEFM  "Thursday"	;
 38)   9575 00          		 DB 0	;
 39)   9576 46 72 69 64 		 FRI DEFM  "Friday"	;
 39)   957A 61 79       		 FRI DEFM  "Friday"	;
 40)   957C 00          		 DB 0	;
 41)   957D 53 61 74 75 		 SAT DEFM  "Saturday"	;
 41)   9581 72 64 61 79 		 SAT DEFM  "Saturday"	;
 42)   9585 00          		 DB 0	;
 44)   9586 4D 95       		 DAYS DEFW SUN	;
 45)   9588 54 95       		 DEFW MON	;
 46)   958A 5B 95       		 DEFW TUE	;
 47)   958C 63 95       		 DEFW WED	;
 48)   958E 6D 95       		 DEFW THU	;
 49)   9590 76 95       		 DEFW FRI	;
 50)   9592 7D 95       		 DEFW SAT	;
 52)   9594 52 54 43 20 		 MESERR DEFM "RTC ER RV"	;
 52)   9598 45 52 20 52 		 MESERR DEFM "RTC ER RV"	;
 52)   959C 56          		 MESERR DEFM "RTC ER RV"	;
 53)   959D 0A 0D 00    		 DEFB 10,13,0	;
 55)   95A0 52 54 43 20 		 MESERR0 DEFM "RTC ER SD"	;
 55)   95A4 45 52 20 53 		 MESERR0 DEFM "RTC ER SD"	;
 55)   95A8 44          		 MESERR0 DEFM "RTC ER SD"	;
 56)   95A9 0A 0D 00    		 DEFB 10,13,0	;
 58)   95AC 7B          		SHERR0: LD A, E	;
 59)   95AD C5          		 PUSH BC	;
 60)   95AE CD F2 80    		 CALL SOUTAS	;
 61)   95B1 C1          		 POP BC	;
 62)   95B2 79          		 LD A, C	;
 63)   95B3 CD F2 80    		 CALL SOUTAS	;
 65)   95B6 21 A0 95    		 LD HL, MESERR0	;
 66)   95B9 CD D1 8B    		 CALL RS_TXT	;
 67)   95BC C9          		 RET	;
 70)   95BD 79          		SHERR: LD A, C	;
 71)   95BE CD F2 80    		 CALL SOUTAS	;
 72)   95C1 21 94 95    		 LD HL, MESERR	;
 73)   95C4 CD D1 8B    		 CALL RS_TXT	;
 74)   95C7 37          		 SCF	;
 75)   95C8 C9          		 RET	;
 78)   95C9 AF          		RST_BUF: XOR A	;
 79)   95CA 06 14       		 LD B, 20	;
 80)   95CC 21 CB 00    		 LD HL, BUFFER	;
 81)   95CF 77          		LP1: LD (HL), A	;
 82)   95D0 23          		 INC HL	;
 83)   95D1 10 FC       		 DJNZ LP1	;
 84)   95D3 C9          		 RET	;
 86)   95D4 64 64 2F 6D 		DATEMASK: DEFM "dd/mm/yy w hh:mm:ss"	;
 86)   95D8 6D 2F 79 79 		DATEMASK: DEFM "dd/mm/yy w hh:mm:ss"	;
 86)   95DC 20 77 20 68 		DATEMASK: DEFM "dd/mm/yy w hh:mm:ss"	;
 86)   95E0 68 3A 6D 6D 		DATEMASK: DEFM "dd/mm/yy w hh:mm:ss"	;
 86)   95E4 3A 73 73    		DATEMASK: DEFM "dd/mm/yy w hh:mm:ss"	;
 89)   95E7 21 D4 95    		DS1307_INIT: LD HL,DATEMASK	;
 90)   95EA 11 CB 00    		 LD DE,TIMMSG	;
 91)   95ED 01 13 00    		 LD BC,19	;
 92)   95F0 ED B0       		 LDIR        	;
 93)   95F2 C9          		 RET	;
 95)   95F3 21 CB 00    		DS1307_GETNOW: LD HL, BUFFER	;
 96)   95F6 AF          		 XOR A         ;SEND COMMAND 0	;SEND COMMAND 0
 97)   95F7 77          		 LD (HL), A	;
 98)   95F8 16 68       		 LD D, DS1307_ADDRESS	;
 99)   95FA 01 01 00    		 LD BC, 1	;
100)   95FD CD 30 93    		 CALL I2C_WRITE	;
101)   9600 C2 AC 95    		 JP NZ, SHERR0	;
103)   9603 21 CB 00    		 LD HL, BUFFER	;
104)   9606 16 68       		 LD D, DS1307_ADDRESS	;
105)   9608 01 07 00    		 LD BC, 7	;
106)   960B CD 80 93    		 CALL I2C_READ	;
107)   960E C2 BD 95    		 JP NZ, SHERR	;
108)   9611 AF          		 XOR A	;
109)   9612 C9          		 RET	;
113)   9613 11 CB 00    		DS1307_SETTIME: LD DE, BUFFER	;
114)   9616 AF          		 XOR A	;
115)   9617 12          		 LD (DE), A	;
116)   9618 13          		 INC DE	;
117)   9619 21 DC 00    		 LD HL,TIMMSG+17  ;SS	;SS
118)   961C CD 4A 96    		 CALL SETTMPARAM	;
119)   961F 21 D9 00    		 LD HL,TIMMSG+14  ;MN	;MN
120)   9622 CD 4A 96    		 CALL SETTMPARAM	;
121)   9625 21 D6 00    		 LD HL,TIMMSG+11  ;HH	;HH
122)   9628 CD 4A 96    		 CALL SETTMPARAM	;
123)   962B 21 D4 00    		 LD HL,TIMMSG+9  ;D OF WEEK 1-7	;D OF WEEK 1-7
124)   962E CD 4A 96    		 CALL SETTMPARAM	;
125)   9631 21 CB 00    		 LD HL,TIMMSG  ;DD	;DD
126)   9634 CD 4A 96    		 CALL SETTMPARAM	;
127)   9637 21 CE 00    		 LD HL,TIMMSG+3  ;MM	;MM
128)   963A CD 4A 96    		 CALL SETTMPARAM	;
129)   963D 21 D1 00    		 LD HL,TIMMSG+6  ;YY	;YY
130)   9640 CD 4A 96    		 CALL SETTMPARAM	;
131)   9643 3E 00       		 LD A,0	;
132)   9645 12          		 LD (DE), A	;
133)   9646 CD 92 96    		 CALL DS1307_ADJUST	;
134)   9649 C9          		 RET	;
136)   964A D5          		SETTMPARAM: PUSH DE	;
137)   964B CD D2 9C    		 CALL strtob	;
138)   964E D1          		 POP DE	;
139)   964F CD 74 9B    		 CALL BN2BCD	;
140)   9652 7D          		 LD A,L	;
141)   9653 12          		 LD (DE),A	;
142)   9654 13          		 INC DE  	;
143)   9655 C9          		 RET	;
148)   9656 11 CB 00    		 LD DE, BUFFER	;
149)   9659 AF          		 XOR A	;
150)   965A 12          		 LD (DE), A	;
151)   965B 13          		 INC DE	;
152)   965C 3E 0A       		 LD A, 10        ; 10 SECS	; 10 SECS
153)   965E CD 74 9B    		 CALL BN2BCD	;
154)   9661 7D          		 LD A, L	;
155)   9662 12          		 LD (DE), A	;
156)   9663 13          		 INC DE	;
157)   9664 3E 22       		 LD A, 34        ; 28 MINS	; 28 MINS
158)   9666 CD 74 9B    		 CALL BN2BCD	;
159)   9669 7D          		 LD A, L	;
160)   966A 12          		 LD (DE), A	;
161)   966B 13          		 INC DE	;
162)   966C 3E 12       		 LD A, 18        ; 19 HOURS	; 19 HOURS
163)   966E CD 74 9B    		 CALL BN2BCD	;
164)   9671 7D          		 LD A, L	;
165)   9672 12          		 LD (DE), A	;
166)   9673 13          		 INC DE	;
167)   9674 3E 05       		 LD A, 5        ; DAY OF WEEK	; DAY OF WEEK
168)   9676 12          		 LD (DE), A	;
169)   9677 13          		 INC DE	;
170)   9678 3E 12       		 LD A, 18        ; 8 DAY	; 8 DAY
171)   967A CD 74 9B    		 CALL BN2BCD	;
172)   967D 7D          		 LD A, L	;
173)   967E 12          		 LD (DE), A	;
174)   967F 13          		 INC DE	;
175)   9680 3E 02       		 LD A, 02        ; 10 MONTH	; 10 MONTH
176)   9682 CD 74 9B    		 CALL BN2BCD	;
177)   9685 7D          		 LD A, L	;
178)   9686 12          		 LD (DE), A	;
179)   9687 13          		 INC DE	;
180)   9688 3E 15       		 LD A, 21        ; 21 YEAR (2020)	; 21 YEAR (2020)
181)   968A CD 74 9B    		 CALL BN2BCD	;
182)   968D 7D          		 LD A, L	;
183)   968E 12          		 LD (DE), A	;
184)   968F 13          		 INC DE	;
185)   9690 AF          		 XOR A	;
186)   9691 12          		 LD (DE), A	;
199)   9692 21 CB 00    		DS1307_ADJUST: LD HL, BUFFER	;
200)   9695 16 68       		 LD D, DS1307_ADDRESS	;
201)   9697 01 09 00    		 LD BC, 9	;
202)   969A CD 30 93    		 CALL I2C_WRITE	;
203)   969D C2 AC 95    		 JP NZ, SHERR0	;
204)   96A0 06 01       		 LD B,1	;
205)   96A2 CD 41 9B    		 CALL DELAYSEC	;
206)   96A5 C9          		 RET	;
210)   96A6 21 CB 00    		DS1307_SETSQ: LD HL, BUFFER	;
211)   96A9 E5          		 PUSH HL	;
212)   96AA 3E 07       		 LD A, DS1307_CONTROL_REGISTER	;
213)   96AC 77          		 LD (HL), A	;
214)   96AD 23          		 INC HL	;
215)   96AE 7A          		 LD A, D	;
216)   96AF 77          		 LD (HL), A	;
217)   96B0 E1          		 POP HL	;
218)   96B1 16 68       		 LD D, DS1307_ADDRESS	;
219)   96B3 01 02 00    		 LD BC, 2	;
220)   96B6 CD 30 93    		 CALL I2C_WRITE	;
221)   96B9 C2 AC 95    		 JP NZ, SHERR0	;
222)   96BC C9          		 RET	;
226)   96BD CD DB 9B    		CONVHL: CALL Bcd2ASC	;
227)   96C0 26 00       		 LD H, 0	;
228)   96C2 C9          		 RET	;
231)   96C3 06 07       		CHKERROR: LD B, 7	;
232)   96C5 21 CB 00    		 LD HL, BUFFER	;
233)   96C8 7E          		CEAGN: LD A, (HL)	;
234)   96C9 FE FF       		 CP $FF	;
235)   96CB 28 05       		 JR Z, STER	;
236)   96CD 23          		 INC HL	;
237)   96CE 10 F8       		 DJNZ CEAGN	;
238)   96D0 AF          		 XOR A	;
239)   96D1 C9          		 RET	;
242)   96D2 37          		 SCF	;
243)   96D3 C9          		 RET	;
248)   96D4 CD C9 95    		DS1307_GETTIME: CALL RST_BUF	;
249)   96D7 CD F3 95    		 CALL DS1307_GETNOW	;
250)   96DA D8          		 RET C         ;ERROR RETURN	;ERROR RETURN
251)   96DB CD C3 96    		 CALL CHKERROR	;
252)   96DE D8          		 RET C         ;ERRREAD  ;IF ERROR DONT PRINT	;ERRREAD  ;IF ERROR DONT PRINT
253)   96DF DD 21 CB 00 		 LD IX, BUFFER	;
254)   96E3 11 CB 00    		 LD DE, TIMMSG	;
255)   96E6 26 00       		 LD H, 0	;
256)   96E8 DD 6E 04    		 LD L, (IX + 4)        ;DAY	;DAY
257)   96EB CD BD 96    		 CALL CONVHL	;
258)   96EE 3E 2F       		 LD A, ' / '	;
259)   96F0 12          		 LD (DE), A	;
260)   96F1 13          		 INC DE	;
261)   96F2 DD 6E 05    		 LD L, (IX + 5)        ;MONTH	;MONTH
262)   96F5 CD BD 96    		 CALL CONVHL	;
263)   96F8 3E 2F       		 LD A, ' / '	;
264)   96FA 12          		 LD (DE), A	;
265)   96FB 13          		 INC DE	;
266)   96FC DD 6E 06    		 LD L, (IX + 6)        ;YEAR	;YEAR
267)   96FF CD BD 96    		 CALL CONVHL	;
268)   9702 3E 20       		 LD A, ' '	;
269)   9704 12          		 LD (DE), A	;
270)   9705 13          		 INC DE	;
271)   9706 DD 6E 02    		 LD L, (IX + 2)        ;HOUR	;HOUR
272)   9709 CD BD 96    		 CALL CONVHL	;
273)   970C 3E 3A       		 LD A, ':'	;
274)   970E 12          		 LD (DE), A	;
275)   970F 13          		 INC DE	;
276)   9710 DD 6E 01    		 LD L, (IX + 1)        ;MIN	;MIN
277)   9713 CD BD 96    		 CALL CONVHL	;
278)   9716 3E 3A       		 LD A, ':'	;
279)   9718 12          		 LD (DE), A	;
280)   9719 13          		 INC DE	;
281)   971A DD 6E 00    		 LD L, (IX)        ;SECS	;SECS
282)   971D CD BD 96    		 CALL CONVHL	;
283)   9720 13          		 INC DE	;
284)   9721 AF          		 XOR A	;
285)   9722 12          		 LD (DE), A	;
286)   9723 C9          		 RET	;
108)   9724 ED 44       		DELAYABIT: NEG  ;8 CLOCK CYCLES	;8 CLOCK CYCLES
109)   9726 ED 44       		 NEG	;
110)   9728 ED 44       		 NEG	;
111)   972A ED 44       		 NEG	;
112)   972C ED 44       		 NEG	;
113)   972E ED 44       		 NEG	;
114)   9730 ED 44       		 NEG	;
115)   9732 ED 44       		 NEG	;
116)   9734 C9          		 RET	;
123)   9735 D3 38       		SND_OUT: OUT (DEVSND),A ;SEND TO SOUND	;SEND TO SOUND
139)   9737 CD 24 97    		 CALL DELAYABIT	;
140)   973A C9          		 RET	;
142)   973B 3E 9F       		SND_MUTEALL:   LD A,$9F  ;MUTE CHANNEL 0	;MUTE CHANNEL 0
143)   973D CD 35 97    		 CALL SND_OUT	;
144)   9740 3E BF       		 LD A,$BF  ;MUTE CHANNEL 1	;MUTE CHANNEL 1
145)   9742 CD 35 97    		 CALL SND_OUT	;
146)   9745 3E DF       		 LD A,$DF  ;MUTE CHANNEL 2	;MUTE CHANNEL 2
147)   9747 CD 35 97    		 CALL SND_OUT	;
148)   974A 3E FF       		 LD A,$FF  ;MUTE CHANNEL NOISE	;MUTE CHANNEL NOISE
149)   974C CD 35 97    		 CALL SND_OUT                	;
150)   974F C9          		               RET	;
152)   9750 CD 3B 97    		SND_INIT: CALL SND_MUTEALL	;
153)   9753 AF          		               XOR A	;
154)   9754 32 F4 00    		               LD (CHANST),A	;
155)   9757 AF          		SND_CLRDAT:    XOR A	;
156)   9758 21 E0 00    		               LD HL,CHANDATA	;
157)   975B 77          		               LD (HL),A	;
158)   975C 54          		               LD D,H	;
159)   975D 5D          		               LD E,L	;
160)   975E 13          		               INC DE	;
161)   975F 01 0B 00    		               LD BC,11  	;
162)   9762 ED B0       		               LDIR	;
163)   9764 C9          		 RET	;
168)   9765 F5          		SND_NOTE:      PUSH AF	;
169)   9766 E6 03       		               AND $03                  ;KEEP 2 BITS	;KEEP 2 BITS
170)   9768 07          		               RLCA	;
171)   9769 07          		               RLCA	;
172)   976A 07          		               RLCA	;
173)   976B 07          		               RLCA	;
174)   976C 07          		               RLCA                    ;TRANSFER TO BITS 6&5	;TRANSFER TO BITS 6&5
175)   976D B4          		               OR H                    ;A HAS THE HI BYTE TO SEND TO THE SOUND CHIP WITH CORRECT CHANNEL	;A HAS THE HI BYTE TO SEND TO THE SOUND CHIP WITH CORRECT CHANNEL
176)   976E CD 35 97    		               CALL SND_OUT	;
177)   9771 7D          		SN_LOW:        LD A,L                	;
178)   9772 CD 35 97    		               CALL SND_OUT	;
179)   9775 F1          		               POP AF	;
180)   9776 C9          		               RET	;
186)   9777 F5          		SND_DOBEEP:    PUSH AF	;
187)   9778 3E 02       		               LD A,DEFCHN	;
188)   977A 0E 00       		               LD C,SNDVOLHI	;
189)   977C CD A0 97    		               CALL SND_SETVOLUME                	;
190)   977F 3E 02       		               LD A,DEFCHN	;
191)   9781 CD 65 97    		               CALL SND_NOTE	;
192)   9784 06 A0       		               LD B,160	;
193)   9786 CD 37 9B    		               CALL DELAYMILI	;
194)   9789 3E 02       		               LD A,DEFCHN	;
195)   978B 0E 04       		               LD C,SNDMUTE	;
196)   978D CD A0 97    		               CALL SND_SETVOLUME	;
197)   9790 F1          		               POP AF	;
198)   9791 C9          		               RET	;
200)   9792 21 07 83    		SND_BEEP:      LD HL,nG4             ;NOTE G4 ON CHANNEL2	;NOTE G4 ON CHANNEL2
201)   9795 CD 77 97    		               CALL SND_DOBEEP	;
202)   9798 C9          		               RET	;
204)   9799 21 02 81    		SND_BEEP2:     LD HL,nD6             ;NOTE D6 ON CHANNEL2	;NOTE D6 ON CHANNEL2
205)   979C CD 77 97    		               CALL SND_DOBEEP	;
206)   979F C9          		               RET	;
213)   97A0 07          		SND_SETVOLUME: RLCA                            ;DOUBLE CHANNEL 0-3 --> 0,2,4,6               	;DOUBLE CHANNEL 0-3 --> 0,2,4,6
214)   97A1 3C          		               INC A                           ;E=A+1	;E=A+1
215)   97A2 5F          		               LD E,A                          ;SAVE CHANNEL INFO	;SAVE CHANNEL INFO
216)   97A3 79          		               LD A,C	;
217)   97A4 FE 04       		               CP SNDMUTE	;
218)   97A6 3E 0F       		               LD A,$F	;
219)   97A8 28 09       		               JR Z, SV_DOIT                   ;SNDMUTE=4 MEANS NO VOLUME = MUTE	;SNDMUTE=4 MEANS NO VOLUME = MUTE
220)   97AA 3E 01       		               LD A,1                          ;VOLUME 0-3 --> 1,2,4,8 SET THE CORRESPONDING BIT 0-3	;VOLUME 0-3 --> 1,2,4,8 SET THE CORRESPONDING BIT 0-3
221)   97AC 0C          		               INC C	;
222)   97AD 0D          		SV_AGN:        DEC C	;
223)   97AE 28 03       		               JR Z, SV_DOIT	;
224)   97B0 07          		               RLCA	;
225)   97B1 18 FA       		               JR SV_AGN	;
226)   97B3 57          		SV_DOIT:       LD D,A                          ;D THE VOLUME , E THE CHANNEL  1&CCC&VVVV	;D THE VOLUME , E THE CHANNEL  1&CCC&VVVV
227)   97B4 3E 80       		               LD A,$80	;
228)   97B6 CB 03       		               RLC E	;
229)   97B8 CB 03       		               RLC E	;
230)   97BA CB 03       		               RLC E	;
231)   97BC CB 03       		               RLC E	;
232)   97BE B2          		               OR D	;
233)   97BF B3          		               OR E	;
234)   97C0 CD 35 97    		               CALL SND_OUT                    ;SET THE VOLUME        	;SET THE VOLUME
235)   97C3 C9          		               RET	;
238)   97C4 F5          		SND_DISABLE:   PUSH AF	;
239)   97C5 CD ED 97    		               CALL SND_GETCHMASK	;
240)   97C8 47          		               LD B,A	;
241)   97C9 3A F4 00    		               LD A,(CHANST)	;
242)   97CC B0          		               OR B	;
243)   97CD 32 F4 00    		               LD (CHANST),A	;
244)   97D0 F1          		               POP AF	;
245)   97D1 0E 04       		               LD C, SNDMUTE	;
246)   97D3 CD A0 97    		               CALL SND_SETVOLUME	;
247)   97D6 C9          		               RET	;
250)   97D7 F5          		SND_ENABLE:    PUSH AF	;
251)   97D8 CD ED 97    		               CALL SND_GETCHMASK	;
252)   97DB ED 44       		               NEG	;
253)   97DD 3D          		               DEC A	;
254)   97DE 47          		               LD B,A	;
255)   97DF 3A F4 00    		               LD A,(CHANST)	;
256)   97E2 A0          		               AND B	;
257)   97E3 32 F4 00    		               LD (CHANST),A	;
258)   97E6 F1          		               POP AF	;
259)   97E7 0E 00       		               LD C, SNDVOLHI                  ;TODO: KEEP RECORD OF THE VOLUME IN EACH CHANNEL	;TODO: KEEP RECORD OF THE VOLUME IN EACH CHANNEL
260)   97E9 CD A0 97    		               CALL SND_SETVOLUME	;
261)   97EC C9          		               RET	;
266)   97ED 3C          		SND_GETCHMASK: INC A	;
267)   97EE 4F          		               LD C,A	;
268)   97EF AF          		               XOR A	;
269)   97F0 3C          		               INC A                	;
270)   97F1 0D          		GMCAGN:        DEC C	;
271)   97F2 C8          		               RET Z	;
272)   97F3 07          		               RLCA	;
273)   97F4 18 FB       		               JR GMCAGN             	;
280)   97F6 F5          		SND_PLAYCH:    PUSH AF	;
281)   97F7 21 E0 00    		               LD HL,CHANDATA	;
282)   97FA 07          		               RLCA                            ;DOUBLE A	;DOUBLE A
283)   97FB 06 00       		               LD B,0	;
284)   97FD 4F          		               LD C,A	;
285)   97FE 09          		               ADD HL,BC                       ;HL ON CHANNELS DATA ADDRESS VAR	;HL ON CHANNELS DATA ADDRESS VAR
286)   97FF 5E          		               LD E,(HL)	;
287)   9800 23          		               INC HL	;
288)   9801 56          		               LD D,(HL)                       ;DE THE CHANNEL DATA ADDRESS	;DE THE CHANNEL DATA ADDRESS
289)   9802 7A          		               LD A,D	;
290)   9803 83          		               ADD E	;
291)   9804 B7          		               OR A	;
292)   9805 28 4B       		               JR Z, PC_NOMORE                 ;IF CHANDATA ADDRESS IS ZERO RETURN	;IF CHANDATA ADDRESS IS ZERO RETURN
294)   9807 F1          		               POP AF                          ;GET CHANNEL	;GET CHANNEL
295)   9808 F5          		               PUSH AF	;
296)   9809 CD ED 97    		               CALL SND_GETCHMASK	;
297)   980C 4F          		               LD C, A	;
298)   980D 3A F4 00    		               LD A,(CHANST)	;
299)   9810 A1          		               AND C	;
300)   9811 C1          		               POP BC	;
301)   9812 20 50       		               JR NZ,SNDOK                     ;SIGNAL OK BUT DON'T PLAY ANYTHING	;SIGNAL OK BUT DON'T PLAY ANYTHING
302)   9814 C5          		               PUSH BC	;
303)   9815 48          		               LD C,B                          ;CHAN NO ON C	;CHAN NO ON C
304)   9816 06 00       		               LD B,0	;
305)   9818 21 F0 00    		               LD HL,CHANCN	;
306)   981B 09          		               ADD HL,BC                       ;HL ON CHANNELS NOTE IDX	;HL ON CHANNELS NOTE IDX
307)   981C 7E          		               LD A,(HL)                       ;A THE NOTE IDX 0-255 	;A THE NOTE IDX 0-255
308)   981D 3C          		               INC A	;
309)   981E 28 32       		               JR Z, PC_NOMORE                 ;IF 255 NO MORE NOTES TO PLAY	;IF 255 NO MORE NOTES TO PLAY
310)   9820 3D          		               DEC A          	;
311)   9821 34          		               INC (HL)                        ;NEXT NOTE	;NEXT NOTE
312)   9822 6F          		               LD L,A                          ;HL THE NOTE IDX	;HL THE NOTE IDX
313)   9823 26 00       		               LD H,0                          ;	;
314)   9825 29          		               ADD HL,HL                       ;DOUBLE THE IDX CAUSE 2 BYTES PER NOTE	;DOUBLE THE IDX CAUSE 2 BYTES PER NOTE
315)   9826 29          		               ADD HL,HL                       ;DOUBLE AGAIN THE IDX CAUSE 2 BYTES IS THE DURATION OF THE NOTE	;DOUBLE AGAIN THE IDX CAUSE 2 BYTES IS THE DURATION OF THE NOTE
316)   9827 19          		               ADD HL,DE                       ;THE NOTE ADDRESS ON HL	;THE NOTE ADDRESS ON HL
317)   9828 5E          		               LD E,(HL)                       ;E 2ND BYTE OF THE NOTE TO PLAY	;E 2ND BYTE OF THE NOTE TO PLAY
318)   9829 23          		               INC HL	;
319)   982A 56          		               LD D,(HL)                       ;D 1ST BYTE OF THE NOTE TO PLAY	;D 1ST BYTE OF THE NOTE TO PLAY
320)   982B 23          		               INC HL	;
321)   982C 4E          		               LD C,(HL)                      ;THE DURATION OF THE NOTE ON BC	;THE DURATION OF THE NOTE ON BC
322)   982D 23          		               INC HL	;
323)   982E 46          		               LD B,(HL)	;
324)   982F ED 43 A9 00 		               LD (PRGEX),BC                   ;SAVE BC                	;SAVE BC
325)   9833 C1          		               POP BC                          ;CHANNEL ON B	;CHANNEL ON B
326)   9834 C5          		               PUSH BC                         	;
327)   9835 21 E8 00    		               LD HL,CHANDEL                   ;SAVING DURATION ON CHANDEL + CHAN IDX         	;SAVING DURATION ON CHANDEL + CHAN IDX
328)   9838 CB 00       		               RLC B                           ;DOUBLE IDX	;DOUBLE IDX
329)   983A 48          		               LD C,B	;
330)   983B 06 00       		               LD B,0	;
331)   983D 09          		               ADD HL,BC	;
332)   983E ED 4B A9 00 		               LD BC,(PRGEX)                      ;RESTORE BC	;RESTORE BC
333)   9842 71          		               LD (HL),C                       ;SAVE NOTE DELAY ON CHANNEL DELAY	;SAVE NOTE DELAY ON CHANNEL DELAY
334)   9843 23          		               INC HL	;
335)   9844 70          		               LD (HL),B	;
336)   9845 7A          		               LD A,D	;
337)   9846 C1          		               POP BC                          ;GET THE CHANNEL ON B	;GET THE CHANNEL ON B
338)   9847 FE 0A       		               CP 10                           ;CHECK IF 1ST BYTE IS UNDER 10  MAYBE DO SPECIAL OPS	;CHECK IF 1ST BYTE IS UNDER 10  MAYBE DO SPECIAL OPS
339)   9849 38 0A       		               JR C,SND_SPOPS	;
340)   984B EB          		               EX DE,HL                        ;HL THE NOTE	;HL THE NOTE
341)   984C 78          		               LD A,B                          ;CHANNEL ON A	;CHANNEL ON A
342)   984D CD 65 97    		               CALL SND_NOTE	;
343)   9850 18 12       		               JR SNDOK                        ;NOTE PLAYED OK	;NOTE PLAYED OK
344)   9852 C1          		PC_NOMORE:     POP BC	;
345)   9853 18 11       		               JR SNDEND                       ;SIGNAL  SONG END	;SIGNAL  SONG END
349)   9855 FE 03       		SND_SPOPS:     CP 3	;
350)   9857 30 07       		               JR NC,SNDOTOPS	;
351)   9859 4F          		               LD C,A                          ;VOLUME	;VOLUME
352)   985A 78          		               LD A,B                          ;CHANNEL	;CHANNEL
353)   985B CD A0 97    		               CALL SND_SETVOLUME	;
354)   985E 18 04       		               JR SNDOK                        ;VOLUME SET OK	;VOLUME SET OK
356)   9860 FE 09       		SNDOTOPS:      CP 9                            ;9 MEANS SONG ENDED	;9 MEANS SONG ENDED
357)   9862 28 02       		               JR Z, SNDEND	;
359)   9864 AF          		SNDOK:         XOR A                           ;END OK                	;END OK
360)   9865 C9          		               RET	;
361)   9866 3E 01       		SNDEND:        LD A,1                          ;SONG END	;SONG END
362)   9868 C9          		               RET	;
368)   9869 21 E8 00    		SND_DOCHAN:    LD HL,CHANDEL	;
369)   986C 4F          		               LD C,A	;
370)   986D 06 00       		               LD B,0	;
371)   986F 09          		               ADD HL,BC	;
372)   9870 09          		               ADD HL,BC       ;DOUBLE CAUSE 2 BYTES PER DELAY VALUE	;DOUBLE CAUSE 2 BYTES PER DELAY VALUE
373)   9871 4E          		               LD C,(HL)	;
374)   9872 23          		               INC HL	;
375)   9873 46          		               LD B,(HL)	;
376)   9874 57          		               LD D,A          ;SAVE A	;SAVE A
377)   9875 78          		               LD A,B	;
378)   9876 B1          		               OR C	;
379)   9877 7A          		               LD A,D          ;RESTORE CHANNEL ON A	;RESTORE CHANNEL ON A
380)   9878 CA F6 97    		               JP Z,SND_PLAYCH ;PLAY CHANNEL NOTES	;PLAY CHANNEL NOTES
381)   987B AF          		               XOR A           ;DATA ON CHANNEL CAUSE WE DELAY 	;DATA ON CHANNEL CAUSE WE DELAY
383)   987C C9          		               RET	;
389)   987D 21 E8 00    		SND_INTDELAY:  LD HL,CHANDEL	;
390)   9880 06 04       		               LD B,4                  	;
391)   9882 5E          		ID_NXTCH:      LD E,(HL)	;
392)   9883 23          		               INC HL	;
393)   9884 56          		               LD D,(HL)	;
394)   9885 7A          		               LD A, D	;
395)   9886 B3          		               OR E	;
396)   9887 28 05       		               JR Z, ID_SKP	;
397)   9889 1B          		               DEC DE          ;MINUS NOTE DELAY VALUE	;MINUS NOTE DELAY VALUE
398)   988A 72          		               LD (HL),D	;
399)   988B 2B          		               DEC HL	;
400)   988C 73          		               LD (HL),E	;
401)   988D 23          		               INC HL	;
402)   988E 23          		ID_SKP:        INC HL	;
403)   988F 10 F1       		               DJNZ ID_NXTCH	;
404)   9891 C9          		               RET	;
408)   9892 06 04       		SND_PLAYMUSIC: LD B,4	;
409)   9894 0E 00       		               LD C,0	;
410)   9896 05          		PM_NXT:        DEC B                           ;PLAY 3,2,1,0	;PLAY 3,2,1,0
411)   9897 78          		               LD A,B	;
412)   9898 C5          		               PUSH BC                	;
413)   9899 CD 69 98    		               CALL SND_DOCHAN	;
414)   989C C1          		               POP BC                	;
415)   989D 81          		               ADD A,C                         ;A=0 IF NOTE PLAYED A=1 IF CHANNEL NOT ENABLED OR NO MORE NOTES	;A=0 IF NOTE PLAYED A=1 IF CHANNEL NOT ENABLED OR NO MORE NOTES
416)   989E 4F          		               LD C,A	;
417)   989F 78          		               LD A,B	;
418)   98A0 B7          		               OR A	;
419)   98A1 20 F3       		               JR NZ, PM_NXT	;
420)   98A3 79          		               LD A,C	;
421)   98A4 FE 04       		               CP 4                            ;MEANS ALL 4 CHANNELS ARE NOT ENABLED	;MEANS ALL 4 CHANNELS ARE NOT ENABLED
422)   98A6 C9          		               RET	;
  8)   98A7 FE E1       		@CHECKEXT:     CP $E1         ;BREAK KEY	;BREAK KEY
  9)   98A9 C8          		 RET Z        ;JUST SAVE IT  	;JUST SAVE IT
 10)   98AA FE F0       		 CP $F0         ;240 KEY RELEASED	;240 KEY RELEASED
 11)   98AC C8          		 RET Z        ;JUST SAVE IT  	;JUST SAVE IT
 12)   98AD FE E0       		 CP $E0         ;224 EXTENDED KEYS	;224 EXTENDED KEYS
 13)   98AF C8          		 RET Z        ;JUST SAVE IT	;JUST SAVE IT
 14)   98B0 FE AA       		 CP $AA        ;POST TEST KB OK	;POST TEST KB OK
 15)   98B2 C8          		 RET Z	;
 17)   98B3 4F          		 LD C,A        ;SAVE KEY	;SAVE KEY
 18)   98B4 3A 81 00    		 LD A,(LASTKEY)	;
 19)   98B7 FE E1       		 CP $E1	;
 20)   98B9 28 23       		 JR Z, GTBRK	;
 21)   98BB FE F0       		 CP $F0	;
 22)   98BD 28 59       		 JR Z, GTREL	;
 23)   98BF FE E0       		 CP $E0	;
 24)   98C1 28 21       		 JR Z, GTEXT	;
 25)   98C3 79          		 LD A,C	;
 27)   98C4 FE 12       		 CP 18         ;LEFT SHIFT	;LEFT SHIFT
 28)   98C6 CC 44 99    		 CALL Z, SHFTOG	;
 29)   98C9 FE 59       		 CP 89         ;RIGHT SHIFT	;RIGHT SHIFT
 30)   98CB CC 44 99    		 CALL Z, SHFTOG	;
 31)   98CE FE 14       		 CP 20         ;RIGHT CONTROL	;RIGHT CONTROL
 32)   98D0 CC 4D 99    		 CALL Z, CTRTOG	;
 33)   98D3 FE 11       		 CP 17         ;LEFT ALT	;LEFT ALT
 34)   98D5 CC 56 99    		 CALL Z, ALTTOG	;
 35)   98D8 FE 58       		 CP $58         ;CAPS LOCK	;CAPS LOCK
 36)   98DA CC 5F 99    		 CALL Z, CAPSTOG	;
 37)   98DD C9          		               RET	;
 39)   98DE 79          		GTBRK: LD A,C       ;$14 OR $F0	;$14 OR $F0
 40)   98DF FE F0       		 CP $F0	;
 41)   98E1 C8          		 RET Z  	;
 42)   98E2 AF          		 XOR A        	;
 43)   98E3 C9          		 RET	;
 45)   98E4 79          		GTEXT: LD A,C       ; THIS IS THE EXTENDED KEY	; THIS IS THE EXTENDED KEY
 46)   98E5 FE 6B       		 CP $6B         ;LEFT	;LEFT
 47)   98E7 C8          		 RET Z	;
 48)   98E8 FE 72       		 CP $72        ;DOWN	;DOWN
 49)   98EA C8          		 RET Z	;
 50)   98EB FE 74       		 CP $74        ;RIGHT	;RIGHT
 51)   98ED C8          		 RET Z	;
 52)   98EE FE 75       		 CP $75        ;UP	;UP
 53)   98F0 C8          		 RET Z	;
 54)   98F1 FE 70       		 CP $70        ;INSERT	;INSERT
 55)   98F3 C8          		 RET Z	;
 56)   98F4 FE 6C       		 CP $6C        ;HOME	;HOME
 57)   98F6 C8          		 RET Z	;
 58)   98F7 FE 7D       		 CP $7D        ;PG UP	;PG UP
 59)   98F9 C8          		 RET Z	;
 60)   98FA FE 7A       		 CP $7A        ;PG DN	;PG DN
 61)   98FC C8          		 RET Z	;
 62)   98FD FE 69       		 CP $69        ;END	;END
 63)   98FF C8          		 RET Z	;
 64)   9900 FE 71       		 CP $71        ;DEL	;DEL
 65)   9902 C8          		 RET Z	;
 66)   9903 FE 66       		 CP $66         ;BACKSPACE	;BACKSPACE
 67)   9905 C8          		 RET Z	;
 68)   9906 FE 5A       		 CP $5A        ;ENTER NUM	;ENTER NUM
 69)   9908 C8          		 RET Z	;
 70)   9909 FE 11       		 CP $11        ;RIGHT ALT	;RIGHT ALT
 71)   990B C8          		 RET Z	;
 72)   990C FE 14       		 CP $14        ;LEFT ALT	;LEFT ALT
 73)   990E C8          		 RET Z	;
 74)   990F FE 4A       		 CP $4A         ;NUMLOCK /	;NUMLOCK /
 75)   9911 C8          		 RET Z	;
 76)   9912 FE F0       		 CP $F0	;
 77)   9914 20 00       		 JR NZ, EXGTEX       ;GTREL ;EXTENDED KEY RELEASED $E0 $F0 $KEY  	;GTREL ;EXTENDED KEY RELEASED $E0 $F0 $KEY
 79)   9916 AF          		EXGTEX: XOR A        ;NOT VALID EXTENDED KEY	;NOT VALID EXTENDED KEY
 80)   9917 C9          		 RET	;
 83)   9918 79          		GTREL: LD A,C       ; THIS IS THE RELEASED KEY	; THIS IS THE RELEASED KEY
 84)   9919 FE 12       		 CP 18         ; LSHIFT RELEASED	; LSHIFT RELEASED
 85)   991B CC 32 99    		 CALL Z, SHFRES       ; RESET SHIFT	; RESET SHIFT
 86)   991E FE 14       		 CP 20         ; LCTRL RELEASED	; LCTRL RELEASED
 87)   9920 CC 38 99    		 CALL Z, CTRRES       ; RESET CONTROL	; RESET CONTROL
 88)   9923 FE 11       		 CP 17         ; LALT RELEASED	; LALT RELEASED
 89)   9925 CC 3E 99    		 CALL Z, ALTRES       ; RESET ALT	; RESET ALT
 90)   9928 FE 59       		 CP 89         ; RSHIFT RELEASED	; RSHIFT RELEASED
 91)   992A CC 32 99    		 CALL Z, SHFRES       ; RESET SHIFT  	; RESET SHIFT
 92)   992D 32 81 00    		 LD (LASTKEY),A         ; SET LAST KEY	; SET LAST KEY
 93)   9930 AF          		 XOR A         ; NO KEY  	; NO KEY
 94)   9931 C9          		 RET	;
 96)   9932 21 80 00    		SHFRES: LD HL, KEYCTR       ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
 97)   9935 CB B6       		 RES 6, (HL)        ; BIT 6 IS SHIFT $40=64	; BIT 6 IS SHIFT $40=64
 98)   9937 C9          		 RET	;
100)   9938 21 80 00    		CTRRES: LD HL, KEYCTR       ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
101)   993B CB BE       		 RES 7, (HL)       ; BIT 7 IS CTRL $80=128	; BIT 7 IS CTRL $80=128
102)   993D C9          		 RET	;
104)   993E 21 80 00    		ALTRES: LD HL, KEYCTR       ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
105)   9941 CB AE       		 RES 5, (HL)       ; BIT 5 IS SHIFT $20=32	; BIT 5 IS SHIFT $20=32
106)   9943 C9          		 RET	;
108)   9944 21 80 00    		SHFTOG: LD HL, KEYCTR       ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
109)   9947 3E 40       		 LD A, $40       ; MASK	; MASK
110)   9949 AE          		 XOR (HL)        ; BIT 6 IS SHIFT $40=64	; BIT 6 IS SHIFT $40=64
111)   994A 77          		 LD (HL), A       ; SAVE	; SAVE
112)   994B AF          		 XOR A         ; NO KEY	; NO KEY
113)   994C C9          		 RET	;
115)   994D 21 80 00    		CTRTOG: LD HL, KEYCTR       ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
116)   9950 3E 80       		 LD A, $80       ; MASK	; MASK
117)   9952 AE          		 XOR (HL)       ; BIT 7 IS CTRL $80=128	; BIT 7 IS CTRL $80=128
118)   9953 77          		 LD (HL), A       ; SAVE	; SAVE
119)   9954 AF          		 XOR A         ; NO KEY	; NO KEY
120)   9955 C9          		 RET	;
122)   9956 21 80 00    		ALTTOG: LD HL, KEYCTR       ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH
123)   9959 3E 20       		 LD A, $20	;
124)   995B AE          		 XOR (HL)       ; BIT 5 IS ALT $20=32	; BIT 5 IS ALT $20=32
125)   995C 77          		 LD (HL), A       ; SAVE	; SAVE
126)   995D AF          		 XOR A         ; NO KEY	; NO KEY
127)   995E C9          		 RET	;
129)   995F 21 80 00    		CAPSTOG: LD HL, KEYCTR      ;KEYBOARD FLAGS SHFT,CONTROL,GRAPH,CAPS	;KEYBOARD FLAGS SHFT,CONTROL,GRAPH,CAPS
130)   9962 3E 10       		 LD A, $10	;
131)   9964 AE          		 XOR (HL)       ; BIT 4 IS CAPS $10=16	; BIT 4 IS CAPS $10=16
132)   9965 77          		 LD (HL), A       ; SAVE	; SAVE
133)   9966 AF          		 XOR A         ; NO KEY	; NO KEY
134)   9967 C9          		 RET	;
138)   9968 FE AA       		@PS2LOK: CP $AA	;
139)   996A 38 02       		 JR C,DOTRANS       ;ONLY 0-170	;ONLY 0-170
141)   996C AF          		 XOR A	;
142)   996D C9          		 RET	;
143)   996E 21 A4 99    		DOTRANS: LD HL, PS2TAB1      ;UNSHIFTED	;UNSHIFTED
144)   9971 57          		 LD D,A        ;SAVE KEY CODE	;SAVE KEY CODE
145)   9972 CD 9E 99    		 CALL PLK1       ;GET CHAR NO SHIFT NO CAPS	;GET CHAR NO SHIFT NO CAPS
146)   9975 47          		 LD B,A        ;SAVE CHAR	;SAVE CHAR
147)   9976 FE 61       		 CP 'a'	;
148)   9978 38 04       		 JR C,PS2CHKCAPS	;
149)   997A FE 7B       		PS2SGT: CP 'z'+1  	;
150)   997C 38 09       		 JR C, PS2CPSF;ITS A LETTER CAPS AND SHIFT MATTERS	;ITS A LETTER CAPS AND SHIFT MATTERS
152)   997E 3A 80 00    		PS2CHKCAPS: LD A, (KEYCTR)      ; GET KEYBFLAGS ON A SHIFT  	; GET KEYBFLAGS ON A SHIFT
153)   9981 CB 77       		 BIT 6, A	;
154)   9983 78          		 LD A,B	;
155)   9984 C8          		 RET Z        ;IF NO SHIFT RETURN TAB1 CHAR	;IF NO SHIFT RETURN TAB1 CHAR
157)   9985 18 0F       		 JR PS2SHIFT	;
159)   9987 3A 80 00    		PS2CPSF: LD A, (KEYCTR)      ; GET KEYBFLAGS ON A SHIFT	; GET KEYBFLAGS ON A SHIFT
160)   998A 4F          		 LD C, A        ;CAPS ON C	;CAPS ON C
161)   998B CB 1F       		 RR A	;
162)   998D CB 1F       		 RR A         ;2 ROTATIONS RIGHT SHIFT BECOMES BIT 4 FROM 6	;2 ROTATIONS RIGHT SHIFT BECOMES BIT 4 FROM 6
163)   998F A9          		 XOR C         ;XOR SHIFT WITH CAPS	;XOR SHIFT WITH CAPS
164)   9990 CB 67       		 BIT 4, A        ;CHECK IF BIT 4 IS 0 = UNSHIFTED      	;CHECK IF BIT 4 IS 0 = UNSHIFTED
165)   9992 20 02       		 JR NZ,PS2SHIFT	;
169)   9994 78          		 LD A,B    	;
170)   9995 C9          		 RET	;
171)   9996 7A          		PS2SHIFT: LD A, D       ;RESTORE A KEYCODE	;RESTORE A KEYCODE
172)   9997 21 4E 9A    		 LD HL, PS2TAB2       ;SHIFTED	;SHIFTED
173)   999A CD 9E 99    		 CALL PLK1       ;GET CHAR	;GET CHAR
174)   999D C9          		 RET	;
175)   999E 06 00       		PLK1: LD B, 0	;
176)   99A0 4F          		 LD C, A	;
177)   99A1 09          		 ADD HL, BC	;
178)   99A2 7E          		 LD A, (HL)       ;GET THE CHAR	;GET THE CHAR
179)   99A3 C9          		 RET	;
183)   99A4 00 00 00 A5 		PS2TAB1: DB 0,0,0,165,0,0,0,0,0,0	;
183)   99A8 00 00 00 00 		PS2TAB1: DB 0,0,0,165,0,0,0,0,0,0	;
183)   99AC 00 00       		PS2TAB1: DB 0,0,0,165,0,0,0,0,0,0	;
184)   99AE A8 A6 00 00 		 DB 168,166,0,0,'`',0,0,0,0,0	;
184)   99B2 60 00 00 00 		 DB 168,166,0,0,'`',0,0,0,0,0	;
184)   99B6 00 00       		 DB 168,166,0,0,'`',0,0,0,0,0	;
185)   99B8 00 71 31 00 		 DB 0,'q','1',0,0,0,'z','s','a','w'	;
185)   99BC 00 00 7A 73 		 DB 0,'q','1',0,0,0,'z','s','a','w'	;
185)   99C0 61 77       		 DB 0,'q','1',0,0,0,'z','s','a','w'	;
186)   99C2 32 00 00 63 		 DB '2',0,0,'c','x','d','e','4','3',0	;
186)   99C6 78 64 65 34 		 DB '2',0,0,'c','x','d','e','4','3',0	;
186)   99CA 33 00       		 DB '2',0,0,'c','x','d','e','4','3',0	;
187)   99CC 00 20 76 66 		 DB 0,' ','v','f','t','r','5',0,0,'n'     ;40-49	;40-49
187)   99D0 74 72 35 00 		 DB 0,' ','v','f','t','r','5',0,0,'n'     ;40-49	;40-49
187)   99D4 00 6E       		 DB 0,' ','v','f','t','r','5',0,0,'n'     ;40-49	;40-49
188)   99D6 62 68 67 79 		 DB 'b','h','g','y','6',0,0,44,'m','j'     ;50-59	;50-59
188)   99DA 36 00 00 2C 		 DB 'b','h','g','y','6',0,0,44,'m','j'     ;50-59	;50-59
188)   99DE 6D 6A       		 DB 'b','h','g','y','6',0,0,44,'m','j'     ;50-59	;50-59
189)   99E0 75 37 38 00 		 DB 'u','7','8',0,0,',','k','i','o','0'     ;60-69	;60-69
189)   99E4 00 2C 6B 69 		 DB 'u','7','8',0,0,',','k','i','o','0'     ;60-69	;60-69
189)   99E8 6F 30       		 DB 'u','7','8',0,0,',','k','i','o','0'     ;60-69	;60-69
190)   99EA 39 00 00 2E 		 DB '9',0,0,'.','/','l',59,'p','-',0         ;70-79	;70-79
190)   99EE 2F 6C 3B 70 		 DB '9',0,0,'.','/','l',59,'p','-',0         ;70-79	;70-79
190)   99F2 2D 00       		 DB '9',0,0,'.','/','l',59,'p','-',0         ;70-79	;70-79
191)   99F4 00 00 27 00 		 DB 0,0,39,0,'[','=',0,0,0,0                 ;80-89	;80-89
191)   99F8 5B 3D 00 00 		 DB 0,0,39,0,'[','=',0,0,0,0                 ;80-89	;80-89
191)   99FC 00 00       		 DB 0,0,39,0,'[','=',0,0,0,0                 ;80-89	;80-89
192)   99FE 0D 5D 00 5C 		 DB 13,']',0,'\',0,0,0,0,0,0                 ;90-99	;90-99
192)   9A02 00 00 00 00 		 DB 13,']',0,'\',0,0,0,0,0,0                 ;90-99	;90-99
192)   9A06 00 00       		 DB 13,']',0,'\',0,0,0,0,0,0                 ;90-99	;90-99
193)   9A08 00 00 06 00 		 DB 0,0,6,0,0,8,0,4,9,0                      ;100-109	;100-109
193)   9A0C 00 08 00 04 		 DB 0,0,6,0,0,8,0,4,9,0                      ;100-109	;100-109
193)   9A10 09 00       		 DB 0,0,6,0,0,8,0,4,9,0                      ;100-109	;100-109
194)   9A12 00 00 01 07 		 DB 0,0,1,7,10,0,3,11,ESC,0                  ;110-119	;110-119
194)   9A16 0A 00 03 0B 		 DB 0,0,1,7,10,0,3,11,ESC,0                  ;110-119	;110-119
194)   9A1A 1B 00       		 DB 0,0,1,7,10,0,3,11,ESC,0                  ;110-119	;110-119
195)   9A1C 00 00 2B 2D 		 DB 0,0,'+','-','*','9',0,0,0,0              ;120-129	;120-129
195)   9A20 2A 39 00 00 		 DB 0,0,'+','-','*','9',0,0,0,0              ;120-129	;120-129
195)   9A24 00 00       		 DB 0,0,'+','-','*','9',0,0,0,0              ;120-129	;120-129
196)   9A26 00 A7 00 00 		 DB 0,167,0,0,0,0,0,0,0,0      ;130-139	;130-139
196)   9A2A 00 00 00 00 		 DB 0,167,0,0,0,0,0,0,0,0      ;130-139	;130-139
196)   9A2E 00 00       		 DB 0,167,0,0,0,0,0,0,0,0      ;130-139	;130-139
197)   9A30 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;140-149	;140-149
197)   9A34 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;140-149	;140-149
197)   9A38 00 00       		 DB 0,0,0,0,0,0,0,0,0,0                      ;140-149	;140-149
198)   9A3A 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0       ;150-159	;150-159
198)   9A3E 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0       ;150-159	;150-159
198)   9A42 00 00       		 DB 0,0,0,0,0,0,0,0,0,0       ;150-159	;150-159
199)   9A44 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;160-169	;160-169
199)   9A48 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;160-169	;160-169
199)   9A4C 00 00       		 DB 0,0,0,0,0,0,0,0,0,0                      ;160-169	;160-169
202)   9A4E 00 00 00 A5 		PS2TAB2: DB 0,0,0,165,0,0,0,0,0,0	;
202)   9A52 00 00 00 00 		PS2TAB2: DB 0,0,0,165,0,0,0,0,0,0	;
202)   9A56 00 00       		PS2TAB2: DB 0,0,0,165,0,0,0,0,0,0	;
203)   9A58 A8 A6 00 00 		 DB 168,166,0,0,'~',0,0,0,0,0	;
203)   9A5C 7E 00 00 00 		 DB 168,166,0,0,'~',0,0,0,0,0	;
203)   9A60 00 00       		 DB 168,166,0,0,'~',0,0,0,0,0	;
204)   9A62 00 51 21 00 		 DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
204)   9A66 00 00 5A 53 		 DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
204)   9A6A 41 57       		 DB 0,'Q','!',0,0,0,'Z','S','A','W'	;
205)   9A6C 40 00 00 43 		 DB '@',0,0,'C','X','D','E','$','#',0	;
205)   9A70 58 44 45 24 		 DB '@',0,0,'C','X','D','E','$','#',0	;
205)   9A74 23 00       		 DB '@',0,0,'C','X','D','E','$','#',0	;
206)   9A76 00 20 56 46 		 DB 0,' ','V','F','T','R','%',0,0,'N'     ;40-49	;40-49
206)   9A7A 54 52 25 00 		 DB 0,' ','V','F','T','R','%',0,0,'N'     ;40-49	;40-49
206)   9A7E 00 4E       		 DB 0,' ','V','F','T','R','%',0,0,'N'     ;40-49	;40-49
207)   9A80 42 48 47 59 		 DB 'B','H','G','Y','^',0,0,34,'M','J'     ;50-59 34=""	;50-59 34=""
207)   9A84 5E 00 00 22 		 DB 'B','H','G','Y','^',0,0,34,'M','J'     ;50-59 34=""	;50-59 34=""
207)   9A88 4D 4A       		 DB 'B','H','G','Y','^',0,0,34,'M','J'     ;50-59 34=""	;50-59 34=""
208)   9A8A 55 26 2A 00 		 DB 'U','&','*',0,0,'<','K','I','O',')'     ;60-69	;60-69
208)   9A8E 00 3C 4B 49 		 DB 'U','&','*',0,0,'<','K','I','O',')'     ;60-69	;60-69
208)   9A92 4F 29       		 DB 'U','&','*',0,0,'<','K','I','O',')'     ;60-69	;60-69
209)   9A94 28 00 00 3E 		 DB '(',0,0,'>','?','L',':','P','_',0        ;70-79	;70-79
209)   9A98 3F 4C 3A 50 		 DB '(',0,0,'>','?','L',':','P','_',0        ;70-79	;70-79
209)   9A9C 5F 00       		 DB '(',0,0,'>','?','L',':','P','_',0        ;70-79	;70-79
210)   9A9E 00 00 22 00 		 DB 0,0,34,0,'{','+',0,0,0,0                 ;80-89	;80-89
210)   9AA2 7B 2B 00 00 		 DB 0,0,34,0,'{','+',0,0,0,0                 ;80-89	;80-89
210)   9AA6 00 00       		 DB 0,0,34,0,'{','+',0,0,0,0                 ;80-89	;80-89
211)   9AA8 0D 7D 00 7C 		 DB 13,'}',0,'|',0,0,0,0,0,0                 ;90-99	;90-99
211)   9AAC 00 00 00 00 		 DB 13,'}',0,'|',0,0,0,0,0,0                 ;90-99	;90-99
211)   9AB0 00 00       		 DB 13,'}',0,'|',0,0,0,0,0,0                 ;90-99	;90-99
212)   9AB2 00 00 06 00 		 DB 0,0,6,0,0,8,0,4,9,0                      ;100-109	;100-109
212)   9AB6 00 08 00 04 		 DB 0,0,6,0,0,8,0,4,9,0                      ;100-109	;100-109
212)   9ABA 09 00       		 DB 0,0,6,0,0,8,0,4,9,0                      ;100-109	;100-109
213)   9ABC 00 00 01 07 		 DB 0,0,1,7,10,0,3,11,ESC,0                  ;110-119	;110-119
213)   9AC0 0A 00 03 0B 		 DB 0,0,1,7,10,0,3,11,ESC,0                  ;110-119	;110-119
213)   9AC4 1B 00       		 DB 0,0,1,7,10,0,3,11,ESC,0                  ;110-119	;110-119
214)   9AC6 00 00 2B 2D 		 DB 0,0,'+','-','*','9',0,0,0,0              ;120-129	;120-129
214)   9ACA 2A 39 00 00 		 DB 0,0,'+','-','*','9',0,0,0,0              ;120-129	;120-129
214)   9ACE 00 00       		 DB 0,0,'+','-','*','9',0,0,0,0              ;120-129	;120-129
215)   9AD0 00 A7 00 00 		 DB 0,167,0,0,0,0,0,0,0,0      ;130-139	;130-139
215)   9AD4 00 00 00 00 		 DB 0,167,0,0,0,0,0,0,0,0      ;130-139	;130-139
215)   9AD8 00 00       		 DB 0,167,0,0,0,0,0,0,0,0      ;130-139	;130-139
216)   9ADA 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;140-149	;140-149
216)   9ADE 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;140-149	;140-149
216)   9AE2 00 00       		 DB 0,0,0,0,0,0,0,0,0,0                      ;140-149	;140-149
217)   9AE4 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0       ;150-159	;150-159
217)   9AE8 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0       ;150-159	;150-159
217)   9AEC 00 00       		 DB 0,0,0,0,0,0,0,0,0,0       ;150-159	;150-159
218)   9AEE 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;160-169	;160-169
218)   9AF2 00 00 00 00 		 DB 0,0,0,0,0,0,0,0,0,0                      ;160-169	;160-169
218)   9AF6 00 00       		 DB 0,0,0,0,0,0,0,0,0,0                      ;160-169	;160-169
 43)   9AF8 00          		m18: nop         ; 4 cycles	; 4 cycles
 44)   9AF9 00          		 nop         ; 4 cycles	; 4 cycles
 45)   9AFA 00          		m16:    nop         ; 4 cycles	; 4 cycles
 46)   9AFB 00          		      nop         ; 4 cycles	; 4 cycles
 47)   9AFC 00          		      nop         ; 4 cycles	; 4 cycles
 48)   9AFD 00          		m14:    nop         ; 4 cycles	; 4 cycles
 49)   9AFE 00          		 nop         ; 4 cycles	; 4 cycles
 50)   9AFF 00          		m12:    nop         ; 4 cycles	; 4 cycles
 51)   9B00 00          		      nop         ; 4 cycles	; 4 cycles
 52)   9B01 00          		      nop         ; 4 cycles	; 4 cycles
 53)   9B02 00          		m10:    nop         ; 4 cycles	; 4 cycles
 54)   9B03 00          		      nop         ; 4 cycles	; 4 cycles
 55)   9B04 00          		m8:    nop         ; 4 cycles	; 4 cycles
 56)   9B05 00          		      nop         ; 4 cycles	; 4 cycles
 57)   9B06 00          		    nop         ; 4 cycles	; 4 cycles
 58)   9B07 00          		m6:     nop         ; 4 cycles	; 4 cycles
 59)   9B08 00          		    nop         ; 4 cycles	; 4 cycles
 60)   9B09 00          		m4: nop         ; 4 cycles	; 4 cycles
 61)   9B0A 00          		     nop         ; 4 cycles	; 4 cycles
 62)   9B0B 00          		      nop         ; 4 cycles	; 4 cycles
 63)   9B0C C3 34 9B    		 JP DM3CONT	;
 69)   9B0F 00 14 13 12 		DMHELPIDX: DB 0,20,19,18,18,17,16,16,13,13,11,11,11,08,06,06,03,03,01,00,00 ;FIXED FOR DELAYS 	;FIXED FOR DELAYS
 69)   9B13 12 11 10 10 		DMHELPIDX: DB 0,20,19,18,18,17,16,16,13,13,11,11,11,08,06,06,03,03,01,00,00 ;FIXED FOR DELAYS 	;FIXED FOR DELAYS
 69)   9B17 0D 0D 0B 0B 		DMHELPIDX: DB 0,20,19,18,18,17,16,16,13,13,11,11,11,08,06,06,03,03,01,00,00 ;FIXED FOR DELAYS 	;FIXED FOR DELAYS
 69)   9B1B 0B 08 06 06 		DMHELPIDX: DB 0,20,19,18,18,17,16,16,13,13,11,11,11,08,06,06,03,03,01,00,00 ;FIXED FOR DELAYS 	;FIXED FOR DELAYS
 69)   9B1F 03 03 01 00 		DMHELPIDX: DB 0,20,19,18,18,17,16,16,13,13,11,11,11,08,06,06,03,03,01,00,00 ;FIXED FOR DELAYS 	;FIXED FOR DELAYS
 69)   9B23 00          		DMHELPIDX: DB 0,20,19,18,18,17,16,16,13,13,11,11,11,08,06,06,03,03,01,00,00 ;FIXED FOR DELAYS 	;FIXED FOR DELAYS
 73)   9B24 DB 80       		DELAY5MICS: IN A, (128)         ; THE CPU SPEED IN MHZ e.g. 12	; THE CPU SPEED IN MHZ e.g. 12
 74)   9B26 21 0F 9B    		 LD HL,DMHELPIDX	;
 75)   9B29 5F          		 LD E,A	;
 76)   9B2A 16 00       		 LD D,0	;
 77)   9B2C 19          		 ADD HL,DE	;
 78)   9B2D 7E          		 LD A,(HL)	;
 79)   9B2E 5F          		 LD E,A	;
 80)   9B2F 21 F8 9A    		 LD HL,DELAYRTN	;
 81)   9B32 19          		 ADD HL,DE	;
 82)   9B33 E9          		DM3AGN: JP (HL)	;
 83)   9B34 10 FD       		DM3CONT: DJNZ DM3AGN	;
 84)   9B36 C9          		 RET	;
 93)   9B37 C5          		NXTMS: PUSH BC	;
 95)   9B38 06 BE       		 LD B,950/5  ;FIX SHOULD BE 1000	;FIX SHOULD BE 1000
 96)   9B3A CD 24 9B    		 CALL DELAY5MICS	;
 97)   9B3D C1          		 POP BC	;
 98)   9B3E 10 F7       		 DJNZ NXTMS	;
102)   9B40 C9          		 RET	;
107)   9B41 C5          		DELAYSEC: PUSH BC	;
108)   9B42 06 FA       		 LD B,250	;
109)   9B44 CD 37 9B    		 CALL DELAYMILI	;
110)   9B47 06 FA       		 LD B,250	;
111)   9B49 CD 37 9B    		 CALL DELAYMILI	;
112)   9B4C 06 FA       		 LD B,250	;
113)   9B4E CD 37 9B    		 CALL DELAYMILI	;
114)   9B51 06 FA       		 LD B,250	;
115)   9B53 CD 37 9B    		 CALL DELAYMILI	;
116)   9B56 C1          		 POP BC	;
117)   9B57 10 E8       		 DJNZ DELAYSEC	;
118)   9B59 C9          		 RET	;
124)   9B5A F5          		OUTASC: PUSH AF	;
125)   9B5B D5          		 PUSH DE	;
126)   9B5C CD 8F 9B    		 CALL B2Bcd	;
127)   9B5F D1          		 POP DE	;
128)   9B60 CD B5 9B    		 CALL BCD2HA	;
129)   9B63 F1          		 POP AF	;
130)   9B64 C9          		 RET	;
144)   9B65 B7          		BCD2BN: OR A	;
145)   9B66 47          		 LD B, A	;
146)   9B67 E6 F0       		 AND $F0	;
147)   9B69 0F          		 RRCA	;
148)   9B6A 4F          		 LD C, A	;
149)   9B6B 0F          		 RRCA	;
150)   9B6C 0F          		 RRCA	;
151)   9B6D 81          		 ADD A, C	;
152)   9B6E 4F          		 LD C, A	;
153)   9B6F 78          		 LD A, B	;
154)   9B70 E6 0F       		 AND $0F	;
155)   9B72 81          		 ADD A, C	;
156)   9B73 C9          		 RET	;
171)   9B74 26 FF       		BN2BCD: LD H, $FF	;
172)   9B76 24          		D100LP: INC H	;
173)   9B77 D6 64       		 SUB 100	;
174)   9B79 30 FB       		 JR NC, D100LP	;
175)   9B7B C6 64       		 ADD A, 100	;
176)   9B7D 2E FF       		 LD L, $FF	;
177)   9B7F 2C          		D10LP: INC L	;
178)   9B80 D6 0A       		 SUB 10	;
179)   9B82 30 FB       		 JR NC, D10LP	;
180)   9B84 C6 0A       		 ADD A, 10	;
181)   9B86 4F          		 LD C, A	;
182)   9B87 7D          		 LD A, L	;
183)   9B88 07          		 RLCA	;
184)   9B89 07          		 RLCA	;
185)   9B8A 07          		 RLCA	;
186)   9B8B 07          		 RLCA	;
187)   9B8C B1          		 OR C	;
188)   9B8D 6F          		 LD L, A	;
189)   9B8E C9          		 RET	;
203)   9B8F 01 00 10    		 LD BC, 16 * 256 + 0       ; handle 16 bits, one bit per iteration	; handle 16 bits, one bit per iteration
204)   9B92 11 00 00    		 LD DE, 0	;
206)   9B95 29          		 ADD HL, HL	;
207)   9B96 7B          		 LD A, E	;
208)   9B97 8F          		 ADC A, A	;
209)   9B98 27          		 DAA	;
210)   9B99 5F          		 LD E, A	;
211)   9B9A 7A          		 LD A, D	;
212)   9B9B 8F          		 ADC A, A	;
213)   9B9C 27          		 DAA	;
214)   9B9D 57          		 LD D, A	;
215)   9B9E 79          		 LD A, C	;
216)   9B9F 8F          		 ADC A, A	;
217)   9BA0 27          		 DAA	;
218)   9BA1 4F          		 LD C, A	;
219)   9BA2 10 F1       		 DJNZ cvtLp	;
220)   9BA4 EB          		 EX DE, HL	;
221)   9BA5 C9          		 RET	;
235)   9BA6 B7          		BCD2BN: OR A	;
236)   9BA7 47          		 LD B, A	;
237)   9BA8 E6 F0       		 AND $F0	;
238)   9BAA 0F          		 RRCA	;
239)   9BAB 4F          		 LD C, A	;
240)   9BAC 0F          		 RRCA	;
241)   9BAD 0F          		 RRCA	;
242)   9BAE 81          		 ADD A, C	;
243)   9BAF 4F          		 LD C, A	;
244)   9BB0 78          		 LD A, B	;
245)   9BB1 E6 0F       		 AND $0F	;
246)   9BB3 81          		 ADD A, C	;
247)   9BB4 C9          		 RET	;
259)   9BB5 79          		 LD A, C	;
260)   9BB6 CD E2 9B    		 CALL cvtUN	;
261)   9BB9 79          		 LD A, C	;
262)   9BBA CD E6 9B    		 CALL cvtLN	;
263)   9BBD 7C          		 LD A, H	;
264)   9BBE CD E2 9B    		 CALL cvtUN	;
265)   9BC1 7C          		 LD A, H	;
266)   9BC2 CD E6 9B    		 CALL cvtLN	;
267)   9BC5 7D          		 LD A, L	;
268)   9BC6 CD E2 9B    		 CALL cvtUN	;
269)   9BC9 7D          		 LD A, L	;
270)   9BCA 18 1A       		 JR cvtLN	;
272)   9BCC 1F          		 RRA         ; move upper nibble into lower nibble	; move upper nibble into lower nibble
273)   9BCD 1F          		 RRA	;
274)   9BCE 1F          		 RRA	;
275)   9BCF 1F          		 RRA	;
277)   9BD0 E6 0F       		 AND 0Fh        ; isolate lower nibble	; isolate lower nibble
278)   9BD2 C6 90       		 ADD A, 90h        ; old trick	; old trick
279)   9BD4 27          		 DAA         ; for converting	; for converting
280)   9BD5 CE 40       		 ADC A, 40h        ; one nibble	; one nibble
281)   9BD7 27          		 DAA         ; to hex ASCII	; to hex ASCII
282)   9BD8 12          		 LD (DE), A	;
283)   9BD9 13          		 INC DE	;
284)   9BDA C9          		 RET	;
296)   9BDB 7D          		 LD A, L	;
297)   9BDC CD CC 9B    		 CALL cvtUN	;
298)   9BDF 7D          		 LD A, L	;
299)   9BE0 18 EE       		 JR cvtLN	;
301)   9BE2 1F          		 RRA         ; move upper nibble into lower nibble	; move upper nibble into lower nibble
302)   9BE3 1F          		 RRA	;
303)   9BE4 1F          		 RRA	;
304)   9BE5 1F          		 RRA	;
306)   9BE6 E6 0F       		 AND 0Fh        ; isolate lower nibble	; isolate lower nibble
307)   9BE8 C6 90       		 ADD A, 90h        ; old trick	; old trick
308)   9BEA 27          		 DAA         ; for converting	; for converting
309)   9BEB CE 40       		 ADC A, 40h        ; one nibble	; one nibble
310)   9BED 27          		 DAA         ; to hex ASCII	; to hex ASCII
311)   9BEE 12          		 LD (DE), A	;
312)   9BEF 13          		 INC DE	;
313)   9BF0 C9          		 RET	;
344)   9BF1 26 00       		@B2D8: LD H, 0	;
345)   9BF3 6F          		 LD L, A	;
346)   9BF4 1E 00       		@B2D16: LD E, 0	;
347)   9BF6 16 00       		@B2D24: LD D, 0	;
348)   9BF8 01 00 00    		@B2D32: LD BC, 0	;
349)   9BFB DD 21 00 00 		@B2D48: LD IX, 0        ; zero all non-used bits	; zero all non-used bits
350)   9BFF 22 C3 00    		@B2D64: LD (B2DINV), HL	;
351)   9C02 ED 53 C5 00 		 LD (B2DINV + 2), DE	;
352)   9C06 ED 43 C7 00 		 LD (B2DINV + 4), BC	;
353)   9C0A DD 22 C9 00 		 LD (B2DINV + 6), IX       ; place full 64-bit input value in buffer	; place full 64-bit input value in buffer
354)   9C0E 21 CB 00    		 LD HL, B2DBUF	;
355)   9C11 11 CC 00    		 LD DE, B2DBUF + 1	;
356)   9C14 36 20       		 LD (HL), ' '	;
358)   9C16 01 12 00    		 LD BC, 18	;
359)   9C19 ED B0       		 LDIR         ; fill 1st 19 bytes of buffer with spaces	; fill 1st 19 bytes of buffer with spaces
360)   9C1B ED 43 DE 00 		 LD (B2DEND - 1), BC       ;set BCD value to "0" & place terminating 0	;set BCD value to "0" & place terminating 0
361)   9C1F 1E 01       		 LD E, 1        ; no. of bytes in BCD value	; no. of bytes in BCD value
362)   9C21 21 CB 00    		 LD HL, B2DINV + 8       ; (address MSB input)+1	; (address MSB input)+1
363)   9C24 01 09 09    		 LD BC, 0x0909	;
364)   9C27 AF          		 XOR A	;
365)   9C28 05          		B2DSKP0: DEC B	;
366)   9C29 28 29       		 JR Z, B2DSIZ        ; all 0: continue with postprocessing	; all 0: continue with postprocessing
367)   9C2B 2B          		 DEC HL	;
368)   9C2C B6          		 OR (HL)        ; find first byte <>0	; find first byte <>0
369)   9C2D 28 F9       		 JR Z, B2DSKP0	;
370)   9C2F 0D          		B2DFND1: DEC C	;
371)   9C30 17          		 RLA	;
372)   9C31 30 FC       		 JR NC, B2DFND1        ; determine no. of most significant 1-bit	; determine no. of most significant 1-bit
373)   9C33 1F          		 RRA	;
374)   9C34 57          		 LD D, A        ; byte from binary input value	; byte from binary input value
375)   9C35 E5          		B2DLUS2: PUSH HL	;
376)   9C36 C5          		 PUSH BC	;
377)   9C37 21 DE 00    		B2DLUS1: LD HL, B2DEND - 1      ; address LSB of BCD value	; address LSB of BCD value
378)   9C3A 43          		 LD B, E        ; current length of BCD value in bytes	; current length of BCD value in bytes
379)   9C3B CB 12       		 RL D         ; highest bit from input value -> carry	; highest bit from input value -> carry
380)   9C3D 7E          		B2DLUS0: LD A, (HL)	;
381)   9C3E 8F          		 ADC A, A	;
382)   9C3F 27          		 DAA	;
383)   9C40 77          		 LD (HL), A        ; double 1 BCD byte from intermediate result	; double 1 BCD byte from intermediate result
384)   9C41 2B          		 DEC HL	;
385)   9C42 10 F9       		 DJNZ B2DLUS0        ; and go on to double entire BCD value (+carry!)	; and go on to double entire BCD value (+carry!)
386)   9C44 30 03       		 JR NC, B2DNXT	;
387)   9C46 1C          		 INC E         ; carry at MSB -> BCD value grew 1 byte larger	; carry at MSB -> BCD value grew 1 byte larger
388)   9C47 36 01       		 LD (HL), 1        ; initialize new MSB of BCD value	; initialize new MSB of BCD value
389)   9C49 0D          		B2DNXT: DEC C	;
390)   9C4A 20 EB       		 JR NZ, B2DLUS1        ; repeat for remaining bits from 1 input byte	; repeat for remaining bits from 1 input byte
391)   9C4C C1          		 POP BC         ; no. of remaining bytes in input value	; no. of remaining bytes in input value
392)   9C4D 0E 08       		 LD C, 8        ; reset bit-counter	; reset bit-counter
393)   9C4F E1          		 POP HL         ; pointer to byte from input value	; pointer to byte from input value
394)   9C50 2B          		 DEC HL	;
395)   9C51 56          		 LD D, (HL)        ; get next group of 8 bits	; get next group of 8 bits
396)   9C52 10 E1       		 DJNZ B2DLUS2        ; and repeat until last byte from input value	; and repeat until last byte from input value
397)   9C54 21 DF 00    		B2DSIZ: LD HL, B2DEND        ; address of terminating 0	; address of terminating 0
398)   9C57 4B          		 LD C, E        ; size of BCD value in bytes	; size of BCD value in bytes
399)   9C58 B7          		 OR A	;
400)   9C59 ED 42       		 SBC HL, BC        ; calculate address of MSB BCD	; calculate address of MSB BCD
401)   9C5B 54          		 LD D, H	;
402)   9C5C 5D          		 LD E, L	;
403)   9C5D ED 42       		 SBC HL, BC	;
404)   9C5F EB          		 EX DE, HL        ; HL=address BCD value, DE=start of decimal value	; HL=address BCD value, DE=start of decimal value
405)   9C60 41          		 LD B, C        ; no. of bytes BCD	; no. of bytes BCD
406)   9C61 CB 21       		 SLA C         ; no. of bytes decimal (possibly 1 too high)	; no. of bytes decimal (possibly 1 too high)
407)   9C63 3E 30       		 LD A, '0'	;
408)   9C65 ED 6F       		 RLD         ; shift bits 4-7 of (HL) into bit 0-3 of A	; shift bits 4-7 of (HL) into bit 0-3 of A
409)   9C67 FE 30       		 CP '0'         ; (HL) was > 9h?	; (HL) was > 9h?
410)   9C69 20 06       		 JR NZ, B2DEXPH        ; if yes, start with recording high digit	; if yes, start with recording high digit
411)   9C6B 0D          		 DEC C         ; correct number of decimals	; correct number of decimals
412)   9C6C 13          		 INC DE         ; correct start address	; correct start address
413)   9C6D 18 04       		 JR B2DEXPL        ; continue with converting low digit	; continue with converting low digit
414)   9C6F ED 6F       		B2DEXP: RLD         ; shift high digit (HL) into low digit of A	; shift high digit (HL) into low digit of A
415)   9C71 12          		B2DEXPH: LD (DE), A       ; record resulting ASCII-code	; record resulting ASCII-code
416)   9C72 13          		 INC DE	;
417)   9C73 ED 6F       		B2DEXPL: RLD	;
418)   9C75 12          		 LD (DE), A	;
419)   9C76 13          		 INC DE	;
420)   9C77 23          		 INC HL         ; next BCD-byte	; next BCD-byte
421)   9C78 10 F5       		 DJNZ B2DEXP        ; and go on to convert each BCD-byte into 2 ASCII	; and go on to convert each BCD-byte into 2 ASCII
422)   9C7A ED 42       		 SBC HL, BC        ; return with HL pointing to 1st decimal	; return with HL pointing to 1st decimal
423)   9C7C C9          		 RET	;
427)   9C7D EB          		 ex de, hl        ; Get destination into DE	; Get destination into DE
428)   9C7E 21 CB 00    		 ld hl, B2DBUF	;
429)   9C81 CD 88 9C    		 call SkipWhitespace	;
430)   9C84 ED B0       		 ldir	;
431)   9C86 EB          		 ex de, hl        ; Get destination into DE	; Get destination into DE
432)   9C87 C9          		 ret	;
437)   9C88 7E          		 ld a, (hl)	;
438)   9C89 FE 20       		 cp ' '	;
439)   9C8B C0          		 ret nz	;
440)   9C8C 23          		 inc hl	;
441)   9C8D 18 F9       		 jr SkipWhitespace	;
445)   9C8F 06 08       		@REVBITS: ld b, 8	;
446)   9C91 6F          		 ld l, a	;
448)   9C92 CB 15       		 rl l	;
449)   9C94 1F          		 rra	;
450)   9C95 10 FB       		 djnz REVLOOP	;
451)   9C97 C9          		 RET	;
461)   9C98 E5          		 push hl	;
463)   9C99 7E          		 ld a, (hl)	;
465)   9C9A FE 00       		 cp  0	;
466)   9C9C 28 0E       		 jr z, IsStrDecTrue	;
468)   9C9E FE 30       		 cp  '0'	;
469)   9CA0 38 06       		 jr c, IsStrDecFalse	;
471)   9CA2 FE 3A       		 cp  '9'+1	;
472)   9CA4 38 09       		 jr c, IsStrDecContinue	;
473)   9CA6 FE 39       		 cp  '9'	;
476)   9CA8 F6 01       		 or 1         ; Reset zero flag	; Reset zero flag
477)   9CAA E1          		 pop hl	;
478)   9CAB C9          		 ret	;
480)   9CAC BF          		 cp a         ; Set zero flag	; Set zero flag
481)   9CAD E1          		 pop hl	;
482)   9CAE C9          		 ret	;
484)   9CAF 23          		 inc hl	;
485)   9CB0 18 E7       		 jr IsStrDec00	;
492)   9CB2 E5          		 push hl	;
494)   9CB3 7E          		 ld a, (hl)	;
496)   9CB4 FE 00       		 cp  0	;
497)   9CB6 28 14       		 jr z, IsStrHexTrue	;
499)   9CB8 FE 30       		 cp  '0'	;
500)   9CBA 38 0C       		 jr c, IsStrHexFalse	;
502)   9CBC FE 3A       		 cp  '9'+1	;
503)   9CBE 38 0F       		 jr c, IsStrHexContinue	;
505)   9CC0 FE 30       		 cp  '0'	;
506)   9CC2 38 04       		 jr c, IsStrHexFalse	;
508)   9CC4 FE 47       		 cp  'F'+1	;
509)   9CC6 38 07       		 jr c, IsStrHexContinue	;
512)   9CC8 F6 01       		 or 1         ; Reset zero flag	; Reset zero flag
513)   9CCA E1          		 pop hl	;
514)   9CCB C9          		 ret	;
516)   9CCC BF          		 cp a         ; Set zero flag	; Set zero flag
517)   9CCD E1          		 pop hl	;
518)   9CCE C9          		 ret	;
520)   9CCF 23          		 inc hl	;
521)   9CD0 18 E1       		 jr IsStrHex00	;
528)   9CD2 AF          		 xor a	;
529)   9CD3 CD D8 9C    		 call loop	;
530)   9CD6 7A          		 ld a, d	;
531)   9CD7 C9          		 ret	;
533)   9CD8 57          		 ld d, a	;
534)   9CD9 7E          		 ld a, (hl)	;
535)   9CDA 23          		 inc hl	;
536)   9CDB D6 3A       		 sub '9' + 1	;
537)   9CDD C6 0A       		 add 10	;
538)   9CDF D0          		 ret nc	;
539)   9CE0 5F          		 ld e, a	;
540)   9CE1 7A          		 ld a, d	;
541)   9CE2 87          		 add a, a        ;double our accumulator	;double our accumulator
542)   9CE3 87          		 add a, a        ;double again (now x4)	;double again (now x4)
543)   9CE4 82          		 add a, d        ;add the original (now x5)	;add the original (now x5)
544)   9CE5 87          		 add a, a        ;double again (now x10)	;double again (now x10)
545)   9CE6 83          		 add a, e        ;add in the incoming digit	;add in the incoming digit
546)   9CE7 18 EF       		 jr loop	;
554)   9CE9 7E          		 ld a, (hl)        ; Copy first char to A	; Copy first char to A
555)   9CEA CD FA 9C    		 call Hex12        ; Convert first char	; Convert first char
556)   9CED 87          		 add a, a        ; Multiply by 16...	; Multiply by 16...
557)   9CEE 87          		 add a, a        ; ...	; ...
558)   9CEF 87          		 add a, a        ; ...	; ...
559)   9CF0 87          		 add a, a        ; ...done!	; ...done!
560)   9CF1 57          		 ld d, a        ; Store top 4 bits in D	; Store top 4 bits in D
561)   9CF2 23          		 inc hl         ; Advance to next char	; Advance to next char
562)   9CF3 7E          		 ld a, (hl)	;
563)   9CF4 CD FA 9C    		 call Hex12        ; Convert second char	; Convert second char
564)   9CF7 B2          		 or d         ; Add back top bits	; Add back top bits
565)   9CF8 23          		 inc hl         ; Advance for next guy	; Advance for next guy
566)   9CF9 C9          		 ret	;
567)   9CFA D6 30       		Hex12: sub  '0'	;
568)   9CFC FE 0A       		 cp 10	;
569)   9CFE D8          		 ret c	;
570)   9CFF D6 07       		 sub 'A' - '0' - 10	;
571)   9D01 C9          		 ret	;
578)   9D02 CD E9 9C    		 call Read8bit	;
579)   9D05 47          		 ld b, a	;
580)   9D06 CD E9 9C    		 call Read8bit	;
581)   9D09 4F          		 ld c, a	;
582)   9D0A C9          		 ret	;
590)   9D0B 7E          		 ld a, (hl)	;
591)   9D0C 23          		 inc hl	;
592)   9D0D D6 30       		 sub '0'	;
593)   9D0F CB 27       		 sla a	;
594)   9D11 CB 27       		 sla a	;
595)   9D13 CB 27       		 sla a	;
596)   9D15 CB 27       		 sla a	;
597)   9D17 47          		 ld b, a	;
598)   9D18 7E          		 ld a, (hl)	;
599)   9D19 23          		 inc hl	;
600)   9D1A D6 30       		 sub '0'	;
601)   9D1C B0          		 or b	;
602)   9D1D C9          		 ret	;
607)   9D1E 4F          		 ld c, a        ; a = number to convert	; a = number to convert
608)   9D1F CD 2B 9D    		 call Num1	;
609)   9D22 77          		 ld (hl), a	;
610)   9D23 23          		 inc hl	;
611)   9D24 79          		 ld a, c	;
612)   9D25 CD 2F 9D    		 call Num2	;
613)   9D28 77          		 ld (hl), a	;
614)   9D29 23          		 inc hl	;
615)   9D2A C9          		 ret	;
616)   9D2B 1F          		Num1: rra	;
617)   9D2C 1F          		 rra	;
618)   9D2D 1F          		 rra	;
619)   9D2E 1F          		 rra	;
620)   9D2F F6 F0       		Num2: or $F0	;
621)   9D31 27          		 daa	;
622)   9D32 C6 A0       		 add a, $A0	;
623)   9D34 CE 40       		 adc a, $40        ; Ascii hex at this point (0 to F)	; Ascii hex at this point (0 to F)
624)   9D36 C9          		 ret	;
635)   9D37 22 AC 00    		STR_SET: LD (LINESTR),HL	;
636)   9D3A C9          		 RET	;
639)   9D3B AF          		STR_CLR: XOR A	;
640)   9D3C 32 AE 00    		 LD (LINEPOS),A	;
641)   9D3F 32 AC 00    		 LD (LINESTR),A	;
642)   9D42 32 AD 00    		 LD (LINESTR+1),A	;
643)   9D45 C9          		 RET	;
646)   9D46 3A AC 00    		STR_VALID: LD A,(LINESTR)	;
647)   9D49 47          		 LD B,A	;
648)   9D4A 3A AD 00    		 LD A,(LINESTR+1)	;
649)   9D4D 80          		 ADD B	;
650)   9D4E B7          		 OR A	;
651)   9D4F C9          		 RET	;
657)   9D50 F5          		STR_CALCADDR: PUSH AF	;
658)   9D51 ED 5B AC 00 		 LD DE,(LINESTR)	;
659)   9D55 EB          		 EX DE,HL	;
660)   9D56 3A AE 00    		 LD A,(LINEPOS)	;
661)   9D59 4F          		 LD C,A	;
662)   9D5A 06 00       		 LD B,0	;
663)   9D5C 09          		 ADD HL,BC	;
664)   9D5D EB          		 EX DE,HL	;
665)   9D5E F1          		 POP AF	;
666)   9D5F C9          		 RET	;
670)   9D60 3A AE 00    		STR_NEXTPOS: LD A,(LINEPOS)	;
671)   9D63 3C          		 INC A	;
672)   9D64 32 AE 00    		 LD (LINEPOS),A	;
673)   9D67 C9          		 RET	;
677)   9D68 CD 50 9D    		STR_ADD: CALL STR_CALCADDR	;
678)   9D6B CD 60 9D    		STRA_AGN: CALL STR_NEXTPOS	;
679)   9D6E 7E          		 LD A,(HL)	;
680)   9D6F 12          		 LD (DE),A	;
681)   9D70 23          		 INC HL	;
682)   9D71 13          		 INC DE	;
683)   9D72 B7          		 OR A	;
684)   9D73 C8          		 RET Z	;
685)   9D74 18 F5       		 JR STRA_AGN	;
688)   9D76 CD 50 9D    		STR_ADDCHAR: CALL STR_CALCADDR	;
689)   9D79 12          		 LD (DE),A	;
690)   9D7A CD 60 9D    		 CALL STR_NEXTPOS	;
691)   9D7D 13          		 INC DE	;
692)   9D7E AF          		 XOR A	;
693)   9D7F 12          		 LD (DE),A	;
694)   9D80 C9          		 RET	;
702)   9D81 26 00       		@PRINTNUM: LD H,0	;
703)   9D83 6F          		 LD L,A	;
704)   9D84 F5          		@PRINTNUM16: PUSH AF	;
706)   9D85 11 BC 00    		 LD DE,NUMBUF	;
707)   9D88 CD DB 9B    		 CALL Bcd2ASC  ;FOR HEX	;FOR HEX
708)   9D8B 3E 68       		 LD A,'h'	;
709)   9D8D 12          		 LD (DE),A  	;
710)   9D8E 13          		 INC DE	;
711)   9D8F AF          		 XOR A	;
712)   9D90 12          		 LD (DE),A  	;
714)   9D91 21 BC 00    		 LD HL,NUMBUF	;
715)   9D94 CD D1 8B    		 CALL RS_TXT	;
716)   9D97 CD 31 8C    		 CALL RS_NEWLINE	;
717)   9D9A F1          		 POP AF	;
718)   9D9B C9          		 RET	;
726)   9D9C E5          		@NUM_ADDZERO: PUSH HL	;
727)   9D9D 0E 00       		 LD C,0	;
728)   9D9F 7E          		AZ_AGN: LD A,(HL)   	;
729)   9DA0 23          		 INC HL	;
730)   9DA1 0C          		 INC C	;
731)   9DA2 FE 00       		 CP 0	;
732)   9DA4 20 F9       		 JR NZ,AZ_AGN	;
733)   9DA6 0D          		 DEC C ;EXCLUDE ZERO TERM	;EXCLUDE ZERO TERM
734)   9DA7 E1          		 POP HL	;
735)   9DA8 79          		 LD A,C	;
736)   9DA9 B8          		 CP B	;
737)   9DAA C8          		 RET Z	;
739)   9DAB 78          		 LD A,B	;
740)   9DAC 91          		 SUB C	;
741)   9DAD D8          		 RET C ;RETURN IF CARRY MEANS WE HAVE MORE DIGITS	;RETURN IF CARRY MEANS WE HAVE MORE DIGITS
742)   9DAE 47          		 LD B,A	;
743)   9DAF 3E 30       		 LD A,'0'	;
744)   9DB1 2B          		AZ_AGN2: DEC HL	;
745)   9DB2 77          		 LD (HL),A	;
746)   9DB3 10 FC       		 DJNZ AZ_AGN2 	;
747)   9DB5 C9          		 RET	;
753)   9DB6 11 F0 00    		@COPYFNAME: LD DE,STRGBUFF	;
754)   9DB9 7E          		@COPYSTRING:   LD A,(HL)	;
755)   9DBA 12          		 LD (DE),A	;
756)   9DBB FE 00       		 CP 0	;
757)   9DBD C8          		 RET Z  	;
758)   9DBE 13          		 INC DE	;
759)   9DBF 23          		 INC HL	;
760)   9DC0 18 F7       		 JR COPYSTRING	;
764)   9DC2 16 00       		@Mul8b: ld d,0                         ; clearing D and L	; clearing D and L
765)   9DC4 6A          		   ld l,d	;
766)   9DC5 06 08       		   ld b,8                         ; we have 8 bits	; we have 8 bits
767)   9DC7 29          		Mul8bLoop:  add hl,hl                      ; advancing a bit	; advancing a bit
768)   9DC8 D2 CC 9D    		   jp nc,Mul8bSkip                ; if zero, we skip the addition (jp is used for speed)	; if zero, we skip the addition (jp is used for speed)
769)   9DCB 19          		   add hl,de                      ; adding to the product if necessary	; adding to the product if necessary
770)   9DCC 10 F9       		Mul8bSkip: djnz Mul8bLoop	;
771)   9DCE C9          		   ret	;
774)   9DCF 21 00 00    		MUL: LD HL, 0             ; Clear HL	; Clear HL
775)   9DD2 57          		     LD D, A              ; D = A (number of microseconds)	; D = A (number of microseconds)
776)   9DD3 59          		     LD E, C              ; E = C (CPU speed)	; E = C (CPU speed)
777)   9DD4 19          		MUL_LOOP: ADD HL, DE          ; HL = HL + DE	; HL = HL + DE
778)   9DD5 15          		     DEC D                ; Decrement D	; Decrement D
779)   9DD6 20 FC       		     JR NZ, MUL_LOOP      ; Repeat until D is zero	; Repeat until D is zero
780)   9DD8 C9          		     RET	;
783)   9DD9 AF          		DIV:    XOR A                ; Clear A (quotient)	; Clear A (quotient)
784)   9DDA 06 10       		     LD B, 16             ; Set bit counter (16 bits)	; Set bit counter (16 bits)
785)   9DDC 29          		DIV_LOOP:      ADD HL, HL           ; Shift HL left	; Shift HL left
786)   9DDD CB 17       		     RL A                 ; Shift A left through carry	; Shift A left through carry
787)   9DDF BB          		     CP E                 ; Compare A with E	; Compare A with E
788)   9DE0 38 02       		     JR C, NO_SUB         ; If A < E, skip subtraction	; If A < E, skip subtraction
789)   9DE2 93          		     SUB E                ; A = A - E	; A = A - E
790)   9DE3 2C          		     INC L                ; Increment L (part of quotient)	; Increment L (part of quotient)
791)   9DE4 10 F6       		NO_SUB: DJNZ DIV_LOOP        ; Loop 16 times	; Loop 16 times
792)   9DE6 C9          		     RET                  ; Return with quotient in A	; Return with quotient in A
  1)   9DE7 00 00 00 00 		DS 0A000H-$	;
  1)   9DEB 00 00 00 00 		DS 0A000H-$	;
  1)   9DEF 00 00 00 00 		DS 0A000H-$	;
  1)   9DF3 00 00 00 00 		DS 0A000H-$	;
  1)   9DF7 00 00 00 00 		DS 0A000H-$	;
  1)   9DFB 00 00 00 00 		DS 0A000H-$	;
  1)   9DFF 00 00 00 00 		DS 0A000H-$	;
  1)   9E03 00 00 00 00 		DS 0A000H-$	;
  1)   9E07 00 00 00 00 		DS 0A000H-$	;
  1)   9E0B 00 00 00 00 		DS 0A000H-$	;
  1)   9E0F 00 00 00 00 		DS 0A000H-$	;
  1)   9E13 00 00 00 00 		DS 0A000H-$	;
  1)   9E17 00 00 00 00 		DS 0A000H-$	;
  1)   9E1B 00 00 00 00 		DS 0A000H-$	;
  1)   9E1F 00 00 00 00 		DS 0A000H-$	;
  1)   9E23 00 00 00 00 		DS 0A000H-$	;
  1)   9E27 00 00 00 00 		DS 0A000H-$	;
  1)   9E2B 00 00 00 00 		DS 0A000H-$	;
  1)   9E2F 00 00 00 00 		DS 0A000H-$	;
  1)   9E33 00 00 00 00 		DS 0A000H-$	;
  1)   9E37 00 00 00 00 		DS 0A000H-$	;
  1)   9E3B 00 00 00 00 		DS 0A000H-$	;
  1)   9E3F 00 00 00 00 		DS 0A000H-$	;
  1)   9E43 00 00 00 00 		DS 0A000H-$	;
  1)   9E47 00 00 00 00 		DS 0A000H-$	;
  1)   9E4B 00 00 00 00 		DS 0A000H-$	;
  1)   9E4F 00 00 00 00 		DS 0A000H-$	;
  1)   9E53 00 00 00 00 		DS 0A000H-$	;
  1)   9E57 00 00 00 00 		DS 0A000H-$	;
  1)   9E5B 00 00 00 00 		DS 0A000H-$	;
  1)   9E5F 00 00 00 00 		DS 0A000H-$	;
  1)   9E63 00 00 00 00 		DS 0A000H-$	;
  1)   9E67 00 00 00 00 		DS 0A000H-$	;
  1)   9E6B 00 00 00 00 		DS 0A000H-$	;
  1)   9E6F 00 00 00 00 		DS 0A000H-$	;
  1)   9E73 00 00 00 00 		DS 0A000H-$	;
  1)   9E77 00 00 00 00 		DS 0A000H-$	;
  1)   9E7B 00 00 00 00 		DS 0A000H-$	;
  1)   9E7F 00 00 00 00 		DS 0A000H-$	;
  1)   9E83 00 00 00 00 		DS 0A000H-$	;
  1)   9E87 00 00 00 00 		DS 0A000H-$	;
  1)   9E8B 00 00 00 00 		DS 0A000H-$	;
  1)   9E8F 00 00 00 00 		DS 0A000H-$	;
  1)   9E93 00 00 00 00 		DS 0A000H-$	;
  1)   9E97 00 00 00 00 		DS 0A000H-$	;
  1)   9E9B 00 00 00 00 		DS 0A000H-$	;
  1)   9E9F 00 00 00 00 		DS 0A000H-$	;
  1)   9EA3 00 00 00 00 		DS 0A000H-$	;
  1)   9EA7 00 00 00 00 		DS 0A000H-$	;
  1)   9EAB 00 00 00 00 		DS 0A000H-$	;
  1)   9EAF 00 00 00 00 		DS 0A000H-$	;
  1)   9EB3 00 00 00 00 		DS 0A000H-$	;
  1)   9EB7 00 00 00 00 		DS 0A000H-$	;
  1)   9EBB 00 00 00 00 		DS 0A000H-$	;
  1)   9EBF 00 00 00 00 		DS 0A000H-$	;
  1)   9EC3 00 00 00 00 		DS 0A000H-$	;
  1)   9EC7 00 00 00 00 		DS 0A000H-$	;
  1)   9ECB 00 00 00 00 		DS 0A000H-$	;
  1)   9ECF 00 00 00 00 		DS 0A000H-$	;
  1)   9ED3 00 00 00 00 		DS 0A000H-$	;
  1)   9ED7 00 00 00 00 		DS 0A000H-$	;
  1)   9EDB 00 00 00 00 		DS 0A000H-$	;
  1)   9EDF 00 00 00 00 		DS 0A000H-$	;
  1)   9EE3 00 00 00 00 		DS 0A000H-$	;
  1)   9EE7 00 00 00 00 		DS 0A000H-$	;
  1)   9EEB 00 00 00 00 		DS 0A000H-$	;
  1)   9EEF 00 00 00 00 		DS 0A000H-$	;
  1)   9EF3 00 00 00 00 		DS 0A000H-$	;
  1)   9EF7 00 00 00 00 		DS 0A000H-$	;
  1)   9EFB 00 00 00 00 		DS 0A000H-$	;
  1)   9EFF 00 00 00 00 		DS 0A000H-$	;
  1)   9F03 00 00 00 00 		DS 0A000H-$	;
  1)   9F07 00 00 00 00 		DS 0A000H-$	;
  1)   9F0B 00 00 00 00 		DS 0A000H-$	;
  1)   9F0F 00 00 00 00 		DS 0A000H-$	;
  1)   9F13 00 00 00 00 		DS 0A000H-$	;
  1)   9F17 00 00 00 00 		DS 0A000H-$	;
  1)   9F1B 00 00 00 00 		DS 0A000H-$	;
  1)   9F1F 00 00 00 00 		DS 0A000H-$	;
  1)   9F23 00 00 00 00 		DS 0A000H-$	;
  1)   9F27 00 00 00 00 		DS 0A000H-$	;
  1)   9F2B 00 00 00 00 		DS 0A000H-$	;
  1)   9F2F 00 00 00 00 		DS 0A000H-$	;
  1)   9F33 00 00 00 00 		DS 0A000H-$	;
  1)   9F37 00 00 00 00 		DS 0A000H-$	;
  1)   9F3B 00 00 00 00 		DS 0A000H-$	;
  1)   9F3F 00 00 00 00 		DS 0A000H-$	;
  1)   9F43 00 00 00 00 		DS 0A000H-$	;
  1)   9F47 00 00 00 00 		DS 0A000H-$	;
  1)   9F4B 00 00 00 00 		DS 0A000H-$	;
  1)   9F4F 00 00 00 00 		DS 0A000H-$	;
  1)   9F53 00 00 00 00 		DS 0A000H-$	;
  1)   9F57 00 00 00 00 		DS 0A000H-$	;
  1)   9F5B 00 00 00 00 		DS 0A000H-$	;
  1)   9F5F 00 00 00 00 		DS 0A000H-$	;
  1)   9F63 00 00 00 00 		DS 0A000H-$	;
  1)   9F67 00 00 00 00 		DS 0A000H-$	;
  1)   9F6B 00 00 00 00 		DS 0A000H-$	;
  1)   9F6F 00 00 00 00 		DS 0A000H-$	;
  1)   9F73 00 00 00 00 		DS 0A000H-$	;
  1)   9F77 00 00 00 00 		DS 0A000H-$	;
  1)   9F7B 00 00 00 00 		DS 0A000H-$	;
  1)   9F7F 00 00 00 00 		DS 0A000H-$	;
  1)   9F83 00 00 00 00 		DS 0A000H-$	;
  1)   9F87 00 00 00 00 		DS 0A000H-$	;
  1)   9F8B 00 00 00 00 		DS 0A000H-$	;
  1)   9F8F 00 00 00 00 		DS 0A000H-$	;
  1)   9F93 00 00 00 00 		DS 0A000H-$	;
  1)   9F97 00 00 00 00 		DS 0A000H-$	;
  1)   9F9B 00 00 00 00 		DS 0A000H-$	;
  1)   9F9F 00 00 00 00 		DS 0A000H-$	;
  1)   9FA3 00 00 00 00 		DS 0A000H-$	;
  1)   9FA7 00 00 00 00 		DS 0A000H-$	;
  1)   9FAB 00 00 00 00 		DS 0A000H-$	;
  1)   9FAF 00 00 00 00 		DS 0A000H-$	;
  1)   9FB3 00 00 00 00 		DS 0A000H-$	;
  1)   9FB7 00 00 00 00 		DS 0A000H-$	;
  1)   9FBB 00 00 00 00 		DS 0A000H-$	;
  1)   9FBF 00 00 00 00 		DS 0A000H-$	;
  1)   9FC3 00 00 00 00 		DS 0A000H-$	;
  1)   9FC7 00 00 00 00 		DS 0A000H-$	;
  1)   9FCB 00 00 00 00 		DS 0A000H-$	;
  1)   9FCF 00 00 00 00 		DS 0A000H-$	;
  1)   9FD3 00 00 00 00 		DS 0A000H-$	;
  1)   9FD7 00 00 00 00 		DS 0A000H-$	;
  1)   9FDB 00 00 00 00 		DS 0A000H-$	;
  1)   9FDF 00 00 00 00 		DS 0A000H-$	;
  1)   9FE3 00 00 00 00 		DS 0A000H-$	;
  1)   9FE7 00 00 00 00 		DS 0A000H-$	;
  1)   9FEB 00 00 00 00 		DS 0A000H-$	;
  1)   9FEF 00 00 00 00 		DS 0A000H-$	;
  1)   9FF3 00 00 00 00 		DS 0A000H-$	;
  1)   9FF7 00 00 00 00 		DS 0A000H-$	;
  1)   9FFB 00 00 00 00 		DS 0A000H-$	;
  1)   9FFF 00          		DS 0A000H-$	;
