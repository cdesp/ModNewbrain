 36)   007A 00          		 @KEYCTR DEFS 1        ;IN NB SYSTEM VARS	;IN NB SYSTEM VARS
 37)   007B 00          		 @SERERR DEFS 1	;
 39)   007C 00          		 @DISPCT DEFS 1	;
 40)   007D 00          		 @LCDCX DEFS 1        ;DISPLAY X POS (0..F  FOR 1..16)	;DISPLAY X POS (0..F  FOR 1..16)
 41)   007E 00          		 @LCDCX DEFS 1        ;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)	;DISPLAY Y POS (0 OR 1 FOR LINE 1 AND 2)
 42)   007F 00          		 @LCD_DSPCTRL DEFS 1       ;LCD I2C 16X2	;LCD I2C 16X2
 43)   0080 00          		 @LCD_DSPMODE DEFS 1       ;LCD I2C 16X2	;LCD I2C 16X2
 44)   0081 00          		 @LCD_STSMASK DEFS 1       ;LCD I2C 16X2	;LCD I2C 16X2
 45)   0082 00          		 @STRG_STAT DEFS 1       ;STORAGE_NEW STAUS BIT 0=0 NOT CONNECTED,1=CONNECTED,BIT 7 DEVICE EXISTS	;STORAGE_NEW STAUS BIT 0=0 NOT CONNECTED, 1=CONNECTED, BIT 7 DEVICE EXISTS
 46)   0083 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   0087 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   008B 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   008F 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   0093 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   0097 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   009B 00 00 00 00 		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 46)   009F 00 00       		 @USBBUF DEFS 30       ;CH376 USB BUFFER=20BYTES	;CH376 USB BUFFER=20BYTES
 47)   00A1 00 00 00 00 		 @BANKS DEFS 8        ;8 PAGES FOR THE 8 BANKS 0..7	;8 PAGES FOR THE 8 BANKS 0..7
 47)   00A5 00 00 00 00 		 @BANKS DEFS 8        ;8 PAGES FOR THE 8 BANKS 0..7	;8 PAGES FOR THE 8 BANKS 0..7
 48)   00A9 00 00 00 00 		 @TMPG DEFS 4        ;TEMP PAGE FOR VIDEO VGA	;TEMP PAGE FOR VIDEO VGA
 50)   00AD 00 00       		 @PRGEX DEFS 2        ;ONLY FOR BOOTL	;ONLY FOR BOOTL
 51)   00AF 00          		 @TVSTAT DEFS 1        ;ONLY FOR BOOTL	;ONLY FOR BOOTL
 52)   00B0 00 00       		 @LINESTR DEFS 2       ;ADDRESS OF LINEBUF FOR PRINTING ON STRING	;ADDRESS OF LINEBUF FOR PRINTING ON STRING
 53)   00B2 00          		 @LINEPOS DEFS 1	;
 54)   00B3 00 00 00 00 		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 54)   00B7 00 00 00 00 		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 54)   00BB 00 00 00 00 		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 54)   00BF 00          		 @MYNUM DEFS 13        ;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED	;10CHARS MESSAGE FOR NUMBER AND 3 TERMINATED
 55)   00C0 00 00 00 00 		 @NUMBUF DEFS 7    	;
 55)   00C4 00 00 00    		 @NUMBUF DEFS 7    	;
 56)   00C7 00 00 00 00 		 @B2DINV DEFS 8        ;BINARY NUMBER TO BE CONVERTED	;BINARY NUMBER TO BE CONVERTED
 56)   00CB 00 00 00 00 		 @B2DINV DEFS 8        ;BINARY NUMBER TO BE CONVERTED	;BINARY NUMBER TO BE CONVERTED
 57)   00CF 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 57)   00D3 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 57)   00D7 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 57)   00DB 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 57)   00DF 00 00 00 00 		 @B2DBUF DEFS 20       ;ASCCI STRING OF THE NUMBER	;ASCCI STRING OF THE NUMBER
 58)   00E3 00          		 @B2DEND DEFS 1        ;0 FOR TERMINATE THE STRING	;0 FOR TERMINATE THE STRING
 59)   00E4 00 00 00 00 		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 59)   00E8 00 00 00 00 		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 59)   00EC 00 00 00 00 		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 59)   00F0 00 00 00 00 		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 59)   00F4 00 00 00 00 		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 59)   00F8 00 00 00 00 		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 59)   00FC 00 00 00    		 @DIRNM DEFS 0FFh-$       ;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY	;USED BY NB TO KEEP TRACK OF CURRENT DIRECTORY
 84)   8000 2F          		 CPL         ;ROM IS HERE	;ROM IS HERE
 85)   8001 C3 17 81    		 JP START	;
 86)   8004 C3 59 80    		 JP GETKEY        ;CALL HERE FROM NB ROM TO FIND THE GTNBKEY  $8004	;CALL HERE FROM NB ROM TO FIND THE GTNBKEY  $8004
 87)   8007 C3 7B 80    		 JP RSTX        ; CALL HERE FROM NB TO FIND SERIAL TRASMIT  $8007	; CALL HERE FROM NB TO FIND SERIAL TRASMIT  $8007
 88)   800A C3 7F 80    		 JP RSRX        ; CALL HERE FROM NB TO FIND SERIAL RECEIVE  $800A	; CALL HERE FROM NB TO FIND SERIAL RECEIVE  $800A
 89)   800D C3 83 80    		 JP NBSTLCD        ;CALL HERE FROM NB TO FIND THE NBSETLCD $800D	;CALL HERE FROM NB TO FIND THE NBSETLCD $800D
 90)   8010 C3 D3 81    		 JP MENU	;
 91)   8013 C3 4F 80    		 JP CHKKEY       ;CALL HERE FROM NB TO FIND THE CHKKEY $8013	;CALL HERE FROM NB TO FIND THE CHKKEY $8013
 93)   8016 CD 0D 8C    		@OS_PRINTCHAR: CALL RS_TX	;
 94)   8019 C9          		 RET	;
 98)   801A 7E          		@OS_PRINTTEXT: LD A, (HL)	;
 99)   801B FE 00       		 CP 0	;
100)   801D C8          		 RET Z	;
101)   801E E5          		 PUSH HL	;
102)   801F CD 16 80    		 CALL OS_PRINTCHAR	;
103)   8022 E1          		 POP HL	;
104)   8023 23          		 INC HL	;
105)   8024 18 F4       		 JR OS_PRINTTEXT	;
108)   8026 E1          		@OS_PRINTMSG: POP HL	;
109)   8027 CD 1A 80    		 CALL OS_PRINTTEXT	;
110)   802A 23          		 INC HL	;
111)   802B E5          		 PUSH HL        ;CONTINUE AFTER THE MESG	;CONTINUE AFTER THE MESG
112)   802C C9          		 RET	;
118)   802D DF 3C       		@OS_PRCHSCR: DEFW WPTCHAR	;
119)   802F C9          		 RET	;
123)   8030 7E          		@OS_PRMESSCR:  LD A,(HL)	;
124)   8031 B7          		 OR A	;
125)   8032 C8          		 RET Z	;
126)   8033 DF 3C       		 DEFW WPTCHAR	;
127)   8035 23          		 INC HL	;
128)   8036 18 F8       		 JR OS_PRMESSCR	;
130)   8038 7E          		@OS_PRMESSCRSFE: LD A,(HL)	;
131)   8039 B7          		 OR A	;
132)   803A C8          		 RET Z	;
133)   803B FE 0A       		 CP $0A	;
134)   803D 28 04       		 JR Z,PMS_PRN	;
135)   803F FE 1F       		 CP 31 	;
136)   8041 38 04       		 JR C,PMS_SKP	;
137)   8043 DF 3C       		PMS_PRN: DEFW WPTCHAR	;
138)   8045 18 05       		 JR PMS_CNT	;
139)   8047 E5          		PMS_SKP:       PUSH HL	;
140)   8048 CD B6 80    		 CALL SOUTAS	;
141)   804B E1          		 POP HL	;
142)   804C 23          		PMS_CNT: INC HL	;
143)   804D 18 E9       		 JR OS_PRMESSCRSFE	;
145)   804F 47          		CHKKEY: LD B,A	;
146)   8050 CD 74 8C    		 CALL RS_KEYRD  	;
147)   8053 78          		 LD A,B	;
148)   8054 16 A0       		 LD D,$A0        ;DISPCOM 	;DISPCOM
149)   8056 CB B6       		 RES 6,(HL)       ;KDATA= BIT 6 	;KDATA= BIT 6
150)   8058 C9          		 RET	;
157)   8059 E5          		KEYAVAIL: PUSH HL	;
158)   805A D5          		 PUSH DE	;
159)   805B C5          		 PUSH BC	;
160)   805C CD 44 8C    		 CALL RS_RX        ;GET A CHAR FROM RS232 OR PS2_KEYB	;GET A CHAR FROM RS232 OR PS2_KEYB
161)   805F FE FE       		 CP 254        ;BREAK KEY	;BREAK KEY
162)   8061 20 09       		 JR NZ,RGT	;
168)   8063 21 3C 00    		 LD HL,COPST	;
169)   8066 36 66       		 LD (HL),102  ;SIMULATE BREAK	;SIMULATE BREAK
170)   8068 3E 19       		 LD A,$19 	;
171)   806A 18 03       		 JR KAEXIT	;
172)   806C CD 86 87    		RGT: CALL GTNBKEY        ;KEY PRESSED	;KEY PRESSED
181)   806F C1          		KAEXIT: POP BC	;
182)   8070 D1          		 POP DE	;
183)   8071 E1          		 POP HL  	;
184)   8072 FE 00       		 CP 0         ;CHECK IF INVALID KEY	;CHECK IF INVALID KEY
185)   8074 C0          		 RET NZ	;
186)   8075 CB B6       		 RES KDATA (HL)        ; KEY INVALID RESET KDATA TEST BIT	; KEY INVALID RESET KDATA TEST BIT
187)   8077 23          		 INC HL         ;GET TO THE LAST VALID KEY	;GET TO THE LAST VALID KEY
188)   8078 7E          		 LD A, (HL)	;
189)   8079 2B          		 DEC HL	;
190)   807A C9          		 RET	;
192)   807B CD 0D 8C    		RSTX: CALL RS_TX	;
193)   807E C9          		 RET	;
195)   807F CD 44 8C    		RSRX: CALL RS_RX	;
196)   8082 C9          		 RET	;
202)   8083 D5          		NBSTLCD: PUSH DE	;
203)   8084 42          		 LD B, D        ;TOTAL CHARS	;TOTAL CHARS
204)   8085 05          		 DEC B	;
205)   8086 05          		 DEC B         ;SKIP 2	;SKIP 2
206)   8087 11 11 00    		 LD DE, 17        ;START FROM THE END	;START FROM THE END
207)   808A 19          		 ADD HL, DE	;
208)   808B AF          		 XOR A	;
209)   808C 11 7E 00    		 LD DE, LCDCX        ;LCD POSITION	;LCD POSITION
210)   808F 12          		 LD (DE), A	;
211)   8090 13          		 INC DE	;
212)   8091 12          		 LD (DE), A	;
214)   8092 D5          		 PUSH DE	;
215)   8093 57          		 LD D, A	;
216)   8094 5F          		 LD E, A	;
217)   8095 CD 38 95    		 CALL LCD16_SETCURS       ;SET LCD TO LCDCX,LCDCY	;SET LCD TO LCDCX,LCDCY
218)   8098 D1          		 POP DE	;
219)   8099 1B          		 DEC DE         ;POSITION ON LCDCX	;POSITION ON LCDCX
220)   809A 0E 00       		 LD C, 0        ;LCD POSITION COUNT	;LCD POSITION COUNT
221)   809C 7E          		NBSETLP: LD A, (HL)	;
222)   809D CB 7F       		 BIT 7, A        ;CHECK IF CURSOR HERE	;CHECK IF CURSOR HERE
223)   809F 28 06       		 JR Z, NBNXT	;
224)   80A1 F5          		 PUSH AF	;
225)   80A2 79          		 LD A, C	;
226)   80A3 12          		 LD (DE), A        ;POSITION CURSOR	;POSITION CURSOR
227)   80A4 F1          		 POP AF	;
228)   80A5 CB BF       		 RES 7, A        ;CLEAR CHAR FROM CURSOR INFO	;CLEAR CHAR FROM CURSOR INFO
229)   80A7 CD 27 95    		NBNXT: CALL LCD16_PRCHR       ;OUTPUT CHAR TO LCD	;OUTPUT CHAR TO LCD
230)   80AA 2B          		 DEC HL	;
231)   80AB 0C          		 INC C	;
232)   80AC 10 EE       		 DJNZ NBSETLP        ;LOOP NEXT CHAR	;LOOP NEXT CHAR
233)   80AE 16 00       		 LD D, 0	;
234)   80B0 59          		 LD E, C	;
235)   80B1 CD 38 95    		 CALL LCD16_SETCURS       ;POSITION CURSOR	;POSITION CURSOR
236)   80B4 D1          		 POP DE	;
237)   80B5 C9          		 RET	;
241)   80B6 F5          		SOUTAS: PUSH AF        ;SERIAL PRINT ASCII IN DECIMAL	;SERIAL PRINT ASCII IN DECIMAL
242)   80B7 26 00       		 LD H, 0	;
243)   80B9 6F          		 LD L, A	;
244)   80BA 11 B3 00    		 LD DE, MYNUM	;
245)   80BD CD DC 95    		 CALL OUTASC	;
247)   80C0 3E 0A       		 LD A, 10	;
248)   80C2 12          		 LD (DE), A	;
249)   80C3 13          		 INC DE	;
250)   80C4 3E 0D       		 LD A, 13	;
251)   80C6 12          		 LD (DE), A	;
252)   80C7 13          		 INC DE	;
253)   80C8 AF          		 XOR A	;
254)   80C9 12          		 LD (DE), A	;
256)   80CA 21 B3 00    		 LD HL, MYNUM	;
257)   80CD CD 1C 8C    		 CALL RS_TXT	;
258)   80D0 F1          		 POP AF	;
259)   80D1 C9          		 RET	;
262)   80D2 5C 43 48 53 		FONTNAME1 DEFM "\CHSET4.CHR"	;
262)   80D6 45 54 34 2E 		FONTNAME1 DEFM "\CHSET4.CHR"	;
262)   80DA 43 48 52    		FONTNAME1 DEFM "\CHSET4.CHR"	;
263)   80DD 00          		 DB 0	;
264)   80DE 5C 43 48 53 		FONTNAME2 DEFM "\CHSET2.CHR"	;
264)   80E2 45 54 32 2E 		FONTNAME2 DEFM "\CHSET2.CHR"	;
264)   80E6 43 48 52    		FONTNAME2 DEFM "\CHSET2.CHR"	;
265)   80E9 00          		 DB 0	;
267)   80EA 06 02       		LOADFONTS: LD B,2  ;BANK2	;BANK2
268)   80EC 3E 08       		 LD A,8   ;VIDEO PAGE FOR FONTS   	;VIDEO PAGE FOR FONTS
269)   80EE CD C9 8B    		 CALL PUTPGINBANK  	;
270)   80F1 21 D2 80    		 LD HL,FONTNAME1	;
271)   80F4 01 B8 0B    		 LD BC,3000  ;MAX FILE SIZE	;MAX FILE SIZE
272)   80F7 11 00 40    		 LD DE,$4000  ;0000 ON PAGE 8	;0000 ON PAGE 8
273)   80FA CD A4 8F    		 CALL STRG_LOADFILE	;
274)   80FD 30 01       		 JR NC, LFFILOK	;
275)   80FF 76          		 HALT   ;STOP EXEC	;STOP EXEC
276)   8100 21 DE 80    		LFFILOK: LD HL,FONTNAME2	;
277)   8103 01 B8 0B    		 LD BC,3000  ;MAX FILE SIZE	;MAX FILE SIZE
278)   8106 11 00 50    		 LD DE,$5000  ;1000h ON PAGE 8	;1000h ON PAGE 8
279)   8109 CD A4 8F    		 CALL STRG_LOADFILE  	;
280)   810C 30 01       		 JR NC, LFFILOK2	;
281)   810E 76          		 HALT   ;STOP EXEC	;STOP EXEC
282)   810F 3E 0E       		LFFILOK2: LD A,14  ;BANK 2 ON NBRAIN RESTORE PAGE 14	;BANK 2 ON NBRAIN RESTORE PAGE 14
283)   8111 06 02       		 LD B,2	;
284)   8113 CD C9 8B    		 CALL PUTPGINBANK	;
285)   8116 C9          		 RET 	;
288)   8117 F3          		START: DI	;
289)   8118 3A 00 00    		 LD A, (0000)	;
290)   811B FE F3       		 CP $F3	;
292)   811D C2 2C 81    		 JP NZ, CN1	;
293)   8120 CD 36 89    		 CALL STNEWD        ;SET NEWDRIVERS AND DEFSTORE DEVICE	;SET NEWDRIVERS AND DEFSTORE DEVICE
294)   8123 21 91 85    		 LD HL, STRBT	;
295)   8126 CD 1C 8C    		 CALL RS_TXT        ;OUTPUT MENU COMMANDS AT RS232	;OUTPUT MENU COMMANDS AT RS232
296)   8129 C3 BE 81    		 JP ALLOK	;
301)   812C 06 05       		CN1: LD B, 5	;
302)   812E 0E 63       		AGN1: LD C, 99	;
303)   8130 3E 00       		 LD A, 0	;
304)   8132 ED 79       		 OUT (C), A	;
305)   8134 0E 63       		 LD C, 99	;
306)   8136 3E FF       		 LD A, 255	;
307)   8138 ED 79       		 OUT (C), A	;
308)   813A 10 F2       		 DJNZ AGN1	;
313)   813C 11 01 00    		 LD DE, 1	;
314)   813F 3E 00       		 LD A, 0        ;WRITE 0	;WRITE 0
315)   8141 4F          		 LD C, A	;
316)   8142 21 00 60    		 LD HL, RAMAD	;
317)   8145 06 08       		 LD B, 8	;
318)   8147 77          		AGN2: LD (HL), A	;
319)   8148 4E          		 LD C, (HL)	;
320)   8149 B9          		 CP C	;
321)   814A C2 64 81    		 JP NZ, ERR	;
322)   814D 19          		 ADD HL, DE	;
323)   814E C6 20       		 ADD A, 32        ;WRITE +32	;WRITE +32
324)   8150 4F          		 LD C, A	;
325)   8151 10 F4       		 DJNZ AGN2	;
327)   8153 06 05       		 LD B, 5	;
328)   8155 0E 62       		AGN3: LD C, 98	;
329)   8157 3E 40       		 LD A, 64	;
330)   8159 ED 79       		 OUT (C), A	;
331)   815B C6 80       		 ADD A, 128	;
332)   815D ED 79       		 OUT (C), A	;
333)   815F 10 F4       		 DJNZ AGN3        ; SIGNAL ALL OK CONTINUOUS 10 TIMES ON PORT 98	; SIGNAL ALL OK CONTINUOUS 10 TIMES ON PORT 98
334)   8161 C3 9B 81    		 JP BOOT	;
337)   8164 0E 61       		ERR: LD C, 97	;
338)   8166 3E 40       		 LD A, 64	;
339)   8168 ED 79       		 OUT (C), A	;
341)   816A C3 64 81    		 JP ERR         ;DO AGAIN PORT 1	;DO AGAIN PORT 1
343)   816D 15 02 00 18 		SCRDATA DB        $15,$02,$00,$18,$18,$28,$40,$20	;
343)   8171 18 28 40 20 		SCRDATA DB        $15,$02,$00,$18,$18,$28,$40,$20	;
344)   8175 00 02 00 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
344)   8179 00 00 0A 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
344)   817D 00 00 FF 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
344)   8181 AB 00 00 00 		 DB $00,$02,$00,$00,$00,$00,$0A,$00,$00,$00,$FF,$00,$AB,$00,$00,$00	;
345)   8185 00 B1       		 DB $00,$B1	;
347)   8187 21 6D 81    		SETSCRDATA: LD HL,SCRDATA	;
348)   818A 11 68 02    		 LD DE,$268	;
349)   818D 01 1A 00    		 LD BC,26	;
350)   8190 ED B0       		 LDIR	;
351)   8192 21 5C 00    		 LD HL,$5C	;
352)   8195 36 68       		 LD (HL),$68  ;VIDEO START	;VIDEO START
353)   8197 23          		 INC HL	;
354)   8198 36 02       		 LD (HL),$02	;
355)   819A C9          		 RET	;
357)   819B ED 56       		BOOT: IM 1	;
358)   819D F3          		 DI	;
361)   819E 31 64 60    		 LD SP, STACKP	;
368)   81A1 CD 4D 93    		 CALL I2C_INIT	;
369)   81A4 CD 93 94    		 CALL LCD16_INIT       ;LCD 16x2 Initialized	;LCD 16x2 Initialized
370)   81A7 21 E3 84    		 LD HL, STR0	;
371)   81AA CD 1D 95    		 CALL LCD16_PRINT	;
375)   81AD 3E 01       		 LD A, 1        ;1=115200 BPS	;1=115200 BPS
376)   81AF CD F4 8B    		 CALL RS_INI        ;RS232 INITIALIZE	;RS232 INITIALIZE
377)   81B2 21 B9 85    		 LD HL, STR00	;
378)   81B5 CD 1C 8C    		 CALL RS_TXT	;
381)   81B8 21 A6 85    		 LD HL, STRSCR	;
382)   81BB CD 1C 8C    		 CALL RS_TXT	;
392)   81BE CD 87 81    		ALLOK: CALL SETSCRDATA	;
393)   81C1 CD 0A 86    		 CALL SCCLS        ;CLEAR SCREEN BUFFER	;CLEAR SCREEN BUFFER
395)   81C4 21 0D 85    		 LD HL, STR02	;
396)   81C7 CD 4A 86    		 CALL SCPRN        ;PRINT WAITING AT SCREEN BUFFER	;PRINT WAITING AT SCREEN BUFFER
398)   81CA CD EA 80    		 CALL LOADFONTS       ;LOAD NEWBRAIN FONTS TO VIDEO RAM	;LOAD NEWBRAIN FONTS TO VIDEO RAM
399)   81CD CD 6A 83    		 CALL TVON	;
401)   81D0 CD 38 82    		 CALL PATCHCMDS       ;PATCH CD ROM TO IMPLEMENT OUR OWN COMMANDS	;PATCH CD ROM TO IMPLEMENT OUR OWN COMMANDS
404)   81D3 21 61 85    		 LD HL, STRMN	;
405)   81D6 CD 1C 8C    		 CALL RS_TXT        ;OUTPUT MENU COMMANDS AT RS232	;OUTPUT MENU COMMANDS AT RS232
406)   81D9 21 CF 85    		 LD HL, STR01	;
407)   81DC CD 1C 8C    		 CALL RS_TXT        ;OUTPUT WAITING AT RS232	;OUTPUT WAITING AT RS232
409)   81DF CD 86 83    		 CALL TVOFTM	;
410)   81E2 CD 14 95    		 CALL LCD16_CLR	;
412)   81E5 21 0D 85    		 LD HL, STR02	;
413)   81E8 CD 1D 95    		 CALL LCD16_PRINT	;
414)   81EB CD 8A 83    		 CALL RESTV	;
416)   81EE 21 B5 84    		 LD HL, SMENU	;
417)   81F1 3E 02       		 LD A, 2	;
418)   81F3 CD 4A 86    		 CALL SCPRN	;
420)   81F6 CD 0D 83    		 CALL GET_CHAR        ;TAKE A CHAR FROM RS232 OR PS2 KEYB	;TAKE A CHAR FROM RS232 OR PS2 KEYB
423)   81F9 FE 55       		 CP 'U'         ;UPLOAD PROGRAM	;UPLOAD PROGRAM
424)   81FB CC B4 83    		 CALL Z, UPLOD	;
425)   81FE FE 58       		 CP 'X'	;
426)   8200 CA 97 83    		 JP Z, EXEC	;
427)   8203 FE 54       		 CP 'T'	;
428)   8205 CC 6B 84    		 CALL Z, RSTST	;
429)   8208 FE 53       		 CP 'S'	;
430)   820A CC 9D 84    		 CALL Z, TXTSCR	;
431)   820D FE 4E       		 CP 'N'	;
432)   820F CA 03 E0    		 JP Z, $E003	;
433)   8212 FE 4D       		 CP 'M'	;
434)   8214 CA 38 83    		 JP Z, GONB        ;$E090	;$E090
435)   8217 FE 43       		 CP 'C'	;
436)   8219 CC 6A 83    		 CALL Z, TVON	;
437)   821C FE 56       		 CP 'V'	;
438)   821E CC 78 83    		 CALL Z, TVOFF	;
439)   8221 FE 49       		 CP 'I'	;
440)   8223 CC 03 84    		 CALL Z, UPLOD2	;
441)   8226 FE 59       		 CP 'Y'	;
442)   8228 CC 81 84    		 CALL Z, RSTST2	;
443)   822B FE 48       		 CP 'H'	;
444)   822D CC 90 84    		 CALL Z, XMTST	;
445)   8230 FE 4A       		 CP 'J'	;
446)   8232 CC 35 84    		 CALL Z, DNLOD	;
448)   8235 C3 D3 81    		 JP MENU	;
451)   8238 3E 03       		PATCHCMDS: LD A,11b ;DISABLE INTS & DISABLE NB=RAM WRITABLE	;DISABLE INTS & DISABLE NB=RAM WRITABLE
452)   823A D3 E0       		 OUT (INTENB),A	;
453)   823C 21 F9 A2    		 LD HL,$A2F9	;
454)   823F 36 CD       		 LD (HL),$CD ;CALL	;CALL
455)   8241 11 78 82    		 LD DE,CHKNEWCMD	;
456)   8244 23          		 INC HL	;
457)   8245 73          		 LD (HL),E	;
458)   8246 23          		 INC HL	;
459)   8247 72          		 LD (HL),D	;
460)   8248 21 85 A4    		 LD HL,$A485  ;PXCL3	;PXCL3
461)   824B 36 C3       		 LD (HL),$C3 ;JP	;JP
462)   824D 11 5C 82    		 LD DE,OSXCL3	;
463)   8250 23          		 INC HL	;
464)   8251 73          		 LD (HL),E	;
465)   8252 23          		 INC HL	;
466)   8253 72          		 LD (HL),D	;
467)   8254 3E 01       		 LD A,01b  ;DISABLE INTS & ENABLE NB=RAM NON WRITABLE	;DISABLE INTS & ENABLE NB=RAM NON WRITABLE
468)   8256 D3 E0       		 OUT (INTENB),A  	;
469)   8258 C9          		 RET	;
471)   8259 01          		 TOS DEFB 1	;
472)   825A 4F          		 DEFM 'O'	;
473)   825B D3          		 DEFB 'S'+80H	;
490)   825C 01 14 DD    		OSXCL3: LD BC,XTABLE	;
491)   825F FA 35 C3    		 JP M,ENTER	;
492)   8262 01 00 DE    		 LD BC,XTABL2	;
493)   8265 FE 56       		 CP LPCODE	;
494)   8267 DA 35 C3    		 JP C,ENTER       ;IF <$56 GOTO TAB2 	;IF <$56 GOTO TAB2
495)   826A 01 43 A4    		 LD BC,XTABL3	;
496)   826D FE 62       		 CP OSCODE	;
497)   826F DA 35 C3    		 JP C,ENTER ;IF <$62 GOTO TAB3	;IF <$62 GOTO TAB3
498)   8272 01 43 82    		 LD BC,XTABL4 ;ELSE  OUR TAB4	;ELSE  OUR TAB4
499)   8275 C3 35 C3    		 JP ENTER	;
502)   8278 DD E5       		 PUSH IX	;
503)   827A FD E5       		 PUSH IY	;
504)   827C D5          		 PUSH DE	;
505)   827D 21 59 82    		 LD HL,TOS	;
506)   8280 CD D4 A2    		 CALL PSCAN	;
507)   8283 D4 8F 82    		 CALL NC, COSCMD	;
508)   8286 D1          		 POP DE	;
509)   8287 FD E1       		 POP IY	;
510)   8289 DD E1       		 POP IX	;
512)   828B 21 5A A3    		 LD HL,TPLOT	;
513)   828E C9          		 RET	;
516)   828F 21 AF 82    		COSCMD: LD HL,OSLST	;
517)   8292 CD D4 A2    		 CALL PSCAN ;check for any of the OS COMMAND-list	;check for any of the OS COMMAND-list
518)   8295 D8          		 RET C	;
519)   8296 61          		 LD H,C  ;THE OS LIST COMMAND ID ON C	;THE OS LIST COMMAND ID ON C
520)   8297 2E B1       		 LD L,YOSCMD ;THE OS COMMAND	;THE OS COMMAND
521)   8299 D7 01       		 DEFW ZCM2HL	;
522)   829B 05          		 DEC B  ;CHECK FOR ARGS	;CHECK FOR ARGS
523)   829C C8          		 RET Z	;
527)   829D DF 18       		 DEFW WEXPN	;
528)   829F D8          		 RET C	;
536)   82A0 C9          		 RET	;
539)   82A1 B9 82       		OSCMDTBL: DEFW CMD_DIR	;
540)   82A3 C9 82       		 DEFW CMD_CD	;
559)   82A5 A7 82       		       DEFW XOSCMD	;
562)   82A7 7E          		XOSCMD: LD A,(HL) ;GET SUB COMMAND 0=DIR 1=CD	;GET SUB COMMAND 0=DIR 1=CD
563)   82A8 B7          		 OR A	;
564)   82A9 28 0E       		 JR Z,CMD_DIR	;
565)   82AB 3D          		 DEC A	;
566)   82AC 28 1B       		 JR Z,CMD_CD	;
568)   82AE C9          		 RET	;
570)   82AF 02          		OSLST: DEFB 2	;
572)   82B0 44 49       		 DEFM 'DI' 	;
573)   82B2 D2 00 01    		 DEFB 'R'+80H,CDIR,1 ;+1 OF ARGS	;+1 OF ARGS
575)   82B5 43          		 DEFM 'C' 	;
576)   82B6 C4 01 02    		 DEFB 'D'+80H,CCD,2	;
580)   82B9 D7 39       		CMD_DIR: DEFW ZPTMSG ;	;
581)   82BB 09          		 DEFB 9	;
582)   82BC 44 49 52 20 		 DEFM "DIR INFO"	;
582)   82C0 49 4E 46 4F 		 DEFM "DIR INFO"	;
583)   82C4 0D          		 DEFB $0D	;
584)   82C5 CD 19 8D    		 CALL STRG_DIRLIST  ;PRINT DIR	;PRINT DIR
585)   82C8 C9          		 RET	;
587)   82C9 CD 36 DC    		 CALL GUSTP   ;SETS HL FROM IX+11,12 USRTOP	;SETS HL FROM IX+11,12 USRTOP
588)   82CC CD C4 8D    		 CALL STRG_DIRCHG	;
589)   82CF 38 14       		 JR C, CD_ERR	;
590)   82D1 3E 96       		 LD A,150   ;ERROR MISSING FILE	;ERROR MISSING FILE
591)   82D3 28 10       		 JR Z,CD_ERR	;
593)   82D5 E5          		 PUSH HL	;
594)   82D6 D7 39       		 DEFW ZPTMSG ;	;
595)   82D8 06          		 DEFB 6	;
596)   82D9 44 49 52 20 		 DEFM "DIR OK"	;
596)   82DD 4F 4B       		 DEFM "DIR OK"	;
597)   82DF E1          		 POP HL	;
598)   82E0 CD 6A 8D    		 CALL STRG_DIRNMCHG	;
599)   82E3 18 0F       		 JR CD_CONT	;
601)   82E5 E5          		 PUSH HL	;
602)   82E6 F5          		 PUSH AF  	;
603)   82E7 D7 39       		 DEFW ZPTMSG ;	;
604)   82E9 05          		 DEFB 5	;
605)   82EA 45 52 52 5F 		 DEFM "ERR_R"	;
605)   82EE 52          		 DEFM "ERR_R"	;
606)   82EF F1          		 POP AF  	;
607)   82F0 CD B6 80    		 CALL SOUTAS  	;
608)   82F3 E1          		 POP HL	;
611)   82F4 F5          		CD_CONT: PUSH AF   ;SAVE FLAGS  	;SAVE FLAGS
613)   82F5 54          		 LD D,H	;
614)   82F6 5D          		 LD E,L	;
615)   82F7 1A          		CD_AGN: LD A,(DE)	;
616)   82F8 FE 00       		 CP 0	;
617)   82FA 3E 00       		 LD A,0	;
618)   82FC 12          		 LD (DE),A    ;ZERO THIS	;ZERO THIS
619)   82FD 13          		 INC DE	;
620)   82FE 20 F7       		 JR NZ,CD_AGN	;
621)   8300 06 04       		 LD B,4	;
622)   8302 12          		CD_AGN2: LD (DE),A	;
623)   8303 13          		 INC DE	;
624)   8304 10 FC       		 DJNZ CD_AGN2:	;
625)   8306 EB          		 EX DE,HL	;
626)   8307 CD 8C C5    		 CALL LDUSTP	;
630)   830A F1          		 POP AF  ;REST FLAGS  	;REST FLAGS
631)   830B AF          		 XOR A	;
632)   830C C9          		 RET	;
643)   830D AF          		GET_CHAR: XOR A	;
646)   830E CD 74 8C    		 CALL RS_KEYRD        ;CHAR IN RS232?	;CHAR IN RS232?
648)   8311 CA 0D 83    		 JP Z, GET_CHAR	;
649)   8314 CD 44 8C    		 CALL RS_RX        ; GET THAT CHAR	; GET THAT CHAR
650)   8317 C9          		 RET	;
660)   8318 F5          		 PUSH AF	;
661)   8319 CD 0D 8C    		 CALL RS_TX	;
662)   831C 3E 0A       		 LD A, 10	;
663)   831E CD 0D 8C    		 CALL RS_TX	;
664)   8321 3E 0D       		 LD A, 13	;
665)   8323 CD 0D 8C    		 CALL RS_TX	;
666)   8326 F1          		 POP AF	;
667)   8327 C9          		 RET	;
669)   8328 16 00       		LCDLN1: LD D, 0	;
670)   832A 1E 00       		 LD E, 0	;
671)   832C CD 38 95    		 CALL LCD16_SETCURS	;
672)   832F C9          		 RET	;
674)   8330 16 00       		LCDLN2: LD D, 0	;
675)   8332 1E 00       		 LD E, 0	;
676)   8334 CD 38 95    		 CALL LCD16_SETCURS	;
677)   8337 C9          		 RET	;
680)   8338 21 E4 00    		 LD HL,DIRNM	;
681)   833B 3E 2F       		 LD A,'/'	;
682)   833D 77          		 LD (HL),A	;
683)   833E 23          		 INC HL	;
684)   833F 36 00       		 LD (HL),0	;
685)   8341 23          		 INC HL	;
686)   8342 36 00       		 LD (HL),0	;
687)   8344 CD 30 83    		 CALL LCDLN2	;
688)   8347 21 59 83    		 LD HL, DSPMES	;
689)   834A CD 1D 95    		 CALL LCD16_PRINT	;
690)   834D CD 47 95    		 CALL LCD16_CURSOFF       ;CURSOR OFF	;CURSOR OFF
691)   8350 CD 71 95    		 CALL LCD16_BLINKON       ;BLINK ON	;BLINK ON
692)   8353 AF          		 XOR A	;
693)   8354 D3 E0       		 OUT (INTENB),A       ;ENABLE INTERRUPTS ON NB	;ENABLE INTERRUPTS ON NB
694)   8356 C3 15 A0    		 JP $A015	;
696)   8359 3C 3C 20 43 		DSPMES: DEFM "<< CDESP 2022 >>"	;
696)   835D 44 45 53 50 		DSPMES: DEFM "<< CDESP 2022 >>"	;
696)   8361 20 32 30 32 		DSPMES: DEFM "<< CDESP 2022 >>"	;
696)   8365 32 20 3E 3E 		DSPMES: DEFM "<< CDESP 2022 >>"	;
697)   8369 00          		 DB 0	;
699)   836A E5          		TVON: PUSH HL	;
700)   836B 21 AF 00    		 LD HL, TVSTAT	;
701)   836E CB D6       		 SET 2, (HL)	;
702)   8370 21 24 00    		 LD HL, 36	;
703)   8373 CB D6       		 SET 2, (HL)	;
704)   8375 E1          		 POP HL	;
705)   8376 18 12       		 JR RESTV	;
708)   8378 E5          		TVOFF: PUSH HL	;
709)   8379 21 AF 00    		 LD HL, TVSTAT	;
710)   837C CB 96       		 RES 2, (HL)	;
711)   837E 21 24 00    		 LD HL, 36	;
712)   8381 CB 96       		 RES 2, (HL)	;
713)   8383 E1          		 POP HL	;
714)   8384 18 04       		 JR RESTV	;
717)   8386 AF          		TVOFTM: XOR A         ;TV OFF	;TV OFF
718)   8387 D3 07       		 OUT (7), A	;
719)   8389 C9          		 RET	;
721)   838A E5          		RESTV: PUSH HL	;
722)   838B 21 AF 00    		 LD HL, TVSTAT	;
723)   838E 7E          		 LD A, (HL)	;
724)   838F D3 07       		 OUT (7), A	;
725)   8391 3E 05       		 LD A, 5	;
726)   8393 D3 09       		 OUT (9), A        ; SET DISPLAY ADDRESS	; SET DISPLAY ADDRESS
727)   8395 E1          		 POP HL	;
728)   8396 C9          		 RET	;
730)   8397 CD 14 95    		EXEC: CALL LCD16_CLR	;
731)   839A CD 30 83    		 CALL LCDLN2	;
732)   839D 21 34 85    		 LD HL, SPRGX	;
733)   83A0 CD 1D 95    		 CALL LCD16_PRINT	;
734)   83A3 CD 28 83    		 CALL LCDLN1	;
736)   83A6 3E 05       		 LD A, 5	;
737)   83A8 CD 4A 86    		 CALL SCPRN	;
739)   83AB 11 AD 00    		 LD DE, PRGEX	;
740)   83AE 1A          		 LD A, (DE)	;
741)   83AF 6F          		 LD L, A	;
742)   83B0 13          		 INC DE	;
743)   83B1 1A          		 LD A, (DE)	;
744)   83B2 67          		 LD H, A	;
745)   83B3 E9          		 JP (HL)	;
747)   83B4 CD 86 83    		UPLOD: CALL TVOFTM	;
748)   83B7 21 27 85    		 LD HL, DATST	;
749)   83BA CD 30 83    		 CALL LCDLN2	;
750)   83BD CD 1D 95    		 CALL LCD16_PRINT	;
752)   83C0 CD 44 8C    		 CALL RS_RX        ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
753)   83C3 6F          		 LD L, A	;
754)   83C4 CD 44 8C    		 CALL RS_RX	;
755)   83C7 67          		 LD H, A	;
756)   83C8 CD 44 8C    		 CALL RS_RX        ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
757)   83CB 4F          		 LD C, A	;
758)   83CC CD 44 8C    		 CALL RS_RX	;
759)   83CF 47          		 LD B, A	;
761)   83D0 11 AD 00    		 LD DE, PRGEX        ;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
762)   83D3 7D          		 LD A, L	;
763)   83D4 12          		 LD (DE), A	;
764)   83D5 13          		 INC DE	;
765)   83D6 7C          		 LD A, H	;
766)   83D7 12          		 LD (DE), A	;
768)   83D8 FE 80       		 CP $80	;
769)   83DA 28 02       		 JR Z, ROMWR	;
770)   83DC 38 02       		 JR C, NORWR	;
772)   83DE D3 7C       		 ROMWR OUT (124), A       ;SET ROM WRITABLE = '0'	;SET ROM WRITABLE = '0'
777)   83E0 E5          		NORWR: PUSH HL	;
778)   83E1 CD 44 8C    		NXB: CALL RS_RX	;
779)   83E4 77          		 LD (HL), A	;
780)   83E5 23          		 INC HL	;
781)   83E6 0B          		 DEC BC	;
782)   83E7 78          		 LD A, B	;
783)   83E8 B1          		 OR C	;
784)   83E9 20 F6       		 JR NZ, NXB        ;LOOP ALL BYTES	;LOOP ALL BYTES
786)   83EB D3 7D       		 OUT (125), A        ;SET ROM NON WRITABLE ='1'	;SET ROM NON WRITABLE ='1'
788)   83ED 21 18 85    		 LD HL, DATTR	;
789)   83F0 CD 14 95    		 CALL LCD16_CLR	;
790)   83F3 CD 1D 95    		 CALL LCD16_PRINT	;
791)   83F6 3E 05       		 LD A, 5	;
792)   83F8 CD 4A 86    		 CALL SCPRN	;
793)   83FB CD B5 95    		 CALL DELAY	;
795)   83FE E1          		 POP HL	;
798)   83FF CD 8A 83    		 CALL RESTV	;
800)   8402 C9          		 RET	;
804)   8403 CD 86 83    		UPLOD2: CALL TVOFTM	;
805)   8406 21 27 85    		 LD HL, DATST	;
806)   8409 CD 30 83    		 CALL LCDLN2	;
807)   840C CD 1D 95    		 CALL LCD16_PRINT	;
809)   840F CD 44 8C    		 CALL RS_RX        ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
810)   8412 6F          		 LD L, A	;
811)   8413 CD 44 8C    		 CALL RS_RX	;
812)   8416 67          		 LD H, A	;
813)   8417 CD 44 8C    		 CALL RS_RX        ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
814)   841A 4F          		 LD C, A	;
815)   841B CD 44 8C    		 CALL RS_RX	;
816)   841E 47          		 LD B, A	;
818)   841F 11 AD 00    		 LD DE, PRGEX        ;SAVE TO PRGEX THE PROG EXEC ADDR=HL	;SAVE TO PRGEX THE PROG EXEC ADDR=HL
819)   8422 7D          		 LD A, L	;
820)   8423 12          		 LD (DE), A	;
821)   8424 13          		 INC DE	;
822)   8425 7C          		 LD A, H	;
823)   8426 12          		 LD (DE), A	;
825)   8427 CD 44 8C    		NXB2: CALL RS_RX	;
826)   842A 77          		 LD (HL), A	;
827)   842B 23          		 INC HL	;
828)   842C 0B          		 DEC BC	;
829)   842D 78          		 LD A, B	;
830)   842E B1          		 OR C	;
831)   842F 20 F6       		 JR NZ, NXB2        ;LOOP ALL BYTES	;LOOP ALL BYTES
833)   8431 CD 8A 83    		 CALL RESTV	;
834)   8434 C9          		 RET	;
836)   8435 CD 86 83    		DNLOD: CALL TVOFTM	;
841)   8438 CD 44 8C    		 CALL RS_RX        ;HL HAS RAM ADDRESS	;HL HAS RAM ADDRESS
842)   843B 6F          		 LD L, A	;
843)   843C CD 44 8C    		 CALL RS_RX	;
844)   843F 67          		 LD H, A	;
845)   8440 CD 44 8C    		 CALL RS_RX        ;BC HAS TOTAL DATA TO BE SEND	;BC HAS TOTAL DATA TO BE SEND
846)   8443 4F          		 LD C, A	;
847)   8444 CD 44 8C    		 CALL RS_RX	;
848)   8447 47          		 LD B, A	;
850)   8448 7E          		NXB3: LD A, (HL)	;
851)   8449 CD 0D 8C    		 CALL RS_TX        ;SEND BYTE	;SEND BYTE
852)   844C 23          		 INC HL	;
853)   844D 0B          		 DEC BC	;
854)   844E 78          		 LD A, B	;
855)   844F B1          		 OR C	;
856)   8450 20 F6       		 JR NZ, NXB3        ;LOOP ALL BYTES	;LOOP ALL BYTES
858)   8452 CD 8A 83    		 CALL RESTV	;
860)   8455 C9          		 RET	;
864)   8456 FE 00       		 CP 0	;
865)   8458 28 FC       		 JR Z, PS2AGN	;
866)   845A FE FF       		 CP 255	;
867)   845C 28 F8       		 JR Z, PS2AGN	;
868)   845E FE 01       		 CP 1	;
869)   8460 CA 56 84    		 JP Z, PS2AGN	;
871)   8463 CD 0D 8C    		 CALL RS_TX	;
872)   8466 CD C2 95    		 CALL DEL2	;
874)   8469 18 EB       		 JR PS2AGN	;
877)   846B 00          		RSTST: NOP         ;GET A KEY FROM RS232	;GET A KEY FROM RS232
878)   846C 06 0A       		 LD B, 10	;
879)   846E C5          		TEN: PUSH BC	;
880)   846F CD 44 8C    		 CALL RS_RX	;
882)   8472 CD 0D 8C    		 CALL RS_TX        ;SEND BACK THE CHAR	;SEND BACK THE CHAR
884)   8475 3E 20       		 LD A, ' '	;
886)   8477 3E 52       		 LD A, 'R'	;
889)   8479 CD C2 95    		 CALL DEL2	;
891)   847C C1          		 POP BC	;
892)   847D 10 EF       		 DJNZ TEN	;
894)   847F AF          		 XOR A	;
895)   8480 C9          		 RET	;
897)   8481 00          		RSTST2: NOP         ;TEST RECEIVING AND SENDING 255 BYTES	;TEST RECEIVING AND SENDING 255 BYTES
898)   8482 06 FF       		 LD B, 255	;
899)   8484 C5          		TEN2: PUSH BC	;
900)   8485 CD 44 8C    		 CALL RS_RX	;
902)   8488 CD 0D 8C    		 CALL RS_TX        ;SEND BACK THE CHAR	;SEND BACK THE CHAR
904)   848B C1          		 POP BC	;
905)   848C 10 F6       		 DJNZ TEN2	;
906)   848E AF          		 XOR A	;
907)   848F C9          		 RET	;
910)   8490 00          		XMTST: NOP         ;TEST XMIT ALL 8 BITS	;TEST XMIT ALL 8 BITS
911)   8491 06 FF       		 LD B, 255	;
912)   8493 C5          		TEN3: PUSH BC	;
913)   8494 78          		 LD A, B	;
914)   8495 CD 0D 8C    		 CALL RS_TX        ;SEND  THE BYTE	;SEND  THE BYTE
915)   8498 C1          		 POP BC	;
916)   8499 10 F8       		 DJNZ TEN3	;
917)   849B AF          		 XOR A	;
918)   849C C9          		 RET	;
922)   849D 21 4B 85    		TXTSCR: LD HL, TXTMES        ;SCREEN START	;SCREEN START
923)   84A0 11 82 02    		 LD DE, TXTRAM	;
924)   84A3 01 15 00    		 LD BC, 21	;
925)   84A6 ED B0       		 LDIR	;
927)   84A8 21 4B 85    		 LD HL, TXTMES	;
928)   84AB 11 C2 02    		 LD DE, TXTRAM + 64       ;SCREEN START+64 40chars screen +24 excess	;SCREEN START+64 40chars screen +24 excess
929)   84AE 01 15 00    		 LD BC, 21	;
930)   84B1 ED B0       		 LDIR	;
932)   84B3 AF          		 XOR A	;
933)   84B4 C9          		 RET	;
937)   84B5 55 49 3A 55 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84B9 50 2C 58 3A 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84BD 52 55 4E 2C 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84C1 54 59 48 3A 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84C5 52 53 2C 53 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84C9 3A 44 49 53 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84CD 50 2C 4E 4D 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84D1 3A 4E 42 52 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84D5 4F 4D 2C 43 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84D9 56 3A 54 56 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84DD 2C 4A 3A 44 		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
937)   84E1 4E          		SMENU: DEFM "UI:UP,X:RUN,TYH:RS,S:DISP,NM:NBROM,CV:TV,J:DN"	;
938)   84E2 00          		 DB 0	;
941)   84E3 4C 43 44 20 		STR0: DEFM "LCD INITIALIZED"	;
941)   84E7 49 4E 49 54 		STR0: DEFM "LCD INITIALIZED"	;
941)   84EB 49 41 4C 49 		STR0: DEFM "LCD INITIALIZED"	;
941)   84EF 5A 45 44    		STR0: DEFM "LCD INITIALIZED"	;
942)   84F2 00          		 DB 0	;
944)   84F3 52 53 32 33 		STR1: DEFM "RS232 INIT"	;
944)   84F7 32 20 49 4E 		STR1: DEFM "RS232 INIT"	;
944)   84FB 49 54       		STR1: DEFM "RS232 INIT"	;
945)   84FD 00          		 DB 0	;
947)   84FE 50 52 4F 47 		STR2: DEFM "PROGRAM HALTED"	;
947)   8502 52 41 4D 20 		STR2: DEFM "PROGRAM HALTED"	;
947)   8506 48 41 4C 54 		STR2: DEFM "PROGRAM HALTED"	;
947)   850A 45 44       		STR2: DEFM "PROGRAM HALTED"	;
948)   850C 00          		 DB 0	;
950)   850D 57 41 49 54 		STR02: DEFM "WAITING..."	;
950)   8511 49 4E 47 2E 		STR02: DEFM "WAITING..."	;
950)   8515 2E 2E       		STR02: DEFM "WAITING..."	;
951)   8517 00          		 DB 0	;
953)   8518 50 52 47 20 		DATTR: DEFM "PRG TRANSFERED"	;
953)   851C 54 52 41 4E 		DATTR: DEFM "PRG TRANSFERED"	;
953)   8520 53 46 45 52 		DATTR: DEFM "PRG TRANSFERED"	;
953)   8524 45 44       		DATTR: DEFM "PRG TRANSFERED"	;
954)   8526 00          		 DB 0	;
956)   8527 52 45 43 45 		DATST: DEFM "RECEIVING..."	;
956)   852B 49 56 49 4E 		DATST: DEFM "RECEIVING..."	;
956)   852F 47 2E 2E 2E 		DATST: DEFM "RECEIVING..."	;
957)   8533 00          		 DB 0	;
959)   8534 50 52 47 20 		SPRGX: DEFM "PRG EXECUTE"	;
959)   8538 45 58 45 43 		SPRGX: DEFM "PRG EXECUTE"	;
959)   853C 55 54 45    		SPRGX: DEFM "PRG EXECUTE"	;
960)   853F 00          		 DB 0	;
962)   8540 49 4D 41 47 		STIMG: DEFM "IMAGE COPY"	;
962)   8544 45 20 43 4F 		STIMG: DEFM "IMAGE COPY"	;
962)   8548 50 59       		STIMG: DEFM "IMAGE COPY"	;
963)   854A 00          		 DB 0	;
965)   854B 4E 45 57 42 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
965)   854F 52 41 49 4E 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
965)   8553 20 53 43 52 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
965)   8557 45 45 4E 20 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
965)   855B 52 45 41 44 		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
965)   855F 59          		TXTMES: DEFM "NEWBRAIN SCREEN READY"	;
966)   8560 00          		 DB 0	;
970)   8561 55 3A 55 50 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8565 2C 58 3A 52 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8569 55 4E 2C 54 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   856D 3A 52 53 2C 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8571 53 3A 44 49 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8575 53 50 2C 4E 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8579 3A 4E 42 52 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   857D 4F 4D 2C 43 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8581 3A 54 56 4F 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8585 4E 2C 56 3A 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   8589 54 56 4F 46 		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
970)   858D 46          		STRMN: DEFM "U:UP,X:RUN,T:RS,S:DISP,N:NBROM,C:TVON,V:TVOFF"	;
971)   858E 0A 0D 00    		 DB 10,13,0	;
974)   8591 4E 45 57 42 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
974)   8595 52 41 49 4E 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
974)   8599 20 42 4F 4F 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
974)   859D 54 45 44 20 		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
974)   85A1 4F 4B       		STRBT: DEFM "NEWBRAIN BOOTED OK"	;
975)   85A3 0A 0D 00    		 DB 10,13,0	;
977)   85A6 43 4C 45 41 		STRSCR: DEFM "CLEARING SCREEN."	;
977)   85AA 52 49 4E 47 		STRSCR: DEFM "CLEARING SCREEN."	;
977)   85AE 20 53 43 52 		STRSCR: DEFM "CLEARING SCREEN."	;
977)   85B2 45 45 4E 2E 		STRSCR: DEFM "CLEARING SCREEN."	;
978)   85B6 0A 0D 00    		 DB 10,13,0	;
980)   85B9 0A 0D       		STR00: DB 10,13	;
981)   85BB 52 53 32 33 		 DEFM "RS232 INITIALIZED"	;
981)   85BF 32 20 49 4E 		 DEFM "RS232 INITIALIZED"	;
981)   85C3 49 54 49 41 		 DEFM "RS232 INITIALIZED"	;
981)   85C7 4C 49 5A 45 		 DEFM "RS232 INITIALIZED"	;
981)   85CB 44          		 DEFM "RS232 INITIALIZED"	;
982)   85CC 0A 0D 00    		 DB 10,13,0	;
984)   85CF 0A 0D       		STR01: DB 10,13	;
985)   85D1 57 41 49 54 		 DEFM "WAITING..."	;
985)   85D5 49 4E 47 2E 		 DEFM "WAITING..."	;
985)   85D9 2E 2E       		 DEFM "WAITING..."	;
986)   85DB 0A 0D 00    		 DB 10,13,0	;
987)   85DE 00          		 DB 0	;
989)   85DF 0A 0D       		STR06: DB 10,13	;
990)   85E1 4B 45 59 20 		 DEFM "KEY PRESSED"	;
990)   85E5 50 52 45 53 		 DEFM "KEY PRESSED"	;
990)   85E9 53 45 44    		 DEFM "KEY PRESSED"	;
991)   85EC 0A 0D 00    		 DB 10,13,0	;
992)   85EF 00          		 DB 0	;
996)   85F0 80 00 80 00 		 DB 128,0,128,0,255,255	;
996)   85F4 FF FF       		 DB 128,0,128,0,255,255	;
997)   85F6 00          		IMAGE: DB 0	;
 14)   85F7 E5          		SCCLL: PUSH HL	;
 15)   85F8 F5          		 PUSH AF	;
 16)   85F9 21 69 86    		 LD HL, STCL4        ;40 LINE CLEAR	;40 LINE CLEAR
 17)   85FC CD 4D 86    		 CALL SCPRN1	;
 18)   85FF F1          		 POP AF	;
 19)   8600 E1          		 POP HL	;
 20)   8601 C9          		 RET	;
 23)   8602 AF          		 XOR A         ;LINE 0	;LINE 0
 24)   8603 21 76 87    		 LD HL, SCRDY	;
 25)   8606 CD 4A 86    		 CALL SCPRN	;
 26)   8609 C9          		 RET	;
 30)   860A 06 19       		SCCLS: LD B, 25	;
 31)   860C AF          		 XOR A         ;; PRINT STR0 AT LINE 1	;; PRINT STR0 AT LINE 1
 32)   860D C5          		 TSTLP1 PUSH BC	;
 33)   860E CD F7 85    		 CALL SCCLL	;
 34)   8611 3C          		 INC A         ; NEXT LINE	; NEXT LINE
 35)   8612 C1          		 POP BC	;
 36)   8613 10 F8       		 DJNZ TSTLP1	;
 37)   8615 CD 02 86    		 CALL SCMSG1	;
 38)   8618 C9          		 RET	;
 43)   8619 F5          		 PRNRGA PUSH AF	;
 44)   861A 06 08       		 LD B, 8	;
 45)   861C CB 07       		LPN5: RLC A         ; BIT 7 FIRST	; BIT 7 FIRST
 46)   861E F5          		 PUSH AF	;
 47)   861F 3E 00       		 LD A, 0	;
 48)   8621 30 02       		 JR NC, SKP5	;
 49)   8623 3E 01       		 LD A, 1	;
 50)   8625 C6 30       		 SKP5 ADD A, 48	;
 51)   8627 CD 30 86    		 CALL PRNCL        ; PRINT A AT COL,LINE	; PRINT A AT COL,LINE
 52)   862A 1C          		 INC E	;
 53)   862B F1          		 POP AF	;
 54)   862C 10 EE       		 DJNZ LPN5	;
 55)   862E F1          		 POP AF	;
 56)   862F C9          		 RET	;
 59)   8630 E5          		PRNCL: PUSH HL	;
 60)   8631 D5          		 PUSH DE	;
 61)   8632 F5          		 PUSH AF	;
 62)   8633 C5          		 PUSH BC	;
 63)   8634 21 82 02    		 LD HL, TXTRAM	;
 64)   8637 42          		 LD B, D        ; D HAS THE LINE	; D HAS THE LINE
 65)   8638 D5          		 PUSH DE	;
 66)   8639 11 40 00    		 LD DE, 40 + 24        ; FOR 40 COLUMN SCREEN	; FOR 40 COLUMN SCREEN
 67)   863C 19          		LPN2: ADD HL, DE	;
 68)   863D 10 FD       		 DJNZ LPN2	;
 69)   863F D1          		 POP DE	;
 70)   8640 43          		 LD B, E        ; E HAS THE COLUMN	; E HAS THE COLUMN
 71)   8641 23          		LPN3: INC HL	;
 72)   8642 10 FD       		 DJNZ LPN3	;
 73)   8644 77          		 LD (HL), A        ; A HAS THE CHAR TO PRINT	; A HAS THE CHAR TO PRINT
 74)   8645 C1          		 POP BC	;
 75)   8646 F1          		 POP AF	;
 76)   8647 D1          		 POP DE	;
 77)   8648 E1          		 POP HL	;
 78)   8649 C9          		 RET	;
 81)   864A CD F7 85    		SCPRN: CALL SCCLL        ; CLEAR THE LINE	; CLEAR THE LINE
 82)   864D E5          		SCPRN1: PUSH HL	;
 83)   864E 21 82 02    		 LD HL, TXTRAM	;
 84)   8651 FE 00       		 CP 0	;
 85)   8653 28 07       		 JR Z, SCSKIP        ;SKIP FOR LINE 0	;SKIP FOR LINE 0
 86)   8655 47          		 LD B, A	;
 87)   8656 11 40 00    		 LD DE, 40 + 24        ; FOR 40 COLUMN SCREEN	; FOR 40 COLUMN SCREEN
 88)   8659 19          		LPN1: ADD HL, DE	;
 89)   865A 10 FD       		 DJNZ LPN1	;
 90)   865C EB          		SCSKIP: EX DE, HL	;
 91)   865D E1          		 POP HL	;
 92)   865E 7E          		SCLP: LD A, (HL)	;
 93)   865F FE 00       		 CP 0	;
 94)   8661 28 05       		 JR Z SCEXT	;
 95)   8663 12          		 LD (DE), A	;
 96)   8664 23          		 INC HL	;
 97)   8665 13          		 INC DE	;
 98)   8666 18 F6       		 JR SCLP	;
 99)   8668 C9          		SCEXT: RET	;
101)   8669 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   866D 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8671 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8675 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8679 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   867D 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8681 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8685 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8689 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   868D 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8691 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8695 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   8699 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   869D 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86A1 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86A5 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86A9 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86AD 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86B1 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86B5 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86B9 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86BD 20 20 20 20 		STCL4: DEFM "                                                                                         "	;
101)   86C1 20          		STCL4: DEFM "                                                                                         "	;
102)   86C2 00          		 DB 0	;
104)   86C3 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86C7 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86CB 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86CF 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86D3 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86D7 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86DB 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86DF 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86E3 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86E7 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86EB 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86EF 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86F3 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86F7 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86FB 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   86FF 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   8703 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   8707 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   870B 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   870F 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   8713 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   8717 20 20 20 20 		STCL8: DEFM "                                                                                         "	;
104)   871B 20          		STCL8: DEFM "                                                                                         "	;
105)   871C 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8720 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8724 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8728 20 20 20 20 		 DEFM "                                                                                         "	;
105)   872C 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8730 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8734 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8738 20 20 20 20 		 DEFM "                                                                                         "	;
105)   873C 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8740 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8744 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8748 20 20 20 20 		 DEFM "                                                                                         "	;
105)   874C 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8750 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8754 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8758 20 20 20 20 		 DEFM "                                                                                         "	;
105)   875C 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8760 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8764 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8768 20 20 20 20 		 DEFM "                                                                                         "	;
105)   876C 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8770 20 20 20 20 		 DEFM "                                                                                         "	;
105)   8774 20          		 DEFM "                                                                                         "	;
106)   8775 00          		 DB 0	;
108)   8776 53 43 52 45 		SCRDY: DEFM "SCREEN READY!!!"	;
108)   877A 45 4E 20 52 		SCRDY: DEFM "SCREEN READY!!!"	;
108)   877E 45 41 44 59 		SCRDY: DEFM "SCREEN READY!!!"	;
108)   8782 21 21 21    		SCRDY: DEFM "SCREEN READY!!!"	;
109)   8785 00          		 DB 0	;
  6)   8786 FE 00       		 CP 0	;
  7)   8788 C8          		 RET Z	;
  8)   8789 CD 2D 88    		 CALL NBLOOKASC	;
  9)   878C C9          		 RET	;
 11)   878D 21 AB 87    		NBLOOK: LD HL, NBTAB	;
 12)   8790 06 00       		 LD B, 0	;
 13)   8792 4F          		 LD C, A	;
 14)   8793 09          		 ADD HL, BC	;
 15)   8794 7E          		 LD A, (HL)	;
 16)   8795 FE 00       		 CP 0	;
 17)   8797 C8          		 RET Z	;
 18)   8798 21 7A 00    		 LD HL, KEYCTR        ;BIT 6=SHIFT BIT 7=CTRL  BIT 6+7=GRPH	;BIT 6=SHIFT BIT 7=CTRL  BIT 6+7=GRPH
 19)   879B CB 6E       		 BIT 5, (HL)	;
 20)   879D 28 04       		 JR Z, NOGRPH	;
 21)   879F 06 C0       		 LD B, 192        ;SET BIT 6 AND 7	;SET BIT 6 AND 7
 22)   87A1 18 06       		 JR NBLKEX	;
 23)   87A3 4F          		NOGRPH: LD C, A	;
 24)   87A4 7E          		 LD A, (HL)	;
 25)   87A5 E6 C0       		 AND 11000000	;
 26)   87A7 47          		 LD B, A	;
 27)   87A8 79          		 LD A, C	;
 28)   87A9 B0          		NBLKEX: OR B	;
 29)   87AA C9          		 RET	;
 31)   87AB 00 00 00 00 		NBTAB: DB 0,0,0,0,0,0,0,0,0,0       ;  0-  9	;  0-  9
 31)   87AF 00 00 00 00 		NBTAB: DB 0,0,0,0,0,0,0,0,0,0       ;  0-  9	;  0-  9
 31)   87B3 00 00       		NBTAB: DB 0,0,0,0,0,0,0,0,0,0       ;  0-  9	;  0-  9
 32)   87B5 00 00 00 A4 		 DB 0,0,0,36+128,0,0,0,0,0,0      ; 10- 19 0,0,0,TAB	; 10- 19 0,0,0,TAB
 32)   87B9 00 00 00 00 		 DB 0,0,0,36+128,0,0,0,0,0,0      ; 10- 19 0,0,0,TAB	; 10- 19 0,0,0,TAB
 32)   87BD 00 00       		 DB 0,0,0,36+128,0,0,0,0,0,0      ; 10- 19 0,0,0,TAB	; 10- 19 0,0,0,TAB
 33)   87BF 00 0E 09 00 		 DB 0,14,9,0,0,0,60,45,46,13      ; 20- 29	; 20- 29
 33)   87C3 00 00 3C 2D 		 DB 0,14,9,0,0,0,60,45,46,13      ; 20- 29	; 20- 29
 33)   87C7 2E 0D       		 DB 0,14,9,0,0,0,60,45,46,13      ; 20- 29	; 20- 29
 34)   87C9 08 00 00 3A 		 DB 8,0,0,58,59,44,12,6,7,0      ; 30- 39	; 30- 39
 34)   87CD 3B 2C 0C 06 		 DB 8,0,0,58,59,44,12,6,7,0      ; 30- 39	; 30- 39
 34)   87D1 07 00       		 DB 8,0,0,58,59,44,12,6,7,0      ; 30- 39	; 30- 39
 35)   87D3 00 0F 39 2B 		 DB 0,15,57,43,10,11,5,0,0,52      ; 40- 49	; 40- 49
 35)   87D7 0A 0B 05 00 		 DB 0,15,57,43,10,11,5,0,0,52      ; 40- 49	; 40- 49
 35)   87DB 00 34       		 DB 0,15,57,43,10,11,5,0,0,52      ; 40- 49	; 40- 49
 36)   87DD 38 29 2A 25 		 DB 56,41,42,37,4,0,0,0,53,51      ; 50- 59	; 50- 59
 36)   87E1 04 00 00 00 		 DB 56,41,42,37,4,0,0,0,53,51      ; 50- 59	; 50- 59
 36)   87E5 35 33       		 DB 56,41,42,37,4,0,0,0,53,51      ; 50- 59	; 50- 59
 37)   87E7 23 03 13 00 		 DB 35,3,19,0,0,54,62,36,38,21      ; 60- 69	; 60- 69
 37)   87EB 00 36 3E 24 		 DB 35,3,19,0,0,54,62,36,38,21      ; 60- 69	; 60- 69
 37)   87EF 26 15       		 DB 35,3,19,0,0,54,62,36,38,21      ; 60- 69	; 60- 69
 38)   87F1 14 00 00 37 		 DB 20,0,0,55,47,39,40,26,28,0      ; 70- 79	; 70- 79
 38)   87F5 2F 27 28 1A 		 DB 20,0,0,55,47,39,40,26,28,0      ; 70- 79	; 70- 79
 38)   87F9 1C 00       		 DB 20,0,0,55,47,39,40,26,28,0      ; 70- 79	; 70- 79
 39)   87FB 00 00 43 00 		 DB 0,0,67,0,86,27,0,0,0,0      ; 80- 89	; 80- 89
 39)   87FF 56 1B 00 00 		 DB 0,0,67,0,86,27,0,0,0,0      ; 80- 89	; 80- 89
 39)   8803 00 00       		 DB 0,0,67,0,86,27,0,0,0,0      ; 80- 89	; 80- 89
 40)   8805 1E 00 00 00 		 DB 30,0,0,0,0,0,0,0,0,0      ; 90- 99	; 90- 99
 40)   8809 00 00 00 00 		 DB 30,0,0,0,0,0,0,0,0,0      ; 90- 99	; 90- 99
 40)   880D 00 00       		 DB 30,0,0,0,0,0,0,0,0,0      ; 90- 99	; 90- 99
 41)   880F 00 00 40 00 		 DB 0,0,64,0,0,26+128,0,2,63,0      ;100-109  0,0,64,0,0,END	;100-109  0,0,64,0,0,END
 41)   8813 00 9A 00 02 		 DB 0,0,64,0,0,26+128,0,2,63,0      ;100-109  0,0,64,0,0,END	;100-109  0,0,64,0,0,END
 41)   8817 3F 00       		 DB 0,0,64,0,0,26+128,0,2,63,0      ;100-109  0,0,64,0,0,END	;100-109  0,0,64,0,0,END
 42)   8819 00 00 3D A5 		 DB 0,0,61,37+128,34,0,18,50,31,25     ;110-119  0,0,INS,DEL	;110-119  0,0,INS,DEL
 42)   881D 22 00 12 32 		 DB 0,0,61,37+128,34,0,18,50,31,25     ;110-119  0,0,INS,DEL	;110-119  0,0,INS,DEL
 42)   8821 1F 19       		 DB 0,0,61,37+128,34,0,18,50,31,25     ;110-119  0,0,INS,DEL	;110-119  0,0,INS,DEL
 43)   8823 00 1D 07 1C 		 DB 0,29,7,28,24,20,0,0,0,0      ;120-129	;120-129
 43)   8827 18 14 00 00 		 DB 0,29,7,28,24,20,0,0,0,0      ;120-129	;120-129
 43)   882B 00 00       		 DB 0,29,7,28,24,20,0,0,0,0      ;120-129	;120-129
 46)   882D 21 36 88    		NBLOOKASC:     LD HL, NBRSTAB	;
 47)   8830 06 00       		 LD B, 0	;
 48)   8832 4F          		 LD C, A	;
 49)   8833 09          		 ADD HL, BC	;
 50)   8834 7E          		 LD A, (HL)	;
 51)   8835 C9          		 RET	;
 54)   8836 00 3D 52 12 		NBRSTAB:      DB 0,61,18+64,18,2,0,64,0,64,27+128    ;  0-  9	;  0-  9
 54)   883A 02 00 40 00 		NBRSTAB:      DB 0,61,18+64,18,2,0,64,0,64,27+128    ;  0-  9	;  0-  9
 54)   883E 40 9B       		NBRSTAB:      DB 0,61,18+64,18,2,0,64,0,64,27+128    ;  0-  9	;  0-  9
 55)   8840 22 32 00 1E 		 DB 34,50,0,30,0,0,0,0,0,0     ; 10- 19 	; 10- 19
 55)   8844 00 00 00 00 		 DB 34,50,0,30,0,0,0,0,0,0     ; 10- 19 	; 10- 19
 55)   8848 00 00       		 DB 34,50,0,30,0,0,0,0,0,0     ; 10- 19 	; 10- 19
 56)   884A 00 00 00 00 		 DB 0,0,0,0,0,0,0,31,28+128,29+128    ; 20- 29	; 20- 29
 56)   884E 00 00 00 1F 		 DB 0,0,0,0,0,0,0,31,28+128,29+128    ; 20- 29	; 20- 29
 56)   8852 9C 9D       		 DB 0,0,0,0,0,0,0,31,28+128,29+128    ; 20- 29	; 20- 29
 57)   8854 00 00 0F 49 		 DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64          ; 30- 39  	; 30- 39
 57)   8858 48 47 46 45 		 DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64          ; 30- 39  	; 30- 39
 57)   885C 00 43       		 DB 0,0,15,9+64,8+64,7+64,6+64,5+64,0,3+64          ; 30- 39  	; 30- 39
 58)   885E 16 17 18 1D 		 DB 22,23,24,29,54,28,55,47,21,9     ; 40- 49	; 40- 49
 58)   8862 36 1C 37 2F 		 DB 22,23,24,29,54,28,55,47,21,9     ; 40- 49	; 40- 49
 58)   8866 15 09       		 DB 22,23,24,29,54,28,55,47,21,9     ; 40- 49	; 40- 49
 59)   8868 08 07 06 05 		 DB 8,7,6,5,4,3,19,20,40+64,40             ; 50- 59	; 50- 59
 59)   886C 04 03 13 14 		 DB 8,7,6,5,4,3,19,20,40+64,40             ; 50- 59	; 50- 59
 59)   8870 68 28       		 DB 8,7,6,5,4,3,19,20,40+64,40             ; 50- 59	; 50- 59
 60)   8872 00 1B 00 6F 		 DB 0,27,0,47+64,0,46+64,56+64,58+64,44+64,12+64   ; 60- 69	; 60- 69
 60)   8876 00 6E 78 7A 		 DB 0,27,0,47+64,0,46+64,56+64,58+64,44+64,12+64   ; 60- 69	; 60- 69
 60)   887A 6C 4C       		 DB 0,27,0,47+64,0,46+64,56+64,58+64,44+64,12+64   ; 60- 69	; 60- 69
 61)   887C 6B 6A 69 64 		 DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64 ; 70- 79	; 70- 79
 61)   8880 73 7E 67 75 		 DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64 ; 70- 79	; 70- 79
 61)   8884 74 66       		 DB 43+64,42+64,41+64,36+64,51+64,62+64,39+64,53+64,52+64,38+64 ; 70- 79	; 70- 79
 62)   8886 5A 4E 4B 6D 		 DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64 ; 80- 89	; 80- 89
 62)   888A 4A 63 79 4D 		 DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64 ; 80- 89	; 80- 89
 62)   888E 7B 65       		 DB 26+64,14+64,11+64,45+64,10+64,35+64,57+64,13+64,59+64,37+64 ; 80- 89	; 80- 89
 63)   8890 7C 56 5C 57 		 DB 60+64,22+64,92,23+64,0,0,0,46,56,58    ; 90- 99	; 90- 99
 63)   8894 00 00 00 2E 		 DB 60+64,22+64,92,23+64,0,0,0,46,56,58    ; 90- 99	; 90- 99
 63)   8898 38 3A       		 DB 60+64,22+64,92,23+64,0,0,0,46,56,58    ; 90- 99	; 90- 99
 64)   889A 2C 0C 2B 2A 		 DB 44,12,43,42,41,36,51,62,39,53    ;100-109  	;100-109
 64)   889E 29 24 33 3E 		 DB 44,12,43,42,41,36,51,62,39,53    ;100-109  	;100-109
 64)   88A2 27 35       		 DB 44,12,43,42,41,36,51,62,39,53    ;100-109  	;100-109
 65)   88A4 34 26 1A 0E 		 DB 52,38,26,14,11,45,10,35,57,13           ;110-119  	;110-119
 65)   88A8 0B 2D 0A 23 		 DB 52,38,26,14,11,45,10,35,57,13           ;110-119  	;110-119
 65)   88AC 39 0D       		 DB 52,38,26,14,11,45,10,35,57,13           ;110-119  	;110-119
 66)   88AE 3B 25 3C 00 		 DB 59,37,60,0,0,0,0,0,0,0       ;120-129	;120-129
 66)   88B2 00 00 00 00 		 DB 59,37,60,0,0,0,0,0,0,0       ;120-129	;120-129
 66)   88B6 00 00       		 DB 59,37,60,0,0,0,0,0,0,0       ;120-129	;120-129
 67)   88B8 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;130-  9	;130-  9
 67)   88BC 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;130-  9	;130-  9
 67)   88C0 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;130-  9	;130-  9
 68)   88C2 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;140-  9	;140-  9
 68)   88C6 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;140-  9	;140-  9
 68)   88CA 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;140-  9	;140-  9
 69)   88CC 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;150-  9	;150-  9
 69)   88D0 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;150-  9	;150-  9
 69)   88D4 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;150-  9	;150-  9
 70)   88D6 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;160-  9	;160-  9
 70)   88DA 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;160-  9	;160-  9
 70)   88DE 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;160-  9	;160-  9
 71)   88E0 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;170-  9	;170-  9
 71)   88E4 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;170-  9	;170-  9
 71)   88E8 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;170-  9	;170-  9
 72)   88EA 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;180-  9	;180-  9
 72)   88EE 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;180-  9	;180-  9
 72)   88F2 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;180-  9	;180-  9
 73)   88F4 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;190-  9	;190-  9
 73)   88F8 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;190-  9	;190-  9
 73)   88FC 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;190-  9	;190-  9
 74)   88FE 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;200-  9	;200-  9
 74)   8902 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;200-  9	;200-  9
 74)   8906 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;200-  9	;200-  9
 75)   8908 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;210-  9	;210-  9
 75)   890C 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;210-  9	;210-  9
 75)   8910 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;210-  9	;210-  9
 76)   8912 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;220-  9	;220-  9
 76)   8916 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;220-  9	;220-  9
 76)   891A 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;220-  9	;220-  9
 77)   891C 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;230-  9	;230-  9
 77)   8920 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;230-  9	;230-  9
 77)   8924 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;230-  9	;230-  9
 78)   8926 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;240-  9	;240-  9
 78)   892A 00 00 00 00 		               DB 0,0,0,0,0,0,0,0,0,0       ;240-  9	;240-  9
 78)   892E 00 00       		               DB 0,0,0,0,0,0,0,0,0,0       ;240-  9	;240-  9
 79)   8930 00 00 00 00 		               DB 0,0,0,0,0,0           ;250-  5	;250-  5
 79)   8934 00 00       		               DB 0,0,0,0,0,0           ;250-  5	;250-  5
 19)   8936 21 58 00    		STNEWD: LD HL, $58        ;DEVTAB	;DEVTAB
 20)   8939 11 46 89    		 LD DE, DEVTAB        ; NEW TABLE SET	; NEW TABLE SET
 21)   893C 73          		 LD (HL), E	;
 22)   893D 23          		 INC HL	;
 23)   893E 72          		 LD (HL), D	;
 24)   893F 21 13 00    		 LD HL, DEFSTOR	;
 25)   8942 3E 0C       		 LD A, 12        ;DEFAULT STORE DEVICE IS 12 NB STORAGE MODULE	;DEFAULT STORE DEVICE IS 12 NB STORAGE MODULE
 26)   8944 77          		 LD (HL), A	;
 27)   8945 C9          		 RET	;
 31)   8946 11          		DEVTAB: DEFB 17        ;number of entries ;number of entries	;number of entries ;number of entries
 32)   8947 83 E6       		 DEFW TVIO        ;	;
 33)   8949 EE ED       		 DEFW TP1IO        ;	;
 34)   894B F4 ED       		 DEFW TP2IO        ;	;
 35)   894D 50 E6       		 DEFW LIIO        ;	;
 36)   894F 75 E6       		 DEFW TLIO        ;	;
 37)   8951 36 A1       		 DEFW NKBWIO        ;	;
 38)   8953 1A A1       		 DEFW NKBIIO        ;	;
 39)   8955 1F E4       		 DEFW UPIO        ;	;
 40)   8957 3C E4       		 DEFW LPIO        ;	;
 41)   8959 2F E4       		 DEFW JGIO        ;	;
 42)   895B 19 E4       		 DEFW DUMMY        ;	;
 43)   895D 96 A5       		 DEFW GRAPH        ;  	;
 44)   895F CD 89       		               DEFW SG2IO        ;MY STORAGE DEVICE 13 BDISCIO BINARY SERIAL	;MY STORAGE DEVICE 13 BDISCIO BINARY SERIAL
 45)   8961 CD 89       		               DEFW SG2IO                                                      ;MY STORAGE DEVICE 14 TDISCIO SAME AS 13 FOR ME	;MY STORAGE DEVICE 14 TDISCIO SAME AS 13 FOR ME
 46)   8963 CD 89       		               DEFW SG2IO                                                      ;MY STORAGE DEVICE 15 RDISCIO RANDOM ACCESS	;MY STORAGE DEVICE 15 RDISCIO RANDOM ACCESS
 47)   8965 CD 89       		               DEFW SG2IO                                                      ;MY STORAGE DEVICE 16 SDISCIO DIR COMMANDS	;MY STORAGE DEVICE 16 SDISCIO DIR COMMANDS
 48)   8967 69 89       		               DEFW RS2IO        ;MY SERIAL DEVICE 17	;MY SERIAL DEVICE 17
 15)   8969 	            		 RBR EQU DEVSER+0       ;	;
 16)   8969 	            		 MCR EQU DEVSER+04	;
 17)   8969 	            		 LSR EQU DEVSER+05	;
 33)   8969 04          		 DEFB 4	;
 34)   896A 05          		 DEFB RS2OIN-$        ;OPEN IN	;OPEN IN
 35)   896B 04          		 DEFB RS2OOT-$        ;OPEN OUT	;OPEN OUT
 36)   896C 10          		 DEFB RS2INP-$        ;INPUT BYTE	;INPUT BYTE
 37)   896D 2A          		 DEFB RS2OTP-$        ;OUTPUT BYTE	;OUTPUT BYTE
 38)   896E 0A          		 DEFB RS2CLS-$        ;CLOSE	;CLOSE
 50)   896F C5          		RS2OOT: PUSH BC        ;OPENOUT	;OPENOUT
 51)   8970 01 01 00    		 LD BC, 1        ;NO OF BYTES REQUIRED	;NO OF BYTES REQUIRED
 52)   8973 EF 37       		 DEFW WMKBUFF        ;	;
 53)   8975 C1          		 POP BC         ;	;
 54)   8976 D8          		 RET C         ;	;
 56)   8977 72          		 LD (HL), D        ;PORT NUMBER	;PORT NUMBER
 57)   8978 AF          		RS2CLS: XOR A         ; CLOSE STREAM	; CLOSE STREAM
 58)   8979 47          		 LD B A         ;	;
 59)   897A 4F          		 LD C A         ;	;
 60)   897B C9          		 RET         ;	;
 70)   897C F3          		RS2INP: DI         ;	;
 71)   897D 21 24 00    		 LD HL ENREGMAP        ;	;
 72)   8980 CB 86       		 RES VIDEO, (HL)       ; NO VIDEO	; NO VIDEO
 73)   8982 7E          		 LD A, (HL)	;
 74)   8983 D3 07       		 OUT (ENREG) A        ;	;
 75)   8985 3E 01       		 LD A, 1	;
 76)   8987 D3 24       		 OUT (MCR), A	;
 77)   8989 CD A7 89    		 CALL MWAIT        ;	;
 78)   898C AF          		 XOR A         ;NOT ready to receive SIGNAL DSR 0	;NOT ready to receive SIGNAL DSR 0
 79)   898D D3 24       		 OUT (MCR), A	;
 80)   898F DB 20       		 IN A, (RBR)        ;GET THE CHAR	;GET THE CHAR
 81)   8991 CD 48 E5    		 CALL STOPTV        ;	;
 82)   8994 FB          		 EI         ;	;
 83)   8995 B7          		 OR A         ;	;
 84)   8996 C9          		 RET	;
 87)   8997 4F          		RS2OTP: LD C, A        ;	;
 93)   8998 F3          		 DI         ;	;
 94)   8999 CD 1C E2    		 CALL $E21C        ;NOVID ;	;NOVID ;
 95)   899C 79          		 LD A, C	;
 96)   899D CD 07 80    		 CALL $8007        ;RSTX   ;SEND CHAR IN A	;RSTX   ;SEND CHAR IN A
 97)   89A0 CD 48 E5    		 CALL STOPTV        ;	;
 98)   89A3 FB          		 EI         ;	;
 99)   89A4 2B          		 DEC HL         ;	;
100)   89A5 B7          		 OR A         ;	;
101)   89A6 C9          		 RET         ;	;
104)   89A7 21 00 64    		MWAIT: LD HL 25600	;
106)   89AA DB 25       		MWAIT2: IN A, (LSR)	;
107)   89AC 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
108)   89AD D8          		 RET C	;
109)   89AE 10 FA       		 DJNZ MWAIT2	;
110)   89B0 DB 25       		 IN A, (LSR)	;
111)   89B2 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
112)   89B3 D8          		 RET C	;
113)   89B4 2D          		 DEC L	;
114)   89B5 DB 25       		 IN A, (LSR)	;
115)   89B7 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
116)   89B8 D8          		 RET C	;
117)   89B9 C2 AA 89    		 JP NZ MWAIT2	;
118)   89BC DB 25       		 IN A, (LSR)	;
119)   89BE 1F          		 RRA         ;check d0 ('DATA')	;check d0 ('DATA')
120)   89BF D8          		 RET C	;
121)   89C0 25          		 DEC H	;
122)   89C1 DB 25       		 IN A, (LSR)	;
123)   89C3 1F          		 RRA	;
124)   89C4 D8          		 RET C	;
125)   89C5 C2 AA 89    		 JP NZ, MWAIT2	;
126)   89C8 F1          		 POP AF         ;POP LAST RETURN ADDRESS FROM STACK	;POP LAST RETURN ADDRESS FROM STACK
127)   89C9 3E C8       		 LD A, 200        ;TIMEOUT ERROR	;TIMEOUT ERROR
128)   89CB 37          		 SCF	;
129)   89CC C9          		 RET         ;RETURN TO BASIC WITH ERROR TIMEOUT	;RETURN TO BASIC WITH ERROR TIMEOUT
 25)   89CD 04          		 DEFB 4                                                          ;COUNT OF DISPLACEMENTS-1	;COUNT OF DISPLACEMENTS-1
 26)   89CE 18          		 DEFB SG2OIN-$        ;OPEN IN	;OPEN IN
 27)   89CF 1B          		 DEFB SG2OOT-$        ;OPEN OUT	;OPEN OUT
 28)   89D0 85          		 DEFB SG2INP-$        ;INPUT BYTE	;INPUT BYTE
 29)   89D1 EF          		 DEFB SG2OTP-$        ;OUTPUT BYTE	;OUTPUT BYTE
 30)   89D2 68          		 DEFB SG2CLS-$        ;CLOSE	;CLOSE
 33)   89D3 11 83 00    		CPYFNAME:      LD DE,STRGBUFF	;
 34)   89D6 ED B0       		               LDIR	;
 35)   89D8 C9          		               RET	;
 39)   89D9 E5          		MKCAPS:        PUSH HL	;
 40)   89DA 7E          		MC_NXT:        LD A,(HL)	;
 41)   89DB B7          		               OR A	;
 42)   89DC 28 06       		               JR Z,MC_EXIT	;
 43)   89DE E7 2F       		               DEFW ZTTCAPS	;
 44)   89E0 77          		               LD (HL),A	;
 45)   89E1 23          		               INC HL	;
 46)   89E2 18 F6       		               JR MC_NXT	;
 47)   89E4 E1          		MC_EXIT:       POP HL	;
 48)   89E5 C9          		               RET	;
 75)   89E6 3E 00       		SG2OIN: LD A,0        ;OPENIN	;OPENIN
 76)   89E8 18 02       		               JR SG2OPN	;
 79)   89EA 3E 01       		SG2OOT: LD A,1	;
 80)   89EC E5          		SG2OPN:        PUSH HL	;
 81)   89ED C5          		               PUSH BC        ;OPENOUT	;OPENOUT
 82)   89EE F5          		               PUSH AF	;
 83)   89EF 01 0F 02    		 LD BC, SPCNEED        ;NO OF BYTES REQUIRED	;NO OF BYTES REQUIRED
 84)   89F2 EF 37       		 DEFW WMKBUFF        ;	;
 85)   89F4 D1          		               POP DE	;
 86)   89F5 C1          		 POP BC                                 	;
 87)   89F6 38 3F       		 JR C, ERREXIT                	;
 88)   89F8 E5          		               PUSH HL                                                         ;SAVE START OF STRUCT	;SAVE START OF STRUCT
 89)   89F9 7A          		               LD A,D	;
 91)   89FA 77          		 LD (HL), A        ;OPEN TYPE	;OPEN TYPE
 92)   89FB 23          		               INC HL	;
 93)   89FC 36 00       		               LD (HL),0                                                       ;FILE POS ZERO	;FILE POS ZERO
 94)   89FE 23          		               INC HL	;
 95)   89FF 36 00       		               LD (HL),0	;
 96)   8A01 23          		               INC HL	;
 97)   8A02 36 00       		               LD (HL),0                                                     ;BUF POS 0 	;BUF POS 0
 98)   8A04 23          		               INC HL	;
 99)   8A05 36 00       		               LD (HL),0	;
100)   8A07 23          		               INC HL	;
101)   8A08 E5          		               PUSH HL	;
102)   8A09 C5          		               PUSH BC	;
103)   8A0A 01 14 00    		               LD BC,BYTREAD-FNAMEIX                                           ;SKIP FILENAME	;SKIP FILENAME
104)   8A0D 09          		               ADD HL,BC	;
105)   8A0E C1          		               POP BC	;
106)   8A0F 36 00       		               LD (HL),0                                                       ;BYTES READ TO 0 	;BYTES READ TO 0
107)   8A11 23          		               INC HL	;
108)   8A12 36 00       		               LD (HL),0                                                     	;
109)   8A14 D1          		               POP DE                                                          ;DE AT FNAMEIX       	;DE AT FNAMEIX
110)   8A15 DD E1       		               POP IX                                                          ;IX THE START OF STRUCT                	;IX THE START OF STRUCT
111)   8A17 E1          		               POP HL                                                          ;HL THE FILE NAME	;HL THE FILE NAME
112)   8A18 D5          		               PUSH DE                                                         ;SAVE THE START OF FILENAME        	;SAVE THE START OF FILENAME
113)   8A19 ED B0       		               LDIR                                                            ;TRANSFER THE FNAME TO OUR STRUCT        	;TRANSFER THE FNAME TO OUR STRUCT
114)   8A1B AF          		               XOR A	;
115)   8A1C 12          		               LD (DE),A                                                       ;NULL TERMINATED STRING	;NULL TERMINATED STRING
116)   8A1D E1          		               POP HL                                                          ;START OF FNAME                	;START OF FNAME
117)   8A1E CD D9 89    		               CALL MKCAPS                                                     ;make hl filename caps  	;make hl filename caps
118)   8A21 DD 7E 00    		               LD A,(IX)	;
119)   8A24 FE 00       		               CP 0	;
120)   8A26 20 0D       		               JR NZ,SG2EX                                                      ;IF FILE OPEN OUT EXIT	;IF FILE OPEN OUT EXIT
122)   8A28 01 00 00    		               LD BC,0	;
123)   8A2B 13          		               INC DE	;
124)   8A2C CD 4B 8D    		               CALL STRG_OPENCDIR ;OPEN UP TO CURRENT DIR  	;OPEN UP TO CURRENT DIR
125)   8A2F CD A4 8F    		               CALL STRG_LOADFILE	;
126)   8A32 3E 96       		               LD A,ERROPF                                                     ;ERROR NO IF FILE ERROR	;ERROR NO IF FILE ERROR
127)   8A34 D8          		               RET C	;
128)   8A35 AF          		SG2EX:         XOR A	;
129)   8A36 C9          		               RET	;
132)   8A37 E1          		ERREXIT:       POP HL	;
133)   8A38 37          		               SCF	;
134)   8A39 C9          		               RET	;
136)   8A3A 7E          		SG2CLS: LD A,(HL)	;
137)   8A3B FE 01       		               CP 1                                                            ;CHECK IF OPENOUT	;CHECK IF OPENOUT
138)   8A3D 20 12       		               JR NZ,SCL_EX	;
145)   8A3F DD E5       		               PUSH IX	;
146)   8A41 E5          		               PUSH HL	;
147)   8A42 DD E1       		               POP IX	;
148)   8A44 01 05 00    		               LD BC,FNAMEIX	;
149)   8A47 09          		               ADD HL,BC	;
150)   8A48 DD 4E 03    		               LD C,(IX+BUFFOFS)	;
151)   8A4B DD 46 04    		               LD B,(IX+BUFFOFS+1)	;
152)   8A4E CD EF 8A    		               CALL SO_STFILE	;
153)   8A51 AF          		SCL_EX:        XOR A         ; CLOSE STREAM	; CLOSE STREAM
154)   8A52 47          		 LD B A         ;	;
155)   8A53 4F          		 LD C A         ;	;
156)   8A54 C9          		 RET         ;	;
163)   8A55 DD E5       		SG2INP:        PUSH IX	;
164)   8A57 CD 5D 8A    		               CALL SG2INP2	;
165)   8A5A DD E1       		               POP IX	;
166)   8A5C C9          		               RET	;
168)   8A5D 7E          		SG2INP2:       LD A,(HL)	;
169)   8A5E FE 00       		               CP 0	;
170)   8A60 3E 9B       		               LD A,ERRTRA	;
171)   8A62 37          		               SCF	;
172)   8A63 C0          		               RET NZ                                                          ;IF NOT INPUT THEN ERROR                	;IF NOT INPUT THEN ERROR
173)   8A64 CD 1A 8B    		               CALL SGCHKEOF                                                   ;TEST EOF	;TEST EOF
174)   8A67 23          		               INC HL                	;
175)   8A68 E5          		               PUSH HL                                                         ;SAVE OFFSET POS	;SAVE OFFSET POS
176)   8A69 4E          		               LD C,(HL)	;
177)   8A6A 23          		               INC HL	;
178)   8A6B 46          		               LD B,(HL)                                                       ;BC THE FILE OFFS	;BC THE FILE OFFS
179)   8A6C 23          		               INC HL	;
180)   8A6D 5E          		               LD E,(HL)	;
181)   8A6E 23          		               INC HL	;
182)   8A6F 56          		               LD D,(HL)                                                       ;DE THE BUFFER OFFS	;DE THE BUFFER OFFS
183)   8A70 23          		               INC HL                                                          ;NOW ON FILENAME OFFS	;NOW ON FILENAME OFFS
185)   8A71 3E 97       		               LD A,ERREOF	;
186)   8A73 DA 37 8A    		               JP C,ERREXIT                                                    ;ON C EOF REACHED                	;ON C EOF REACHED
187)   8A76 28 0E       		               JR Z,RDFMFILE                                                   ;ON Z=EOB READ FROM FILE	;ON Z=EOB READ FROM FILE
196)   8A78 01 16 00    		RDFMBUFF:      LD BC,FBUFFIX-FNAMEIX                                           ;500 BYTES BUFFER OFFSET	;500 BYTES BUFFER OFFSET
197)   8A7B 09          		               ADD HL,BC                                                       ;HL ON BUFFER        	;HL ON BUFFER
198)   8A7C 19          		               ADD HL,DE                                                       ;HL ON NXT BYTE INSIDE BUFFER	;HL ON NXT BYTE INSIDE BUFFER
200)   8A7D 7E          		               LD A,(HL)                                                       ;READ BYTE TO A                	;READ BYTE TO A
201)   8A7E E1          		               POP HL                                                          ;HL AT THE FILE OFFSET	;HL AT THE FILE OFFSET
202)   8A7F 23          		               INC HL	;
203)   8A80 23          		               INC HL                                                          ;AT THE BUFFER OFFSET	;AT THE BUFFER OFFSET
204)   8A81 13          		               INC DE                                                          ;POINT TO NEXT BYTE	;POINT TO NEXT BYTE
205)   8A82 73          		               LD (HL),E                                                       ;SAVE 	;SAVE
206)   8A83 23          		               INC HL	;
207)   8A84 72          		               LD (HL),D	;
208)   8A85 C9          		               RET	;
209)   8A86 E5          		RDFMFILE:      PUSH HL                                                         ;HL FILENAME        	;HL FILENAME
210)   8A87 D1          		               POP DE                                                          ;DE FILENAME	;DE FILENAME
211)   8A88 EB          		               EX DE,HL	;
212)   8A89 C5          		               PUSH BC	;
213)   8A8A 01 16 00    		               LD BC,FBUFFIX-FNAMEIX                                           ;500 BYTES BUFFER OFFSET	;500 BYTES BUFFER OFFSET
214)   8A8D 09          		               ADD HL,BC	;
215)   8A8E C1          		               POP BC	;
216)   8A8F EB          		               EX DE,HL                                                        ;HL TO FNAME OFFSET, DE TO BUFFER OFFSET	;HL TO FNAME OFFSET, DE TO BUFFER OFFSET
219)   8A90 D5          		               PUSH DE                                                         ;BC THE FILE OFFSET TO READ FROM	;BC THE FILE OFFSET TO READ FROM
222)   8A91 CD 4B 8D    		               CALL STRG_OPENCDIR ;OPEN UP TO CURRENT DIR                                                                                	;OPEN UP TO CURRENT DIR
223)   8A94 CD 24 90    		               CALL STRG_READBUFR                                              ;READ 500 BYTES FROM FILE TO BUFFER BC= BYTES READ	;READ 500 BYTES FROM FILE TO BUFFER BC= BYTES READ
224)   8A97 D1          		               POP DE                                                          ;THE BUFFER TO READ THE BYTE	;THE BUFFER TO READ THE BYTE
225)   8A98 3E 98       		               LD A,ERRRDF                                                     ;ERROR CODE CAN'T READ FROM FILE	;ERROR CODE CAN'T READ FROM FILE
226)   8A9A DA 37 8A    		               JP C,ERREXIT	;
228)   8A9D E1          		               POP HL                                                          ;GET FILE OFFSET POS ADDR	;GET FILE OFFSET POS ADDR
229)   8A9E D5          		               PUSH DE                                                         ;SAVE START OF BUFFER	;SAVE START OF BUFFER
230)   8A9F EB          		               EX DE,HL                                                        ;DE THE OFFSET ADDR	;DE THE OFFSET ADDR
231)   8AA0 1A          		               LD A,(DE)                                                       ;OFFSET OF FILE 	;OFFSET OF FILE
232)   8AA1 6F          		               LD L,A	;
233)   8AA2 13          		               INC DE	;
234)   8AA3 1A          		               LD A,(DE)	;
235)   8AA4 67          		               LD H,A	;
236)   8AA5 09          		               ADD HL,BC                                                       ;ADD NEW READ BYTES TO PREVIOUS OFFSET	;ADD NEW READ BYTES TO PREVIOUS OFFSET
237)   8AA6 EB          		               EX DE,HL                                                        ;HL THE OFFSET ADDR, DE THE NEW OFFSET	;HL THE OFFSET ADDR, DE THE NEW OFFSET
238)   8AA7 72          		               LD (HL),D                                                       ;SAVE BACK	;SAVE BACK
239)   8AA8 2B          		               DEC HL	;
240)   8AA9 73          		               LD (HL),E	;
241)   8AAA 23          		               INC HL	;
242)   8AAB 23          		               INC HL                                                          ;TO THE BUF OFFSET 	;TO THE BUF OFFSET
243)   8AAC 3E 01       		               LD A,1	;
244)   8AAE 77          		               LD (HL),A                                                       ;SET THE BUF OFFS TO 1	;SET THE BUF OFFS TO 1
245)   8AAF 23          		               INC HL	;
246)   8AB0 AF          		               XOR A	;
247)   8AB1 77          		               LD (HL),A     	;
248)   8AB2 23          		               INC HL                                                  	;
251)   8AB3 C5          		               PUSH BC	;
252)   8AB4 01 14 00    		               LD BC,20	;
253)   8AB7 09          		               ADD HL,BC                                                       ;NOW AT BYTREAD	;NOW AT BYTREAD
254)   8AB8 C1          		               POP BC	;
255)   8AB9 71          		               LD (HL),C                                                       ;SAVE BYTES READ FROM FILE	;SAVE BYTES READ FROM FILE
256)   8ABA 23          		               INC HL	;
257)   8ABB 70          		               LD (HL),B	;
258)   8ABC D1          		               POP DE                                                          ;GET START OF BUFFER	;GET START OF BUFFER
259)   8ABD AF          		               XOR A                                                           ;CLEAR CARRY FLAG	;CLEAR CARRY FLAG
260)   8ABE 1A          		               LD A,(DE)                                                       ;READ THE 1ST BYTE TO A	;READ THE 1ST BYTE TO A
261)   8ABF C9          		               RET	;
270)   8AC0 DD E5       		SG2OTP:        PUSH IX	;
271)   8AC2 E5          		               PUSH HL	;
272)   8AC3 DD E1       		               POP IX	;
273)   8AC5 57          		               LD D,A                                                          ;SAVE BYTE TO BE WRITTEN	;SAVE BYTE TO BE WRITTEN
274)   8AC6 7E          		               LD A,(HL)	;
275)   8AC7 FE 00       		               CP 0	;
276)   8AC9 3E 9B       		               LD A,ERRTRA	;
277)   8ACB 37          		               SCF	;
278)   8ACC 28 47       		               JR Z,SO_EX	;
279)   8ACE 7A          		               LD A,D                                                          ;RESTORE A BYTE TO WRITE	;RESTORE A BYTE TO WRITE
280)   8ACF 01 05 00    		               LD BC,FNAMEIX	;
281)   8AD2 09          		               ADD HL,BC                	;
282)   8AD3 DD E5       		               PUSH IX	;
283)   8AD5 D1          		               POP DE	;
284)   8AD6 EB          		               EX DE,HL	;
285)   8AD7 01 1B 00    		               LD BC,FBUFFIX	;
286)   8ADA 09          		               ADD HL,BC                	;
287)   8ADB DD 4E 03    		               LD C,(IX+BUFFOFS)	;
288)   8ADE DD 46 04    		               LD B,(IX+BUFFOFS+1)	;
289)   8AE1 09          		               ADD HL,BC	;
290)   8AE2 EB          		               EX DE,HL                                	;
291)   8AE3 12          		               LD (DE),A	;
293)   8AE4 79          		               LD A,C	;
294)   8AE5 FE F3       		               CP $F3                                                          ;499 WE START AT 0  	;499 WE START AT 0
295)   8AE7 20 25       		               JR NZ,SO_BUFFNXT	;
296)   8AE9 78          		               LD A,B	;
297)   8AEA FE 01       		               CP $01	;
298)   8AEC 20 20       		               JR NZ,SO_BUFFNXT	;
299)   8AEE 03          		               INC BC                                                          ;500	;500
307)   8AEF EB          		 SO_STFILE:    EX DE,HL	;
308)   8AF0 DD E5       		               PUSH IX	;
309)   8AF2 E1          		               POP HL	;
310)   8AF3 C5          		               PUSH BC	;
311)   8AF4 01 1B 00    		               LD BC,FBUFFIX	;
312)   8AF7 09          		               ADD HL,BC	;
313)   8AF8 C1          		               POP BC	;
314)   8AF9 EB          		               EX DE,HL	;
317)   8AFA CD 4B 8D    		               CALL STRG_OPENCDIR ;OPEN UP TO CURRENT DIR	;OPEN UP TO CURRENT DIR
318)   8AFD CD 7E 91    		               CALL STRG_WRITEBUFR                             ;WRITES 500 BYTES FROM BUFFER DE TO THE END OF THE FILE	;WRITES 500 BYTES FROM BUFFER DE TO THE END OF THE FILE
319)   8B00 3E 96       		               LD A,ERROPF	;
320)   8B02 38 06       		               JR C,SO_ERROUT	;
321)   8B04 3E 99       		               LD A,ERRWTF	;
322)   8B06 37          		               SCF	;
323)   8B07 20 01       		               JR NZ,SO_ERROUT	;
324)   8B09 AF          		               XOR A	;
325)   8B0A 01 00 00    		SO_ERROUT:     LD BC,0                                         ;ZERO BUFFER OFFSET	;ZERO BUFFER OFFSET
326)   8B0D 16          		               DB $16                                          ;SKIP INC BC LD D,NN	;SKIP INC BC LD D,NN
327)   8B0E 03          		SO_BUFFNXT:    INC BC                                          	;
328)   8B0F DD 71 03    		               LD (IX+BUFFOFS),C	;
329)   8B12 DD 70 04    		               LD (IX+BUFFOFS+1),B	;
330)   8B15 DD E1       		SO_EX          POP IX	;
331)   8B17 FE 00       		               CP 0	;
332)   8B19 C9          		               RET	;
339)   8B1A DD E5       		SGCHKEOF:      PUSH IX	;
340)   8B1C D5          		               PUSH DE	;
341)   8B1D C5          		               PUSH BC	;
343)   8B1E E5          		               PUSH HL	;
344)   8B1F DD E1       		               POP IX	;
345)   8B21 DD 5E 03    		               LD E,(IX+BUFFOFS)	;
346)   8B24 DD 56 04    		               LD D,(IX+BUFFOFS+1)	;
347)   8B27 DD 4E 19    		               LD C,(IX+BYTREAD)	;
348)   8B2A DD 46 1A    		               LD B,(IX+BYTREAD+1)	;
350)   8B2D 78          		               LD A,B	;
351)   8B2E B1          		               OR C	;
352)   8B2F 3E 03       		               LD A,3	;
353)   8B31 28 1C       		               JR Z, SGEFEXIT                                                  ;Z=EOB	;Z=EOB
354)   8B33 EB          		               EX DE,HL                                                        ;SAVE HL SET HL=DE	;SAVE HL SET HL=DE
355)   8B34 B7          		               OR A	;
356)   8B35 ED 42       		               SBC HL,BC	;
357)   8B37 7C          		               LD A,H	;
358)   8B38 B5          		               OR L	;
359)   8B39 EB          		               EX DE,HL                                                        ;RESTORE HL	;RESTORE HL
360)   8B3A 3E 01       		               LD A,1                                                          ;NO EOF NO EOB = NZ	;NO EOF NO EOB = NZ
361)   8B3C 20 11       		               JR NZ,SGEFEXIT	;
363)   8B3E 78          		               LD A,B	;
364)   8B3F D6 01       		               SUB $01	;
365)   8B41 20 09       		               JR NZ, SGDOEOF	;
366)   8B43 79          		               LD A,C	;
367)   8B44 D6 F4       		               SUB $F4	;
368)   8B46 20 04       		               JR NZ, SGDOEOF	;
369)   8B48 3E 02       		               LD A,2                                                          ;Z MEANS EOB END OF BUFFER                	;Z MEANS EOB END OF BUFFER
370)   8B4A 18 03       		               JR  SGEFEXIT	;
372)   8B4C 3E 97       		SGDOEOF:       LD A,ERREOF                                                           ;RETURN 0 ON EOF	;RETURN 0 ON EOF
373)   8B4E 37          		               SCF         	;
374)   8B4F C1          		SGEFEXIT:      POP BC	;
375)   8B50 D1          		               POP DE	;
376)   8B51 DD E1       		               POP IX	;
377)   8B53 C9          		               RET	;
380)   8B54 E5          		PRNHL:         PUSH HL	;
381)   8B55 C5          		               PUSH BC	;
382)   8B56 D5          		               PUSH DE	;
383)   8B57 CD 87 96    		 CALL B2D16	;
384)   8B5A 21 CF 00    		 LD HL,B2DBUF	;
385)   8B5D CD 1B 97    		 CALL SKIPSPC	;
386)   8B60 CD 1C 8C    		 CALL RS_TXT	;
387)   8B63 D1          		               POP DE	;
388)   8B64 C1          		               POP BC	;
389)   8B65 E1          		               POP HL	;
390)   8B66 C9          		               RET	;
391)   8B67 E5          		PRINTDBG:      PUSH HL	;
392)   8B68 C5          		               PUSH BC	;
393)   8B69 D5          		               PUSH DE	;
394)   8B6A F5          		               PUSH AF	;
396)   8B6B CD 54 8B    		               CALL PRNHL	;
397)   8B6E D5          		               PUSH DE	;
398)   8B6F C5          		               PUSH BC	;
399)   8B70 CD 26 80    		 CALL OS_PRINTMSG	;
400)   8B73 20 48 4C    		 DEFM " HL"	;
401)   8B76 0A 0D 00    		 DB 10,13,0	;
402)   8B79 C1          		               POP BC	;
403)   8B7A D1          		               POP DE	;
405)   8B7B D5          		               PUSH DE	;
406)   8B7C E1          		               POP HL	;
407)   8B7D CD 54 8B    		               CALL PRNHL	;
408)   8B80 D5          		               PUSH DE	;
409)   8B81 C5          		               PUSH BC	;
410)   8B82 CD 26 80    		 CALL OS_PRINTMSG	;
411)   8B85 20 44 45    		 DEFM " DE"	;
412)   8B88 0A 0D 00    		 DB 10,13,0	;
413)   8B8B C1          		               POP BC	;
414)   8B8C D1          		               POP DE	;
416)   8B8D C5          		               PUSH BC	;
417)   8B8E E1          		               POP HL	;
418)   8B8F CD 54 8B    		               CALL PRNHL	;
419)   8B92 D5          		               PUSH DE	;
420)   8B93 C5          		               PUSH BC	;
421)   8B94 CD 26 80    		 CALL OS_PRINTMSG	;
422)   8B97 20 42 43    		 DEFM " BC"	;
423)   8B9A 0A 0D 00    		 DB 10,13,0	;
424)   8B9D C1          		               POP BC	;
425)   8B9E D1          		               POP DE	;
428)   8B9F F1          		               POP AF	;
429)   8BA0 D1          		               POP DE	;
430)   8BA1 C1          		               POP BC	;
431)   8BA2 E1          		               POP HL	;
432)   8BA3 C9          		               RET	;
436)   8BA4 F5          		CLRBUFR:       PUSH AF	;
437)   8BA5 E5          		               PUSH HL	;
438)   8BA6 D5          		               PUSH DE	;
439)   8BA7 C5          		               PUSH BC	;
440)   8BA8 AF          		               XOR A	;
441)   8BA9 12          		               LD (DE),A	;
442)   8BAA D5          		               PUSH DE	;
443)   8BAB E1          		               POP HL	;
444)   8BAC 13          		               INC DE	;
445)   8BAD 01 F3 01    		               LD BC,499	;
446)   8BB0 ED B0       		               LDIR        	;
447)   8BB2 C1          		               POP BC	;
448)   8BB3 D1          		               POP DE	;
449)   8BB4 E1          		               POP HL	;
450)   8BB5 F1          		               POP AF	;
451)   8BB6 C9          		               RET	;
456)   8BB7 04          		 DEFB 4                                                          ;COUNT OF DISPLACEMENTS-1	;COUNT OF DISPLACEMENTS-1
457)   8BB8 2E          		 DEFB SG2OIN-$        ;OPEN IN	;OPEN IN
458)   8BB9 31          		 DEFB SG2OOT-$        ;OPEN OUT	;OPEN OUT
459)   8BBA 9B          		 DEFB SG2INP-$        ;INPUT BYTE	;INPUT BYTE
460)   8BBB 05          		 DEFB SG2OTP-$        ;OUTPUT BYTE	;OUTPUT BYTE
461)   8BBC 7E          		 DEFB SG2CLS-$        ;CLOSE	;CLOSE
 10)   8BBD 21 A1 00    		INITMMU:       LD HL,BANKS	;
 11)   8BC0 06 08       		               LD B,8	;
 12)   8BC2 AF          		               XOR A	;
 13)   8BC3 77          		INM_AGN:       LD (HL),A	;
 14)   8BC4 3C          		               INC A	;
 15)   8BC5 23          		 INC HL	;
 16)   8BC6 10 FB       		               DJNZ INM_AGN	;
 17)   8BC8 C9          		               RET                	;
 23)   8BC9 4F          		PUTPGINBANK: LD C, A       ;SAVE PAGE	;SAVE PAGE
 24)   8BCA 78          		 LD A, B                                                         ;BANK IN A	;BANK IN A
 25)   8BCB FE 02       		 CP 2	;
 26)   8BCD D8          		 RET C         ;BANK 0,1 WILL NEVER CHANGE	;BANK 0,1 WILL NEVER CHANGE
 27)   8BCE FE 07       		 CP 7	;
 28)   8BD0 C8          		 RET Z         ;BANK 7 WILL NEVER CHANGE	;BANK 7 WILL NEVER CHANGE
 29)   8BD1 21 A1 00    		 LD HL, BANKS	;
 30)   8BD4 16 00       		 LD D, 0	;
 31)   8BD6 5F          		 LD E, A	;
 32)   8BD7 19          		 ADD HL, DE	;
 33)   8BD8 79          		 LD A, C        ;RESTORE PAGE	;RESTORE PAGE
 34)   8BD9 77          		 LD (HL), A        ;SAVE PG IN BANK B MEMORY	;SAVE PG IN BANK B MEMORY
 35)   8BDA 0E 00       		 LD C, DEVMMU	;
 36)   8BDC 58          		 LD E,B	;
 37)   8BDD CB 20       		 SLA B         ;SHIFT BANK TO A15..A13 FROM A2..A0 WE USE THESE PINS ON THE CPLD FOR BANK INPUT	;SHIFT BANK TO A15..A13 FROM A2..A0 WE USE THESE PINS ON THE CPLD FOR BANK INPUT
 38)   8BDF CB 20       		 SLA B	;
 39)   8BE1 CB 20       		 SLA B	;
 40)   8BE3 CB 20       		 SLA B	;
 41)   8BE5 CB 20       		 SLA B         ;SET TO A15,A14,A13	;SET TO A15,A14,A13
 42)   8BE7 ED 79       		 OUT (C), A	;
 43)   8BE9 43          		 LD B,E	;
 44)   8BEA C9          		 RET	;
 49)   8BEB 21 A1 00    		GETPGINBANK:   LD HL,BANKS	;
 50)   8BEE 16 00       		               LD D,0	;
 51)   8BF0 58          		               LD E,B	;
 52)   8BF1 19          		               ADD HL,DE	;
 53)   8BF2 7E          		               LD A,(HL)	;
 54)   8BF3 C9          		               RET	;
 17)   8BF4 	            		 RBR EQU DEVSER+0      ;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)	;RECEIVER BUFFER REGISTER (READ ONLY) (DLAB = 0)
 18)   8BF4 	            		 THR EQU DEVSER+0      ;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)	;TRANSMITER HOLDING REGISTER (WRITE ONLY) (DLAB = 0)
 19)   8BF4 	            		 IER EQU DEVSER+1      ;INTERRUPT ENABLE REGISTER (DLAB = 0)	;INTERRUPT ENABLE REGISTER (DLAB = 0)
 24)   8BF4 	            		 IIR EQU DEVSER+2      ;INTERRUPT IDENT. REGISTER (READ ONLY)	;INTERRUPT IDENT. REGISTER (READ ONLY)
 29)   8BF4 	            		 FCR EQU DEVSER+2      ;FIFO CONTROL REGISTER (WRITE ONLY)	;FIFO CONTROL REGISTER (WRITE ONLY)
 37)   8BF4 	            		 LCR EQU DEVSER+3      ;LINE CONTROL REGISTER	;LINE CONTROL REGISTER
 45)   8BF4 	            		 MCR EQU DEVSER+4      ;MODEM CONTROL REGISTER	;MODEM CONTROL REGISTER
 46)   8BF4 	            		 LSR EQU DEVSER+5      ;LINE STATUS REGISTER	;LINE STATUS REGISTER
 55)   8BF4 	            		 MSR EQU DEVSER+6      ;MODEM STATUS REGISTER	;MODEM STATUS REGISTER
 56)   8BF4 	            		 SCR EQU DEVSER+7      ;SCRATCH REGISTER	;SCRATCH REGISTER
 57)   8BF4 	            		 DLL EQU DEVSER+0      ;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (LEAST SIGNIFICANT BYTE) (DLAB = 1)
 58)   8BF4 	            		 DLM EQU DEVSER+1      ;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)	;DIVISOR LATCH (MOST SIGNIFICANT BYTE) (DLAB = 1)
 64)   8BF4 F5          		RS_INI: PUSH AF	;
 65)   8BF5 3E 80       		 LD A, $80        ; Mask to set DLAB on	; Mask to set DLAB on
 66)   8BF7 D3 23       		 OUT (LCR), A        ; Send to LINe Control Register	; Send to LINe Control Register
 75)   8BF9 F1          		 POP AF	;
 76)   8BFA D3 20       		 OUT (DLL), A        ; Set LSB of divisor	; Set LSB of divisor
 77)   8BFC 3E 00       		 LD A, 00        ; This will be the MSB of the divisior	; This will be the MSB of the divisior
 78)   8BFE D3 21       		 OUT (DLM), A        ; Send to the MSB register	; Send to the MSB register
 79)   8C00 3E 03       		 LD A, $03        ; 8 bits, 1 stop, no parity (and clear DLAB)	; 8 bits, 1 stop, no parity (and clear DLAB)
 80)   8C02 D3 23       		 OUT (LCR), A        ; Write new value to LCR	; Write new value to LCR
 82)   8C04 3E 00       		 LD A, 0	;
 83)   8C06 D3 22       		 OUT (FCR), A        ;//was commented	;//was commented
 84)   8C08 3E 00       		 LD A, $00        ; 5 A=0 Disable all INterrupts	; 5 A=0 Disable all INterrupts
 85)   8C0A D3 21       		 OUT (IER), A        ; Send to INterrupt Enable Register	; Send to INterrupt Enable Register
 86)   8C0C C9          		 RET	;
 89)   8C0D CD 13 8C    		RS_TX: CALL RSTXRD	;
 90)   8C10 D3 20       		 OUT (THR), A	;
 92)   8C12 C9          		 RET	;
 95)   8C13 F5          		RSTXRD: PUSH AF	;
 96)   8C14 DB 25       		RSTXLP: IN A, (LSR)        ; fetch the control register	; fetch the control register
 97)   8C16 CB 6F       		 BIT 5, A        ; bit will be set if UART is ready	; bit will be set if UART is ready
 98)   8C18 28 FA       		 JR Z, RSTXLP	;
 99)   8C1A F1          		 POP AF	;
100)   8C1B C9          		 RET	;
104)   8C1C 7E          		RS_TXT: LD A, (HL)	;
105)   8C1D 23          		 INC HL	;
106)   8C1E FE 00       		 CP 0	;
107)   8C20 C8          		 RET Z	;
108)   8C21 CD 0D 8C    		 CALL RS_TX	;
109)   8C24 18 F6       		 JR RS_TXT	;
113)   8C26 E5          		RS_MESG: PUSH HL	;
114)   8C27 C5          		 PUSH BC	;
115)   8C28 D5          		 PUSH DE	;
116)   8C29 F5          		 PUSH AF	;
117)   8C2A 21 09 00    		 LD HL,9 ;POINTS TO RET ADDRESS +10 FROM SP = OUR STRING	;POINTS TO RET ADDRESS +10 FROM SP = OUR STRING
118)   8C2D 39          		 ADD HL,SP	;
119)   8C2E 46          		 LD B,(HL)    	;
120)   8C2F 2B          		 DEC HL	;
121)   8C30 4E          		 LD C,(HL)	;
122)   8C31 60          		 LD H,B	;
123)   8C32 69          		 LD L,C	;
124)   8C33 CD 1C 8C    		 CALL RS_TXT	;
125)   8C36 F1          		 POP AF	;
126)   8C37 D1          		 POP DE	;
127)   8C38 44          		 LD B,H  ;NEW RET ADDRESS	;NEW RET ADDRESS
128)   8C39 4D          		 LD C,L	;
129)   8C3A 21 05 00    		 LD HL,5 ;POINTS TO RET ADDRESS +6 FROM SP	;POINTS TO RET ADDRESS +6 FROM SP
130)   8C3D 39          		 ADD HL,SP  	;
131)   8C3E 70          		 LD (HL),B	;
132)   8C3F 2B          		 DEC HL	;
133)   8C40 71          		 LD (HL),C  	;
134)   8C41 C1          		 POP BC	;
135)   8C42 E1          		 POP HL	;
136)   8C43 C9          		 RET 	;
143)   8C44 ED 57       		RS_RX: LD A,I        ;SETS PV IF INTS ARE ENABLED	;SETS PV IF INTS ARE ENABLED
144)   8C46 F5          		 PUSH AF	;
145)   8C47 D1          		 POP DE	;
146)   8C48 F3          		 DI	;
147)   8C49 3E 01       		 LD A, 1        ;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
148)   8C4B D3 24       		 OUT (MCR), A	;
149)   8C4D CD 6B 8C    		 CALL RSRXRD	;
150)   8C50 AF          		RS_GTCH: XOR A        ;NOT ready to receive SIGNAL DSR 0	;NOT ready to receive SIGNAL DSR 0
151)   8C51 D3 24       		 OUT (MCR), A	;
153)   8C53 DB 20       		 IN A, (RBR)  	;
154)   8C55 D5          		 PUSH DE	;
155)   8C56 57          		 LD D,A	;
156)   8C57 F1          		 POP AF	;
157)   8C58 7A          		 LD A,D	;
158)   8C59 E0          		 RET PO  	;
159)   8C5A FB          		 EI	;
160)   8C5B C9          		 RET	;
162)   8C5C 3E 01       		RS_RXNW: LD A, 1       ;ready to receive SIGNAL DSR 1	;ready to receive SIGNAL DSR 1
163)   8C5E D3 24       		 OUT (MCR), A	;
164)   8C60 DB 25       		 IN A, (LSR)        ; fetch the conrtol register	; fetch the conrtol register
165)   8C62 CB 47       		 BIT 0, A	;
166)   8C64 28 03       		 JR Z, RS_NOCHAR	;
167)   8C66 F3          		 DI	;
168)   8C67 18 E7       		 JR RS_GTCH	;
169)   8C69 AF          		RS_NOCHAR: XOR A        ;RETURN ZERO	;RETURN ZERO
170)   8C6A C9          		 RET	;
178)   8C6B F5          		 PUSH AF	;
184)   8C6C DB 25       		 IN A, (LSR)        ; fetch the control register	; fetch the control register
185)   8C6E CB 47       		 BIT 0, A        ; bit will be set if UART has data	; bit will be set if UART has data
186)   8C70 28 FA       		 JR Z, RSRXLP	;
188)   8C72 F1          		 POP AF	;
190)   8C73 C9          		 RET	;
194)   8C74 DB 25       		RS_KEYRD: IN A, (LSR)       ; fetch the conrtol register	; fetch the conrtol register
195)   8C76 CB 47       		 BIT 0, A        ; bit will be set if UART has data	; bit will be set if UART has data
196)   8C78 C9          		 RET	;
198)   8C79 F5          		SHLCD: PUSH AF	;
200)   8C7A F1          		 POP AF	;
202)   8C7B C9          		 RET	;
204)   8C7C F5          		RS_NEWLINE: PUSH AF	;
205)   8C7D 3E 0D       		 LD A,13	;
206)   8C7F CD 0D 8C    		 CALL RS_TX	;
207)   8C82 3E 0A       		 LD A,10	;
208)   8C84 CD 0D 8C    		 CALL RS_TX	;
209)   8C87 F1          		 POP AF	;
210)   8C88 C9          		 RET  	;
213)   8C89 F5          		CHKERR: PUSH AF	;
214)   8C8A E5          		 PUSH HL	;
215)   8C8B C5          		 PUSH BC	;
216)   8C8C DB 25       		 IN A, (LSR)        ;FETCH LINE STATUS REGISTER	;FETCH LINE STATUS REGISTER
217)   8C8E CB 67       		 BIT 4, A	;
218)   8C90 28 04       		 JR Z, LBLPE	;
219)   8C92 3E 42       		 LD A, 'B'       ;$20  ;BREAK	;$20  ;BREAK
220)   8C94 18 1A       		 JR EXIT	;
221)   8C96 CB 57       		LBLPE: BIT 2, A	;
222)   8C98 28 04       		 JR Z, LBLFE	;
223)   8C9A 3E 50       		 LD A, 'P'       ;$40  ;PARITY	;$40  ;PARITY
224)   8C9C 18 12       		 JR EXIT	;
225)   8C9E CB 5F       		LBLFE: BIT 3, A	;
226)   8CA0 28 04       		 JR Z, LBLOE	;
227)   8CA2 3E 46       		 LD A, 'F'       ;$60  ;FRAME	;$60  ;FRAME
228)   8CA4 18 0A       		 JR EXIT	;
229)   8CA6 CB 4F       		LBLOE: BIT 1, A	;
230)   8CA8 28 04       		 JR Z, LBLNE	;
231)   8CAA 3E 4F       		 LD A, 'O'        ;$80  ;OVERRUN	;$80  ;OVERRUN
232)   8CAC 18 02       		 JR EXIT	;
233)   8CAE 3E 4E       		LBLNE: LD A, 'N'        ;NO ERROR	;NO ERROR
234)   8CB0 21 7B 00    		EXIT: LD HL, SERERR	;
235)   8CB3 77          		 LD (HL), A	;
237)   8CB4 C1          		 POP BC	;
238)   8CB5 E1          		 POP HL	;
239)   8CB6 F1          		 POP AF	;
240)   8CB7 C9          		 RET	;
 31)   8CB8 	            		@CH376_ERROR EQU RS_MESG	;
 41)   8CB8 57          		STRG_INIT: LD D,A	;
 42)   8CB9 AF          		 XOR A  	;
 43)   8CBA 32 82 00    		 LD (STRG_STAT),A  ;NOT CONNECTED, NOT EXISTS	;NOT CONNECTED, NOT EXISTS
 44)   8CBD CD 91 92    		 CALL CH376_INIT	;
 45)   8CC0 20 06       		 JR NZ,INIERR	;
 46)   8CC2 7A          		 LD A,D   ;SELECT USB DEVICE 3 FOR SDCARD, 6 FOR FLASH	;SELECT USB DEVICE 3 FOR SDCARD, 6 FOR FLASH
 47)   8CC3 CD A6 92    		 CALL CH376_SETUSB	;
 48)   8CC6 28 03       		 JR Z,INIOK	;
 49)   8CC8 3E 00       		INIERR: LD A,0  	;
 50)   8CCA C9          		 RET	;
 51)   8CCB CD 86 92    		INIOK: CALL CH376_VERSION	;
 52)   8CCE BF          		 CP A  ;SET ZF	;SET ZF
 53)   8CCF 3E 80       		 LD A, $80  ;BIT 7 MEANS EXISTS	;BIT 7 MEANS EXISTS
 54)   8CD1 32 82 00    		 LD (STRG_STAT),A  ;	;
 55)   8CD4 C9          		 RET	;
 58)   8CD5 3A 82 00    		STRG_EXISTS: LD A,(STRG_STAT)	;
 59)   8CD8 CB 7F       		 BIT 7,A	;
 60)   8CDA C9          		 RET	;
 66)   8CDB CD D5 8C    		STRG_CHECK: CALL STRG_EXISTS	;
 67)   8CDE 37          		 SCF	;
 68)   8CDF C8          		 RET Z    ;Z MEANS NOT EXISTS	;Z MEANS NOT EXISTS
 69)   8CE0 06 05       		 LD B,5	;
 70)   8CE2 CD D6 92    		SC_AGN1: CALL CH376_CONNECT 	;
 71)   8CE5 28 06       		 JR Z,DOCON	;
 72)   8CE7 30 1C       		 JR NC,DODISC	;
 73)   8CE9 10 F7       		 DJNZ SC_AGN1    	;
 77)   8CEB AF          		 XOR A   	;
 78)   8CEC C9          		 RET   ;TIMEOUT	;TIMEOUT
 80)   8CED AF          		DOCON: XOR A    ;CLCF	;CLCF
 81)   8CEE 3A 82 00    		 LD A,(STRG_STAT)	;
 82)   8CF1 CB 47       		 BIT 0,A	;
 83)   8CF3 C0          		 RET NZ    ;ALREADY MOUNTED THE DRIVE	;ALREADY MOUNTED THE DRIVE
 87)   8CF4 CD E1 92    		 CALL CH376_MOUNT   ;MOUNT THE DRIVE	;MOUNT THE DRIVE
 88)   8CF7 20 0C       		 JR NZ, DONOMNT	;
 92)   8CF9 3A 82 00    		 LD A,(STRG_STAT)	;
 93)   8CFC CB C7       		 SET 0,A	;
 94)   8CFE 32 82 00    		 LD (STRG_STAT),A	;
 95)   8D01 AF          		 XOR A    ;CLEAR CARRY FLAG MEANS WE ARE OK	;CLEAR CARRY FLAG MEANS WE ARE OK
 96)   8D02 3E 01       		 LD A,1    ;A=1 IS JUST CONNECTED	;A=1 IS JUST CONNECTED
 97)   8D04 C9          		 RET	;
105)   8D05 AF          		 XOR A 	;
106)   8D06 3A 82 00    		 LD A,(STRG_STAT)  	;
107)   8D09 CB 47       		 BIT 0,A	;
108)   8D0B C8          		 RET Z    ;ALREADY DISCONNECTED	;ALREADY DISCONNECTED
109)   8D0C CB 87       		 RES 0,A    ;SET BIT 0 TO 0=DISCONNECTED	;SET BIT 0 TO 0=DISCONNECTED
110)   8D0E 32 82 00    		 LD (STRG_STAT),A  	;
111)   8D11 3E 02       		 LD A,2    ;A=2 IS JUST DISCONNECTED	;A=2 IS JUST DISCONNECTED
112)   8D13 C9          		 RET	;
118)   8D14 C3 EA 92    		STRG_OPENCRD:  JP CH376_MOUNTDEV  	;
121)   8D17 2A 00       		SDIRTP  DEFB '*',0	;
123)   8D19 CD 4B 8D    		STRG_DIRLIST: CALL STRG_OPENCDIR ;OPEN CURRENT DIR	;OPEN CURRENT DIR
124)   8D1C 21 17 8D    		 LD HL,SDIRTP	;
125)   8D1F CD C4 8D    		 CALL STRG_OPENFD	;
126)   8D22 C8          		DL_NXTFILE: RET Z   ;NO  MORE FILES	;NO  MORE FILES
127)   8D23 3E 27       		 LD A,CMD_RDUSB_DATA0	;
128)   8D25 CD 70 92    		 CALL CH376_COMMD	;
129)   8D28 CD AF 91    		 CALL CH376_GETDATA ;DATA ON USBBUF A=BYTES TO READ	;DATA ON USBBUF A=BYTES TO READ
130)   8D2B 3E 00       		 LD A,0	;
131)   8D2D 12          		 LD (DE),A   ;ZT STRING	;ZT STRING
133)   8D2E 21 83 00    		 LD HL,USBBUF	;
134)   8D31 CD 38 80    		 CALL OS_PRMESSCRSFE	;
135)   8D34 3E 0D       		 LD A,$0D	;
136)   8D36 CD 2D 80    		 CALL OS_PRCHSCR	;
138)   8D39 3E 33       		 LD A, CMD_FILEENUM_GO	;
139)   8D3B CD 70 92    		 CALL CH376_COMMD	;
140)   8D3E CD 01 92    		 CALL CH376_WTCMDEND	;
141)   8D41 FE 42       		 CP ERR_MISS_FILE	;
142)   8D43 18 DD       		 JR DL_NXTFILE	;
146)   8D45 7E          		NEXTDIR: LD A,(HL)	;
147)   8D46 23          		 INC HL	;
148)   8D47 B7          		 OR A	;
149)   8D48 C8          		 RET Z	;
150)   8D49 18 FA       		 JR NEXTDIR	;
156)   8D4B E5          		STRG_OPENCDIR: PUSH HL	;
157)   8D4C D5          		 PUSH DE	;
158)   8D4D C5          		 PUSH BC  	;
159)   8D4E 21 E4 00    		 LD HL,DIRNM	;
160)   8D51 CD 58 8D    		 CALL STRG_OPENCDIR2	;
161)   8D54 C1          		        POP BC	;
162)   8D55 D1          		 POP DE	;
163)   8D56 E1          		 POP HL	;
164)   8D57 C9          		 RET	;
166)   8D58 7E          		STRG_OPENCDIR2: LD A,(HL)	;
167)   8D59 B7          		 OR A	;
168)   8D5A C8          		 RET Z  ;WHEN ZERO MEANS NO MORE DIR TO OPEN	;WHEN ZERO MEANS NO MORE DIR TO OPEN
169)   8D5B E5          		 PUSH HL	;
170)   8D5C CD C4 8D    		 CALL STRG_OPENFD	;
171)   8D5F E1          		 POP HL	;
172)   8D60 D8          		 RET C  ;ERROR	;ERROR
173)   8D61 37          		 SCF	;
174)   8D62 3E 96       		 LD A,150 ;MISSING FILENAME	;MISSING FILENAME
175)   8D64 C8          		 RET Z  ;FILE MISSING	;FILE MISSING
177)   8D65 CD 45 8D    		 CALL NEXTDIR	;
178)   8D68 18 EE       		 JR STRG_OPENCDIR2	;
182)   8D6A E5          		STRG_DIRNMCHG: PUSH HL 	;
183)   8D6B 7E          		 LD A,(HL)	;
184)   8D6C FE 2F       		 CP '/'	;
185)   8D6E 28 0A       		 JR Z,DNC_RESET	;
186)   8D70 FE 2E       		 CP '.'	;
187)   8D72 20 2D       		 JR NZ, DNC_ADD	;
188)   8D74 FE 2E       		 CP '.'	;
189)   8D76 28 0F       		 JR Z,DNC_RMV	;
190)   8D78 E1          		 POP HL	;
191)   8D79 C9          		 RET ;DO NOTHING IF . OR .\ OR .<x>	;DO NOTHING IF . OR .\ OR .<x>
192)   8D7A 21 E4 00    		DNC_RESET: LD HL,DIRNM	;
193)   8D7D 36 2F       		 LD (HL),'/'	;
194)   8D7F 23          		 INC HL	;
195)   8D80 36 00       		 LD (HL),0	;
196)   8D82 23          		 INC HL	;
197)   8D83 36 00       		 LD (HL),0	;
198)   8D85 E1          		 POP HL	;
199)   8D86 C9          		 RET	;
202)   8D87 21 E4 00    		DNC_RMV: LD HL,DIRNM	;
203)   8D8A CD 45 8D    		 CALL NEXTDIR	;
204)   8D8D 7E          		 LD A,(HL)	;
205)   8D8E B7          		 OR A	;
206)   8D8F EB          		 EX DE,HL ;DE THE NEXT DIR	;DE THE NEXT DIR
207)   8D90 E1          		 POP HL	;
208)   8D91 C8          		 RET Z ;RET IF WE ARE ON 1ST DIRECTORY  	;RET IF WE ARE ON 1ST DIRECTORY
209)   8D92 E5          		 PUSH HL	;
210)   8D93 EB          		 EX DE,HL ;HL THE NEXT DIR	;HL THE NEXT DIR
211)   8D94 44          		RMV_NXT: LD B,H	;
212)   8D95 4D          		 LD C,L	;
213)   8D96 CD 45 8D    		 CALL NEXTDIR	;
214)   8D99 7E          		 LD A,(HL)	;
215)   8D9A B7          		 OR A	;
216)   8D9B 20 F7       		 JR NZ,RMV_NXT ;GO TO NEXT DIR 	;GO TO NEXT DIR
219)   8D9D AF          		 XOR A	;
220)   8D9E 02          		 LD (BC),A	;
221)   8D9F E1          		 POP HL	;
222)   8DA0 C9          		 RET	;
224)   8DA1 EB          		DNC_ADD: EX DE,HL ;DE THE NEW FILE	;DE THE NEW FILE
225)   8DA2 21 E4 00    		 LD HL,DIRNM	;
226)   8DA5 CD 45 8D    		ADDNXT: CALL NEXTDIR	;
227)   8DA8 7E          		 LD A,(HL)	;
228)   8DA9 B7          		 OR A	;
229)   8DAA 20 F9       		 JR NZ,ADDNXT	;
231)   8DAC EB          		 EX DE,HL	;
233)   8DAD 7E          		ADDNXT2: LD A,(HL)	;
234)   8DAE 12          		 LD (DE),A	;
235)   8DAF 23          		 INC HL	;
236)   8DB0 13          		 INC DE	;
237)   8DB1 B7          		 OR A	;
238)   8DB2 20 F9       		 JR NZ,ADDNXT2	;
240)   8DB4 EB          		 EX DE,HL	;
241)   8DB5 36 00       		 LD (HL),0 ;SIGNAL END OF DIRECTORIES WITH A SECOND ZERO	;SIGNAL END OF DIRECTORIES WITH A SECOND ZERO
242)   8DB7 E1          		 POP HL	;
243)   8DB8 C9          		 RET	;
247)   8DB9 F5          		TEMPPRMSG: PUSH AF	;
248)   8DBA CD 30 80    		 CALL OS_PRMESSCR	;
249)   8DBD 3E 0A       		 LD A,$0A	;
250)   8DBF CD 2D 80    		 CALL OS_PRCHSCR	;
251)   8DC2 F1          		 POP AF	;
252)   8DC3 C9          		 RET	;
261)   8DC4 E5          		STRG_DIRCHG: PUSH HL	;
265)   8DC5 3E 2F       		 LD A, CMD_SETFILENAME	;
266)   8DC7 CD 70 92    		     CALL CH376_COMMD  	;
267)   8DCA CD 25 93    		     CALL CH376_WRSTRING	;
268)   8DCD 20 0E       		 JR NZ,DC_WSERR  	;
269)   8DCF 3E 32       		 LD A, CMD_FILE_OPEN	;
270)   8DD1 CD 70 92    		 CALL CH376_COMMD	;
271)   8DD4 CD 01 92    		 CALL CH376_WTCMDEND   	;
272)   8DD7 E1          		 POP HL	;
273)   8DD8 FE 42       		 CP ERR_MISS_FILE	;
274)   8DDA C8          		 RET Z	;
275)   8DDB B7          		 OR A  ;CLEAR CARRY	;CLEAR CARRY
276)   8DDC C9          		 RET	;
278)   8DDD E1          		DC_WSERR: POP HL	;
279)   8DDE 37          		 SCF	;
280)   8DDF C9          		 RET  	;
282)   8DE0 C9          		STRG_TPFILE: RET	;
283)   8DE1 C9          		STRG_GETPOS: RET	;
287)   8DE2 D5          		STRG_SETPOS16: PUSH DE	;
288)   8DE3 11 00 00    		 LD DE,0	;
289)   8DE6 CD EB 8D    		 CALL STRG_SETPOS 	;
290)   8DE9 D1          		 POP DE	;
291)   8DEA C9          		 RET	;
293)   8DEB 3E 39       		STRG_SETPOS: LD A,CMD_BYTE_LOCATE	;
294)   8DED CD 70 92    		 CALL CH376_COMMD	;
295)   8DF0 79          		 LD A,C                             ; 4 BYTES TO SET THE OFFSET LOW IN FRONT	; 4 BYTES TO SET THE OFFSET LOW IN FRONT
296)   8DF1 CD 74 92    		     CALL CH376_DATAWR	;
297)   8DF4 78          		 LD A,B	;
298)   8DF5 CD 74 92    		 CALL CH376_DATAWR	;
299)   8DF8 7B          		 LD A,E	;
300)   8DF9 CD 74 92    		 CALL CH376_DATAWR            ;LAST 2 BYTES 0 MAX 65535 SKIP	;LAST 2 BYTES 0 MAX 65535 SKIP
301)   8DFC 7A          		 LD A,D	;
302)   8DFD CD 74 92    		 CALL CH376_DATAWR	;
303)   8E00 CD 01 92    		     CALL CH376_WTCMDEND	;
304)   8E03 C9          		 RET	;
307)   8E04 C9          		STRG_GETSIZE: RET	;
308)   8E05 C9          		STRG_GETEOF: RET	;
315)   8E06 3E 27       		STRG_PRDRVINFO: LD A,CMD_RDUSB_DATA0	;
316)   8E08 CD 70 92    		 CALL CH376_COMMD	;
317)   8E0B CD AF 91    		 CALL CH376_GETDATA	;
318)   8E0E F5          		 PUSH AF	;
319)   8E0F D6 08       		 SUB 8  	;
320)   8E11 47          		 LD B,A	;
321)   8E12 F1          		 POP AF   	;
322)   8E13 21 8B 00    		 LD HL,USBBUF+8  ;SKIP 8 BYTES	;SKIP 8 BYTES
323)   8E16 7E          		PDI_NXT: LD A,(HL)	;
324)   8E17 E5          		 PUSH HL	;
325)   8E18 C5          		 PUSH BC	;
326)   8E19 CD 16 80    		 CALL OS_PRINTCHAR	;
327)   8E1C C1          		 POP BC	;
328)   8E1D E1          		 POP HL	;
329)   8E1E 23          		 INC HL	;
330)   8E1F 10 F5       		 DJNZ PDI_NXT  	;
331)   8E21 CD 7C 8C    		 CALL RS_NEWLINE	;
333)   8E24 3E 3F       		 LD A,CMD_DISK_QUERY   	;
334)   8E26 CD 70 92    		 CALL CH376_COMMD	;
335)   8E29 CD 01 92    		 CALL CH376_WTCMDEND	;
336)   8E2C C0          		 RET NZ	;
337)   8E2D 3E 27       		 LD A,CMD_RDUSB_DATA0	;
338)   8E2F CD 70 92    		 CALL CH376_COMMD  	;
339)   8E32 CD AF 91    		 CALL CH376_GETDATA	;
341)   8E35 DD 21 83 00 		 LD IX,USBBUF 	;
342)   8E39 DD E5       		 PUSH IX   	;
343)   8E3B DD 56 03    		 LD D,(IX+3)	;
344)   8E3E DD 5E 02    		 LD E,(IX+2)	;
345)   8E41 DD 66 01    		 LD H,(IX+1)	;
346)   8E44 DD 6E 00    		 LD L,(IX+0)	;
347)   8E47 CD 8B 96    		 CALL B2D32    ;DE:HL RES ON B2DBUF	;DE:HL RES ON B2DBUF
348)   8E4A 21 CF 00    		 LD HL,B2DBUF	;
349)   8E4D CD 1B 97    		 CALL SKIPSPC	;
350)   8E50 CD 1A 80    		 CALL OS_PRINTTEXT	;
351)   8E53 CD 26 80    		 CALL OS_PRINTMSG	;
352)   8E56 20 53 45 43 		 DEFM " SECTORS"	;
352)   8E5A 54 4F 52 53 		 DEFM " SECTORS"	;
353)   8E5E 0A 0D 00    		 DB 10,13 0	;
354)   8E61 DD E1       		 POP IX	;
356)   8E63 DD E5       		 PUSH IX     	;
357)   8E65 DD 56 07    		 LD D,(IX+7)	;
358)   8E68 DD 5E 06    		 LD E,(IX+6)	;
359)   8E6B DD 66 05    		 LD H,(IX+5)	;
360)   8E6E DD 6E 04    		 LD L,(IX+4)  	;
361)   8E71 CD 8B 96    		 CALL B2D32  ;DE:HL RES ON B2DBUF	;DE:HL RES ON B2DBUF
362)   8E74 21 CF 00    		 LD HL,B2DBUF	;
363)   8E77 CD 1B 97    		 CALL SKIPSPC	;
364)   8E7A CD 1A 80    		 CALL OS_PRINTTEXT	;
365)   8E7D CD 26 80    		 CALL OS_PRINTMSG	;
366)   8E80 20 53 45 43 		 DEFM " SECTORS FREE   "	;
366)   8E84 54 4F 52 53 		 DEFM " SECTORS FREE   "	;
366)   8E88 20 46 52 45 		 DEFM " SECTORS FREE   "	;
366)   8E8C 45 20 20 20 		 DEFM " SECTORS FREE   "	;
367)   8E90 0A 0D 00    		 DB 10,13,0   	;
368)   8E93 DD E1       		 POP IX	;
370)   8E95 DD 7E 08    		FILESYSTEM: LD A,(IX+8) ;1-FAT12,2-FAT16,3-FAT32	;1-FAT12,2-FAT16,3-FAT32
371)   8E98 3D          		 DEC A	;
372)   8E99 28 08       		 JR Z,PDI_NXT0	;
373)   8E9B 3D          		 DEC A	;
374)   8E9C 28 18       		 JR Z,PDI_NXT1	;
375)   8E9E 3D          		 DEC A	;
376)   8E9F 28 28       		 JR Z,PDI_NXT2	;
377)   8EA1 18 39       		 JR PDI_NXT3	;
379)   8EA3 CD 26 80    		PDI_NXT0: CALL OS_PRINTMSG	;
380)   8EA6 46 53 20 49 		 DEFM "FS IS FAT-12"	;
380)   8EAA 53 20 46 41 		 DEFM "FS IS FAT-12"	;
380)   8EAE 54 2D 31 32 		 DEFM "FS IS FAT-12"	;
381)   8EB2 0A 0D 00    		 DB 10,13,0	;
382)   8EB5 C9          		 RET	;
383)   8EB6 CD 26 80    		PDI_NXT1: CALL OS_PRINTMSG	;
384)   8EB9 46 53 20 49 		 DEFM "FS IS FAT-16"	;
384)   8EBD 53 20 46 41 		 DEFM "FS IS FAT-16"	;
384)   8EC1 54 2D 31 36 		 DEFM "FS IS FAT-16"	;
385)   8EC5 0A 0D 00    		 DB 10,13,0	;
386)   8EC8 C9          		 RET	;
387)   8EC9 CD 26 80    		PDI_NXT2: CALL OS_PRINTMSG	;
388)   8ECC 46 53 20 49 		 DEFM "FS IS FAT-32"	;
388)   8ED0 53 20 46 41 		 DEFM "FS IS FAT-32"	;
388)   8ED4 54 2D 33 32 		 DEFM "FS IS FAT-32"	;
389)   8ED8 0A 0D 00    		 DB 10,13,0	;
390)   8EDB C9          		 RET	;
391)   8EDC CD 26 80    		PDI_NXT3: CALL OS_PRINTMSG	;
392)   8EDF 55 4E 4B 4E 		 DEFM "UNKNOWN FS"	;
392)   8EE3 4F 57 4E 20 		 DEFM "UNKNOWN FS"	;
392)   8EE7 46 53       		 DEFM "UNKNOWN FS"	;
393)   8EE9 0A 0D 00    		 DB 10,13,0	;
394)   8EEC DD 7E 08    		 LD A,(IX+8)  ;TO BE PRINTED MAYBE	;TO BE PRINTED MAYBE
395)   8EEF C9          		 RET	;
400)   8EF0 F5          		STRG_OPNFILE: PUSH AF	;
401)   8EF1 3E 2F       		 LD A, CMD_SETFILENAME	;
402)   8EF3 CD 70 92    		     CALL CH376_COMMD	;
403)   8EF6 21 83 00    		 LD HL, STRGBUFF	;
404)   8EF9 CD 25 93    		     CALL CH376_WRSTRING	;
405)   8EFC 28 1E       		 JR Z,OF_WSOK	;
406)   8EFE F1          		 POP AF	;
407)   8EFF CD 26 80    		 CALL OS_PRINTMSG	;
408)   8F02 45 52 52 4F 		 DEFM "ERROR SETTING FILENAME"	;
408)   8F06 52 20 53 45 		 DEFM "ERROR SETTING FILENAME"	;
408)   8F0A 54 54 49 4E 		 DEFM "ERROR SETTING FILENAME"	;
408)   8F0E 47 20 46 49 		 DEFM "ERROR SETTING FILENAME"	;
408)   8F12 4C 45 4E 41 		 DEFM "ERROR SETTING FILENAME"	;
408)   8F16 4D 45       		 DEFM "ERROR SETTING FILENAME"	;
409)   8F18 0A 0D 00    		 DB 10,13,0  	;
410)   8F1B C9          		 RET	;
411)   8F1C F1          		OF_WSOK: POP AF	;
415)   8F1D B7          		 OR A  ;0 READ	;0 READ
416)   8F1E 28 0C       		 JR Z,OF_OPEN	;
417)   8F20 D6 01       		 SUB 1  ;1 WRITE	;1 WRITE
418)   8F22 28 08       		 JR Z,OF_OPEN	;
419)   8F24 D6 01       		 SUB 1  ;2 READ/WRITE	;2 READ/WRITE
420)   8F26 28 04       		 JR Z,OF_OPEN	;
430)   8F28 3E 34       		 LD A, CMD_FILE_CREATE  	;
431)   8F2A 18 02       		 JR OF_EXEC	;
436)   8F2C 3E 32       		 LD A, CMD_FILE_OPEN	;
440)   8F2E CD 70 92    		 CALL CH376_COMMD	;
441)   8F31 CD 01 92    		 CALL CH376_WTCMDEND	;
442)   8F34 C9          		 RET	;
444)   8F35 3E 36       		STRG_CLSFILE: LD A, CMD_FILE_CLOSE	;
445)   8F37 CD 70 92    		     CALL CH376_COMMD	;
446)   8F3A 3E 01       		     LD A, 1                             ; 1 = update file size if necessary	; 1 = update file size if necessary
447)   8F3C CD 74 92    		     CALL CH376_DATAWR	;
448)   8F3F CD 01 92    		     CALL CH376_WTCMDEND	;
449)   8F42 C9          		     RET	;
455)   8F43 D5          		STRG_BLKREAD: PUSH DE	;
456)   8F44 3E 3A       		 LD A, CMD_BYTE_READ	;
457)   8F46 CD 70 92    		     CALL CH376_COMMD	;
458)   8F49 79          		     LD A, C                           ; BYTES REQUEST ON BC	; BYTES REQUEST ON BC
459)   8F4A CD 74 92    		     CALL CH376_DATAWR	;
460)   8F4D 78          		     LD A, B	;
461)   8F4E CD 74 92    		     CALL CH376_DATAWR	;
462)   8F51 2F          		 CPL	;
463)   8F52 2F          		 CPL    	;
467)   8F53 D1          		 POP DE	;
468)   8F54 21 00 00    		 LD HL,0      ;BYTE RECEIVE COUNTER	;BYTE RECEIVE COUNTER
469)   8F57 E5          		STBR_DOREST: PUSH HL	;
470)   8F58 D5          		 PUSH DE	;
471)   8F59 CD 01 92    		 CALL CH376_WTCMDEND	;
472)   8F5C D1          		 POP DE	;
473)   8F5D E1          		 POP HL	;
474)   8F5E 28 1C       		 JR Z, FR_DONE   ;Z=NO MORE OR CANNOT READ	;Z=NO MORE OR CANNOT READ
475)   8F60 FE 1D       		 CP USB_INT_DISK_READ                    	;
476)   8F62 20 1C       		     JR NZ, FR_ERROR	;
478)   8F64 3E 27       		 LD A,CMD_RDUSB_DATA0	;
479)   8F66 CD 70 92    		 CALL CH376_COMMD 	;
480)   8F69 CD 83 92    		 CALL CH376_DATARD  ;A= BYTES TO READ TO BUFFER	;A= BYTES TO READ TO BUFFER
481)   8F6C 47          		 LD B,A	;
494)   8F6D CD 83 92    		STBR_NXT1: CALL CH376_DATARD ;READ THE BYTES TO BUFFER	;READ THE BYTES TO BUFFER
495)   8F70 12          		 LD (DE),A	;
496)   8F71 13          		 INC DE	;
497)   8F72 23          		 INC HL    ;TOTAL BYTES READ COUNTER	;TOTAL BYTES READ COUNTER
498)   8F73 10 F8       		 DJNZ STBR_NXT1  	;
499)   8F75 3E 3B       		 LD A, CMD_BYTE_RD_GO 	;
500)   8F77 CD 70 92    		 CALL CH376_COMMD 	;
501)   8F7A 18 DB       		 JR STBR_DOREST	;
507)   8F7C 44          		 LD B,H	;
508)   8F7D 4D          		 LD C,L	;
509)   8F7E AF          		 XOR A	;
510)   8F7F C9          		 RET	;
511)   8F80 F5          		FR_ERROR: PUSH AF	;
512)   8F81 CD 14 98    		 CALL PRINTNUM	;
513)   8F84 CD 26 80    		 CALL OS_PRINTMSG	;
514)   8F87 45 52 52 4F 		 DEFM "ERROR READING BLOCK!!! "	;
514)   8F8B 52 20 52 45 		 DEFM "ERROR READING BLOCK!!! "	;
514)   8F8F 41 44 49 4E 		 DEFM "ERROR READING BLOCK!!! "	;
514)   8F93 47 20 42 4C 		 DEFM "ERROR READING BLOCK!!! "	;
514)   8F97 4F 43 4B 21 		 DEFM "ERROR READING BLOCK!!! "	;
514)   8F9B 21 21 20    		 DEFM "ERROR READING BLOCK!!! "	;
515)   8F9E 00          		 DB 0 	;
516)   8F9F F1          		 POP AF	;
517)   8FA0 06 02       		 LD B,2	;
518)   8FA2 05          		 DEC B	;
519)   8FA3 C9          		 RET  	;
526)   8FA4 D5          		STRG_LOADFILE: PUSH DE	;
527)   8FA5 C5          		 PUSH BC	;
533)   8FA6 CD 49 98    		 CALL COPYFNAME	;
534)   8FA9 AF          		 XOR A   ;READ ONLY 	;READ ONLY
535)   8FAA CD F0 8E    		 CALL STRG_OPNFILE  	;
536)   8FAD 20 4B       		 JR NZ, FOPENERR	;
541)   8FAF C1          		 POP BC  ;BYTECOUNT	;BYTECOUNT
542)   8FB0 D1          		 POP DE  ;DEST BUFFER	;DEST BUFFER
543)   8FB1 CD 43 8F    		 CALL STRG_BLKREAD	;
544)   8FB4 28 20       		 JR Z, FREADOK	;
545)   8FB6 CD 14 98    		 CALL PRINTNUM	;
546)   8FB9 CD 26 80    		 CALL OS_PRINTMSG	;
547)   8FBC 20 45 52 52 		 DEFM " ERROR READING FILE"	;
547)   8FC0 4F 52 20 52 		 DEFM " ERROR READING FILE"	;
547)   8FC4 45 41 44 49 		 DEFM " ERROR READING FILE"	;
547)   8FC8 4E 47 20 46 		 DEFM " ERROR READING FILE"	;
547)   8FCC 49 4C 45    		 DEFM " ERROR READING FILE"	;
548)   8FCF 0A 0D 00    		 DB 10,13,0	;
549)   8FD2 D5          		 PUSH DE	;
550)   8FD3 C5          		 PUSH BC	;
551)   8FD4 18 24       		 JR FOPENERR	;
552)   8FD6 C5          		FREADOK: PUSH BC	;
553)   8FD7 CD 87 96    		 CALL B2D16	;
554)   8FDA 21 CF 00    		 LD HL,B2DBUF	;
555)   8FDD CD 1B 97    		 CALL SKIPSPC	;
556)   8FE0 CD 1C 8C    		 CALL RS_TXT	;
557)   8FE3 CD 26 80    		 CALL OS_PRINTMSG	;
558)   8FE6 20 42 59 54 		 DEFM " BYTES READ"	;
558)   8FEA 45 53 20 52 		 DEFM " BYTES READ"	;
558)   8FEE 45 41 44    		 DEFM " BYTES READ"	;
559)   8FF1 0A 0D 00    		 DB 10,13,0	;
560)   8FF4 CD 35 8F    		 CALL STRG_CLSFILE	;
561)   8FF7 C1          		 POP BC   ;BYTES LOADED TO BUFFER	;BYTES LOADED TO BUFFER
562)   8FF8 AF          		 XOR A	;
563)   8FF9 C9          		 RET	;
564)   8FFA C1          		FOPENERR: POP BC	;
565)   8FFB D1          		 POP DE	;
566)   8FFC CD 14 98    		 CALL PRINTNUM	;
567)   8FFF CD 26 80    		 CALL OS_PRINTMSG	;
568)   9002 2D 2D 3E 45 		 DEFM "-->ERROR AT LOADFILE"	;
568)   9006 52 52 4F 52 		 DEFM "-->ERROR AT LOADFILE"	;
568)   900A 20 41 54 20 		 DEFM "-->ERROR AT LOADFILE"	;
568)   900E 4C 4F 41 44 		 DEFM "-->ERROR AT LOADFILE"	;
568)   9012 46 49 4C 45 		 DEFM "-->ERROR AT LOADFILE"	;
569)   9016 0A 0D 00    		 DB 10,13,0	;
570)   9019 21 83 00    		 LD HL,STRGBUFF	;
571)   901C CD 1C 8C    		 CALL RS_TXT	;
572)   901F CD 7C 8C    		 CALL RS_NEWLINE	;
573)   9022 37          		 SCF	;
574)   9023 C9          		 RET	;
582)   9024 D5          		STRG_READBUFR: PUSH DE	;
583)   9025 C5          		 PUSH BC	;
589)   9026 CD 49 98    		 CALL COPYFNAME	;
590)   9029 AF          		 XOR A   ;READ ONLY 	;READ ONLY
591)   902A CD F0 8E    		 CALL STRG_OPNFILE  	;
592)   902D 20 32       		 JR NZ, RB_FOPENERR	;
597)   902F C1          		 POP BC  ;BYTE OFFSET	;BYTE OFFSET
598)   9030 CD E2 8D    		 CALL STRG_SETPOS16	;
599)   9033 01 F4 01    		 LD BC, 500 ;READ 500 BYTES  	;READ 500 BYTES
600)   9036 D1          		 POP DE  ;DEST BUFFER	;DEST BUFFER
601)   9037 CD 43 8F    		 CALL STRG_BLKREAD	;
602)   903A 28 1E       		 JR Z, RB_FREADOK	;
603)   903C CD 14 98    		 CALL PRINTNUM	;
604)   903F CD 26 80    		 CALL OS_PRINTMSG	;
605)   9042 20 45 52 52 		 DEFM " ERROR READING FILE"	;
605)   9046 4F 52 20 52 		 DEFM " ERROR READING FILE"	;
605)   904A 45 41 44 49 		 DEFM " ERROR READING FILE"	;
605)   904E 4E 47 20 46 		 DEFM " ERROR READING FILE"	;
605)   9052 49 4C 45    		 DEFM " ERROR READING FILE"	;
606)   9055 0A 0D 00    		 DB 10,13,0	;
607)   9058 18 09       		 JR RB_FOPENERR2	;
608)   905A C5          		RB_FREADOK: PUSH BC	;
616)   905B CD 35 8F    		 CALL STRG_CLSFILE	;
617)   905E C1          		 POP BC   ;BYTES LOADED TO BUFFER	;BYTES LOADED TO BUFFER
618)   905F AF          		 XOR A	;
619)   9060 C9          		 RET	;
620)   9061 C1          		RB_FOPENERR: POP BC	;
621)   9062 D1          		 POP DE	;
622)   9063 CD 14 98    		RB_FOPENERR2: CALL PRINTNUM	;
623)   9066 CD 26 80    		 CALL OS_PRINTMSG	;
624)   9069 2D 2D 3E 45 		 DEFM "-->ERROR OPENING FILE"	;
624)   906D 52 52 4F 52 		 DEFM "-->ERROR OPENING FILE"	;
624)   9071 20 4F 50 45 		 DEFM "-->ERROR OPENING FILE"	;
624)   9075 4E 49 4E 47 		 DEFM "-->ERROR OPENING FILE"	;
624)   9079 20 46 49 4C 		 DEFM "-->ERROR OPENING FILE"	;
624)   907D 45          		 DEFM "-->ERROR OPENING FILE"	;
625)   907E 0A 0D 00    		 DB 10,13,0	;
626)   9081 21 83 00    		 LD HL,STRGBUFF	;
627)   9084 CD 1C 8C    		 CALL RS_TXT	;
628)   9087 CD 7C 8C    		 CALL RS_NEWLINE	;
629)   908A 37          		 SCF	;
630)   908B C9          		 RET	;
635)   908C D5          		STRG_BLKWRITE: PUSH DE	;
636)   908D 3E 3C       		 LD A, CMD_BYTE_WRITE	;
637)   908F CD 70 92    		     CALL CH376_COMMD	;
638)   9092 79          		     LD A, C                           ; BYTES REQUEST ON BC	; BYTES REQUEST ON BC
639)   9093 CD 74 92    		     CALL CH376_DATAWR	;
640)   9096 78          		     LD A, B	;
641)   9097 CD 74 92    		     CALL CH376_DATAWR    	;
645)   909A E1          		 POP HL	;
646)   909B CD 01 92    		STBW_DOREST: CALL CH376_WTCMDEND 	;
647)   909E 28 1B       		 JR Z, WFR_DONE   ;Z=NO MORE OR CANNOT READ	;Z=NO MORE OR CANNOT READ
648)   90A0 FE 1E       		 CP USB_INT_DISK_WRITE                    	;
649)   90A2 20 19       		     JR NZ, WFR_ERROR	;
650)   90A4 3E 2D       		 LD A,CMD_WR_REQ_DATA	;
651)   90A6 CD 70 92    		 CALL CH376_COMMD 	;
653)   90A9 CD 83 92    		 CALL CH376_DATARD ;READ BYTE COUNT UP TO 255 BYTES	;READ BYTE COUNT UP TO 255 BYTES
654)   90AC 47          		 LD B,A   	;
656)   90AD 7E          		STBW_NXT1: LD A,(HL)	;
657)   90AE CD 74 92    		 CALL CH376_DATAWR	;
658)   90B1 23          		 INC HL	;
659)   90B2 10 F9       		 DJNZ STBW_NXT1	;
660)   90B4 3E 3D       		 LD A, CMD_BYTE_WR_GO 	;
661)   90B6 CD 70 92    		 CALL CH376_COMMD 	;
662)   90B9 18 E0       		 JR STBW_DOREST	;
668)   90BB B7          		 OR A	;
669)   90BC C9          		 RET	;
670)   90BD F5          		WFR_ERROR: PUSH AF	;
671)   90BE CD 14 98    		 CALL PRINTNUM	;
672)   90C1 CD 26 80    		 CALL OS_PRINTMSG	;
673)   90C4 45 52 52 4F 		 DEFM "ERROR WRITING BLOCK!!! "	;
673)   90C8 52 20 57 52 		 DEFM "ERROR WRITING BLOCK!!! "	;
673)   90CC 49 54 49 4E 		 DEFM "ERROR WRITING BLOCK!!! "	;
673)   90D0 47 20 42 4C 		 DEFM "ERROR WRITING BLOCK!!! "	;
673)   90D4 4F 43 4B 21 		 DEFM "ERROR WRITING BLOCK!!! "	;
673)   90D8 21 21 20    		 DEFM "ERROR WRITING BLOCK!!! "	;
674)   90DB 0D 0A 00    		 DB 13,10,0 	;
675)   90DE F1          		 POP AF	;
676)   90DF 06 02       		 LD B,2	;
677)   90E1 05          		 DEC B	;
678)   90E2 C9          		 RET  	;
686)   90E3 D5          		STRG_SAVEFILE: PUSH DE	;
687)   90E4 C5          		 PUSH BC	;
688)   90E5 E5          		 PUSH HL  	;
689)   90E6 CD 26 80    		 CALL OS_PRINTMSG	;
690)   90E9 0A 0D       		 DB 10,13	;
691)   90EB 53 41 56 45 		 DEFM "SAVE FILE"	;
691)   90EF 20 46 49 4C 		 DEFM "SAVE FILE"	;
691)   90F3 45          		 DEFM "SAVE FILE"	;
692)   90F4 0A 0D 0A 0D 		 DB 10,13,10,13,0	;
692)   90F8 00          		 DB 10,13,10,13,0	;
693)   90F9 E1          		 POP HL	;
694)   90FA CD 49 98    		 CALL COPYFNAME	;
695)   90FD 3E 04       		 LD A,4   ;CREATE THE FILE	;CREATE THE FILE
696)   90FF CD F0 8E    		 CALL STRG_OPNFILE  	;
697)   9102 20 4E       		 JR NZ, FSAVEERR	;
698)   9104 CD 26 80    		 CALL OS_PRINTMSG	;
699)   9107 0A 0D       		 DB 10,13	;
700)   9109 46 49 4C 45 		 DEFM "FILE CREATED OK"	;
700)   910D 20 43 52 45 		 DEFM "FILE CREATED OK"	;
700)   9111 41 54 45 44 		 DEFM "FILE CREATED OK"	;
700)   9115 20 4F 4B    		 DEFM "FILE CREATED OK"	;
701)   9118 0A 0D 00    		 DB 10,13,0	;
702)   911B C1          		 POP BC  ;BYTECOUNT	;BYTECOUNT
703)   911C D1          		 POP DE  ;SOURCE BUFFER	;SOURCE BUFFER
704)   911D CD 8C 90    		 CALL STRG_BLKWRITE	;
705)   9120 28 19       		 JR Z, FWRITEOK	;
707)   9122 CD 26 80    		 CALL OS_PRINTMSG	;
708)   9125 20 45 52 52 		 DEFM " ERROR WRITING FILE"	;
708)   9129 4F 52 20 57 		 DEFM " ERROR WRITING FILE"	;
708)   912D 52 49 54 49 		 DEFM " ERROR WRITING FILE"	;
708)   9131 4E 47 20 46 		 DEFM " ERROR WRITING FILE"	;
708)   9135 49 4C 45    		 DEFM " ERROR WRITING FILE"	;
709)   9138 0A 0D 00    		 DB 10,13,0	;
710)   913B CD 26 80    		FWRITEOK: CALL OS_PRINTMSG	;
711)   913E 42 59 54 45 		 DEFM "BYTE WRITTEN"	;
711)   9142 20 57 52 49 		 DEFM "BYTE WRITTEN"	;
711)   9146 54 54 45 4E 		 DEFM "BYTE WRITTEN"	;
712)   914A 0A 0D 00    		 DB 10,13,0	;
713)   914D CD 35 8F    		 CALL STRG_CLSFILE	;
714)   9150 AF          		 XOR A	;
715)   9151 C9          		 RET	;
716)   9152 C1          		FSAVEERR: POP BC	;
717)   9153 D1          		 POP DE	;
718)   9154 CD 14 98    		 CALL PRINTNUM	;
719)   9157 CD 26 80    		 CALL OS_PRINTMSG	;
720)   915A 2D 2D 3E 45 		 DEFM "-->ERROR CREATING FILE"	;
720)   915E 52 52 4F 52 		 DEFM "-->ERROR CREATING FILE"	;
720)   9162 20 43 52 45 		 DEFM "-->ERROR CREATING FILE"	;
720)   9166 41 54 49 4E 		 DEFM "-->ERROR CREATING FILE"	;
720)   916A 47 20 46 49 		 DEFM "-->ERROR CREATING FILE"	;
720)   916E 4C 45       		 DEFM "-->ERROR CREATING FILE"	;
721)   9170 0A 0D 00    		 DB 10,13,0	;
722)   9173 21 83 00    		 LD HL,STRGBUFF	;
723)   9176 CD 1C 8C    		 CALL RS_TXT	;
724)   9179 CD 7C 8C    		 CALL RS_NEWLINE	;
725)   917C 37          		 SCF	;
726)   917D C9          		 RET	;
736)   917E C5          		STRG_WRITEBUFR: PUSH BC	;
737)   917F D5          		 PUSH DE	;
738)   9180 CD 49 98    		 CALL COPYFNAME   ;HL NOT NEEDED AFTER THIS	;HL NOT NEEDED AFTER THIS
739)   9183 3E 01       		 LD A,1    ;OPEN THE FILE FOR W	;OPEN THE FILE FOR W
740)   9185 CD F0 8E    		 CALL STRG_OPNFILE  	;
741)   9188 20 0B       		 JR NZ,SWB_CREATE  ;ON ERROR TRY TO CREATE THE FILE	;ON ERROR TRY TO CREATE THE FILE
743)   918A 01 FF FF    		 LD BC,$FFFF	;
744)   918D 11 FF FF    		 LD DE,$FFFF 	;
745)   9190 CD EB 8D    		 CALL STRG_SETPOS  ;GOTO EOF	;GOTO EOF
746)   9193 18 09       		 JR SWB_WRITEBUF	;
748)   9195 3E 04       		 LD A,4	;
749)   9197 CD F0 8E    		 CALL STRG_OPNFILE  	;
750)   919A 3E 97       		 LD A,151   ;ERROR NUMBER	;ERROR NUMBER
751)   919C 20 0D       		 JR NZ, SWB_ERR	;
752)   919E D1          		SWB_WRITEBUF: POP DE	;
753)   919F C1          		 POP BC    ;THE BYTE COUNT  	;THE BYTE COUNT
754)   91A0 CD 8C 90    		 CALL STRG_BLKWRITE  	;
755)   91A3 F5          		 PUSH AF	;
756)   91A4 CD 35 8F    		 CALL STRG_CLSFILE  ;ALWAYS CLOSE FILE	;ALWAYS CLOSE FILE
757)   91A7 F1          		 POP AF	;
758)   91A8 C0          		 RET NZ    ;NZ IF ERROR	;NZ IF ERROR
759)   91A9 AF          		 XOR A	;
760)   91AA C9          		 RET	;
761)   91AB D1          		SWB_ERR: POP DE	;
762)   91AC C1          		 POP BC  	;
763)   91AD 37          		 SCF	;
764)   91AE C9          		 RET  	;
  3)   91AF 	            		INT376CMD EQU DEV376+1	;
  4)   91AF 	            		INT376DAT EQU DEV376	;
 90)   91AF CD 83 92    		CH376_GETDATA: CALL CH376_DATARD	;
 91)   91B2 FE 00       		 CP 0	;
 92)   91B4 C8          		 RET Z   ;NO DATA AVAILABLE	;NO DATA AVAILABLE
 99)   91B5 F5          		               PUSH AF	;
100)   91B6 11 83 00    		 LD DE,USBBUF	;
101)   91B9 47          		 LD B,A	;
102)   91BA CD 83 92    		UDC_NXT1: CALL CH376_DATARD	;
104)   91BD 12          		 LD (DE),A	;
105)   91BE 13          		 INC DE	;
109)   91BF 10 F9       		 DJNZ UDC_NXT1 	;
110)   91C1 F1          		               POP AF	;
111)   91C2 C9          		 RET	;
114)   91C3 F5          		DISKERROR: PUSH AF	;
115)   91C4 CD 26 8C    		 CALL RS_MESG	;
116)   91C7 46 41 54 41 		 DEFM "FATAL ERROR:" 	;
116)   91CB 4C 20 45 52 		 DEFM "FATAL ERROR:" 	;
116)   91CF 52 4F 52 3A 		 DEFM "FATAL ERROR:" 	;
117)   91D3 00          		 DB 0  	;
118)   91D4 F1          		 POP AF	;
119)   91D5 CD 14 98    		 CALL PRINTNUM	;
120)   91D8 21 E4 91    		 LD HL,ERR_PART	;
121)   91DB FE 92       		 CP ERR_TYPE_ERROR	;
122)   91DD 28 01       		 JR Z,PRNMES	;
123)   91DF C9          		 RET	;
124)   91E0 CD 1C 8C    		PRNMES: CALL RS_TXT 	;
125)   91E3 C9          		 RET	;
127)   91E4 50 41 52 54 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91E8 49 54 49 4F 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91EC 4E 2E 4E 4F 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91F0 54 2E 53 55 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91F4 50 50 4F 52 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91F8 54 45 44 21 		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
127)   91FC 21 21       		ERR_PART DEFM "PARTITION NOT SUPPORTED!!!"	;
128)   91FE 0A 0D 00    		 DB 10,13,0	;
138)   9201 E5          		CH376_WTCMDEND: PUSH HL	;
139)   9202 CD 0F 92    		 CALL CH376_WAITINT	;
140)   9205 E1          		 POP HL	;
141)   9206 C0          		               RET NZ	;
142)   9207 D8          		 RET C	;
143)   9208 AF          		 XOR A	;
144)   9209 CD 2E 92    		 CALL CH376_GETSTAT	;
145)   920C FE 14       		 CP USB_INT_SUCCESS  	;
146)   920E C9          		 RET  ;NZ FLAG MEANS ERROR USUALLY	;NZ FLAG MEANS ERROR USUALLY
152)   920F AF          		CH376_WAITINT: XOR A	;
153)   9210 01 32 00    		 LD BC,50	;
154)   9213 CD 80 92    		C3AGN2: CALL CH376_INSTAT	;
155)   9216 CB 7F       		 BIT 7,A	;
156)   9218 C8          		 RET Z	;
157)   9219 F5          		 PUSH AF	;
158)   921A C5          		 PUSH BC	;
159)   921B 06 14       		 LD B,20	;
160)   921D CD AF 95    		 CALL DELAYMICRO	;
161)   9220 C1          		 POP BC	;
162)   9221 F1          		 POP AF	;
163)   9222 0B          		 DEC BC	;
164)   9223 5F          		 LD E,A	;
165)   9224 78          		 LD A,B	;
166)   9225 B1          		 OR C	;
167)   9226 7B          		 LD A,E	;
168)   9227 20 EA       		 JR NZ, C3AGN2  	;
173)   9229 37          		 SCF ;TIMEOUT       	;TIMEOUT
174)   922A 06 02       		 LD B,2	;
175)   922C 05          		 DEC B  ;NZ FLAG	;NZ FLAG
176)   922D C9          		 RET	;
178)   922E 3E 22       		CH376_GETSTAT: LD A,CMD_GET_STATUS	;
179)   9230 CD 70 92    		 CALL CH376_COMMD	;
180)   9233 CD 83 92    		 CALL CH376_DATARD	;
181)   9236 C9          		 RET	;
189)   9237 01 C4 09    		CH376_CHOK: LD BC,2500	;
190)   923A CD 80 92    		C3AGN: CALL CH376_INSTAT	;
191)   923D CB 67       		 BIT 4,A   ;CHECK BUSY	;CHECK BUSY
192)   923F C8          		 RET Z   	;
193)   9240 C5          		 PUSH BC	;
194)   9241 F5          		 PUSH AF	;
195)   9242 06 32       		 LD B,50	;
196)   9244 CD AF 95    		 CALL DELAYMICRO	;
197)   9247 F1          		 POP AF	;
198)   9248 C1          		 POP BC	;
199)   9249 0B          		 DEC BC	;
200)   924A 5F          		 LD E,A	;
201)   924B 78          		 LD A,B	;
202)   924C B1          		 OR C	;
203)   924D 7B          		 LD A,E	;
204)   924E 20 EA       		 JR NZ,C3AGN	;
205)   9250 F5          		 PUSH AF  	;
206)   9251 CD 14 98    		 CALL PRINTNUM  	;
207)   9254 F1          		 POP AF	;
208)   9255 CD 26 8C    		 CALL RS_MESG	;
209)   9258 2A 2A 2A 43 		 DEFM "***CMD TIMEOUT***"	;
209)   925C 4D 44 20 54 		 DEFM "***CMD TIMEOUT***"	;
209)   9260 49 4D 45 4F 		 DEFM "***CMD TIMEOUT***"	;
209)   9264 55 54 2A 2A 		 DEFM "***CMD TIMEOUT***"	;
209)   9268 2A          		 DEFM "***CMD TIMEOUT***"	;
210)   9269 0A 0D 00    		 DB 10,13,0       	;
211)   926C 06 02       		 LD B,2	;
212)   926E 05          		 DEC B  ;NZ FLAG	;NZ FLAG
213)   926F C9          		 RET	;
219)   9270 D3 31       		CH376_COMMD: OUT (INT376CMD),A	;
220)   9272 18 02       		 JR C3D_CONT	;
223)   9274 D3 30       		CH376_DATAWR: OUT (INT376DAT),A 	;
224)   9276 C5          		C3D_CONT: PUSH BC	;
225)   9277 D5          		 PUSH DE	;
226)   9278 E5          		 PUSH HL	;
227)   9279 CD 37 92    		 CALL CH376_CHOK  ;CHECK NOT BUSY	;CHECK NOT BUSY
228)   927C E1          		 POP HL	;
229)   927D D1          		 POP DE	;
230)   927E C1          		 POP BC	;
231)   927F C9          		 RET	;
233)   9280 DB 31       		CH376_INSTAT: IN A,(INT376CMD)	;
235)   9282 C9          		 RET	;
238)   9283 DB 30       		CH376_DATARD: IN A,(INT376DAT)	;
243)   9285 C9          		 RET	;
246)   9286 3E 01       		CH376_VERSION: LD A,CMD_GET_IC_VER 	;
247)   9288 CD 70 92    		 CALL CH376_COMMD	;
248)   928B CD 83 92    		 CALL CH376_DATARD	;
249)   928E E6 0F       		 AND 00001111B	;
250)   9290 C9          		               RET	;
252)   9291 3E 05       		CH376_INIT:    LD A,CMD_RESET_ALL	;
253)   9293 CD 70 92    		 CALL CH376_COMMD  	;
254)   9296 3E 06       		 LD A,CMD_CHECK_EXIST 	;
255)   9298 CD 70 92    		 CALL CH376_COMMD	;
256)   929B 3E 57       		 LD A,87	;
257)   929D CD 74 92    		 CALL CH376_DATAWR	;
258)   92A0 CD 83 92    		 CALL CH376_DATARD	;
259)   92A3 FE A8       		 CP 255 - 87 	;
260)   92A5 C9          		               RET               	;
264)   92A6 F5          		CH376_SETUSB: PUSH AF	;
265)   92A7 3E 15       		               LD A,CMD_SETUSB_MODE	;
266)   92A9 CD 70 92    		 CALL CH376_COMMD	;
267)   92AC F1          		               POP AF	;
268)   92AD CD 74 92    		 CALL CH376_DATAWR	;
270)   92B0 06 14       		 LD B,20	;
271)   92B2 CD AF 95    		 CALL DELAYMICRO     ;WAIT A BIT	;WAIT A BIT
276)   92B5 CD 2E 92    		 CALL CH376_GETSTAT	;
277)   92B8 FE 15       		 CP USB_INT_CONNECT	;
278)   92BA C8          		 RET Z	;
280)   92BB F5          		 PUSH AF	;
281)   92BC CD 26 8C    		 CALL CH376_ERROR	;
282)   92BF 45 52 52 3A 		 DEFM "ERR: SETUSBMODE"	;
282)   92C3 20 53 45 54 		 DEFM "ERR: SETUSBMODE"	;
282)   92C7 55 53 42 4D 		 DEFM "ERR: SETUSBMODE"	;
282)   92CB 4F 44 45    		 DEFM "ERR: SETUSBMODE"	;
283)   92CE 0A 0D 00    		 DB 10,13,0	;
284)   92D1 F1          		 POP AF	;
285)   92D2 CD 14 98    		 CALL PRINTNUM	;
286)   92D5 C9          		               RET	;
291)   92D6 3E 30       		CH376_CONNECT: LD A, CMD_DISK_CONNECT	;
292)   92D8 CD 70 92    		     CALL CH376_COMMD	;
293)   92DB CD 01 92    		 CALL CH376_WTCMDEND	;
295)   92DE D8          		 RET C ;TIMEOUT	;TIMEOUT
296)   92DF C8          		 RET Z ;CONNECT OK	;CONNECT OK
301)   92E0 C9          		 RET ;NZ HERE	;NZ HERE
311)   92E1 3E 31       		CH376_MOUNT:   LD A,CMD_DISK_MOUNT  	;
312)   92E3 CD 70 92    		 CALL CH376_COMMD	;
313)   92E6 CD 01 92    		 CALL CH376_WTCMDEND  	;
314)   92E9 C9          		 RET	;
319)   92EA 06 0A       		CH376_MOUNTDEV:   LD B,10  ;TRY TO MOUNT 10 TIMES	;TRY TO MOUNT 10 TIMES
320)   92EC C5          		CM_AGN1: PUSH BC	;
321)   92ED CD A6 92    		 CALL CH376_SETUSB	;
322)   92F0 20 10       		 JR NZ,CM_ERROR	;
323)   92F2 CD D6 92    		 CALL CH376_CONNECT	;
324)   92F5 20 0B       		 JR NZ,CM_ERROR	;
325)   92F7 3E 31       		        LD A,CMD_DISK_MOUNT  	;
326)   92F9 CD 70 92    		 CALL CH376_COMMD	;
327)   92FC CD 01 92    		 CALL CH376_WTCMDEND	;
328)   92FF C1          		 POP BC	;
329)   9300 C8          		 RET Z	;
330)   9301 C5          		 PUSH BC	;
331)   9302 06 64       		CM_ERROR: LD B,100	;
332)   9304 CD C4 95    		 CALL DELAYMILI     ;WAIT A BIT	;WAIT A BIT
333)   9307 C1          		 POP BC	;
334)   9308 10 E2       		 DJNZ CM_AGN1  	;
335)   930A 06 02       		 LD B,2	;
336)   930C 05          		 DEC B  ;NZ  	;NZ
337)   930D F5          		 PUSH AF	;
338)   930E CD 26 8C    		 CALL CH376_ERROR	;
339)   9311 45 52 52 3A 		 DEFM "ERR: MOUNT DISK"	;
339)   9315 20 4D 4F 55 		 DEFM "ERR: MOUNT DISK"	;
339)   9319 4E 54 20 44 		 DEFM "ERR: MOUNT DISK"	;
339)   931D 49 53 4B    		 DEFM "ERR: MOUNT DISK"	;
340)   9320 0A 0D 00    		 DB 10,13,0	;
341)   9323 F1          		     POP AF	;
342)   9324 C9          		               RET	;
345)   9325 7E          		CH376_WRSTRING: LD A,(HL)	;
351)   9326 CD 74 92    		 CALL CH376_DATAWR	;
352)   9329 C0          		 RET NZ	;
353)   932A 7E          		 LD A,(HL)	;
354)   932B B7          		 OR A	;
355)   932C C8          		 RET Z	;
356)   932D 23          		 INC HL	;
357)   932E 18 F5       		 JR CH376_WRSTRING	;
  7)   9330 	            		 DI2C_STA EQU DEVI2C+0      ;00 A0=LOW A1=LOW READONLY  DEF $F8	;00 A0=LOW A1=LOW READONLY  DEF $F8
  8)   9330 	            		 DI2C_INDPTR EQU DEVI2C+0     ;00 A0=LOW A1=LOW WRITEONLY DEF $00	;00 A0=LOW A1=LOW WRITEONLY DEF $00
  9)   9330 	            		 DI2C_DAT EQU DEVI2C+1      ;01 A0=HIGH A1=LOW R/W   DEF $00	;01 A0=HIGH A1=LOW R/W   DEF $00
 10)   9330 	            		 DI2C_CON EQU DEVI2C+3      ;11 A0=HIGH A1=HIGH R/W  DEF $00	;11 A0=HIGH A1=HIGH R/W  DEF $00
 11)   9330 	            		 DI2C_INDIR EQU DEVI2C+2     ;10 A0=LOW A1=HIGH R/W  DEF $00	;10 A0=LOW A1=HIGH R/W  DEF $00
 56)   9330 C5          		I2C_RDSTAT_WT: PUSH BC	;
 57)   9331 01 00 20    		 LD BC, $2000	;
 58)   9334 DB 73       		I2CRWT_AGN: IN A, (DI2C_CON)      ;READ CONTROL REGISTER BIT 3 IS SI	;READ CONTROL REGISTER BIT 3 IS SI
 59)   9336 CB 5F       		 BIT 3, A        ;CHECK BIT 3 SI	;CHECK BIT 3 SI
 60)   9338 20 05       		 JR NZ, I2CRWT_OK       ;BIT 3 SHOULD BE SET IF VALID STATUS	;BIT 3 SHOULD BE SET IF VALID STATUS
 61)   933A 0B          		 DEC BC	;
 62)   933B 78          		 LD A, B	;
 63)   933C B1          		 OR C	;
 64)   933D 20 F5       		 JR NZ, I2CRWT_AGN	;
 65)   933F C1          		I2CRWT_OK: POP BC	;
 66)   9340 DB 70       		 IN A, (DI2C_STA)       ;VALID HERE	;VALID HERE
 67)   9342 C9          		 RET	;
 69)   9343 DB 73       		I2C_RDSTAT_NW: IN A, (DI2C_CON)      ;READ CONTROL REGISTER BIT 3 IS SI	;READ CONTROL REGISTER BIT 3 IS SI
 70)   9345 CB 5F       		 BIT 3, A        ;CHECK BIT 3 SI	;CHECK BIT 3 SI
 71)   9347 3E FF       		 LD A, $FF        ;$FF=INVALID STATUS	;$FF=INVALID STATUS
 72)   9349 C8          		 RET Z         ;BIT 3 SHOULD BE SET IF VALID STATUS	;BIT 3 SHOULD BE SET IF VALID STATUS
 73)   934A DB 70       		 IN A, (DI2C_STA)       ;VALID HERE	;VALID HERE
 74)   934C C9          		 RET	;
 77)   934D 3E 01       		I2C_INIT: LD A, I2CADR	;
 78)   934F D3 70       		 OUT (DI2C_INDPTR), A	;
 79)   9351 3E E0       		 LD A, $E0	;
 80)   9353 D3 72       		 OUT (DI2C_INDIR), A       ;SET MY SLAVE ADDR	;SET MY SLAVE ADDR
 82)   9355 3E 40       		 LD A, $40        ;INIT	;INIT
 83)   9357 D3 73       		 OUT (DI2C_CON), A      ;	;
 84)   9359 06 FA       		 LD B, 250	;
 85)   935B CD AF 95    		 CALL DELAYMICRO	;
 86)   935E 06 FA       		 LD B, 250	;
 87)   9360 CD AF 95    		 CALL DELAYMICRO       ;DELAY 500 MICROSECS	;DELAY 500 MICROSECS
 92)   9363 3E 06       		 LD A, I2CMODE	;
 93)   9365 D3 70       		 OUT (DI2C_INDPTR), A      ;SELECT I2CMODE REGISTER	;SELECT I2CMODE REGISTER
 94)   9367 3E 00       		 LD A, 0        ;SELECT MODE 0	;SELECT MODE 0
 95)   9369 D3 72       		 OUT (DI2C_INDIR), A	;
 96)   936B 3E 02       		 LD A, I2CSCLL	;
 97)   936D D3 70       		 OUT (DI2C_INDPTR), A      ;SELECT I2CMODE REGISTER	;SELECT I2CMODE REGISTER
 98)   936F 3E 9D       		 LD A, $9D        ;SELECT CLK L	;SELECT CLK L
 99)   9371 D3 72       		 OUT (DI2C_INDIR), A	;
100)   9373 3E 03       		 LD A, I2CSCLH	;
101)   9375 D3 70       		 OUT (DI2C_INDPTR), A      ;SELECT I2CMODE REGISTER	;SELECT I2CMODE REGISTER
102)   9377 3E 86       		 LD A, $86        ;SELECT CLK H	;SELECT CLK H
103)   9379 D3 72       		 OUT (DI2C_INDIR), A	;
105)   937B C9          		 RET	;
112)   937C 3E 60       		I2C_WR_BYTE: LD A, $60       ;START	;START
113)   937E D3 73       		 OUT (DI2C_CON), A	;
114)   9380 CD 30 93    		WRB_LP1: CALL I2C_RDSTAT_WT      ;WAIT FOR INTERRUPT SI=1	;WAIT FOR INTERRUPT SI=1
115)   9383 5F          		 LD E, A        ;SAVE STATUS	;SAVE STATUS
116)   9384 FE 08       		 CP MASTER_START_TXed      ;A HAS THE STATUS	;A HAS THE STATUS
117)   9386 28 21       		 JR Z, WRB_S1	;
118)   9388 FE 10       		 CP MASTER_RESTART_TXed	;
119)   938A 28 1D       		 JR Z, WRB_S1	;
120)   938C FE 28       		 CP MASTER_DATA_W_ACK	;
121)   938E 28 26       		 JR Z, WRB_S2	;
122)   9390 FE 18       		 CP MASTER_SLA_W_ACK	;
123)   9392 28 23       		 JR Z, WRB_S3	;
124)   9394 FE 20       		 CP MASTER_SLA_W_NAK	;
125)   9396 28 2D       		 JR Z, WRB_EXIT	;
126)   9398 FE 30       		 CP MASTER_DATA_W_NAK	;
127)   939A 28 29       		 JR Z, WRB_EXIT	;
128)   939C FE 38       		 CP MASTER_ARB_LOST	;
129)   939E C8          		 RET Z	;
130)   939F FE B0       		 CP SLAVE_AL_ADDRESSED_R	;
131)   93A1 C8          		 RET Z	;
132)   93A2 FE 68       		 CP SLAVE_AL_ADDRESSED_W	;
133)   93A4 C8          		 RET Z	;
134)   93A5 FE D8       		 CP SLAVE_GENERALCALL_AL	;
135)   93A7 C8          		 RET Z	;
136)   93A8 C9          		 RET	;
138)   93A9 7A          		WRB_S1: LD A, D        ;DEVICE ADDR	;DEVICE ADDR
139)   93AA CB 27       		 SLA A	;
140)   93AC E6 FE       		 AND $FE        ;ADDR+WRITE ON D0=0	;ADDR+WRITE ON D0=0
141)   93AE D3 71       		 OUT (DI2C_DAT), A	;
142)   93B0 3E 40       		 LD A, $40	;
143)   93B2 D3 73       		 OUT (DI2C_CON), A	;
144)   93B4 18 CA       		 JR WRB_LP1	;
145)   93B6 0B          		WRB_S2: DEC BC	;
146)   93B7 78          		WRB_S3: LD A, B	;
147)   93B8 B1          		 OR C	;
148)   93B9 28 0A       		 JR Z, WRB_EXIT	;
149)   93BB 7E          		 LD A, (HL)	;
150)   93BC 23          		 INC HL	;
151)   93BD D3 71       		 OUT (DI2C_DAT), A	;
152)   93BF 3E 40       		 LD A, $40	;
153)   93C1 D3 73       		 OUT (DI2C_CON), A	;
154)   93C3 18 BB       		 JR WRB_LP1	;
156)   93C5 3E 50       		WRB_EXIT: LD A, $50       ;STOP	;STOP
157)   93C7 D3 73       		 OUT (DI2C_CON), A	;
158)   93C9 78          		 LD A, B	;
159)   93CA B1          		 OR C	;
160)   93CB C9          		 RET         ;IF A NOT ZERO THEN ERROR	;IF A NOT ZERO THEN ERROR
166)   93CC 78          		I2C_RD_BYTE: LD A, B	;
167)   93CD B1          		 OR C	;
168)   93CE C8          		 RET Z        ;RETURN IF ZERO BYTE COUNT	;RETURN IF ZERO BYTE COUNT
169)   93CF 3E 60       		 LD A, $60	;
170)   93D1 D3 73       		 OUT (DI2C_CON), A	;
171)   93D3 CD 30 93    		RDB_LP1: CALL I2C_RDSTAT_WT      ;WAIT FOR INTERRUPT SI=1	;WAIT FOR INTERRUPT SI=1
172)   93D6 1E 00       		 LD E, 0	;
173)   93D8 FE 08       		 CP MASTER_START_TXed	;
174)   93DA 28 1F       		 JR Z, RDB_S1	;
176)   93DC 28 1D       		 JR Z, RDB_S1	;
177)   93DE FE 58       		 CP MASTER_DATA_R_NAK	;
178)   93E0 28 26       		 JR Z, RDB_S2	;
179)   93E2 FE 50       		 CP MASTER_DATA_R_ACK	;
180)   93E4 28 24       		 JR Z, RDB_S3	;
181)   93E6 FE 40       		 CP MASTER_SLA_R_ACK	;
182)   93E8 28 25       		 JR Z, RDB_S4	;
183)   93EA FE 48       		 CP MASTER_SLA_R_NAK	;
184)   93EC 28 38       		 JR Z, RDB_EXIT	;
185)   93EE FE 38       		 CP MASTER_ARB_LOST	;
186)   93F0 C8          		 RET Z	;
187)   93F1 FE B0       		 CP SLAVE_AL_ADDRESSED_R	;
188)   93F3 C8          		 RET Z	;
189)   93F4 FE 68       		 CP SLAVE_AL_ADDRESSED_W	;
190)   93F6 C8          		 RET Z	;
191)   93F7 FE D8       		 CP SLAVE_GENERALCALL_AL	;
192)   93F9 C8          		 RET Z	;
193)   93FA C9          		 RET	;
196)   93FB 7A          		RDB_S1: LD A, D        ;DEVICE ADDR	;DEVICE ADDR
197)   93FC CB 27       		 SLA A	;
198)   93FE F6 01       		 OR $01         ;ADDR + READ COMMAND	;ADDR + READ COMMAND
199)   9400 D3 71       		 OUT (DI2C_DAT), A	;
200)   9402 3E 40       		 LD A, $40	;
201)   9404 D3 73       		 OUT (DI2C_CON), A	;
202)   9406 18 CB       		 JR RDB_LP1	;
203)   9408 1E 01       		RDB_S2: LD E, 1        ;MEANS WE EXIT	;MEANS WE EXIT
204)   940A DB 71       		RDB_S3: IN A, (DI2C_DAT)       ;READ DATA	;READ DATA
205)   940C 77          		 LD (HL), A	;
206)   940D 23          		 INC HL	;
207)   940E 0B          		 DEC BC	;
208)   940F 78          		RDB_S4: LD A, B        ; IS LENGTH 0	; IS LENGTH 0
209)   9410 B1          		 OR C	;
210)   9411 28 13       		 JR Z, RDB_EXIT	;
211)   9413 7B          		 LD A, E	;
212)   9414 FE 01       		 CP 1	;
213)   9416 28 0E       		 JR Z, RDB_EXIT	;
214)   9418 78          		 LD A, B	;
215)   9419 81          		 ADD C	;
216)   941A FE 01       		 CP 1	;
217)   941C 3E 40       		 LD A, $40	;
218)   941E 28 02       		 JR Z, RDB_NXT1	;
219)   9420 3E C0       		 LD A, $C0	;
220)   9422 D3 73       		RDB_NXT1: OUT (DI2C_CON), A      ;WRITE $40 IF BYTE COUNT BC=1 ELSE WRITE $C0	;WRITE $40 IF BYTE COUNT BC=1 ELSE WRITE $C0
221)   9424 18 AD       		 JR RDB_LP1	;
223)   9426 3E 50       		RDB_EXIT: LD A, $50	;
224)   9428 D3 73       		 OUT (DI2C_CON), A	;
225)   942A 78          		 LD A, B	;
226)   942B B1          		 OR C	;
227)   942C C9          		 RET         ;IF A NOT ZERO THEN ERROR	;IF A NOT ZERO THEN ERROR
112)   942D 16 00       		LCD16_WR4BITS: LD D, 0       ;PIN MAP VALUES FRO 8574 BIT 0-7	;PIN MAP VALUES FRO 8574 BIT 0-7
114)   942F 0F          		 RRCA         ;D4 = D0,D5=D1,D6=D2,D7=D3	;D4 = D0,D5=D1,D6=D2,D7=D3
115)   9430 30 02       		 JR NC, LWNXT1        ;BIT 0 NOT SET JR	;BIT 0 NOT SET JR
116)   9432 CB E2       		 SET D4, D	;
117)   9434 0F          		LWNXT1: RRCA	;
118)   9435 30 02       		 JR NC, LWNXT2        ;BIT 1 NOT SET JR	;BIT 1 NOT SET JR
119)   9437 CB EA       		 SET D5, D	;
120)   9439 0F          		LWNXT2: RRCA	;
121)   943A 30 02       		 JR NC, LWNXT3        ;BIT 2 NOT SET JR	;BIT 2 NOT SET JR
122)   943C CB F2       		 SET D6, D	;
123)   943E 0F          		LWNXT3: RRCA	;
124)   943F 30 02       		 JR NC, LWNXT4        ;BIT 3 NOT SET JR	;BIT 3 NOT SET JR
125)   9441 CB FA       		 SET D7, D	;
126)   9443 7B          		LWNXT4: LD A, E	;
127)   9444 0F          		 RRCA	;
128)   9445 30 02       		 JR NC, LWNXT5	;
129)   9447 CB C2       		 SET RS, D	;
131)   9449 3A 81 00    		 LD A,(LCD_STSMASK)       ;ADD THE BACKLIGHT MASKS  	;ADD THE BACKLIGHT MASKS
132)   944C B2          		 OR D	;
133)   944D 57          		 LD D,A	;
135)   944E CB D2       		 SET EN, D        ;EN=HIGH	;EN=HIGH
136)   9450 7A          		 LD A, D	;
137)   9451 CD 5B 94    		 CALL LCD16_I2CSEND	;
138)   9454 CB 92       		 RES EN, D        ;EN=LOW	;EN=LOW
139)   9456 7A          		 LD A, D	;
140)   9457 CD 5B 94    		 CALL LCD16_I2CSEND	;
141)   945A C9          		 RET	;
145)   945B D5          		LCD16_I2CSEND: PUSH DE	;
146)   945C E5          		 PUSH HL	;
147)   945D 21 83 00    		 LD HL, BUFFER	;
148)   9460 77          		 LD (HL), A	;
149)   9461 16 27       		 LD D, LCDADDR	;
150)   9463 01 01 00    		 LD BC, 1	;
151)   9466 CD 7C 93    		 CALL I2C_WRITE	;
152)   9469 E1          		 POP HL	;
153)   946A D1          		 POP DE	;
154)   946B C9          		 RET	;
157)   946C 1E 00       		LCD16_COMMD: LD E, COMMAND	;
158)   946E 18 02       		 JR LCD16_SEND	;
161)   9470 1E 01       		LCD16_DATA: LD E, LCD_DATA 	;
164)   9472 57          		LCD16_SEND: LD D, A       ;SAVE A FOR LATER USE	;SAVE A FOR LATER USE
165)   9473 7B          		 LD A, E	;
166)   9474 0F          		 RRCA	;
167)   9475 38 07       		 JR C, ISCMDDATA	;
168)   9477 0F          		 RRCA	;
169)   9478 30 04       		 JR NC, ISCMDDATA	;
171)   947A 1E 00       		 LD E, COMMAND        ;SEND 4 BITS AS COMMAND E=0	;SEND 4 BITS AS COMMAND E=0
172)   947C 18 0E       		 JR LCSD_4BIT	;
173)   947E 7A          		ISCMDDATA: LD A, D	;
174)   947F CB 3F       		 SRL A	;
175)   9481 CB 3F       		 SRL A	;
176)   9483 CB 3F       		 SRL A	;
177)   9485 CB 3F       		 SRL A	;
178)   9487 D5          		 PUSH DE	;
179)   9488 CD 2D 94    		 CALL LCD16_WR4BITS      ;HIGH 4 BITS FIRST	;HIGH 4 BITS FIRST
180)   948B D1          		 POP DE	;
181)   948C 7A          		LCSD_4BIT: LD A, D	;
182)   948D E6 0F       		 AND $0F	;
183)   948F CD 2D 94    		 CALL LCD16_WR4BITS      ;LOW 4 BITS NEXT	;LOW 4 BITS NEXT
184)   9492 C9          		 RET	;
186)   9493 3E 03       		@LCD16_INIT: LD A, 3       ;SET LCD TO 4BIT MODE	;SET LCD TO 4BIT MODE
187)   9495 1E 02       		 LD E, FOUR_BITS	;
188)   9497 CD 72 94    		 CALL LCD16_SEND	;
189)   949A 01 00 30    		 LD BC, $3000	;
190)   949D CD 73 96    		 CALL PAUSE_LOOP       ;DELAY 4,5ms	;DELAY 4,5ms
191)   94A0 3E 03       		 LD A, 3	;
192)   94A2 1E 02       		 LD E, FOUR_BITS	;
193)   94A4 CD 72 94    		 CALL LCD16_SEND	;
194)   94A7 01 00 30    		 LD BC, $3000	;
195)   94AA CD 73 96    		 CALL PAUSE_LOOP       ;DELAY 4,5ms	;DELAY 4,5ms
196)   94AD 3E 03       		 LD A, 3	;
197)   94AF 1E 02       		 LD E, FOUR_BITS	;
198)   94B1 CD 72 94    		 CALL LCD16_SEND	;
199)   94B4 01 00 30    		 LD BC, $3000	;
200)   94B7 CD 73 96    		 CALL PAUSE_LOOP       ;DELAY 4,5ms	;DELAY 4,5ms
201)   94BA 3E 02       		 LD A, 2        ;PUT 4 BIT MODE	;PUT 4 BIT MODE
202)   94BC 1E 02       		 LD E, FOUR_BITS	;
203)   94BE CD 72 94    		 CALL LCD16_SEND	;
204)   94C1 01 00 30    		 LD BC, $3000	;
205)   94C4 CD 73 96    		 CALL PAUSE_LOOP       ;DELAY 4,5ms	;DELAY 4,5ms
207)   94C7 3E 28       		 LD A, LCD_FUNCTIONSET OR LCD_2LINE	;
208)   94C9 CD 6C 94    		 CALL LCD16_COMMD	;
209)   94CC 3E 02       		 LD A, LCD_DISPLAYON OR LCD_CURSOROFF OR LCD_BLINKOFF	;
210)   94CE 32 7F 00    		 LD (LCD_DSPCTRL), A	;
211)   94D1 CD F9 94    		 CALL LCD16_DISP	;
212)   94D4 CD 14 95    		 CALL LCD16_CLR	;
213)   94D7 3E 02       		 LD A, LCD_ENTRYLEFT OR LCD_ENTRYSHIFTDECREMENT	;
214)   94D9 32 80 00    		 LD (LCD_DSPMODE), A	;
215)   94DC F6 04       		 OR LCD_ENTRYMODESET	;
216)   94DE CD 6C 94    		 CALL LCD16_COMMD	;
217)   94E1 01 00 30    		 LD BC, $3000	;
218)   94E4 CD 73 96    		 CALL PAUSE_LOOP       ;DELAY 4,5ms	;DELAY 4,5ms
219)   94E7 CD 97 95    		 CALL LCD16_BKLTON      ;BACKLIGHT ON BY DEFAULT	;BACKLIGHT ON BY DEFAULT
220)   94EA C9          		 RET	;
222)   94EB 3A 7F 00    		@LCD16_NODISP: LD A, (LCD_DSPCTRL)	;
223)   94EE CB 97       		 RES LCD_DISPLAYON, A	;
224)   94F0 32 7F 00    		 LD (LCD_DSPCTRL), A	;
225)   94F3 F6 08       		 OR LCD_DISPLAYCONTROL	;
226)   94F5 CD 6C 94    		 CALL LCD16_COMMD	;
227)   94F8 C9          		 RET	;
228)   94F9 3A 7F 00    		@LCD16_DISP: LD A, (LCD_DSPCTRL)	;
229)   94FC CB D7       		 SET LCD_DISPLAYON, A	;
230)   94FE 32 7F 00    		 LD (LCD_DSPCTRL), A	;
231)   9501 F6 08       		 OR LCD_DISPLAYCONTROL	;
232)   9503 CD 6C 94    		 CALL LCD16_COMMD	;
233)   9506 C9          		 RET	;
235)   9507 01 D0 07    		LCDDELAY: LD BC, HOME_CLEAR_EXEC	;
236)   950A C5          		LCLR_AGN1: PUSH BC	;
237)   950B CD AF 95    		 CALL DELAYMICRO	;
238)   950E C1          		 POP BC	;
239)   950F 0D          		 DEC C	;
240)   9510 E2 0A 95    		 JP PO, LCLR_AGN1	;
241)   9513 C9          		 RET	;
243)   9514 3E 01       		@LCD16_CLR: LD A, LCD_CLEARDISPLAY      ;clear display, set cursor position to zero	;clear display, set cursor position to zero
244)   9516 CD 6C 94    		 CALL LCD16_COMMD	;
245)   9519 CD 07 95    		 CALL LCDDELAY	;
246)   951C C9          		 RET	;
249)   951D 7E          		@LCD16_PRINT: LD A, (HL)	;
250)   951E FE 00       		 CP 0	;
251)   9520 C8          		 RET Z	;
252)   9521 CD 70 94    		 CALL LCD16_DATA	;
253)   9524 23          		 INC HL	;
254)   9525 18 F6       		 JR LCD16_PRINT	;
257)   9527 CD 70 94    		@LCD16_PRCHR: CALL LCD16_DATA	;
258)   952A C9          		 RET	;
260)   952B 3E 02       		@LCD16_HOME: LD A, LCD_RETURNHOME	;
261)   952D CD 6C 94    		 CALL LCD16_COMMD	;
262)   9530 CD 07 95    		 CALL LCDDELAY	;
263)   9533 C9          		 RET	;
266)   9534 00 40 14 54 		ROWOFFSET: DB $00,$40,$14,$54	;
267)   9538 06 00       		@LCD16_SETCURS: LD B, 0	;
268)   953A 4B          		 LD C, E	;
269)   953B 21 34 95    		 LD HL, ROWOFFSET	;
270)   953E 09          		 ADD HL, BC	;
271)   953F 7E          		 LD A, (HL)	;
272)   9540 82          		 ADD D	;
273)   9541 F6 80       		 OR LCD_SETDDRAMADDR	;
274)   9543 CD 6C 94    		 CALL LCD16_COMMD	;
275)   9546 C9          		 RET	;
277)   9547 3A 7F 00    		@LCD16_CURSOFF: LD A, (LCD_DSPCTRL)	;
278)   954A CB 8F       		 RES LCD_CURSORON, A	;
279)   954C 32 7F 00    		 LD (LCD_DSPCTRL), A	;
280)   954F F6 08       		 OR LCD_DISPLAYCONTROL	;
281)   9551 CD 6C 94    		 CALL LCD16_COMMD	;
282)   9554 C9          		 RET	;
285)   9555 3A 7F 00    		@LCD16_CURSON: LD A, (LCD_DSPCTRL)	;
286)   9558 CB CF       		 SET LCD_CURSORON, A	;
287)   955A 32 7F 00    		 LD (LCD_DSPCTRL), A	;
288)   955D F6 08       		 OR LCD_DISPLAYCONTROL	;
289)   955F CD 6C 94    		 CALL LCD16_COMMD	;
290)   9562 C9          		 RET	;
292)   9563 3A 7F 00    		@LCD16_BLINKOFF: LD A, (LCD_DSPCTRL)	;
293)   9566 CB 87       		 RES LCD_BLINKON, A	;
294)   9568 32 7F 00    		 LD (LCD_DSPCTRL), A	;
295)   956B F6 08       		 OR LCD_DISPLAYCONTROL	;
296)   956D CD 6C 94    		 CALL LCD16_COMMD	;
297)   9570 C9          		 RET	;
300)   9571 3A 7F 00    		@LCD16_BLINKON: LD A, (LCD_DSPCTRL)	;
301)   9574 CB C7       		 SET LCD_BLINKON, A	;
302)   9576 32 7F 00    		 LD (LCD_DSPCTRL), A	;
303)   9579 F6 08       		 OR LCD_DISPLAYCONTROL	;
304)   957B CD 6C 94    		 CALL LCD16_COMMD	;
305)   957E C9          		 RET	;
307)   957F 3E 18       		@LCD16_SCRLEFT: LD A, LCD_CURSORSHIFT OR LCD_DISPLAYMOVE OR LCD_MOVELEFT	;
308)   9581 CD 6C 94    		 CALL LCD16_COMMD	;
309)   9584 C9          		 RET	;
311)   9585 3E 1C       		@LCD16_SCRRIGHT: LD A, LCD_CURSORSHIFT OR LCD_DISPLAYMOVE OR LCD_MOVERIGHT	;
312)   9587 CD 6C 94    		 CALL LCD16_COMMD	;
313)   958A C9          		 RET	;
315)   958B 3E 10       		@LCD16_MOVLEFT: LD A, LCD_CURSORSHIFT OR LCD_CURSORMOVE OR LCD_MOVELEFT	;
316)   958D CD 6C 94    		 CALL LCD16_COMMD	;
317)   9590 C9          		 RET	;
319)   9591 3E 14       		@LCD16_MOVRIGHT: LD A, LCD_CURSORSHIFT OR LCD_CURSORMOVE OR LCD_MOVERIGHT	;
320)   9593 CD 6C 94    		 CALL LCD16_COMMD	;
321)   9596 C9          		 RET	;
324)   9597 3E 08       		@LCD16_BKLTON: LD A, BACKLIGHTPINMASK AND LCD_BACKLIGHT	;
325)   9599 32 81 00    		 LD (LCD_STSMASK),A	;
326)   959C CD 5B 94    		 CALL LCD16_I2CSEND	;
327)   959F C9          		 RET	;
329)   95A0 3E 00       		@LCD16_BKLTOFF: LD A, BACKLIGHTPINMASK AND LCD_NOBACKLIGHT	;
330)   95A2 32 81 00    		 LD (LCD_STSMASK),A	;
331)   95A5 CD 5B 94    		 CALL LCD16_I2CSEND	;
332)   95A8 C9          		 RET	;
 37)   95A9 F5          		DELAYMICROSEC: PUSH AF	;
 38)   95AA D5          		 PUSH DE	;
 39)   95AB 1B          		 DEC DE	;
 40)   95AC D1          		 POP DE	;
 41)   95AD F1          		 POP AF	;
 42)   95AE C9          		 RET	;
 45)   95AF CD A9 95    		S21: CALL DELAYMICROSEC	;
 46)   95B2 10 FB       		 DJNZ S21	;
 47)   95B4 C9          		 RET	;
 51)   95B5 F5          		DELAYMILISEC: PUSH AF	;
 52)   95B6 D5          		 PUSH DE	;
 53)   95B7 11 2C 01    		 LD DE, 300        ;2000 1 MILISEC =300 ON 8MHZ SO 30= 0.1 MILISECS = 100 MICROSECS	;2000 1 MILISEC =300 ON 8MHZ SO 30= 0.1 MILISECS = 100 MICROSECS
 54)   95BA 1B          		DEL1: DEC DE	;
 55)   95BB 7A          		 LD A, D        ;TEST FOR DE=00	;TEST FOR DE=00
 56)   95BC B3          		 OR E	;
 57)   95BD 20 FB       		 JR NZ, DEL1	;
 58)   95BF D1          		 POP DE	;
 59)   95C0 F1          		 POP AF	;
 60)   95C1 C9          		 RET	;
 63)   95C2 06 50       		 LD B, 80	;
 65)   95C4 CD B5 95    		S1: CALL DELAYMILISEC	;
 66)   95C7 10 FB       		 DJNZ S1	;
 67)   95C9 C9          		 RET	;
 72)   95CA C5          		@DELAYSEC: PUSH BC	;
 73)   95CB 01 E8 03    		 LD BC, 1000	;
 74)   95CE C5          		MYDLAGN: PUSH BC	;
 75)   95CF CD B5 95    		 CALL DELAY        ;1MS ON 8 MHZ	;1MS ON 8 MHZ
 76)   95D2 C1          		 POP BC	;
 77)   95D3 0B          		 DEC BC	;
 78)   95D4 78          		 LD A, B	;
 79)   95D5 B1          		 OR C	;
 80)   95D6 20 F6       		 JR NZ, MYDLAGN	;
 81)   95D8 C1          		 POP BC	;
 82)   95D9 10 EF       		 DJNZ DELAYSEC	;
 83)   95DB C9          		 RET	;
 88)   95DC F5          		OUTASC: PUSH AF	;
 89)   95DD D5          		 PUSH DE	;
 90)   95DE CD 11 96    		 CALL B2Bcd	;
 91)   95E1 D1          		 POP DE	;
 92)   95E2 CD 37 96    		 CALL BCD2HA	;
 93)   95E5 F1          		 POP AF	;
 94)   95E6 C9          		 RET	;
108)   95E7 B7          		BCD2BN: OR A	;
109)   95E8 47          		 LD B, A	;
110)   95E9 E6 F0       		 AND $F0	;
111)   95EB 0F          		 RRCA	;
112)   95EC 4F          		 LD C, A	;
113)   95ED 0F          		 RRCA	;
114)   95EE 0F          		 RRCA	;
115)   95EF 81          		 ADD A, C	;
116)   95F0 4F          		 LD C, A	;
117)   95F1 78          		 LD A, B	;
118)   95F2 E6 0F       		 AND $0F	;
119)   95F4 81          		 ADD A, C	;
120)   95F5 C9          		 RET	;
135)   95F6 26 FF       		BN2BCD: LD H, $FF	;
136)   95F8 24          		D100LP: INC H	;
137)   95F9 D6 64       		 SUB 100	;
138)   95FB 30 FB       		 JR NC, D100LP	;
139)   95FD C6 64       		 ADD A, 100	;
140)   95FF 2E FF       		 LD L, $FF	;
141)   9601 2C          		D10LP: INC L	;
142)   9602 D6 0A       		 SUB 10	;
143)   9604 30 FB       		 JR NC, D10LP	;
144)   9606 C6 0A       		 ADD A, 10	;
145)   9608 4F          		 LD C, A	;
146)   9609 7D          		 LD A, L	;
147)   960A 07          		 RLCA	;
148)   960B 07          		 RLCA	;
149)   960C 07          		 RLCA	;
150)   960D 07          		 RLCA	;
151)   960E B1          		 OR C	;
152)   960F 6F          		 LD L, A	;
153)   9610 C9          		 RET	;
167)   9611 01 00 10    		 LD BC, 16 * 256 + 0       ; handle 16 bits, one bit per iteration	; handle 16 bits, one bit per iteration
168)   9614 11 00 00    		 LD DE, 0	;
170)   9617 29          		 ADD HL, HL	;
171)   9618 7B          		 LD A, E	;
172)   9619 8F          		 ADC A, A	;
173)   961A 27          		 DAA	;
174)   961B 5F          		 LD E, A	;
175)   961C 7A          		 LD A, D	;
176)   961D 8F          		 ADC A, A	;
177)   961E 27          		 DAA	;
178)   961F 57          		 LD D, A	;
179)   9620 79          		 LD A, C	;
180)   9621 8F          		 ADC A, A	;
181)   9622 27          		 DAA	;
182)   9623 4F          		 LD C, A	;
183)   9624 10 F1       		 DJNZ cvtLp	;
184)   9626 EB          		 EX DE, HL	;
185)   9627 C9          		 RET	;
199)   9628 B7          		BCD2BN: OR A	;
200)   9629 47          		 LD B, A	;
201)   962A E6 F0       		 AND $F0	;
202)   962C 0F          		 RRCA	;
203)   962D 4F          		 LD C, A	;
204)   962E 0F          		 RRCA	;
205)   962F 0F          		 RRCA	;
206)   9630 81          		 ADD A, C	;
207)   9631 4F          		 LD C, A	;
208)   9632 78          		 LD A, B	;
209)   9633 E6 0F       		 AND $0F	;
210)   9635 81          		 ADD A, C	;
211)   9636 C9          		 RET	;
223)   9637 79          		 LD A, C	;
224)   9638 CD 64 96    		 CALL cvtUN	;
225)   963B 79          		 LD A, C	;
226)   963C CD 68 96    		 CALL cvtLN	;
227)   963F 7C          		 LD A, H	;
228)   9640 CD 64 96    		 CALL cvtUN	;
229)   9643 7C          		 LD A, H	;
230)   9644 CD 68 96    		 CALL cvtLN	;
231)   9647 7D          		 LD A, L	;
232)   9648 CD 64 96    		 CALL cvtUN	;
233)   964B 7D          		 LD A, L	;
234)   964C 18 1A       		 JR cvtLN	;
236)   964E 1F          		 RRA         ; move upper nibble into lower nibble	; move upper nibble into lower nibble
237)   964F 1F          		 RRA	;
238)   9650 1F          		 RRA	;
239)   9651 1F          		 RRA	;
241)   9652 E6 0F       		 AND 0Fh        ; isolate lower nibble	; isolate lower nibble
242)   9654 C6 90       		 ADD A, 90h        ; old trick	; old trick
243)   9656 27          		 DAA         ; for converting	; for converting
244)   9657 CE 40       		 ADC A, 40h        ; one nibble	; one nibble
245)   9659 27          		 DAA         ; to hex ASCII	; to hex ASCII
246)   965A 12          		 LD (DE), A	;
247)   965B 13          		 INC DE	;
248)   965C C9          		 RET	;
260)   965D 7D          		 LD A, L	;
261)   965E CD 4E 96    		 CALL cvtUN	;
262)   9661 7D          		 LD A, L	;
263)   9662 18 EE       		 JR cvtLN	;
265)   9664 1F          		 RRA         ; move upper nibble into lower nibble	; move upper nibble into lower nibble
266)   9665 1F          		 RRA	;
267)   9666 1F          		 RRA	;
268)   9667 1F          		 RRA	;
270)   9668 E6 0F       		 AND 0Fh        ; isolate lower nibble	; isolate lower nibble
271)   966A C6 90       		 ADD A, 90h        ; old trick	; old trick
272)   966C 27          		 DAA         ; for converting	; for converting
273)   966D CE 40       		 ADC A, 40h        ; one nibble	; one nibble
274)   966F 27          		 DAA         ; to hex ASCII	; to hex ASCII
275)   9670 12          		 LD (DE), A	;
276)   9671 13          		 INC DE	;
277)   9672 C9          		 RET	;
294)   9673 F5          		 PUSH AF        ; 11 T-states	; 11 T-states
296)   9674 ED 44       		 NEG         ; 8 T-states	; 8 T-states
297)   9676 ED 44       		 NEG         ; 8 T-states	; 8 T-states
298)   9678 ED 44       		 NEG         ; 8 T-states	; 8 T-states
299)   967A ED 44       		 NEG         ; 8 T-states	; 8 T-states
300)   967C 0B          		 DEC BC         ; 6 T-states	; 6 T-states
301)   967D 79          		 LD A, C        ; 9 T-states	; 9 T-states
302)   967E B0          		 OR B         ; 4 T-states	; 4 T-states
303)   967F C2 74 96    		 JP NZ, pau_lp        ; 10 T-states	; 10 T-states
304)   9682 F1          		 POP AF         ; 10 T-states	; 10 T-states
305)   9683 C9          		 RET         ; Pause complete, RETurn	; Pause complete, RETurn
343)   9684 26 00       		@B2D8: LD H, 0	;
344)   9686 6F          		 LD L, A	;
345)   9687 1E 00       		@B2D16: LD E, 0	;
346)   9689 16 00       		@B2D24: LD D, 0	;
347)   968B 01 00 00    		@B2D32: LD BC, 0	;
348)   968E DD 21 00 00 		@B2D48: LD IX, 0        ; zero all non-used bits	; zero all non-used bits
349)   9692 22 C7 00    		@B2D64: LD (B2DINV), HL	;
350)   9695 ED 53 C9 00 		 LD (B2DINV + 2), DE	;
351)   9699 ED 43 CB 00 		 LD (B2DINV + 4), BC	;
352)   969D DD 22 CD 00 		 LD (B2DINV + 6), IX       ; place full 64-bit input value in buffer	; place full 64-bit input value in buffer
353)   96A1 21 CF 00    		 LD HL, B2DBUF	;
354)   96A4 11 D0 00    		 LD DE, B2DBUF + 1	;
355)   96A7 36 20       		 LD (HL), ' '	;
357)   96A9 01 12 00    		 LD BC, 18	;
358)   96AC ED B0       		 LDIR         ; fill 1st 19 bytes of buffer with spaces	; fill 1st 19 bytes of buffer with spaces
359)   96AE ED 43 E2 00 		 LD (B2DEND - 1), BC       ;set BCD value to "0" & place terminating 0	;set BCD value to "0" & place terminating 0
360)   96B2 1E 01       		 LD E, 1        ; no. of bytes in BCD value	; no. of bytes in BCD value
361)   96B4 21 CF 00    		 LD HL, B2DINV + 8       ; (address MSB input)+1	; (address MSB input)+1
362)   96B7 01 09 09    		 LD BC, 0x0909	;
363)   96BA AF          		 XOR A	;
364)   96BB 05          		B2DSKP0: DEC B	;
365)   96BC 28 29       		 JR Z, B2DSIZ        ; all 0: continue with postprocessing	; all 0: continue with postprocessing
366)   96BE 2B          		 DEC HL	;
367)   96BF B6          		 OR (HL)        ; find first byte <>0	; find first byte <>0
368)   96C0 28 F9       		 JR Z, B2DSKP0	;
369)   96C2 0D          		B2DFND1: DEC C	;
370)   96C3 17          		 RLA	;
371)   96C4 30 FC       		 JR NC, B2DFND1        ; determine no. of most significant 1-bit	; determine no. of most significant 1-bit
372)   96C6 1F          		 RRA	;
373)   96C7 57          		 LD D, A        ; byte from binary input value	; byte from binary input value
374)   96C8 E5          		B2DLUS2: PUSH HL	;
375)   96C9 C5          		 PUSH BC	;
376)   96CA 21 E2 00    		B2DLUS1: LD HL, B2DEND - 1      ; address LSB of BCD value	; address LSB of BCD value
377)   96CD 43          		 LD B, E        ; current length of BCD value in bytes	; current length of BCD value in bytes
378)   96CE CB 12       		 RL D         ; highest bit from input value -> carry	; highest bit from input value -> carry
379)   96D0 7E          		B2DLUS0: LD A, (HL)	;
380)   96D1 8F          		 ADC A, A	;
381)   96D2 27          		 DAA	;
382)   96D3 77          		 LD (HL), A        ; double 1 BCD byte from intermediate result	; double 1 BCD byte from intermediate result
383)   96D4 2B          		 DEC HL	;
384)   96D5 10 F9       		 DJNZ B2DLUS0        ; and go on to double entire BCD value (+carry!)	; and go on to double entire BCD value (+carry!)
385)   96D7 30 03       		 JR NC, B2DNXT	;
386)   96D9 1C          		 INC E         ; carry at MSB -> BCD value grew 1 byte larger	; carry at MSB -> BCD value grew 1 byte larger
387)   96DA 36 01       		 LD (HL), 1        ; initialize new MSB of BCD value	; initialize new MSB of BCD value
388)   96DC 0D          		B2DNXT: DEC C	;
389)   96DD 20 EB       		 JR NZ, B2DLUS1        ; repeat for remaining bits from 1 input byte	; repeat for remaining bits from 1 input byte
390)   96DF C1          		 POP BC         ; no. of remaining bytes in input value	; no. of remaining bytes in input value
391)   96E0 0E 08       		 LD C, 8        ; reset bit-counter	; reset bit-counter
392)   96E2 E1          		 POP HL         ; pointer to byte from input value	; pointer to byte from input value
393)   96E3 2B          		 DEC HL	;
394)   96E4 56          		 LD D, (HL)        ; get next group of 8 bits	; get next group of 8 bits
395)   96E5 10 E1       		 DJNZ B2DLUS2        ; and repeat until last byte from input value	; and repeat until last byte from input value
396)   96E7 21 E3 00    		B2DSIZ: LD HL, B2DEND        ; address of terminating 0	; address of terminating 0
397)   96EA 4B          		 LD C, E        ; size of BCD value in bytes	; size of BCD value in bytes
398)   96EB B7          		 OR A	;
399)   96EC ED 42       		 SBC HL, BC        ; calculate address of MSB BCD	; calculate address of MSB BCD
400)   96EE 54          		 LD D, H	;
401)   96EF 5D          		 LD E, L	;
402)   96F0 ED 42       		 SBC HL, BC	;
403)   96F2 EB          		 EX DE, HL        ; HL=address BCD value, DE=start of decimal value	; HL=address BCD value, DE=start of decimal value
404)   96F3 41          		 LD B, C        ; no. of bytes BCD	; no. of bytes BCD
405)   96F4 CB 21       		 SLA C         ; no. of bytes decimal (possibly 1 too high)	; no. of bytes decimal (possibly 1 too high)
406)   96F6 3E 30       		 LD A, '0'	;
407)   96F8 ED 6F       		 RLD         ; shift bits 4-7 of (HL) into bit 0-3 of A	; shift bits 4-7 of (HL) into bit 0-3 of A
408)   96FA FE 30       		 CP '0'         ; (HL) was > 9h?	; (HL) was > 9h?
409)   96FC 20 06       		 JR NZ, B2DEXPH        ; if yes, start with recording high digit	; if yes, start with recording high digit
410)   96FE 0D          		 DEC C         ; correct number of decimals	; correct number of decimals
411)   96FF 13          		 INC DE         ; correct start address	; correct start address
412)   9700 18 04       		 JR B2DEXPL        ; continue with converting low digit	; continue with converting low digit
413)   9702 ED 6F       		B2DEXP: RLD         ; shift high digit (HL) into low digit of A	; shift high digit (HL) into low digit of A
414)   9704 12          		B2DEXPH: LD (DE), A       ; record resulting ASCII-code	; record resulting ASCII-code
415)   9705 13          		 INC DE	;
416)   9706 ED 6F       		B2DEXPL: RLD	;
417)   9708 12          		 LD (DE), A	;
418)   9709 13          		 INC DE	;
419)   970A 23          		 INC HL         ; next BCD-byte	; next BCD-byte
420)   970B 10 F5       		 DJNZ B2DEXP        ; and go on to convert each BCD-byte into 2 ASCII	; and go on to convert each BCD-byte into 2 ASCII
421)   970D ED 42       		 SBC HL, BC        ; return with HL pointing to 1st decimal	; return with HL pointing to 1st decimal
422)   970F C9          		 RET	;
426)   9710 EB          		 ex de, hl        ; Get destination into DE	; Get destination into DE
427)   9711 21 CF 00    		 ld hl, B2DBUF	;
428)   9714 CD 1B 97    		 call SkipWhitespace	;
429)   9717 ED B0       		 ldir	;
430)   9719 EB          		 ex de, hl        ; Get destination into DE	; Get destination into DE
431)   971A C9          		 ret	;
436)   971B 7E          		 ld a, (hl)	;
437)   971C FE 20       		 cp ' '	;
438)   971E C0          		 ret nz	;
439)   971F 23          		 inc hl	;
440)   9720 18 F9       		 jr SkipWhitespace	;
444)   9722 06 08       		@REVBITS: ld b, 8	;
445)   9724 6F          		 ld l, a	;
447)   9725 CB 15       		 rl l	;
448)   9727 1F          		 rra	;
449)   9728 10 FB       		 djnz REVLOOP	;
450)   972A C9          		 RET	;
460)   972B E5          		 push hl	;
462)   972C 7E          		 ld a, (hl)	;
464)   972D FE 00       		 cp  0	;
465)   972F 28 0E       		 jr z, IsStrDecTrue	;
467)   9731 FE 30       		 cp  '0'	;
468)   9733 38 06       		 jr c, IsStrDecFalse	;
470)   9735 FE 3A       		 cp  '9'+1	;
471)   9737 38 09       		 jr c, IsStrDecContinue	;
472)   9739 FE 39       		 cp  '9'	;
475)   973B F6 01       		 or 1         ; Reset zero flag	; Reset zero flag
476)   973D E1          		 pop hl	;
477)   973E C9          		 ret	;
479)   973F BF          		 cp a         ; Set zero flag	; Set zero flag
480)   9740 E1          		 pop hl	;
481)   9741 C9          		 ret	;
483)   9742 23          		 inc hl	;
484)   9743 18 E7       		 jr IsStrDec00	;
491)   9745 E5          		 push hl	;
493)   9746 7E          		 ld a, (hl)	;
495)   9747 FE 00       		 cp  0	;
496)   9749 28 14       		 jr z, IsStrHexTrue	;
498)   974B FE 30       		 cp  '0'	;
499)   974D 38 0C       		 jr c, IsStrHexFalse	;
501)   974F FE 3A       		 cp  '9'+1	;
502)   9751 38 0F       		 jr c, IsStrHexContinue	;
504)   9753 FE 30       		 cp  '0'	;
505)   9755 38 04       		 jr c, IsStrHexFalse	;
507)   9757 FE 47       		 cp  'F'+1	;
508)   9759 38 07       		 jr c, IsStrHexContinue	;
511)   975B F6 01       		 or 1         ; Reset zero flag	; Reset zero flag
512)   975D E1          		 pop hl	;
513)   975E C9          		 ret	;
515)   975F BF          		 cp a         ; Set zero flag	; Set zero flag
516)   9760 E1          		 pop hl	;
517)   9761 C9          		 ret	;
519)   9762 23          		 inc hl	;
520)   9763 18 E1       		 jr IsStrHex00	;
527)   9765 AF          		 xor a	;
528)   9766 CD 6B 97    		 call loop	;
529)   9769 7A          		 ld a, d	;
530)   976A C9          		 ret	;
532)   976B 57          		 ld d, a	;
533)   976C 7E          		 ld a, (hl)	;
534)   976D 23          		 inc hl	;
535)   976E D6 3A       		 sub '9' + 1	;
536)   9770 C6 0A       		 add 10	;
537)   9772 D0          		 ret nc	;
538)   9773 5F          		 ld e, a	;
539)   9774 7A          		 ld a, d	;
540)   9775 87          		 add a, a        ;double our accumulator	;double our accumulator
541)   9776 87          		 add a, a        ;double again (now x4)	;double again (now x4)
542)   9777 82          		 add a, d        ;add the original (now x5)	;add the original (now x5)
543)   9778 87          		 add a, a        ;double again (now x10)	;double again (now x10)
544)   9779 83          		 add a, e        ;add in the incoming digit	;add in the incoming digit
545)   977A 18 EF       		 jr loop	;
553)   977C 7E          		 ld a, (hl)        ; Copy first char to A	; Copy first char to A
554)   977D CD 8D 97    		 call Hex12        ; Convert first char	; Convert first char
555)   9780 87          		 add a, a        ; Multiply by 16...	; Multiply by 16...
556)   9781 87          		 add a, a        ; ...	; ...
557)   9782 87          		 add a, a        ; ...	; ...
558)   9783 87          		 add a, a        ; ...done!	; ...done!
559)   9784 57          		 ld d, a        ; Store top 4 bits in D	; Store top 4 bits in D
560)   9785 23          		 inc hl         ; Advance to next char	; Advance to next char
561)   9786 7E          		 ld a, (hl)	;
562)   9787 CD 8D 97    		 call Hex12        ; Convert second char	; Convert second char
563)   978A B2          		 or d         ; Add back top bits	; Add back top bits
564)   978B 23          		 inc hl         ; Advance for next guy	; Advance for next guy
565)   978C C9          		 ret	;
566)   978D D6 30       		Hex12: sub  '0'	;
567)   978F FE 0A       		 cp 10	;
568)   9791 D8          		 ret c	;
569)   9792 D6 07       		 sub 'A' - '0' - 10	;
570)   9794 C9          		 ret	;
577)   9795 CD 7C 97    		 call Read8bit	;
578)   9798 47          		 ld b, a	;
579)   9799 CD 7C 97    		 call Read8bit	;
580)   979C 4F          		 ld c, a	;
581)   979D C9          		 ret	;
589)   979E 7E          		 ld a, (hl)	;
590)   979F 23          		 inc hl	;
591)   97A0 D6 30       		 sub '0'	;
592)   97A2 CB 27       		 sla a	;
593)   97A4 CB 27       		 sla a	;
594)   97A6 CB 27       		 sla a	;
595)   97A8 CB 27       		 sla a	;
596)   97AA 47          		 ld b, a	;
597)   97AB 7E          		 ld a, (hl)	;
598)   97AC 23          		 inc hl	;
599)   97AD D6 30       		 sub '0'	;
600)   97AF B0          		 or b	;
601)   97B0 C9          		 ret	;
606)   97B1 4F          		 ld c, a        ; a = number to convert	; a = number to convert
607)   97B2 CD BE 97    		 call Num1	;
608)   97B5 77          		 ld (hl), a	;
609)   97B6 23          		 inc hl	;
610)   97B7 79          		 ld a, c	;
611)   97B8 CD C2 97    		 call Num2	;
612)   97BB 77          		 ld (hl), a	;
613)   97BC 23          		 inc hl	;
614)   97BD C9          		 ret	;
615)   97BE 1F          		Num1: rra	;
616)   97BF 1F          		 rra	;
617)   97C0 1F          		 rra	;
618)   97C1 1F          		 rra	;
619)   97C2 F6 F0       		Num2: or $F0	;
620)   97C4 27          		 daa	;
621)   97C5 C6 A0       		 add a, $A0	;
622)   97C7 CE 40       		 adc a, $40        ; Ascii hex at this point (0 to F)	; Ascii hex at this point (0 to F)
623)   97C9 C9          		 ret	;
634)   97CA 22 B0 00    		STR_SET: LD (LINESTR),HL	;
635)   97CD C9          		 RET	;
638)   97CE AF          		STR_CLR: XOR A	;
639)   97CF 32 B2 00    		 LD (LINEPOS),A	;
640)   97D2 32 B0 00    		 LD (LINESTR),A	;
641)   97D5 32 B1 00    		 LD (LINESTR+1),A	;
642)   97D8 C9          		 RET	;
645)   97D9 3A B0 00    		STR_VALID: LD A,(LINESTR)	;
646)   97DC 47          		 LD B,A	;
647)   97DD 3A B1 00    		 LD A,(LINESTR+1)	;
648)   97E0 80          		 ADD B	;
649)   97E1 B7          		 OR A	;
650)   97E2 C9          		 RET	;
656)   97E3 F5          		STR_CALCADDR: PUSH AF	;
657)   97E4 ED 5B B0 00 		 LD DE,(LINESTR)	;
658)   97E8 EB          		 EX DE,HL	;
659)   97E9 3A B2 00    		 LD A,(LINEPOS)	;
660)   97EC 4F          		 LD C,A	;
661)   97ED 06 00       		 LD B,0	;
662)   97EF 09          		 ADD HL,BC	;
663)   97F0 EB          		 EX DE,HL	;
664)   97F1 F1          		 POP AF	;
665)   97F2 C9          		 RET	;
669)   97F3 3A B2 00    		STR_NEXTPOS: LD A,(LINEPOS)	;
670)   97F6 3C          		 INC A	;
671)   97F7 32 B2 00    		 LD (LINEPOS),A	;
672)   97FA C9          		 RET	;
676)   97FB CD E3 97    		STR_ADD: CALL STR_CALCADDR	;
677)   97FE CD F3 97    		STRA_AGN: CALL STR_NEXTPOS	;
678)   9801 7E          		 LD A,(HL)	;
679)   9802 12          		 LD (DE),A	;
680)   9803 23          		 INC HL	;
681)   9804 13          		 INC DE	;
682)   9805 B7          		 OR A	;
683)   9806 C8          		 RET Z	;
684)   9807 18 F5       		 JR STRA_AGN	;
687)   9809 CD E3 97    		STR_ADDCHAR: CALL STR_CALCADDR	;
688)   980C 12          		 LD (DE),A	;
689)   980D CD F3 97    		 CALL STR_NEXTPOS	;
690)   9810 13          		 INC DE	;
691)   9811 AF          		 XOR A	;
692)   9812 12          		 LD (DE),A	;
693)   9813 C9          		 RET	;
701)   9814 26 00       		@PRINTNUM: LD H,0	;
702)   9816 6F          		 LD L,A	;
703)   9817 F5          		@PRINTNUM16: PUSH AF	;
705)   9818 11 C0 00    		 LD DE,NUMBUF	;
706)   981B CD 5D 96    		 CALL Bcd2ASC  ;FOR HEX	;FOR HEX
707)   981E 3E 68       		 LD A,'h'	;
708)   9820 12          		 LD (DE),A  	;
709)   9821 13          		 INC DE	;
710)   9822 AF          		 XOR A	;
711)   9823 12          		 LD (DE),A  	;
713)   9824 21 C0 00    		 LD HL,NUMBUF	;
714)   9827 CD 1C 8C    		 CALL RS_TXT	;
715)   982A CD 7C 8C    		 CALL RS_NEWLINE	;
716)   982D F1          		 POP AF	;
717)   982E C9          		 RET	;
725)   982F E5          		@NUM_ADDZERO: PUSH HL	;
726)   9830 0E 00       		 LD C,0	;
727)   9832 7E          		AZ_AGN: LD A,(HL)   	;
728)   9833 23          		 INC HL	;
729)   9834 0C          		 INC C	;
730)   9835 FE 00       		 CP 0	;
731)   9837 20 F9       		 JR NZ,AZ_AGN	;
732)   9839 0D          		 DEC C ;EXCLUDE ZERO TERM	;EXCLUDE ZERO TERM
733)   983A E1          		 POP HL	;
734)   983B 79          		 LD A,C	;
735)   983C B8          		 CP B	;
736)   983D C8          		 RET Z	;
738)   983E 78          		 LD A,B	;
739)   983F 91          		 SUB C	;
740)   9840 D8          		 RET C ;RETURN IF CARRY MEANS WE HAVE MORE DIGITS	;RETURN IF CARRY MEANS WE HAVE MORE DIGITS
741)   9841 47          		 LD B,A	;
742)   9842 3E 30       		 LD A,'0'	;
743)   9844 2B          		AZ_AGN2: DEC HL	;
744)   9845 77          		 LD (HL),A	;
745)   9846 10 FC       		 DJNZ AZ_AGN2 	;
746)   9848 C9          		 RET	;
752)   9849 11 83 00    		@COPYFNAME: LD DE,STRGBUFF	;
753)   984C 7E          		@COPYSTRING:   LD A,(HL)	;
754)   984D 12          		 LD (DE),A	;
755)   984E FE 00       		 CP 0	;
756)   9850 C8          		 RET Z  	;
757)   9851 13          		 INC DE	;
758)   9852 23          		 INC HL	;
759)   9853 18 F7       		 JR COPYSTRING	;
  1)   9855 00 00 00 00 		DS 0A000H-$	;
  1)   9859 00 00 00 00 		DS 0A000H-$	;
  1)   985D 00 00 00 00 		DS 0A000H-$	;
  1)   9861 00 00 00 00 		DS 0A000H-$	;
  1)   9865 00 00 00 00 		DS 0A000H-$	;
  1)   9869 00 00 00 00 		DS 0A000H-$	;
  1)   986D 00 00 00 00 		DS 0A000H-$	;
  1)   9871 00 00 00 00 		DS 0A000H-$	;
  1)   9875 00 00 00 00 		DS 0A000H-$	;
  1)   9879 00 00 00 00 		DS 0A000H-$	;
  1)   987D 00 00 00 00 		DS 0A000H-$	;
  1)   9881 00 00 00 00 		DS 0A000H-$	;
  1)   9885 00 00 00 00 		DS 0A000H-$	;
  1)   9889 00 00 00 00 		DS 0A000H-$	;
  1)   988D 00 00 00 00 		DS 0A000H-$	;
  1)   9891 00 00 00 00 		DS 0A000H-$	;
  1)   9895 00 00 00 00 		DS 0A000H-$	;
  1)   9899 00 00 00 00 		DS 0A000H-$	;
  1)   989D 00 00 00 00 		DS 0A000H-$	;
  1)   98A1 00 00 00 00 		DS 0A000H-$	;
  1)   98A5 00 00 00 00 		DS 0A000H-$	;
  1)   98A9 00 00 00 00 		DS 0A000H-$	;
  1)   98AD 00 00 00 00 		DS 0A000H-$	;
  1)   98B1 00 00 00 00 		DS 0A000H-$	;
  1)   98B5 00 00 00 00 		DS 0A000H-$	;
  1)   98B9 00 00 00 00 		DS 0A000H-$	;
  1)   98BD 00 00 00 00 		DS 0A000H-$	;
  1)   98C1 00 00 00 00 		DS 0A000H-$	;
  1)   98C5 00 00 00 00 		DS 0A000H-$	;
  1)   98C9 00 00 00 00 		DS 0A000H-$	;
  1)   98CD 00 00 00 00 		DS 0A000H-$	;
  1)   98D1 00 00 00 00 		DS 0A000H-$	;
  1)   98D5 00 00 00 00 		DS 0A000H-$	;
  1)   98D9 00 00 00 00 		DS 0A000H-$	;
  1)   98DD 00 00 00 00 		DS 0A000H-$	;
  1)   98E1 00 00 00 00 		DS 0A000H-$	;
  1)   98E5 00 00 00 00 		DS 0A000H-$	;
  1)   98E9 00 00 00 00 		DS 0A000H-$	;
  1)   98ED 00 00 00 00 		DS 0A000H-$	;
  1)   98F1 00 00 00 00 		DS 0A000H-$	;
  1)   98F5 00 00 00 00 		DS 0A000H-$	;
  1)   98F9 00 00 00 00 		DS 0A000H-$	;
  1)   98FD 00 00 00 00 		DS 0A000H-$	;
  1)   9901 00 00 00 00 		DS 0A000H-$	;
  1)   9905 00 00 00 00 		DS 0A000H-$	;
  1)   9909 00 00 00 00 		DS 0A000H-$	;
  1)   990D 00 00 00 00 		DS 0A000H-$	;
  1)   9911 00 00 00 00 		DS 0A000H-$	;
  1)   9915 00 00 00 00 		DS 0A000H-$	;
  1)   9919 00 00 00 00 		DS 0A000H-$	;
  1)   991D 00 00 00 00 		DS 0A000H-$	;
  1)   9921 00 00 00 00 		DS 0A000H-$	;
  1)   9925 00 00 00 00 		DS 0A000H-$	;
  1)   9929 00 00 00 00 		DS 0A000H-$	;
  1)   992D 00 00 00 00 		DS 0A000H-$	;
  1)   9931 00 00 00 00 		DS 0A000H-$	;
  1)   9935 00 00 00 00 		DS 0A000H-$	;
  1)   9939 00 00 00 00 		DS 0A000H-$	;
  1)   993D 00 00 00 00 		DS 0A000H-$	;
  1)   9941 00 00 00 00 		DS 0A000H-$	;
  1)   9945 00 00 00 00 		DS 0A000H-$	;
  1)   9949 00 00 00 00 		DS 0A000H-$	;
  1)   994D 00 00 00 00 		DS 0A000H-$	;
  1)   9951 00 00 00 00 		DS 0A000H-$	;
  1)   9955 00 00 00 00 		DS 0A000H-$	;
  1)   9959 00 00 00 00 		DS 0A000H-$	;
  1)   995D 00 00 00 00 		DS 0A000H-$	;
  1)   9961 00 00 00 00 		DS 0A000H-$	;
  1)   9965 00 00 00 00 		DS 0A000H-$	;
  1)   9969 00 00 00 00 		DS 0A000H-$	;
  1)   996D 00 00 00 00 		DS 0A000H-$	;
  1)   9971 00 00 00 00 		DS 0A000H-$	;
  1)   9975 00 00 00 00 		DS 0A000H-$	;
  1)   9979 00 00 00 00 		DS 0A000H-$	;
  1)   997D 00 00 00 00 		DS 0A000H-$	;
  1)   9981 00 00 00 00 		DS 0A000H-$	;
  1)   9985 00 00 00 00 		DS 0A000H-$	;
  1)   9989 00 00 00 00 		DS 0A000H-$	;
  1)   998D 00 00 00 00 		DS 0A000H-$	;
  1)   9991 00 00 00 00 		DS 0A000H-$	;
  1)   9995 00 00 00 00 		DS 0A000H-$	;
  1)   9999 00 00 00 00 		DS 0A000H-$	;
  1)   999D 00 00 00 00 		DS 0A000H-$	;
  1)   99A1 00 00 00 00 		DS 0A000H-$	;
  1)   99A5 00 00 00 00 		DS 0A000H-$	;
  1)   99A9 00 00 00 00 		DS 0A000H-$	;
  1)   99AD 00 00 00 00 		DS 0A000H-$	;
  1)   99B1 00 00 00 00 		DS 0A000H-$	;
  1)   99B5 00 00 00 00 		DS 0A000H-$	;
  1)   99B9 00 00 00 00 		DS 0A000H-$	;
  1)   99BD 00 00 00 00 		DS 0A000H-$	;
  1)   99C1 00 00 00 00 		DS 0A000H-$	;
  1)   99C5 00 00 00 00 		DS 0A000H-$	;
  1)   99C9 00 00 00 00 		DS 0A000H-$	;
  1)   99CD 00 00 00 00 		DS 0A000H-$	;
  1)   99D1 00 00 00 00 		DS 0A000H-$	;
  1)   99D5 00 00 00 00 		DS 0A000H-$	;
  1)   99D9 00 00 00 00 		DS 0A000H-$	;
  1)   99DD 00 00 00 00 		DS 0A000H-$	;
  1)   99E1 00 00 00 00 		DS 0A000H-$	;
  1)   99E5 00 00 00 00 		DS 0A000H-$	;
  1)   99E9 00 00 00 00 		DS 0A000H-$	;
  1)   99ED 00 00 00 00 		DS 0A000H-$	;
  1)   99F1 00 00 00 00 		DS 0A000H-$	;
  1)   99F5 00 00 00 00 		DS 0A000H-$	;
  1)   99F9 00 00 00 00 		DS 0A000H-$	;
  1)   99FD 00 00 00 00 		DS 0A000H-$	;
  1)   9A01 00 00 00 00 		DS 0A000H-$	;
  1)   9A05 00 00 00 00 		DS 0A000H-$	;
  1)   9A09 00 00 00 00 		DS 0A000H-$	;
  1)   9A0D 00 00 00 00 		DS 0A000H-$	;
  1)   9A11 00 00 00 00 		DS 0A000H-$	;
  1)   9A15 00 00 00 00 		DS 0A000H-$	;
  1)   9A19 00 00 00 00 		DS 0A000H-$	;
  1)   9A1D 00 00 00 00 		DS 0A000H-$	;
  1)   9A21 00 00 00 00 		DS 0A000H-$	;
  1)   9A25 00 00 00 00 		DS 0A000H-$	;
  1)   9A29 00 00 00 00 		DS 0A000H-$	;
  1)   9A2D 00 00 00 00 		DS 0A000H-$	;
  1)   9A31 00 00 00 00 		DS 0A000H-$	;
  1)   9A35 00 00 00 00 		DS 0A000H-$	;
  1)   9A39 00 00 00 00 		DS 0A000H-$	;
  1)   9A3D 00 00 00 00 		DS 0A000H-$	;
  1)   9A41 00 00 00 00 		DS 0A000H-$	;
  1)   9A45 00 00 00 00 		DS 0A000H-$	;
  1)   9A49 00 00 00 00 		DS 0A000H-$	;
  1)   9A4D 00 00 00 00 		DS 0A000H-$	;
  1)   9A51 00 00 00 00 		DS 0A000H-$	;
  1)   9A55 00 00 00 00 		DS 0A000H-$	;
  1)   9A59 00 00 00 00 		DS 0A000H-$	;
  1)   9A5D 00 00 00 00 		DS 0A000H-$	;
  1)   9A61 00 00 00 00 		DS 0A000H-$	;
  1)   9A65 00 00 00 00 		DS 0A000H-$	;
  1)   9A69 00 00 00 00 		DS 0A000H-$	;
  1)   9A6D 00 00 00 00 		DS 0A000H-$	;
  1)   9A71 00 00 00 00 		DS 0A000H-$	;
  1)   9A75 00 00 00 00 		DS 0A000H-$	;
  1)   9A79 00 00 00 00 		DS 0A000H-$	;
  1)   9A7D 00 00 00 00 		DS 0A000H-$	;
  1)   9A81 00 00 00 00 		DS 0A000H-$	;
  1)   9A85 00 00 00 00 		DS 0A000H-$	;
  1)   9A89 00 00 00 00 		DS 0A000H-$	;
  1)   9A8D 00 00 00 00 		DS 0A000H-$	;
  1)   9A91 00 00 00 00 		DS 0A000H-$	;
  1)   9A95 00 00 00 00 		DS 0A000H-$	;
  1)   9A99 00 00 00 00 		DS 0A000H-$	;
  1)   9A9D 00 00 00 00 		DS 0A000H-$	;
  1)   9AA1 00 00 00 00 		DS 0A000H-$	;
  1)   9AA5 00 00 00 00 		DS 0A000H-$	;
  1)   9AA9 00 00 00 00 		DS 0A000H-$	;
  1)   9AAD 00 00 00 00 		DS 0A000H-$	;
  1)   9AB1 00 00 00 00 		DS 0A000H-$	;
  1)   9AB5 00 00 00 00 		DS 0A000H-$	;
  1)   9AB9 00 00 00 00 		DS 0A000H-$	;
  1)   9ABD 00 00 00 00 		DS 0A000H-$	;
  1)   9AC1 00 00 00 00 		DS 0A000H-$	;
  1)   9AC5 00 00 00 00 		DS 0A000H-$	;
  1)   9AC9 00 00 00 00 		DS 0A000H-$	;
  1)   9ACD 00 00 00 00 		DS 0A000H-$	;
  1)   9AD1 00 00 00 00 		DS 0A000H-$	;
  1)   9AD5 00 00 00 00 		DS 0A000H-$	;
  1)   9AD9 00 00 00 00 		DS 0A000H-$	;
  1)   9ADD 00 00 00 00 		DS 0A000H-$	;
  1)   9AE1 00 00 00 00 		DS 0A000H-$	;
  1)   9AE5 00 00 00 00 		DS 0A000H-$	;
  1)   9AE9 00 00 00 00 		DS 0A000H-$	;
  1)   9AED 00 00 00 00 		DS 0A000H-$	;
  1)   9AF1 00 00 00 00 		DS 0A000H-$	;
  1)   9AF5 00 00 00 00 		DS 0A000H-$	;
  1)   9AF9 00 00 00 00 		DS 0A000H-$	;
  1)   9AFD 00 00 00 00 		DS 0A000H-$	;
  1)   9B01 00 00 00 00 		DS 0A000H-$	;
  1)   9B05 00 00 00 00 		DS 0A000H-$	;
  1)   9B09 00 00 00 00 		DS 0A000H-$	;
  1)   9B0D 00 00 00 00 		DS 0A000H-$	;
  1)   9B11 00 00 00 00 		DS 0A000H-$	;
  1)   9B15 00 00 00 00 		DS 0A000H-$	;
  1)   9B19 00 00 00 00 		DS 0A000H-$	;
  1)   9B1D 00 00 00 00 		DS 0A000H-$	;
  1)   9B21 00 00 00 00 		DS 0A000H-$	;
  1)   9B25 00 00 00 00 		DS 0A000H-$	;
  1)   9B29 00 00 00 00 		DS 0A000H-$	;
  1)   9B2D 00 00 00 00 		DS 0A000H-$	;
  1)   9B31 00 00 00 00 		DS 0A000H-$	;
  1)   9B35 00 00 00 00 		DS 0A000H-$	;
  1)   9B39 00 00 00 00 		DS 0A000H-$	;
  1)   9B3D 00 00 00 00 		DS 0A000H-$	;
  1)   9B41 00 00 00 00 		DS 0A000H-$	;
  1)   9B45 00 00 00 00 		DS 0A000H-$	;
  1)   9B49 00 00 00 00 		DS 0A000H-$	;
  1)   9B4D 00 00 00 00 		DS 0A000H-$	;
  1)   9B51 00 00 00 00 		DS 0A000H-$	;
  1)   9B55 00 00 00 00 		DS 0A000H-$	;
  1)   9B59 00 00 00 00 		DS 0A000H-$	;
  1)   9B5D 00 00 00 00 		DS 0A000H-$	;
  1)   9B61 00 00 00 00 		DS 0A000H-$	;
  1)   9B65 00 00 00 00 		DS 0A000H-$	;
  1)   9B69 00 00 00 00 		DS 0A000H-$	;
  1)   9B6D 00 00 00 00 		DS 0A000H-$	;
  1)   9B71 00 00 00 00 		DS 0A000H-$	;
  1)   9B75 00 00 00 00 		DS 0A000H-$	;
  1)   9B79 00 00 00 00 		DS 0A000H-$	;
  1)   9B7D 00 00 00 00 		DS 0A000H-$	;
  1)   9B81 00 00 00 00 		DS 0A000H-$	;
  1)   9B85 00 00 00 00 		DS 0A000H-$	;
  1)   9B89 00 00 00 00 		DS 0A000H-$	;
  1)   9B8D 00 00 00 00 		DS 0A000H-$	;
  1)   9B91 00 00 00 00 		DS 0A000H-$	;
  1)   9B95 00 00 00 00 		DS 0A000H-$	;
  1)   9B99 00 00 00 00 		DS 0A000H-$	;
  1)   9B9D 00 00 00 00 		DS 0A000H-$	;
  1)   9BA1 00 00 00 00 		DS 0A000H-$	;
  1)   9BA5 00 00 00 00 		DS 0A000H-$	;
  1)   9BA9 00 00 00 00 		DS 0A000H-$	;
  1)   9BAD 00 00 00 00 		DS 0A000H-$	;
  1)   9BB1 00 00 00 00 		DS 0A000H-$	;
  1)   9BB5 00 00 00 00 		DS 0A000H-$	;
  1)   9BB9 00 00 00 00 		DS 0A000H-$	;
  1)   9BBD 00 00 00 00 		DS 0A000H-$	;
  1)   9BC1 00 00 00 00 		DS 0A000H-$	;
  1)   9BC5 00 00 00 00 		DS 0A000H-$	;
  1)   9BC9 00 00 00 00 		DS 0A000H-$	;
  1)   9BCD 00 00 00 00 		DS 0A000H-$	;
  1)   9BD1 00 00 00 00 		DS 0A000H-$	;
  1)   9BD5 00 00 00 00 		DS 0A000H-$	;
  1)   9BD9 00 00 00 00 		DS 0A000H-$	;
  1)   9BDD 00 00 00 00 		DS 0A000H-$	;
  1)   9BE1 00 00 00 00 		DS 0A000H-$	;
  1)   9BE5 00 00 00 00 		DS 0A000H-$	;
  1)   9BE9 00 00 00 00 		DS 0A000H-$	;
  1)   9BED 00 00 00 00 		DS 0A000H-$	;
  1)   9BF1 00 00 00 00 		DS 0A000H-$	;
  1)   9BF5 00 00 00 00 		DS 0A000H-$	;
  1)   9BF9 00 00 00 00 		DS 0A000H-$	;
  1)   9BFD 00 00 00 00 		DS 0A000H-$	;
  1)   9C01 00 00 00 00 		DS 0A000H-$	;
  1)   9C05 00 00 00 00 		DS 0A000H-$	;
  1)   9C09 00 00 00 00 		DS 0A000H-$	;
  1)   9C0D 00 00 00 00 		DS 0A000H-$	;
  1)   9C11 00 00 00 00 		DS 0A000H-$	;
  1)   9C15 00 00 00 00 		DS 0A000H-$	;
  1)   9C19 00 00 00 00 		DS 0A000H-$	;
  1)   9C1D 00 00 00 00 		DS 0A000H-$	;
  1)   9C21 00 00 00 00 		DS 0A000H-$	;
  1)   9C25 00 00 00 00 		DS 0A000H-$	;
  1)   9C29 00 00 00 00 		DS 0A000H-$	;
  1)   9C2D 00 00 00 00 		DS 0A000H-$	;
  1)   9C31 00 00 00 00 		DS 0A000H-$	;
  1)   9C35 00 00 00 00 		DS 0A000H-$	;
  1)   9C39 00 00 00 00 		DS 0A000H-$	;
  1)   9C3D 00 00 00 00 		DS 0A000H-$	;
  1)   9C41 00 00 00 00 		DS 0A000H-$	;
  1)   9C45 00 00 00 00 		DS 0A000H-$	;
  1)   9C49 00 00 00 00 		DS 0A000H-$	;
  1)   9C4D 00 00 00 00 		DS 0A000H-$	;
  1)   9C51 00 00 00 00 		DS 0A000H-$	;
  1)   9C55 00 00 00 00 		DS 0A000H-$	;
  1)   9C59 00 00 00 00 		DS 0A000H-$	;
  1)   9C5D 00 00 00 00 		DS 0A000H-$	;
  1)   9C61 00 00 00 00 		DS 0A000H-$	;
  1)   9C65 00 00 00 00 		DS 0A000H-$	;
  1)   9C69 00 00 00 00 		DS 0A000H-$	;
  1)   9C6D 00 00 00 00 		DS 0A000H-$	;
  1)   9C71 00 00 00 00 		DS 0A000H-$	;
  1)   9C75 00 00 00 00 		DS 0A000H-$	;
  1)   9C79 00 00 00 00 		DS 0A000H-$	;
  1)   9C7D 00 00 00 00 		DS 0A000H-$	;
  1)   9C81 00 00 00 00 		DS 0A000H-$	;
  1)   9C85 00 00 00 00 		DS 0A000H-$	;
  1)   9C89 00 00 00 00 		DS 0A000H-$	;
  1)   9C8D 00 00 00 00 		DS 0A000H-$	;
  1)   9C91 00 00 00 00 		DS 0A000H-$	;
  1)   9C95 00 00 00 00 		DS 0A000H-$	;
  1)   9C99 00 00 00 00 		DS 0A000H-$	;
  1)   9C9D 00 00 00 00 		DS 0A000H-$	;
  1)   9CA1 00 00 00 00 		DS 0A000H-$	;
  1)   9CA5 00 00 00 00 		DS 0A000H-$	;
  1)   9CA9 00 00 00 00 		DS 0A000H-$	;
  1)   9CAD 00 00 00 00 		DS 0A000H-$	;
  1)   9CB1 00 00 00 00 		DS 0A000H-$	;
  1)   9CB5 00 00 00 00 		DS 0A000H-$	;
  1)   9CB9 00 00 00 00 		DS 0A000H-$	;
  1)   9CBD 00 00 00 00 		DS 0A000H-$	;
  1)   9CC1 00 00 00 00 		DS 0A000H-$	;
  1)   9CC5 00 00 00 00 		DS 0A000H-$	;
  1)   9CC9 00 00 00 00 		DS 0A000H-$	;
  1)   9CCD 00 00 00 00 		DS 0A000H-$	;
  1)   9CD1 00 00 00 00 		DS 0A000H-$	;
  1)   9CD5 00 00 00 00 		DS 0A000H-$	;
  1)   9CD9 00 00 00 00 		DS 0A000H-$	;
  1)   9CDD 00 00 00 00 		DS 0A000H-$	;
  1)   9CE1 00 00 00 00 		DS 0A000H-$	;
  1)   9CE5 00 00 00 00 		DS 0A000H-$	;
  1)   9CE9 00 00 00 00 		DS 0A000H-$	;
  1)   9CED 00 00 00 00 		DS 0A000H-$	;
  1)   9CF1 00 00 00 00 		DS 0A000H-$	;
  1)   9CF5 00 00 00 00 		DS 0A000H-$	;
  1)   9CF9 00 00 00 00 		DS 0A000H-$	;
  1)   9CFD 00 00 00 00 		DS 0A000H-$	;
  1)   9D01 00 00 00 00 		DS 0A000H-$	;
  1)   9D05 00 00 00 00 		DS 0A000H-$	;
  1)   9D09 00 00 00 00 		DS 0A000H-$	;
  1)   9D0D 00 00 00 00 		DS 0A000H-$	;
  1)   9D11 00 00 00 00 		DS 0A000H-$	;
  1)   9D15 00 00 00 00 		DS 0A000H-$	;
  1)   9D19 00 00 00 00 		DS 0A000H-$	;
  1)   9D1D 00 00 00 00 		DS 0A000H-$	;
  1)   9D21 00 00 00 00 		DS 0A000H-$	;
  1)   9D25 00 00 00 00 		DS 0A000H-$	;
  1)   9D29 00 00 00 00 		DS 0A000H-$	;
  1)   9D2D 00 00 00 00 		DS 0A000H-$	;
  1)   9D31 00 00 00 00 		DS 0A000H-$	;
  1)   9D35 00 00 00 00 		DS 0A000H-$	;
  1)   9D39 00 00 00 00 		DS 0A000H-$	;
  1)   9D3D 00 00 00 00 		DS 0A000H-$	;
  1)   9D41 00 00 00 00 		DS 0A000H-$	;
  1)   9D45 00 00 00 00 		DS 0A000H-$	;
  1)   9D49 00 00 00 00 		DS 0A000H-$	;
  1)   9D4D 00 00 00 00 		DS 0A000H-$	;
  1)   9D51 00 00 00 00 		DS 0A000H-$	;
  1)   9D55 00 00 00 00 		DS 0A000H-$	;
  1)   9D59 00 00 00 00 		DS 0A000H-$	;
  1)   9D5D 00 00 00 00 		DS 0A000H-$	;
  1)   9D61 00 00 00 00 		DS 0A000H-$	;
  1)   9D65 00 00 00 00 		DS 0A000H-$	;
  1)   9D69 00 00 00 00 		DS 0A000H-$	;
  1)   9D6D 00 00 00 00 		DS 0A000H-$	;
  1)   9D71 00 00 00 00 		DS 0A000H-$	;
  1)   9D75 00 00 00 00 		DS 0A000H-$	;
  1)   9D79 00 00 00 00 		DS 0A000H-$	;
  1)   9D7D 00 00 00 00 		DS 0A000H-$	;
  1)   9D81 00 00 00 00 		DS 0A000H-$	;
  1)   9D85 00 00 00 00 		DS 0A000H-$	;
  1)   9D89 00 00 00 00 		DS 0A000H-$	;
  1)   9D8D 00 00 00 00 		DS 0A000H-$	;
  1)   9D91 00 00 00 00 		DS 0A000H-$	;
  1)   9D95 00 00 00 00 		DS 0A000H-$	;
  1)   9D99 00 00 00 00 		DS 0A000H-$	;
  1)   9D9D 00 00 00 00 		DS 0A000H-$	;
  1)   9DA1 00 00 00 00 		DS 0A000H-$	;
  1)   9DA5 00 00 00 00 		DS 0A000H-$	;
  1)   9DA9 00 00 00 00 		DS 0A000H-$	;
  1)   9DAD 00 00 00 00 		DS 0A000H-$	;
  1)   9DB1 00 00 00 00 		DS 0A000H-$	;
  1)   9DB5 00 00 00 00 		DS 0A000H-$	;
  1)   9DB9 00 00 00 00 		DS 0A000H-$	;
  1)   9DBD 00 00 00 00 		DS 0A000H-$	;
  1)   9DC1 00 00 00 00 		DS 0A000H-$	;
  1)   9DC5 00 00 00 00 		DS 0A000H-$	;
  1)   9DC9 00 00 00 00 		DS 0A000H-$	;
  1)   9DCD 00 00 00 00 		DS 0A000H-$	;
  1)   9DD1 00 00 00 00 		DS 0A000H-$	;
  1)   9DD5 00 00 00 00 		DS 0A000H-$	;
  1)   9DD9 00 00 00 00 		DS 0A000H-$	;
  1)   9DDD 00 00 00 00 		DS 0A000H-$	;
  1)   9DE1 00 00 00 00 		DS 0A000H-$	;
  1)   9DE5 00 00 00 00 		DS 0A000H-$	;
  1)   9DE9 00 00 00 00 		DS 0A000H-$	;
  1)   9DED 00 00 00 00 		DS 0A000H-$	;
  1)   9DF1 00 00 00 00 		DS 0A000H-$	;
  1)   9DF5 00 00 00 00 		DS 0A000H-$	;
  1)   9DF9 00 00 00 00 		DS 0A000H-$	;
  1)   9DFD 00 00 00 00 		DS 0A000H-$	;
  1)   9E01 00 00 00 00 		DS 0A000H-$	;
  1)   9E05 00 00 00 00 		DS 0A000H-$	;
  1)   9E09 00 00 00 00 		DS 0A000H-$	;
  1)   9E0D 00 00 00 00 		DS 0A000H-$	;
  1)   9E11 00 00 00 00 		DS 0A000H-$	;
  1)   9E15 00 00 00 00 		DS 0A000H-$	;
  1)   9E19 00 00 00 00 		DS 0A000H-$	;
  1)   9E1D 00 00 00 00 		DS 0A000H-$	;
  1)   9E21 00 00 00 00 		DS 0A000H-$	;
  1)   9E25 00 00 00 00 		DS 0A000H-$	;
  1)   9E29 00 00 00 00 		DS 0A000H-$	;
  1)   9E2D 00 00 00 00 		DS 0A000H-$	;
  1)   9E31 00 00 00 00 		DS 0A000H-$	;
  1)   9E35 00 00 00 00 		DS 0A000H-$	;
  1)   9E39 00 00 00 00 		DS 0A000H-$	;
  1)   9E3D 00 00 00 00 		DS 0A000H-$	;
  1)   9E41 00 00 00 00 		DS 0A000H-$	;
  1)   9E45 00 00 00 00 		DS 0A000H-$	;
  1)   9E49 00 00 00 00 		DS 0A000H-$	;
  1)   9E4D 00 00 00 00 		DS 0A000H-$	;
  1)   9E51 00 00 00 00 		DS 0A000H-$	;
  1)   9E55 00 00 00 00 		DS 0A000H-$	;
  1)   9E59 00 00 00 00 		DS 0A000H-$	;
  1)   9E5D 00 00 00 00 		DS 0A000H-$	;
  1)   9E61 00 00 00 00 		DS 0A000H-$	;
  1)   9E65 00 00 00 00 		DS 0A000H-$	;
  1)   9E69 00 00 00 00 		DS 0A000H-$	;
  1)   9E6D 00 00 00 00 		DS 0A000H-$	;
  1)   9E71 00 00 00 00 		DS 0A000H-$	;
  1)   9E75 00 00 00 00 		DS 0A000H-$	;
  1)   9E79 00 00 00 00 		DS 0A000H-$	;
  1)   9E7D 00 00 00 00 		DS 0A000H-$	;
  1)   9E81 00 00 00 00 		DS 0A000H-$	;
  1)   9E85 00 00 00 00 		DS 0A000H-$	;
  1)   9E89 00 00 00 00 		DS 0A000H-$	;
  1)   9E8D 00 00 00 00 		DS 0A000H-$	;
  1)   9E91 00 00 00 00 		DS 0A000H-$	;
  1)   9E95 00 00 00 00 		DS 0A000H-$	;
  1)   9E99 00 00 00 00 		DS 0A000H-$	;
  1)   9E9D 00 00 00 00 		DS 0A000H-$	;
  1)   9EA1 00 00 00 00 		DS 0A000H-$	;
  1)   9EA5 00 00 00 00 		DS 0A000H-$	;
  1)   9EA9 00 00 00 00 		DS 0A000H-$	;
  1)   9EAD 00 00 00 00 		DS 0A000H-$	;
  1)   9EB1 00 00 00 00 		DS 0A000H-$	;
  1)   9EB5 00 00 00 00 		DS 0A000H-$	;
  1)   9EB9 00 00 00 00 		DS 0A000H-$	;
  1)   9EBD 00 00 00 00 		DS 0A000H-$	;
  1)   9EC1 00 00 00 00 		DS 0A000H-$	;
  1)   9EC5 00 00 00 00 		DS 0A000H-$	;
  1)   9EC9 00 00 00 00 		DS 0A000H-$	;
  1)   9ECD 00 00 00 00 		DS 0A000H-$	;
  1)   9ED1 00 00 00 00 		DS 0A000H-$	;
  1)   9ED5 00 00 00 00 		DS 0A000H-$	;
  1)   9ED9 00 00 00 00 		DS 0A000H-$	;
  1)   9EDD 00 00 00 00 		DS 0A000H-$	;
  1)   9EE1 00 00 00 00 		DS 0A000H-$	;
  1)   9EE5 00 00 00 00 		DS 0A000H-$	;
  1)   9EE9 00 00 00 00 		DS 0A000H-$	;
  1)   9EED 00 00 00 00 		DS 0A000H-$	;
  1)   9EF1 00 00 00 00 		DS 0A000H-$	;
  1)   9EF5 00 00 00 00 		DS 0A000H-$	;
  1)   9EF9 00 00 00 00 		DS 0A000H-$	;
  1)   9EFD 00 00 00 00 		DS 0A000H-$	;
  1)   9F01 00 00 00 00 		DS 0A000H-$	;
  1)   9F05 00 00 00 00 		DS 0A000H-$	;
  1)   9F09 00 00 00 00 		DS 0A000H-$	;
  1)   9F0D 00 00 00 00 		DS 0A000H-$	;
  1)   9F11 00 00 00 00 		DS 0A000H-$	;
  1)   9F15 00 00 00 00 		DS 0A000H-$	;
  1)   9F19 00 00 00 00 		DS 0A000H-$	;
  1)   9F1D 00 00 00 00 		DS 0A000H-$	;
  1)   9F21 00 00 00 00 		DS 0A000H-$	;
  1)   9F25 00 00 00 00 		DS 0A000H-$	;
  1)   9F29 00 00 00 00 		DS 0A000H-$	;
  1)   9F2D 00 00 00 00 		DS 0A000H-$	;
  1)   9F31 00 00 00 00 		DS 0A000H-$	;
  1)   9F35 00 00 00 00 		DS 0A000H-$	;
  1)   9F39 00 00 00 00 		DS 0A000H-$	;
  1)   9F3D 00 00 00 00 		DS 0A000H-$	;
  1)   9F41 00 00 00 00 		DS 0A000H-$	;
  1)   9F45 00 00 00 00 		DS 0A000H-$	;
  1)   9F49 00 00 00 00 		DS 0A000H-$	;
  1)   9F4D 00 00 00 00 		DS 0A000H-$	;
  1)   9F51 00 00 00 00 		DS 0A000H-$	;
  1)   9F55 00 00 00 00 		DS 0A000H-$	;
  1)   9F59 00 00 00 00 		DS 0A000H-$	;
  1)   9F5D 00 00 00 00 		DS 0A000H-$	;
  1)   9F61 00 00 00 00 		DS 0A000H-$	;
  1)   9F65 00 00 00 00 		DS 0A000H-$	;
  1)   9F69 00 00 00 00 		DS 0A000H-$	;
  1)   9F6D 00 00 00 00 		DS 0A000H-$	;
  1)   9F71 00 00 00 00 		DS 0A000H-$	;
  1)   9F75 00 00 00 00 		DS 0A000H-$	;
  1)   9F79 00 00 00 00 		DS 0A000H-$	;
  1)   9F7D 00 00 00 00 		DS 0A000H-$	;
  1)   9F81 00 00 00 00 		DS 0A000H-$	;
  1)   9F85 00 00 00 00 		DS 0A000H-$	;
  1)   9F89 00 00 00 00 		DS 0A000H-$	;
  1)   9F8D 00 00 00 00 		DS 0A000H-$	;
  1)   9F91 00 00 00 00 		DS 0A000H-$	;
  1)   9F95 00 00 00 00 		DS 0A000H-$	;
  1)   9F99 00 00 00 00 		DS 0A000H-$	;
  1)   9F9D 00 00 00 00 		DS 0A000H-$	;
  1)   9FA1 00 00 00 00 		DS 0A000H-$	;
  1)   9FA5 00 00 00 00 		DS 0A000H-$	;
  1)   9FA9 00 00 00 00 		DS 0A000H-$	;
  1)   9FAD 00 00 00 00 		DS 0A000H-$	;
  1)   9FB1 00 00 00 00 		DS 0A000H-$	;
  1)   9FB5 00 00 00 00 		DS 0A000H-$	;
  1)   9FB9 00 00 00 00 		DS 0A000H-$	;
  1)   9FBD 00 00 00 00 		DS 0A000H-$	;
  1)   9FC1 00 00 00 00 		DS 0A000H-$	;
  1)   9FC5 00 00 00 00 		DS 0A000H-$	;
  1)   9FC9 00 00 00 00 		DS 0A000H-$	;
  1)   9FCD 00 00 00 00 		DS 0A000H-$	;
  1)   9FD1 00 00 00 00 		DS 0A000H-$	;
  1)   9FD5 00 00 00 00 		DS 0A000H-$	;
  1)   9FD9 00 00 00 00 		DS 0A000H-$	;
  1)   9FDD 00 00 00 00 		DS 0A000H-$	;
  1)   9FE1 00 00 00 00 		DS 0A000H-$	;
  1)   9FE5 00 00 00 00 		DS 0A000H-$	;
  1)   9FE9 00 00 00 00 		DS 0A000H-$	;
  1)   9FED 00 00 00 00 		DS 0A000H-$	;
  1)   9FF1 00 00 00 00 		DS 0A000H-$	;
  1)   9FF5 00 00 00 00 		DS 0A000H-$	;
  1)   9FF9 00 00 00 00 		DS 0A000H-$	;
  1)   9FFD 00 00 00    		DS 0A000H-$	;
