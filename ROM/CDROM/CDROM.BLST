 25)   C000 9C C1       		       DEFW    EXEC	;
 32)   C002 17 C3       		       DEFW    CM2HL	;
 39)   C004 15 C3       		       DEFW    CMTHRE	;
 46)   C006 61 C1       		       DEFW    CMOBJ	;
 53)   C008 13 C3       		       DEFW    CPSH	;
 60)   C00A 10 C3       		       DEFW    CPSH0	;
 70)   C00C 40 C3       		       DEFW    CLABEL	;
 77)   C00E F8 C3       		       DEFW    SETS2	;
 84)   C010 FA C3       		       DEFW    SETSN	;
 91)   C012 09 C4       		       DEFW    XLISTN	;
 98)   C014 DF D8       		       DEFW    NUMASS	;
108)   C016 4C C5       		       DEFW    CPINT	;
115)   C018 A1 C4       		       DEFW    CDEVO	;
122)   C01A 85 C5       		       DEFW    PRNSTR	;
129)   C01C 93 C5       		       DEFW    PRSTR	;
136)   C01E EB C6       		       DEFW    QSTR	;
143)   C020 08 C7       		       DEFW    LDSTR	;
153)   C022 59 C9       		       DEFW    GFNAME	;
160)   C024 F7 C8       		       DEFW    XDIM	;
170)   C026 7C D2       		       DEFW    STRCON	;
177)   C028 D2 D2       		       DEFW    NEWSTR	;
184)   C02A EF D2       		       DEFW    MKSTAB	;
191)   C02C 99 D3       		       DEFW    NUMEXP	;
198)   C02E A0 D3       		       DEFW    STREXP	;
205)   C030 A9 D3       		       DEFW    EXPN	;
213)   C032 4E D5       		       DEFW    VARIA	;
223)   C034 7C D5       		       DEFW    FINDVC	;
230)   C036 A0 D5       		       DEFW    ADDSYM	;
237)   C038 A3 D5       		       DEFW    INSERT	;
244)   C03A BC D5       		       DEFW    GETVNM	;
251)   C03C 25 D6       		       DEFW    SCAN	;
258)   C03E 3C D6       		       DEFW    NCONST	;
265)   C040 72 D6       		       DEFW    AMENDL	;
272)   C042 AF D7       		       DEFW    INITOB	;
279)   C044 0A D8       		       DEFW    INTIN	;
286)   C046 2C D8       		       DEFW    CHROOM	;
293)   C048 30 D8       		       DEFW    NCROOM	;
300)   C04A 3A D8       		       DEFW    ROOMQ	;
307)   C04C 4C D8       		       DEFW    PT#HL	;
314)   C04E 78 D8       		       DEFW    FLNT	;
321)   C050 8B D8       		       DEFW    NLNT	;
328)   C052 A7 D8       		       DEFW    FIND	;
338)   C054 BB D8       		       DEFW    POP	;
345)   C056 C1 D8       		       DEFW    UNST2	;
352)   C058 F1 D8       		       DEFW    PUSHFP	;
359)   C05A 17 D9       		       DEFW    LPSTR1	;
366)   C05C 00 D9       		       DEFW    UNST6	;
373)   C05E 20 DA       		       DEFW    UNSTSS	;
380)   C060 29 DA       		       DEFW    CHKSS	;
387)   C062 74 DA       		       DEFW    PUSH2	;
397)   C064 9D DA       		       DEFW    STINST	;
404)   C066 1F DB       		       DEFW    RDCH	;
411)   C068 26 DB       		       DEFW    RDNCH	;
418)   C06A 07 DB       		       DEFW    SVINST	;
425)   C06C 13 DB       		       DEFW    RSINST	;
432)   C06E 3C DB       		       DEFW    RDNSCH	;
439)   C070 37 DB       		       DEFW    RDSCH	;
446)   C072 49 DB       		       DEFW    PTMSG	;
453)   C074 59 DB       		       DEFW    PTEOF	;
460)   C076 5E DB       		       DEFW    PTNL	;
467)   C078 60 DB       		       DEFW    PTCHAR	;
474)   C07A F0 DB       		       DEFW    DIGIT	;
481)   C07C FC DB       		       DEFW    CHKCR	;
488)   C07E 02 DC       		       DEFW    CHKCLS	;
495)   C080 08 DC       		       DEFW    CHKCOM	;
502)   C082 0E DC       		       DEFW    CHKEQ	;
509)   C084 14 DC       		       DEFW    CHKHSH	;
516)   C086 1A DC       		       DEFW    CHKQUO	;
523)   C088 20 DC       		       DEFW    CHKOPN	;
531)   C08A 4B DC       		       DEFW    INUSS	;
538)   C08C 64 DC       		       DEFW    DLUSS	;
545)   C08E 0A C5       		       DEFW    FORMAT	;
552)   C090 BB DC       		       DEFW    NOTBC	;
563)   C092 38 C1       		       DEFW    COMMAN	;
570)   C094 1B D6       		       DEFW    ASFNM	;
577)   C096 1E C3       		       DEFW    STATEL	;
584)   C098 01 D3       		       DEFW    MKNULL	;
591)   C09A 73 D4       		       DEFW    NUMFN	;
598)   C09C D3 DA       		       DEFW    RDLINE	;
605)   C09E F9 DA       		       DEFW    RDLIN2	;
612)   C0A0 07 D6       		       DEFW    SSFNM	;
619)   C0A2 9F D4       		       DEFW    STRSFN	;
626)   C0A4 2C C3       		       DEFW    XCL3	;
633)   C0A6 E6 D4       		       DEFW    VARIAB	;
640)   C0A8 5D D5       		       DEFW    INITST	;
647)   C0AA F7 C1       		       DEFW    REPORT	;
654)   C0AC D2 C9       		       DEFW    XNEW	;
661)   C0AE D0 C2       		       DEFW    CMONE	;
675)   C0B0 87 D3       		       DEFW    ELNUM	;
682)   C0B2 6E CE       		       DEFW    RDFN	;
689)   C0B4 0C C3       		       DEFW    CREM	;
696)   C0B6 33 D1       		       DEFW    TETOLN	;
703)   C0B8 6B D1       		       DEFW    LNTOTE	;
710)   C0BA A7 D1       		       DEFW    TTLN	;
717)   C0BC C6 D1       		       DEFW    LNTT	;
724)   C0BE AB D7       		       DEFW    XCLEA2	;
731)   C0C0 24 C6       		       DEFW    STCIN	;
738)   C0C2 44 DC       		       DEFW    DLSTAB	;
745)   C0C4 69 D2       		       DEFW    LAST	;
752)   C0C6 81 D8       		       DEFW    LANG	;
759)   C0C8 9F D8       		       DEFW    NFIND	;
766)   C0CA 8F D8       		       DEFW    LLN2	;
773)   C0CC 7B D6       		       DEFW    LAM1	;
780)   C0CE 11 D0       		       DEFW    TSTPPF	;
787)   C0D0 1F D0       		       DEFW    UPDPPF	;
794)   C0D2 5F D7       		       DEFW    CODFTK	;
801)   C0D4 64 D7       		       DEFW    CODSTK	;
808)   C0D6 F7 DB       		       DEFW    CHECK	;
815)   C0D8 68 DB       		       DEFW    NBKTST	;
822)   C0DA 77 DB       		       DEFW    UPDLNT	;
829)   C0DC 5F DC       		       DEFW    INSS	;
836)   C0DE 66 DC       		       DEFW    DELT	;
843)   C0E0 B1 DA       		       DEFW    MKRL	;
850)   C0E2 C3 DA       		       DEFW    MKAB	;
124)   C0E4 FD 2A 04 00 		       LD IY,(B3PRM)	;
125)   C0E8 2A 06 00    		       LD HL,(B4)	;
126)   C0EB FD 75 20    		       LD (IY+TOP),L	;
127)   C0EE FD 74 21    		       LD (IY+TOP+1),H	;
128)   C0F1 D7 56       		       DEFW ZXNEW	;
129)   C0F3 CD B8 C2    		       CALL STRTUP	;
131)   C0F6 21 08 40    		       LD HL,040H*256+8        ;free format 8sfigs	;free format 8sfigs
132)   C0F9 22 74 00    		       LD (DEFNF),HL	;
134)   C0FC D7 39       		       DEFW ZPTMSG	;
135)   C0FE 0F          		       DEFB 15	;
136)   C0FF 4E 45 57 42 		       DEFM 'NEWBRAIN BASIC'	;
136)   C103 52 41 49 4E 		       DEFM 'NEWBRAIN BASIC'	;
136)   C107 20 42 41 53 		       DEFM 'NEWBRAIN BASIC'	;
136)   C10B 49 43       		       DEFM 'NEWBRAIN BASIC'	;
137)   C10D 0D          		       DEFB 13	;
140)   C10E D7 39       		       DEFW ZPTMSG	;
141)   C110 05          		       DEFB 5	;
142)   C111 52 45 41 44 		          DEFM 'READY'	;
142)   C115 59          		          DEFM 'READY'	;
144)   C116 D7 55       		       DEFW ZREPORT	;
145)   C118 1E 00       		LMAIN4: LD E,0	;
146)   C11A CD 98 D8    		       CALL GTOP	;
147)   C11D E5          		       PUSH HL	;
148)   C11E DD E1       		       POP IX	;
149)   C120 D7 4E       		       DEFW ZRDLINE	;
150)   C122 38 F2       		       JR C,LMAIN2	;
151)   C124 D7 38       		       DEFW ZRDSCH     ;Switch on 1st sig. chr.	;Switch on 1st sig. chr.
152)   C126 FE 0D       		       CP 15Q	;
153)   C128 28 E4       		       JR Z,READY              ;J. if empty line	;J. if empty line
154)   C12A D7 3D       		       DEFW ZDIGIT	;
155)   C12C 38 06       		       JR C,LMAIN3	;
156)   C12E D7 20       		       DEFW ZAMENDL	;
157)   C130 38 E4       		       JR C LMAIN2	;
158)   C132 18 E4       		       JR LMAIN4	;
160)   C134 D7 49       		LMAIN3: DEFW ZCOMMAN	;
161)   C136 18 E0       		       JR LMAIN4	;
164)   C138 21 00 00    		       LD HL,0	;
165)   C13B D7 66       		       DEFW ZLAM1	;
166)   C13D CD AE D0    		       CALL SLNTT      ;LNTOTE saving AF	;LNTOTE saving AF
167)   C140 CD 2F DC    		       CALL GLBAS	;
168)   C143 DF 00       		LCM3:  DEFW WEXEC	;
169)   C145 38 12       		       JR C LCM4	;
170)   C147 28 FA       		       JR Z,LCM3	;
171)   C149 CD C8 C2    		       CALL TSTCUR	;
172)   C14C 28 06       		       JR Z LCM5	;
173)   C14E D7 28       		       DEFW ZNLNT	;
174)   C150 3E 03       		       LD A,3	;
175)   C152 18 EF       		       JR LCM3	;
176)   C154 D7 62       		LCM5:  DEFW ZLAST	;
177)   C156 28 EB       		       JR Z LCM3	;
178)   C158 B7          		       OR A	;
179)   C159 D7 55       		LCM4:  DEFW ZREPORT	;
180)   C15B 3F          		       CCF	;
181)   C15C 30 E5       		       JR NC LCM3	;
182)   C15E D7 5B       		       DEFW ZTETOLN	;
183)   C160 C9          		       RET	;
188)   C161 CD 93 C1    		       CALL GOPTR	;
189)   C164 C0          		       RET NZ	;
190)   C165 FD CB 22 DE 		       SET 3,(IY+FLAGS)	;
191)   C169 DD E5       		       PUSH IX	;
192)   C16B E1          		       POP HL	;
193)   C16C D7 32       		       DEFW ZSTINST            	;
194)   C16E CD 3D DC    		       CALL GOTOP	;
195)   C171 CD 01 D8    		       CALL LOPTR	;
196)   C174 D7 01       		       DEFW ZCM2HL             ;leave room for length	;leave room for length
198)   C176 DF 4B       		       DEFW WLSTATE	;
199)   C178 FD CB 22 9E 		       RES 3,(IY+FLAGS)	;
200)   C17C 21 00 00    		       LD HL,0	;
201)   C17F DA 03 D8    		       JP C LOPTR1	;
202)   C182 CD 93 C1    		       CALL GOPTR	;
203)   C185 EB          		       EX DE,HL	;
204)   C186 1B          		       DEC DE	;
205)   C187 1B          		       DEC DE	;
206)   C188 CD 3D DC    		       CALL GOTOP	;
207)   C18B ED 52       		       SBC HL,DE	;
208)   C18D EB          		       EX DE,HL	;
209)   C18E 73          		       LD (HL),E       ;HL->OBJ CODE RECORD,DE=LENGTH	;HL->OBJ CODE RECORD,DE=LENGTH
210)   C18F 23          		       INC HL	;
211)   C190 72          		       LD (HL),D	;
212)   C191 23          		       INC HL	;
213)   C192 C9          		       RET	;
215)   C193 DD 66 05    		GOPTR: LD H,(IX+5)	;
216)   C196 DD 6E 04    		       LD L,(IX+4)	;
217)   C199 7C          		       LD A,H	;
218)   C19A B5          		       OR L	;
219)   C19B C9          		       RET	;
228)   C19C E5          		       PUSH HL	;
229)   C19D DD E1       		       POP IX	;
230)   C19F FD CB 22 C6 		       SET 0,(IY+FLAGS)	;
232)   C1A3 D7 6C       		       DEFW ZNBKTST	;
233)   C1A5 D8          		       RET C	;
234)   C1A6 CD 93 C1    		       CALL GOPTR	;
235)   C1A9 20 03       		       JR NZ LXR21	;
236)   C1AB D7 03       		       DEFW ZCMOBJ	;
237)   C1AD D8          		       RET C	;
238)   C1AE FD 36 2D 00 		LXR21: LD (IY+OMOVE+1),0	;
239)   C1B2 7E          		LXR215: LD A,(HL)      ;HERE WITH HL->OBJ CODE	;HERE WITH HL->OBJ CODE
240)   C1B3 23          		       INC HL	;
241)   C1B4 87          		       ADD A,A	;
242)   C1B5 30 04       		       JR NC,LEX3	;
243)   C1B7 D7 52       		       DEFW ZXCL3	;
244)   C1B9 18 03       		       JR LEX4	;
246)   C1BB CD DF C1    		LEX3:  CALL XARITH	;
247)   C1BE 06 00       		LEX4:  LD B,0	;
248)   C1C0 04          		       INC B                   ; set NZ	; set NZ
249)   C1C1 D0          		       RET NC          ;if finished stmt.	;if finished stmt.
250)   C1C2 FE FE       		       CP 254	;
251)   C1C4 C8          		       RET Z           ;if code 254	;if code 254
252)   C1C5 D8          		       RET C	;
253)   C1C6 FD 7E 2D    		       LD A,(IY+OMOVE+1)       ;Here if code 255.	;Here if code 255.
254)   C1C9 A7          		       AND A	;
255)   C1CA 28 E6       		       JR Z,LXR215	;
256)   C1CC 57          		       LD D,A          ;HERE IF OBJ CODE HAS MOVED	;HERE IF OBJ CODE HAS MOVED
257)   C1CD FD 5E 2C    		       LD E,(IY+OMOVE)	;
258)   C1D0 19          		       ADD HL,DE	;
259)   C1D1 18 DB       		       JR LXR21	;
262)   C1D3 E5          		XAR2AD: PUSH HL	;
263)   C1D4 CD 3C DA    		       CALL AR2ADR	;
264)   C1D7 18 19       		       JR XRUN1D	;
266)   C1D9 E5          		XAR1AD: PUSH HL	;
267)   C1DA CD 12 DA    		       CALL AR1ADR	;
268)   C1DD 18 13       		       JR XRUN1D	;
273)   C1DF E5          		       PUSH HL	;
274)   C1E0 47          		       LD B,A          ;save op-code in B	;save op-code in B
275)   C1E1 21 06 00    		       LD HL,6	;
276)   C1E4 CD 2C D8    		       CALL CHROOM     ;check room for answer	;check room for answer
277)   C1E7 38 09       		       JR C XRUN1D     ;if no room	;if no room
278)   C1E9 78          		       LD A,B          ;restore op-code to A	;restore op-code to A
279)   C1EA CD 36 DC    		       CALL GUSTP      ;USRSTP to HL	;USRSTP to HL
280)   C1ED E7 23       		       DEFW ZMATHS     ;enter maths pack	;enter maths pack
281)   C1EF D4 8C C5    		XRUN1C: CALL NC LDUSTP ;set USRSTP to answer	;set USRSTP to answer
282)   C1F2 E1          		XRUN1D: POP HL	;
283)   C1F3 D8          		       RET C	;
284)   C1F4 37          		       SCF	;
285)   C1F5 9F          		       SBC A,A         ;set A=255	;set A=255
286)   C1F6 C9          		       RET	;
294)   C1F7 FD 36 06 00 		       LD (IY+OUTCON),0        ;to fix LFs on OUT!	;to fix LFs on OUT!
295)   C1FB FD CB 22 86 		       RES 0,(IY+FLAGS)	;
296)   C1FF CD 55 D7    		       CALL DISPOSE	;
297)   C202 D2 A5 C2    		       JP NC PTLN1	;
298)   C205 FE 01       		       CP 1	;
299)   C207 CA A5 C2    		       JP Z PTLN1	;
300)   C20A F5          		       PUSH AF	;
301)   C20B CD C8 C2    		       CALL TSTCUR	;
302)   C20E 28 50       		       JR Z LREP2	;
303)   C210 D7 65       		       DEFW ZLLN2	;
304)   C212 38 4C       		       JR C LREP2	;
305)   C214 EB          		       EX DE,HL	;
306)   C215 FD E5       		       PUSH IY	;
307)   C217 E1          		       POP HL	;
308)   C218 01 27 00    		       LD BC,CLINNO	;
309)   C21B 09          		       ADD HL,BC	;
310)   C21C 73          		       LD (HL),E	;
311)   C21D 23          		       INC HL	;
312)   C21E 72          		       LD (HL),D	;
313)   C21F 2B          		       DEC HL	;
314)   C220 D7 5D       		       DEFW ZTTLN	;
315)   C222 F1          		       POP AF	;
316)   C223 30 1D       		       JR NC,LREP3	;
317)   C225 FD 66 3C    		       LD H,(IY+BRKLIN+1)	;
318)   C228 FD 6E 3B    		       LD L,(IY+BRKLIN)	;
319)   C22B 7D          		       LD A,L	;
320)   C22C B4          		       OR H	;
321)   C22D 20 0D       		       JR NZ LREP1	;
322)   C22F D7 39       		LREP9: DEFW ZPTMSG	;
323)   C231 08 0D       		           DEFB 8,13	;
324)   C233 53 54 4F 50 		           DEFM 'STOPPED'	;
324)   C237 50 45 44    		           DEFM 'STOPPED'	;
325)   C23A 18 37       		       JR PTLN	;
327)   C23C FD CB 22 CE 		LREP1: SET 1,(IY+FLAGS)	;
328)   C240 18 0E       		       JR LREP8	;
330)   C242 FD 77 08    		LREP3: LD (IY+ERRNO),A	;
331)   C245 FD 66 3A    		       LD H,(IY+ERRLIN+1)	;
332)   C248 FD 6E 39    		       LD L,(IY+ERRLIN)	;
333)   C24B 4F          		       LD C,A	;
334)   C24C 7C          		       LD A,H	;
335)   C24D B5          		       OR L	;
336)   C24E 28 14       		       JR Z LREP6	;
337)   C250 D7 29       		LREP8: DEFW ZFIND	;
338)   C252 3E 61       		       LD A,97	;
339)   C254 38 0D       		       JR C LREP7	;
340)   C256 EB          		       EX DE,HL	;
341)   C257 CD 4C C3    		       CALL LXG1	;
342)   C25A FE 0A       		       CP 10	;
343)   C25C 28 05       		       JR Z LREP7	;
344)   C25E 37          		       SCF	;
345)   C25F C9          		       RET	;
347)   C260 F1          		LREP2: POP AF	;
348)   C261 38 CC       		       JR C LREP9	;
349)   C263 4F          		LREP7: LD C,A	;
350)   C264 D7 39       		LREP6: DEFW ZPTMSG     ;code in C	;code in C
351)   C266 07 0D       		          DEFB 7,13	;
352)   C268 45 52 52 4F 		          DEFM 'ERROR '	;
352)   C26C 52 20       		          DEFM 'ERROR '	;
353)   C26E 69          		       LD L,C	;
354)   C26F 26 00       		       LD H,0           	;
355)   C271 DF 26       		       DEFW WPT#HL	;
358)   C273 38 35       		       JR C LREP4	;
359)   C275 CD C8 C2    		       CALL TSTCUR	;
360)   C278 28 2B       		       JR Z PTLN1	;
361)   C27A D7 65       		       DEFW ZLLN2	;
362)   C27C 38 27       		       JR C PTLN1	;
363)   C27E D7 39       		       DEFW ZPTMSG	;
364)   C280 04          		          DEFB 4	;
365)   C281 20 41 54 20 		          DEFM ' AT '	;
366)   C285 FD 66 28    		       LD H,(IY+CLINNO+1)	;
367)   C288 FD 6E 27    		       LD L,(IY+CLINNO)	;
368)   C28B E5          		       PUSH HL	;
369)   C28C DF 26       		       DEFW WPT#HL	;
370)   C28E E1          		       POP HL	;
371)   C28F 38 19       		       JR C LREP4	;
372)   C291 D7 29       		       DEFW ZFIND	;
373)   C293 D7 62       		       DEFW ZLAST	;
374)   C295 20 0E       		       JR NZ PTLN1	;
375)   C297 3E 3A       		       LD A,':'	;
376)   C299 D7 3C       		       DEFW ZPTCHAR	;
377)   C29B 26 00       		       LD H,0	;
378)   C29D FD 6E 29    		       LD L,(IY+CLINNO+2)	;
379)   C2A0 2C          		       INC L	;
380)   C2A1 DF 26       		       DEFW WPT#HL	;
381)   C2A3 38 05       		       JR C LREP4	;
382)   C2A5 D7 5F       		PTLN1: DEFW ZXCLE2	;
383)   C2A7 D7 3B       		       DEFW ZPTNL	;
384)   C2A9 D0          		       RET NC	;
385)   C2AA 1E 00       		LREP4: LD E,0	;
386)   C2AC F5          		       PUSH AF	;
387)   C2AD E7 34       		LREP5: DEFW ZCLOSE	;
388)   C2AF 1C          		       INC E	;
389)   C2B0 20 FB       		       JR NZ LREP5	;
390)   C2B2 CD B8 C2    		       CALL STRTUP	;
391)   C2B5 F1          		       POP AF	;
392)   C2B6 18 AB       		       JR LREP7	;
394)   C2B8 3A 0B 00    		STRTUP: LD A,(DEV0)	;
395)   C2BB 11 00 00    		       LD DE,0	;
396)   C2BE ED 4B 36 00 		       LD BC,(DPSL)	;
397)   C2C2 2A 34 00    		       LD HL,(DPSP)	;
398)   C2C5 E7 33       		       DEFW ZOPNOUT	;
399)   C2C7 C9          		       RET	;
401)   C2C8 DD E5       		TSTCUR: PUSH IX	;
402)   C2CA E1          		       POP HL	;
403)   C2CB 7E          		       LD A,(HL)	;
404)   C2CC 23          		       INC HL	;
405)   C2CD B6          		       OR (HL)	;
406)   C2CE 2B          		       DEC HL	;
407)   C2CF C9          		       RET	;
415)   C2D0 B7          		       OR A	;
416)   C2D1 FD CB 22 6E 		       BIT 5,(IY+FLAGS)	;
417)   C2D5 C0          		       RET NZ          ;if in no compile mode	;if in no compile mode
418)   C2D6 C5          		       PUSH BC	;
419)   C2D7 D5          		       PUSH DE	;
420)   C2D8 E5          		       PUSH HL	;
421)   C2D9 4F          		       LD C,A	;
422)   C2DA 21 01 00    		       LD HL,1	;
423)   C2DD D7 24       		       DEFW ZNCROOM	;
425)   C2DF 38 0B       		       JR C,CMONE1	;
426)   C2E1 CD 3D DC    		       CALL GOTOP	;
427)   C2E4 71          		       LD (HL),C	;
428)   C2E5 23          		       INC HL	;
429)   C2E6 FD 75 10    		       LD (IY+OTOP),L	;
430)   C2E9 FD 74 11    		       LD (IY+OTOP+1),H	;
431)   C2EC E1          		CMONE1: POP HL	;
432)   C2ED D1          		       POP DE	;
433)   C2EE C1          		       POP BC	;
434)   C2EF C9          		       RET	;
437)   C2F0 06 B0       		       LD B,TBASE	;
438)   C2F2 D7 6B       		       DEFW ZCHECK	;
439)   C2F4 3E 44       		       LD A,68	;
440)   C2F6 D8          		       RET C	;
441)   C2F7 D7 22       		       DEFW ZINTIN	;
442)   C2F9 7D          		       LD A,L	;
443)   C2FA 1F          		       RRA             	;
444)   C2FB B4          		       OR H	;
445)   C2FC 3E 46       		       LD A,70         ;unless HL=0 or 1 & INTIN left carry clear	;unless HL=0 or 1 & INTIN left carry clear
446)   C2FE 37          		       SCF	;
447)   C2FF C0          		       RET NZ          	;
448)   C300 3D          		       DEC A	;
449)   C301 FD CB 2A 7E 		       BIT 7,(IY+BASFLG)	;
450)   C305 C0          		       RET NZ          ;if musntn't change base flag now	;if musntn't change base flag now
451)   C306 D7 3E       		       DEFW    ZCHKCR	;
452)   C308 D8          		       RET C	;
453)   C309 FD 75 2A    		       LD (IY+BASFLG),L	;
454)   C30C 3E E5       		CREM   LD A,YREM       ;compile REM stmt	;compile REM stmt
455)   C30E 18 0B       		       JR LCM1	;
457)   C310 21 00 00    		CPSH0: LD HL,0	;
458)   C313 3E DA       		CPSH:  LD A,YPUSH2	;
459)   C315 D7 57       		CMTHRE: DEFW ZCMONE	;
461)   C317 7D          		       LD A,L	;
462)   C318 D7 57       		       DEFW ZCMONE	;
463)   C31A 7C          		       LD A,H	;
464)   C31B D7 57       		LCM1:  DEFW ZCMONE	;
465)   C31D C9          		       RET	;
470)   C31E D7 3E       		STATEL: DEFW ZCHKCR    ; if line is blank	; if line is blank
471)   C320 30 EA       		       JR NC CREM      ; compile statement starting at	; compile statement starting at
472)   C322 21 38 DD    		       LD HL,KWDLIS    ; current i/p position,	; current i/p position,
473)   C325 D7 1E       		       DEFW ZSCAN	;
474)   C327 DA 59 CA    		       JP C CLET       ; if keyword found jump to (BC)	; if keyword found jump to (BC)
475)   C32A C5          		       PUSH BC         ; instead	; instead
476)   C32B C9          		       RET	;
478)   C32C 01 14 DD    		XCL3:  LD BC,XTABLE	;
479)   C32F FA 35 C3    		       JP M ENTER	;
480)   C332 01 00 DE    		       LD BC,XTABL2	;
483)   C335 E5          		       PUSH HL	;
484)   C336 26 00       		       LD H,0	;
485)   C338 6F          		       LD L,A	;
486)   C339 09          		       ADD HL,BC       ;n.b. clears carry	;n.b. clears carry
487)   C33A 4E          		       LD C,(HL)       ;pick up addr of rt from table	;pick up addr of rt from table
488)   C33B 23          		       INC HL	;
489)   C33C 46          		       LD B,(HL)	;
490)   C33D E1          		       POP HL	;
491)   C33E C5          		       PUSH BC	;
492)   C33F C9          		       RET             ;enter routine with carry clear	;enter routine with carry clear
 96)   C340 D7 22       		CLABEL: DEFW ZINTIN	;
 97)   C342 DF 29       		       DEFW WFIND	;
 98)   C344 3E 1D       		       LD A,29	;
 99)   C346 DF 01       		       DEFW WCM2HL	;
100)   C348 C9          		       RET	;
103)   C349 5E          		       LD E,(HL)	;
104)   C34A 23          		       INC HL	;
105)   C34B 56          		       LD D,(HL)	;
106)   C34C D5          		LXG1:  PUSH DE	;
107)   C34D 01 03 00    		       LD BC,3	;
108)   C350 1E 16       		       LD E,GSSPTR	;
109)   C352 D7 6E       		       DEFW ZINSS	;
110)   C354 D1          		       POP DE	;
111)   C355 D8          		       RET C	;
112)   C356 DD E5       		       PUSH IX	;
113)   C358 C1          		       POP BC	;
114)   C359 71          		       LD (HL),C	;
115)   C35A 23          		       INC HL	;
116)   C35B 70          		       LD (HL),B	;
117)   C35C 18 0F       		       JR LXG3	;
119)   C35E CD 72 C3    		XRESU: CALL XRESU2	;
120)   C361 D8          		       RET C	;
121)   C362 18 0A       		       JR LXG2	;
123)   C364 E5          		XRESU1: PUSH HL	;
124)   C365 CD 72 C3    		       CALL XRESU2	;
125)   C368 E1          		       POP HL	;
126)   C369 D8          		       RET C	;
128)   C36A 5E          		       LD E,(HL)	;
129)   C36B 23          		       INC HL	;
130)   C36C 56          		       LD D,(HL)	;
131)   C36D EB          		LXG3:  EX DE,HL	;
132)   C36E 3E FE       		LXG2:  LD A,254	;
133)   C370 37          		       SCF	;
134)   C371 C9          		       RET	;
136)   C372 FD CB 22 8E 		XRESU2: RES 1,(IY+FLAGS)	;
138)   C376 CD 2C D1    		       CALL GGSP	;
139)   C379 EB          		       EX DE,HL	;
140)   C37A E5          		       PUSH HL	;
141)   C37B CD 61 D1    		       CALL CHKSTB	;
142)   C37E E1          		       POP HL	;
143)   C37F 3E 21       		       LD A,33	;
144)   C381 37          		       SCF	;
145)   C382 C8          		       RET Z	;
146)   C383 5E          		       LD E,(HL)	;
147)   C384 23          		       INC HL	;
148)   C385 56          		       LD D,(HL)	;
149)   C386 2B          		       DEC HL	;
150)   C387 01 03 00    		       LD BC,3	;
151)   C38A D5          		       PUSH DE	;
152)   C38B 1E 16       		       LD E,GSSPTR	;
153)   C38D D7 6F       		       DEFW ZDELT	;
154)   C38F E1          		       POP HL	;
155)   C390 E5          		       PUSH HL         ;return addr in HL & IX !	;return addr in HL & IX !
156)   C391 DD E1       		       POP IX	;
157)   C393 C9          		       RET	;
160)   C394 D7 54       		       DEFW ZINITST    ;initialise symbol table	;initialise symbol table
161)   C396 E7 24       		       DEFW ZINITRAND	;
162)   C398 D7 27       		       DEFW ZFLNT	;
163)   C39A 30 D2       		       JR NC LXG2	;
164)   C39C 3E 03       		       LD A,3	;
165)   C39E C9          		       RET	;
168)   C39F D7 3E       		       DEFW ZCHKCR	;
169)   C3A1 3E 80       		       LD A,YRESU1	;
170)   C3A3 38 0A       		       JR C GO	;
171)   C3A5 3E 92       		       LD A,YRESU	;
172)   C3A7 D7 57       		       DEFW ZCMONE	;
173)   C3A9 C9          		       RET	;
176)   C3AA 3E C3       		       LD A,YGOSUB	;
177)   C3AC 21          		       DEFB 21H        ;op-code for LD HL,nn-i.e. skip	;op-code for LD HL,nn-i.e. skip
179)   C3AD 3E C2       		       LD A,YGOTO	;
180)   C3AF D7 57       		GO:    DEFW ZCMONE	;
181)   C3B1 DF 06       		       DEFW WCLABEL	;
182)   C3B3 DF 3E       		       DEFW WCHKCR	;
183)   C3B5 C9          		       RET	;
186)   C3B6 D7 16       		       DEFW ZNUMEXP	;
187)   C3B8 D8          		       RET C           ;if not numeric exp.	;if not numeric exp.
188)   C3B9 DD E5       		       PUSH IX	;
189)   C3BB E1          		       POP HL	;
190)   C3BC D7 62       		CIFL1: DEFW ZLAST	;
191)   C3BE 28 FC       		       JR Z CIFL1	;
192)   C3C0 3E C5       		       LD A,YIF	;
193)   C3C2 D7 02       		       DEFW ZCMTHRE    ;comp.cond.ret	;comp.cond.ret
194)   C3C4 21 D5 C3    		       LD HL,CNSQLS	;
195)   C3C7 D7 1E       		       DEFW ZSCAN	;
196)   C3C9 3E 3F       		       LD A,63	;
197)   C3CB D8          		       RET C           ;if no THEN (visible or not)	;if no THEN (visible or not)
198)   C3CC D7 38       		       DEFW ZRDSCH	;
199)   C3CE D7 3D       		       DEFW ZDIGIT	;
200)   C3D0 30 DB       		       JR NC,CGOTO     ;if 'then' <line#>	;if 'then' <line#>
201)   C3D2 D7 4B       		       DEFW ZLSTATE    ;if 'then' otherwise	;if 'then' otherwise
202)   C3D4 C9          		       RET	;
205)   C3D5 B4 02       		       DEFB TTHEN,2    ;includes the notrious	;includes the notrious
209)   C3D7 E5          		XONSUB: PUSH HL	;
210)   C3D8 D7 2F       		       DEFW ZUNSTSS	;
211)   C3DA 01 49 C3    		       LD BC,XGOSUB	;
212)   C3DD 18 06       		       JR LXON2	;
214)   C3DF E5          		       PUSH HL	;
215)   C3E0 D7 2F       		       DEFW ZUNSTSS	;
216)   C3E2 01 6A C3    		       LD BC,XGOTO	;
217)   C3E5 E1          		LXON2: POP HL	;
218)   C3E6 D8          		       RET C	;
219)   C3E7 7E          		XON1:  LD A,(HL)	;
220)   C3E8 23          		       INC HL	;
221)   C3E9 B6          		       OR (HL)	;
222)   C3EA 3E 1C       		       LD A,28	;
223)   C3EC 37          		       SCF	;
224)   C3ED C8          		       RET Z           ;if no more labels	;if no more labels
225)   C3EE 23          		       INC HL	;
226)   C3EF 1B          		       DEC DE	;
227)   C3F0 7A          		       LD A,D	;
228)   C3F1 B3          		       OR E	;
229)   C3F2 20 F3       		       JR NZ,XON1	;
230)   C3F4 2B          		       DEC HL	;
231)   C3F5 2B          		       DEC HL	;
232)   C3F6 C5          		       PUSH BC	;
233)   C3F7 C9          		       RET	;
241)   C3F8 3E 02       		       LD A,2	;
244)   C3FA FD E5       		       PUSH IY	;
245)   C3FC E3          		       EX (SP),HL	;
246)   C3FD C1          		       POP BC	;
247)   C3FE 16 00       		       LD D,0	;
248)   C400 19          		       ADD HL,DE	;
251)   C401 71          		       LD (HL),C	;
252)   C402 23          		       INC HL	;
253)   C403 70          		       LD (HL),B	;
254)   C404 23          		       INC HL	;
255)   C405 3D          		       DEC A	;
256)   C406 20 F9       		       JR NZ,COPYN	;
257)   C408 C9          		       RET	;
260)   C409 11 00 00    		XLISTN: LD DE,0        ;LIST WITH NO LINE NUMBERS	;LIST WITH NO LINE NUMBERS
261)   C40C 01 FF FF    		       LD BC,-1        ;   SPECIFIED (VIZ LIST ALL)	;   SPECIFIED (VIZ LIST ALL)
262)   C40F 18 07       		       JR LIST	;
264)   C411 4E          		XLIST: LD C,(HL)	;
265)   C412 23          		       INC HL	;
266)   C413 46          		       LD B,(HL)       ;BC:='TO' line #	;BC:='TO' line #
267)   C414 23          		       INC HL	;
268)   C415 5E          		       LD E,(HL)	;
269)   C416 23          		       INC HL	;
270)   C417 56          		       LD D,(HL)       ;DE:='FROM' line #	;DE:='FROM' line #
271)   C418 C5          		LIST:  PUSH BC	;
272)   C419 EB          		       EX DE,HL	;
273)   C41A D7 29       		       DEFW ZFIND 	;
274)   C41C 11 FA FF    		       LD DE,-6	;
275)   C41F 19          		       ADD HL,DE       ;move back so NLNT will test for	;move back so NLNT will test for
276)   C420 C1          		LXL2:  POP BC	;
277)   C421 D7 3B       		       DEFW ZPTNL	;
278)   C423 DF 6C       		       DEFW WNBKTST	;
279)   C425 D8          		       RET C	;
280)   C426 D7 28       		       DEFW ZNLNT      ;   end of prog.	;   end of prog.
281)   C428 3F          		       CCF	;
282)   C429 D0          		       RET NC          ;if end of prog.	;if end of prog.
283)   C42A 5E          		       LD E,(HL)	;
284)   C42B 23          		       INC HL	;
285)   C42C 56          		       LD D,(HL)	;
286)   C42D 2B          		       DEC HL	;
287)   C42E EB          		       EX DE,HL	;
288)   C42F ED 42       		       SBC HL,BC       ;carry set above	;carry set above
289)   C431 D0          		       RET NC          ;if beyond 'TO' line	;if beyond 'TO' line
290)   C432 ED 4A       		       ADC HL,BC       ;*BS* LINE# NOW IN HL	;*BS* LINE# NOW IN HL
291)   C434 C5          		       PUSH BC	;
292)   C435 D5          		       PUSH DE	;
293)   C436 D7 26       		       DEFW ZPT#HL     ;*BS* PRINT LINE#	;*BS* PRINT LINE#
294)   C438 E1          		       POP HL	;
295)   C439 38 64       		       JR C LXLC	;
296)   C43B E5          		       PUSH HL         ;ptr to LNT	;ptr to LNT
297)   C43C D7 32       		       DEFW ZSTINST    ;now HL points to source	;now HL points to source
298)   C43E 3E 20       		       LD A,' '	;
299)   C440 BE          		       CP (HL)	;
300)   C441 28 02       		       JR Z LXL21      ;if first chr is space	;if first chr is space
301)   C443 D7 3C       		       DEFW ZPTCHAR    ;print a space	;print a space
302)   C445 E1          		LXL21: POP HL	;
303)   C446 38 57       		       JR C LXLC	;
304)   C448 E5          		LXL5:  PUSH HL	;
305)   C449 D7 32       		       DEFW ZSTINST	;
306)   C44B FD 7E 22    		       LD A,(IY+FLAGS)	;
307)   C44E E6 04       		       AND 4	;
308)   C450 FD 77 2E    		       LD (IY+PPFLGS),A	;
309)   C453 7E          		       LD A,(HL)	;
310)   C454 FE 0D       		LXL3:  CP 15Q	;
311)   C456 20 0D       		       JR NZ,LXL6	;
312)   C458 E1          		       POP HL	;
313)   C459 D7 62       		       DEFW ZLAST	;
314)   C45B 20 C3       		       JR NZ LXL2	;
315)   C45D 3E 3A       		       LD A,':'	;
316)   C45F D7 3C       		       DEFW ZPTCHAR	;
317)   C461 38 3C       		       JR C LXLC	;
318)   C463 18 E3       		       JR LXL5	;
320)   C465 D7 67       		LXL6:  DEFW ZTSTPPF	;
321)   C467 F5          		       PUSH AF	;
322)   C468 D7 68       		       DEFW ZUPDPPF	;
323)   C46A F1          		       POP AF	;
324)   C46B 38 2B       		       JR C LXL4	;
325)   C46D 21 56 DE    		       LD HL,KWDS	;
326)   C470 28 07       		       JR Z LXL0	;
327)   C472 21 20 DF    		       LD HL,OKWDS	;
328)   C475 FE B5       		       CP TINVTH       ;the stupendous invisible THEN	;the stupendous invisible THEN
329)   C477 28 21       		       JR Z LXL8	;
330)   C479 CB 7F       		LXL0:  BIT 7,A	;
331)   C47B 28 1B       		       JR Z LXL4	;
332)   C47D 96          		       SUB (HL)	;
333)   C47E 23          		       INC HL	;
334)   C47F 23          		       INC HL	;
335)   C480 28 08       		       JR Z LXL7	;
336)   C482 CB 7E       		LXL1:  BIT 7,(HL)	;
337)   C484 23          		       INC HL	;
338)   C485 28 FB       		       JR Z LXL1	;
339)   C487 3D          		       DEC A	;
340)   C488 20 F8       		       JR NZ LXL1	;
341)   C48A 7E          		LXL7:  LD A,(HL)	;
342)   C48B CB 7F       		       BIT 7,A	;
343)   C48D 20 07       		       JR NZ LXL9	;
344)   C48F 23          		       INC HL	;
345)   C490 D7 3C       		       DEFW ZPTCHAR	;
346)   C492 38 0A       		       JR C LXLA	;
347)   C494 18 F4       		       JR LXL7	;
349)   C496 E6 7F       		LXL9:  AND 7FH	;
350)   C498 D7 3C       		LXL4:  DEFW ZPTCHAR	;
351)   C49A DF 34       		LXL8:  DEFW WRDNCH	;
352)   C49C 30 B6       		       JR NC LXL3	;
353)   C49E E1          		LXLA:  POP HL	;
354)   C49F E1          		LXLC:  POP HL	;
355)   C4A0 C9          		       RET	;
132)   C4A1 D7 42       		       DEFW ZCHKHSH	;
133)   C4A3 3E CC       		       LD A,YSTDFO	;
134)   C4A5 38 0C       		       JR C,CDEVO1	;
135)   C4A7 D7 16       		       DEFW ZNUMEXP	;
136)   C4A9 D8          		       RET C	;
137)   C4AA D7 3E       		       DEFW ZCHKCR	;
138)   C4AC 30 03       		       JR NC LCDV1	;
139)   C4AE D7 40       		       DEFW ZCHKCOM	;
140)   C4B0 D8          		       RET C	;
141)   C4B1 3E CB       		LCDV1: LD A,YSTOCN	;
142)   C4B3 D7 57       		CDEVO1 DEFW ZCMONE	;
143)   C4B5 C9          		       RET	;
146)   C4B6 D7 0C       		CPRINT: DEFW ZCDEVO	;
147)   C4B8 D8          		       RET C	;
148)   C4B9 06 D2       		       LD B,YPTNL	;
149)   C4BB CD F0 C4    		LCP2:  CALL CPSEP	;
150)   C4BE 06 E5       		LCP3:  LD B,YREM	;
151)   C4C0 30 F9       		       JR NC,LCP2	;
152)   C4C2 06 B9       		       LD B,TTAB	;
153)   C4C4 D7 6B       		       DEFW ZCHECK	;
154)   C4C6 38 0B       		       JR C,CPRIN2	;
155)   C4C8 D7 44       		       DEFW ZCHKOPN	;
156)   C4CA DF 16       		       DEFW WNUMEXP	;
157)   C4CC DF 3F       		       DEFW WCHKCLS	;
158)   C4CE D8          		       RET C	;
159)   C4CF 3E CE       		       LD A,YPTAB	;
160)   C4D1 18 11       		       JR CPRIN4	;
162)   C4D3 D7 18       		CPRIN2: DEFW ZEXPN	;
163)   C4D5 D8          		       RET C	;
164)   C4D6 B7          		       OR A	;
165)   C4D7 3E CF       		       LD A,YPSTR	;
166)   C4D9 20 09       		       JR NZ,CPRIN4    ;if string	;if string
167)   C4DB D7 47       		       DEFW ZFORMAT    ;else numeric: check for	;else numeric: check for
168)   C4DD D8          		       RET C           ;formatted print option	;formatted print option
169)   C4DE 2E D0       		       LD L,YPFFF	;
170)   C4E0 61          		       LD H,C	;
171)   C4E1 D7 01       		       DEFW ZCM2HL	;
172)   C4E3 78          		       LD A,B	;
173)   C4E4 D7 57       		CPRIN4: DEFW ZCMONE	;
174)   C4E6 06 D2       		       LD B,YPTNL	;
175)   C4E8 CD F0 C4    		       CALL CPSEP	;
176)   C4EB 30 D1       		       JR NC,LCP3	;
177)   C4ED 3E 1F       		       LD A,31	;
178)   C4EF C9          		       RET	;
187)   C4F0 D7 38       		       DEFW ZRDSCH	;
188)   C4F2 FE 2C       		       CP ','	;
189)   C4F4 28 0D       		       JR Z,LCPS4	;
190)   C4F6 FE 3B       		       CP ';'	;
191)   C4F8 28 0D       		       JR Z,LCPS5	;
192)   C4FA FE 0D       		       CP 15Q	;
193)   C4FC 37          		       SCF	;
194)   C4FD C0          		       RET NZ	;
195)   C4FE F1          		       POP AF          ;lose ret addr	;lose ret addr
196)   C4FF 78          		       LD A,B	;
197)   C500 D7 57       		       DEFW ZCMONE	;
198)   C502 C9          		       RET	;
200)   C503 3E D1       		LCPS4: LD A,YPCOM	;
201)   C505 D7 57       		       DEFW ZCMONE	;
202)   C507 DF 34       		LCPS5: DEFW WRDNCH	;
203)   C509 C9          		       RET	;
214)   C50A D7 38       		       DEFW ZRDSCH	;
215)   C50C FE 5B       		       CP '['	;
216)   C50E ED 4B 74 00 		       LD BC,(DEFNF)           ;DEFAULT VALUE	;DEFAULT VALUE
217)   C512 37          		       SCF	;
218)   C513 3F          		       CCF	;
219)   C514 C0          		       RET NZ	;
220)   C515 D7 0B       		       DEFW ZCPINT	;
221)   C517 D8          		       RET C	;
222)   C518 41          		       LD B,C	;
223)   C519 D7 38       		       DEFW ZRDSCH	;
224)   C51B E7 2F       		       DEFW ZTTCAPS	;
225)   C51D FE 46       		       CP 'F'	;
226)   C51F 20 04       		       JR NZ,LFMT2	;
227)   C521 06 40       		       LD B,40H	;
228)   C523 18 16       		       JR LFMT4	;
230)   C525 FE 2E       		LFMT2: CP '.'	;
231)   C527 20 0C       		       JR NZ LFMT3	;
232)   C529 D7 0B       		       DEFW ZCPINT	;
233)   C52B D8          		       RET C	;
234)   C52C 78          		       LD A,B	;
235)   C52D 81          		       ADD A,C	;
236)   C52E 38 19       		       JR C,LFMT8	;
237)   C530 4F          		       LD C,A	;
238)   C531 D7 38       		       DEFW ZRDSCH	;
239)   C533 E7 2F       		       DEFW ZTTCAPS	;
240)   C535 FE 45       		LFMT3: CP 'E'	;
241)   C537 20 04       		       JR NZ,LFMT5	;
242)   C539 CB F8       		       SET 7,B	;
243)   C53B D7 37       		LFMT4: DEFW ZRDNSCH	;
244)   C53D FE 5D       		LFMT5: CP ']'	;
245)   C53F 37          		       SCF	;
246)   C540 20 07       		       JR NZ,LFMT8	;
247)   C542 D7 37       		       DEFW ZRDNSCH	;
248)   C544 79          		       LD A,C	;
249)   C545 3D          		       DEC A	;
250)   C546 FE 0A       		       CP 10	;
251)   C548 3F          		       CCF	;
252)   C549 3E 4A       		LFMT8: LD A,74	;
253)   C54B C9          		       RET	;
259)   C54C D7 34       		       DEFW ZRDNCH	;
260)   C54E D7 22       		       DEFW ZINTIN	;
261)   C550 3E 00       		       LD A,0	;
262)   C552 9C          		       SBC A,H         ;set carry if H nonzero or	;set carry if H nonzero or
263)   C553 4D          		       LD C,L          ;   if carry was already set	;   if carry was already set
264)   C554 3E 4B       		       LD A,75	;
265)   C556 C9          		       RET	;
269)   C557 E5          		       PUSH HL	;
270)   C558 D7 2F       		       DEFW ZUNSTSS	;
271)   C55A E1          		       POP HL	;
272)   C55B 3E 00       		       LD A,0	;
273)   C55D 9A          		       SBC A,D         ;now CY set iff DE>255	;now CY set iff DE>255
274)   C55E 3E 5A       		       LD A,90         ;errno for illegal stream no.	;errno for illegal stream no.
275)   C560 D8          		       RET C           ;if illegal stream no.	;if illegal stream no.
276)   C561 01          		       DEFB 01H        ;op-code for LD BC,nn-i.e.skip	;op-code for LD BC,nn-i.e.skip
277)   C562 1E 00       		XSTDFO: LD E,0         ;default stream number	;default stream number
278)   C564 FD 73 06    		XSTOC1: LD (IY+OUTCON),E	;
279)   C567 37          		       SCF	;
280)   C568 9F          		       SBC A,A	;
281)   C569 C9          		       RET	;
284)   C56A 4E          		XPFFF: LD C,(HL)	;
285)   C56B 23          		       INC HL	;
286)   C56C 46          		       LD B,(HL)	;
287)   C56D 23          		       INC HL	;
288)   C56E E5          		       PUSH HL ;REMEMBER OBJ CODE ADDR. FORGET	;REMEMBER OBJ CODE ADDR. FORGET
289)   C56F C5          		       PUSH BC         ;-RET ADDR.	;-RET ADDR.
290)   C570 D7 2E       		       DEFW ZUNST6	;
291)   C572 EB          		       EX DE,HL	;
292)   C573 E7 2B       		       DEFW ZLDF	;
293)   C575 EB          		       EX DE,HL	;
294)   C576 C1          		       POP BC	;
295)   C577 E7 2C       		       DEFW ZOUT	;
296)   C579 06 00       		       LD B,0          ;BC=CHAR.CT.	;BC=CHAR.CT.
297)   C57B D7 0E       		       DEFW ZPRSTR	;
298)   C57D 18 03       		       JR XPSTR1	;
300)   C57F E5          		XPSTR: PUSH HL	;
301)   C580 D7 0D       		       DEFW ZPRNSTR	;
302)   C582 C3 F2 C1    		XPSTR1: JP XRUN1D	;
305)   C585 D7 2B       		       DEFW ZUNST2	;
306)   C587 44          		       LD B,H	;
307)   C588 4D          		       LD C,L	;
308)   C589 EB          		       EX DE,HL	;
309)   C58A D7 0E       		       DEFW ZPRSTR	;
310)   C58C FD 75 12    		LDUSTP: LD (IY+USRSTP),L       ;Load USRSTP from HL	;Load USRSTP from HL
311)   C58F FD 74 13    		       LD (IY+USRSTP+1),H	;
312)   C592 C9          		       RET	;
315)   C593 CD 17 C6    		       CALL PHPR	;
316)   C596 38 17       		       JR C LPS5       ;if PHPOS not supported	;if PHPOS not supported
317)   C598 E5          		       PUSH HL	;
318)   C599 2A 1C 00    		       LD HL,(PHPOS)	;
319)   C59C 26 00       		       LD H,0	;
320)   C59E 54          		       LD D,H	;
321)   C59F 5F          		       LD E,A          ;so DE = line length	;so DE = line length
322)   C5A0 2D          		       DEC L           ;so HL = (PHPOS)-1	;so HL = (PHPOS)-1
323)   C5A1 28 0A       		       JR Z LPS4       ;if at start of line	;if at start of line
324)   C5A3 09          		       ADD HL,BC	;
325)   C5A4 38 05       		       JR C LPS3       ;if very long string	;if very long string
326)   C5A6 EB          		       EX DE,HL	;
327)   C5A7 ED 52       		       SBC HL,DE	;
328)   C5A9 30 02       		       JR NC LPS4      ;if fits	;if fits
329)   C5AB D7 3B       		LPS3:  DEFW ZPTNL	;
330)   C5AD E1          		LPS4:  POP HL	;
331)   C5AE D8          		       RET C           ;if PTNL error	;if PTNL error
332)   C5AF 79          		LPS5:  LD A,C	;
333)   C5B0 B0          		       OR B	;
334)   C5B1 C8          		       RET Z	;
335)   C5B2 7E          		       LD A,(HL)	;
336)   C5B3 D7 3C       		       DEFW ZPTCHAR	;
337)   C5B5 D8          		       RET C	;
338)   C5B6 23          		       INC HL	;
339)   C5B7 0B          		       DEC BC	;
340)   C5B8 18 F5       		       JR LPS5	;
343)   C5BA E5          		       PUSH HL	;
344)   C5BB CD 17 C6    		       CALL PHPR	;
345)   C5BE 38 17       		       JR C LPC6       ;if not PHPOS adj.	;if not PHPOS adj.
346)   C5C0 3A 1D 00    		       LD A,(PZLEN)	;
347)   C5C3 47          		       LD B,A	;
348)   C5C4 AF          		       XOR A	;
349)   C5C5 80          		LPC2:  ADD A,B	;
350)   C5C6 CD 10 C6    		       CALL TSTPHP	;
351)   C5C9 38 FA       		       JR C,LPC2	;
352)   C5CB 3C          		       INC A           ;now A = req'd col #	;now A = req'd col #
353)   C5CC 21 1B 00    		       LD HL,PLLEN	;
354)   C5CF BE          		       CP (HL)	;
355)   C5D0 6F          		       LD L,A	;
356)   C5D1 38 25       		       JR C,TAB        ;unless beyond end of line	;unless beyond end of line
357)   C5D3 2E 01       		       LD L,1	;
358)   C5D5 18 21       		       JR TAB	;
360)   C5D7 3E 09       		LPC6:  LD A,09H        ;Print TAB cntrl char.	;Print TAB cntrl char.
361)   C5D9 D7 3C       		       DEFW ZPTCHAR	;
362)   C5DB 18 30       		       JR LTAB9	;
364)   C5DD E5          		XPTAB: PUSH HL	;
365)   C5DE D7 2F       		       DEFW ZUNSTSS	;
366)   C5E0 38 2B       		       JR C,LTAB9	;
367)   C5E2 CD 17 C6    		       CALL PHPR	;
368)   C5E5 38 F0       		       JR C LPC6	;
369)   C5E7 2A 1B 00    		       LD HL,(PLLEN)	;
370)   C5EA 26 00       		       LD H,0	;
371)   C5EC EB          		       EX DE,HL	;
372)   C5ED 37          		       SCF	;
373)   C5EE ED 52       		PRTAB1: SBC HL,DE	;
374)   C5F0 30 FC       		       JR NC,PRTAB1	;
375)   C5F2 ED 5A       		       ADC HL,DE	;
376)   C5F4 3E 25       		       LD A,37         ;NB carry still set	;NB carry still set
377)   C5F6 28 15       		       JR Z,LTAB9      ;if UNSTSS yielded zero	;if UNSTSS yielded zero
379)   C5F8 7D          		       LD A,L	;
380)   C5F9 CD 10 C6    		       CALL TSTPHP	;
381)   C5FC 30 03       		       JR NC LTAB2     ;@@@@@@@	;@@@@@@@
382)   C5FE D7 3B       		       DEFW ZPTNL      ;if already beyond col L	;if already beyond col L
383)   C600 D8          		       RET C	;
384)   C601 7D          		LTAB2: LD A,L	;
385)   C602 CD 10 C6    		       CALL TSTPHP	;
386)   C605 28 06       		       JR Z,LTAB9      ;if at col L	;if at col L
387)   C607 3E 20       		       LD A,' '	;
388)   C609 DF 3C       		       DEFW WPTCHAR	;
389)   C60B 30 F4       		       JR NC,LTAB2     ;unless overshot or PTCHAR error	;unless overshot or PTCHAR error
390)   C60D C3 F2 C1    		LTAB9: JP XRUN1D	;
396)   C610 E5          		       PUSH HL	;
397)   C611 21 1C 00    		       LD HL,PHPOS	;
398)   C614 BE          		       CP (HL)	;
399)   C615 E1          		       POP HL	;
400)   C616 C9          		       RET	;
407)   C617 FD 7E 06    		       LD A,(IY+OUTCON)	;
408)   C61A B7          		       OR A	;
409)   C61B 37          		       SCF	;
410)   C61C C0          		       RET NZ          ;if not the console	;if not the console
411)   C61D 3A 1B 00    		       LD A,(PLLEN)	;
412)   C620 B7          		       OR A	;
413)   C621 C0          		       RET NZ          ;non-zero line length implies	;non-zero line length implies
414)   C622 37          		       SCF             ;PHPOS is supported.	;PHPOS is supported.
415)   C623 C9          		       RET	;
420)   C624 D7 42       		       DEFW ZCHKHSH	;
421)   C626 38 09       		       JR C,CINP1C	;
422)   C628 D7 16       		       DEFW ZNUMEXP	;
423)   C62A DF 40       		       DEFW WCHKCOM	;
424)   C62C D8          		       RET C	;
425)   C62D 3E CA       		       LD A,YSTICN	;
426)   C62F 18 0D       		       JR CINP1B	;
429)   C631 D7 44       		       DEFW ZCHKOPN	;
430)   C633 3E D4       		       LD A,YQDEF	;
431)   C635 38 07       		       JR C,CINP1B             ;IF NO USER I/P PROMPT	;IF NO USER I/P PROMPT
432)   C637 D7 17       		       DEFW ZSTREXP	;
433)   C639 DF 3F       		       DEFW WCHKCLS	;
434)   C63B D8          		       RET C	;
435)   C63C 3E D3       		       LD A,YQSTR	;
437)   C63E D7 57       		       DEFW ZCMONE	;
438)   C640 C9          		       RET	;
441)   C641 D7 2B       		XLINP: DEFW ZUNST2     ;retrieve variable	;retrieve variable
442)   C643 EB          		       EX DE,HL	;
443)   C644 D5          		       PUSH DE	;
444)   C645 3E 0D       		       LD A,0DH	;
445)   C647 01 00 00    		       LD BC,0	;
446)   C64A ED B1       		       CPIR            ;BC=-length-1	;BC=-length-1
447)   C64C D7 48       		       DEFW ZNOTBC     ;BC=length	;BC=length
448)   C64E 60          		       LD H,B	;
449)   C64F 69          		       LD L,C	;
450)   C650 D7 31       		       DEFW ZPUSH2     ;bung on length	;bung on length
451)   C652 D1          		       POP DE          ;HL=variable again	;HL=variable again
452)   C653 CD 3E D9    		       CALL ASSSTR     ;assign string	;assign string
453)   C656 18 24       		       JR XEND1	;
455)   C658 E5          		XSTICN: PUSH HL	;
456)   C659 D7 2F       		       DEFW ZUNSTSS	;
457)   C65B 3E 00       		       LD A,0	;
458)   C65D 9A          		       SBC A,D         ;Set CY iff DE>255	;Set CY iff DE>255
459)   C65E 3E 5A       		       LD A,90         ;Err no. for illegal stream no.	;Err no. for illegal stream no.
460)   C660 18 11       		       JR LQL8	;
462)   C662 E5          		XQSTR: PUSH HL	;
463)   C663 FD 36 06 00 		       LD (IY+OUTCON),0	;
464)   C667 D7 0D       		       DEFW ZPRNSTR	;
465)   C669 18 06       		       JR QRYLIN	;
467)   C66B E5          		XQDEF: PUSH HL	;
468)   C66C D7 39       		       DEFW ZPTMSG	;
469)   C66E 02          		          DEFB 002Q	;
470)   C66F 3F 20       		          DEFM '? '	;
471)   C671 1E 00       		QRYLIN: LD E,0	;
472)   C673 DF 4E       		LQL8:  DEFW WRDLINE	;
473)   C675 DF 33       		       DEFW WRDCH	;
474)   C677 C3 F2 C1    		LQL9:  JP XRUN1D	;
476)   C67A D7 3E       		XENDIN: DEFW ZCHKCR	;
477)   C67C D2 55 D7    		XEND1: JP NC DISPOSE	;
478)   C67F 18 0C       		       JR LID2	;
480)   C681 E5          		XSEP:  PUSH HL	;
481)   C682 06 09       		       LD B,09H	;
482)   C684 D7 6B       		       DEFW ZCHECK	;
483)   C686 30 EF       		       JR NC LQL9	;
484)   C688 D7 40       		       DEFW ZCHKCOM	;
485)   C68A 30 EB       		INDONE: JR NC,LQL9	;
486)   C68C E1          		       POP HL	;
487)   C68D FD 5E 07    		LID2:  LD E,(IY+INCON)	;
488)   C690 1D          		       DEC E           ;NB carry still set	;NB carry still set
489)   C691 1C          		       INC E	;
490)   C692 C0          		       RET NZ          ;If not console stream	;If not console stream
491)   C693 A7          		       AND A	;
492)   C694 37          		       SCF	;
493)   C695 C8          		       RET Z	;
494)   C696 D7 55       		       DEFW ZREPORT	;
495)   C698 D8          		       RET C           ;in case ON ERR is set(16K)	;in case ON ERR is set(16K)
496)   C699 DD E5       		       PUSH IX	;
497)   C69B E1          		       POP  HL         ;Get IX into HL so redo line	;Get IX into HL so redo line
498)   C69C C3 6E C3    		       JP LXG2	;
500)   C69F E5          		XNUMIN: PUSH HL	;
501)   C6A0 D7 38       		       DEFW ZRDSCH     ;get rid of LF's	;get rid of LF's
502)   C6A2 CD AA DA    		       CALL GINPTR	;
503)   C6A5 EB          		       EX DE,HL	;
504)   C6A6 E7 2A       		       DEFW ZINP	;
505)   C6A8 EB          		       EX DE,HL	;
506)   C6A9 CD A3 DA    		       CALL LINPTR	;
507)   C6AC 3E 1E       		       LD A,30	;
508)   C6AE DF 2A       		       DEFW WPOP	;
509)   C6B0 EF 2D       		       DEFW WSTF	;
510)   C6B2 18 D6       		       JR INDONE	;
512)   C6B4 E5          		XSTRIN: PUSH HL	;
513)   C6B5 D7 2A       		       DEFW ZPOP	;
514)   C6B7 E5          		       PUSH HL	;
515)   C6B8 D7 70       		       DEFW ZMKRL	;
516)   C6BA D7 4C       		       DEFW ZMKNULL	;
517)   C6BC D7 71       		       DEFW ZMKAB	;
518)   C6BE D7 43       		       DEFW ZCHKQUO	;
519)   C6C0 38 09       		       JR C,LSI5	;
520)   C6C2 D7 0F       		       DEFW ZQSTR      ; IF QUOTED STRING	; IF QUOTED STRING
521)   C6C4 E1          		       POP HL	;
522)   C6C5 DF 14       		       DEFW WNEWSTR	;
523)   C6C7 DF 34       		       DEFW WRDNCH	;
524)   C6C9 18 BF       		       JR INDONE	;
526)   C6CB D7 35       		LSI5:  DEFW ZSVINST    ; HERE IF UNQUOTED STRING	; HERE IF UNQUOTED STRING
527)   C6CD 01 00 00    		       LD BC,0	;
528)   C6D0 D7 33       		       DEFW ZRDCH	;
529)   C6D2 FE 22       		LSI54: CP 22H	;
530)   C6D4 28 0D       		       JR Z,LSI8	;
531)   C6D6 FE 0D       		       CP 15Q	;
532)   C6D8 28 0C       		       JR Z,LSI7	;
533)   C6DA FE 2C       		       CP ','	;
534)   C6DC 28 08       		       JR Z,LSI7	;
535)   C6DE 03          		       INC BC	;
536)   C6DF D7 34       		       DEFW ZRDNCH	;
537)   C6E1 18 EF       		       JR LSI54	;
539)   C6E3 37          		LSI8:  SCF	;
540)   C6E4 3E 24       		       LD A,36	;
541)   C6E6 E1          		LSI7:  POP HL	;
542)   C6E7 DF 14       		       DEFW WNEWSTR	;
543)   C6E9 18 9F       		       JR INDONE	;
549)   C6EB D7 35       		       DEFW ZSVINST	;
550)   C6ED 01 00 00    		       LD BC,0	;
551)   C6F0 D7 33       		       DEFW ZRDCH	;
552)   C6F2 FE 0D       		LQS2:  CP 15Q	;
553)   C6F4 28 0E       		       JR Z,LQS5	;
554)   C6F6 FE 22       		       CP 22H	;
555)   C6F8 20 05       		       JR NZ,LQS4	;
556)   C6FA D7 34       		       DEFW ZRDNCH	;
557)   C6FC EE 22       		       XOR 22H	;
558)   C6FE C0          		       RET NZ          ;RETURN NC UNLESS QUOTE IMAGE	;RETURN NC UNLESS QUOTE IMAGE
559)   C6FF 03          		LQS4:  INC BC	;
560)   C700 D7 34       		       DEFW ZRDNCH	;
561)   C702 18 EE       		       JR LQS2	;
563)   C704 3E 41       		LQS5:  LD A,65	;
564)   C706 37          		       SCF	;
565)   C707 C9          		       RET	;
572)   C708 E5          		       PUSH HL	;
573)   C709 C5          		       PUSH BC	;
574)   C70A 1E 18       		       LD E,STBAS	;
575)   C70C D7 6E       		       DEFW ZINSS	;
576)   C70E C1          		       POP BC	;
577)   C70F D1          		       POP DE	;
578)   C710 D8          		       RET C	;
579)   C711 E5          		       PUSH HL	;
580)   C712 D5          		       PUSH DE	;
581)   C713 FD 56 1B    		       LD D,(IY+ARBAS+1)	;
582)   C716 FD 5E 1A    		       LD E,(IY+ARBAS)	;
583)   C719 ED 52       		       SBC HL,DE	;
584)   C71B EB          		       EX DE,HL	;
585)   C71C E1          		       POP HL                  ;HL->DEST,DE=REL ADDR. OF	;HL->DEST,DE=REL ADDR. OF
586)   C71D 73          		       LD (HL),E               ;THE STRING	;THE STRING
587)   C71E 23          		       INC HL	;
588)   C71F 72          		       LD (HL),D	;
589)   C720 23          		       INC HL	;
590)   C721 71          		       LD (HL),C	;
591)   C722 23          		       INC HL	;
592)   C723 70          		       LD (HL),B	;
593)   C724 D1          		       POP DE	;
594)   C725 BF          		       CP A            ;set NC	;set NC
595)   C726 C9          		       RET	;
235)   C727 D7 53       		       DEFW ZBVARIA	;
236)   C729 D8          		       RET C	;
237)   C72A 78          		       LD A,B	;
238)   C72B E6 FC       		       AND 0FCH	;
239)   C72D FE 80       		       CP 080H	;
240)   C72F 37          		       SCF	;
241)   C730 3E 2C       		       LD A,44	;
242)   C732 C0          		       RET NZ	;
243)   C733 FD 71 33    		       LD (IY+FORVAR),C	;
244)   C736 FD 70 34    		       LD (IY+FORVAR+1),B      ;SAVE C.V.NAME TYPE	;SAVE C.V.NAME TYPE
245)   C739 D7 41       		       DEFW ZCHKEQ	;
246)   C73B DF 16       		       DEFW WNUMEXP	;
247)   C73D D8          		       RET C	;
248)   C73E 3E D8       		       LD A,YFOR1	;
249)   C740 D7 57       		       DEFW ZCMONE	;
250)   C742 06 B6       		       LD B,TTO	;
251)   C744 D7 6B       		       DEFW ZCHECK	;
252)   C746 3E 2E       		       LD A,46	;
253)   C748 DF 16       		       DEFW WNUMEXP	;
254)   C74A D8          		       RET C	;
255)   C74B D7 3E       		       DEFW ZCHKCR	;
256)   C74D 30 0D       		       JR NC,CFOR1     ;J. IF NO STEP	;J. IF NO STEP
257)   C74F 06 B7       		       LD B,TSTEP	;
258)   C751 D7 6B       		       DEFW ZCHECK	;
259)   C753 3E 2F       		       LD A,47	;
260)   C755 DF 16       		       DEFW WNUMEXP	;
261)   C757 DF 3E       		       DEFW WCHKCR	;
262)   C759 D8          		       RET C	;
263)   C75A 18 04       		       JR CFOR2	;
265)   C75C 3E 03       		CFOR1: LD A,3          ;CLASS 0 OP CODE FOR "PUSH 1.0"	;CLASS 0 OP CODE FOR "PUSH 1.0"
266)   C75E D7 57       		       DEFW ZCMONE	;
268)   C760 3E 9F       		CFOR2: LD A,YPUSH3	;
269)   C762 DD E5       		       PUSH IX	;
270)   C764 E1          		       POP HL	;
271)   C765 E5          		       PUSH HL	;
272)   C766 D7 02       		       DEFW ZCMTHRE	;
273)   C768 1E 01       		       LD E,1          ;level 1 after 1st FOR	;level 1 after 1st FOR
274)   C76A E1          		CFOR6: POP HL          ;now find corresp NEXT instr	;now find corresp NEXT instr
275)   C76B 4B          		CFOR3: LD C,E	;
276)   C76C D7 28       		       DEFW ZNLNT	;
277)   C76E 3E 30       		       LD A,48	;
278)   C770 D8          		       RET C	;
279)   C771 E5          		       PUSH HL                 ;SAVE L.N.T ENTRY ADRR.	;SAVE L.N.T ENTRY ADRR.
280)   C772 D7 32       		       DEFW ZSTINST	;
281)   C774 C5          		       PUSH BC	;
282)   C775 D1          		       POP DE	;
283)   C776 D7 38       		       DEFW ZRDSCH	;
284)   C778 D6 8C       		       SUB TNEXT	;
285)   C77A 28 05       		       JR Z CFOR4	;
286)   C77C 3C          		       INC A	;
287)   C77D 20 EB       		       JR NZ CFOR6	;
288)   C77F 1C          		       INC E           ;add 2 to level if FOR	;add 2 to level if FOR
289)   C780 1C          		       INC E	;
290)   C781 D7 34       		CFOR4: DEFW ZRDNCH	;
291)   C783 D7 19       		       DEFW ZVARIA	;
292)   C785 E1          		       POP HL	;
293)   C786 3E 2D       		       LD A,45	;
294)   C788 D8          		       RET C	;
295)   C789 79          		       LD A,C	;
296)   C78A FD BE 33    		       CP (IY+FORVAR)	;
297)   C78D 20 06       		       JR NZ,CFOR45	;
298)   C78F 78          		       LD A,B	;
299)   C790 FD BE 34    		       CP (IY+FORVAR+1)	;
300)   C793 28 07       		       JR Z,CFOR8	;
302)   C795 1D          		       DEC E           ;net +1 if FOR, -1 if NEXT	;net +1 if FOR, -1 if NEXT
303)   C796 20 D3       		       JR NZ,CFOR3     ;unless is matching NEXT	;unless is matching NEXT
304)   C798 3E 31       		CFOR7: LD A,49         ;here if first with same ctl	;here if first with same ctl
305)   C79A 37          		       SCF             ;   var doesn't coincide with	;   var doesn't coincide with
306)   C79B C9          		       RET             ;   first "level := 0"	;   first "level := 0"
308)   C79C 1D          		CFOR8: DEC E           ;here if same	;here if same
309)   C79D 20 F9       		       JR NZ,CFOR7     ;unless is matching NEXT	;unless is matching NEXT
310)   C79F 3E 9F       		       LD A,YPUSH3	;
311)   C7A1 D7 02       		       DEFW ZCMTHRE	;
312)   C7A3 3E D9       		       LD A,YFOR2	;
313)   C7A5 D7 57       		       DEFW ZCMONE	;
314)   C7A7 C9          		       RET	;
317)   C7A8 D7 19       		       DEFW ZVARIA	;
318)   C7AA D8          		       RET C	;
319)   C7AB 3E DB       		       LD A,YNEXT	;
320)   C7AD C3 85 CA    		       JP CSTOP1	;
322)   C7B0 E5          		XFOR1: PUSH HL	;
324)   C7B1 D7 0A       		       DEFW ZNUMASS	;
325)   C7B3 01 02 00    		       LD BC,2	;
326)   C7B6 D7 45       		       DEFW ZINUSS             ;RETRIEVE ADDR OF CTL VAR	;RETRIEVE ADDR OF CTL VAR
327)   C7B8 C3 F2 C1    		       JP XRUN1D	;
331)   C7BB CD 36 DC    		       CALL GUSTP	;
332)   C7BE 23          		       INC HL	;
333)   C7BF 23          		       INC HL	;
334)   C7C0 23          		       INC HL	;
335)   C7C1 4E          		       LD C,(HL)	;
336)   C7C2 23          		       INC HL	;
337)   C7C3 46          		       LD B,(HL)       ;BC=LNT addr of current FOR line	;BC=LNT addr of current FOR line
341)   C7C4 11 13 00    		       LD DE,20-3+2	;
342)   C7C7 19          		       ADD HL,DE	;
343)   C7C8 CD 32 C8    		       CALL XFOR3	;
344)   C7CB 30 12       		       JR NC,FORIN2    ;J. IF STACK ALL CHECKED	;J. IF STACK ALL CHECKED
345)   C7CD 7E          		       LD A,(HL)	;
346)   C7CE 23          		       INC HL	;
347)   C7CF B9          		       CP C	;
348)   C7D0 20 F2       		       JR NZ,FORINA	;
349)   C7D2 7E          		       LD A,(HL)	;
350)   C7D3 B8          		       CP B	;
351)   C7D4 20 EE       		       JR NZ,FORINA    ;J. IF NOT SAME FOR LOOP	;J. IF NOT SAME FOR LOOP
353)   C7D6 2B          		       DEC HL	;
354)   C7D7 2B          		       DEC HL	;
355)   C7D8 2B          		       DEC HL	;
356)   C7D9 2B          		       DEC HL	;
357)   C7DA 01 14 00    		       LD BC,20	;
358)   C7DD D7 46       		       DEFW ZDLUSS	;
362)   C7DF E7 05       		       DEFW ZFPZERO	;
363)   C7E1 CD 36 DC    		       CALL GUSTP	;
364)   C7E4 FD 75 14    		       LD (IY+FORPTR),L	;
365)   C7E7 FD 74 15    		       LD (IY+FORPTR+1),H	;
366)   C7EA 01 03 00    		       LD BC,3	;
367)   C7ED 09          		       ADD HL,BC	;
368)   C7EE E5          		       PUSH HL         ;ADDR OF L.N.T. ENTRY FOR "FOR"	;ADDR OF L.N.T. ENTRY FOR "FOR"
369)   C7EF 09          		       ADD HL,BC	;
370)   C7F0 E5          		       PUSH HL	;
371)   C7F1 EB          		       EX DE,HL	;
372)   C7F2 21 00 01    		       LD HL,FACC	;
373)   C7F5 E7 26       		       DEFW ZCOMP      ;compare step against zero	;compare step against zero
374)   C7F7 17          		       RLA             ;shift sign of step into	;shift sign of step into
375)   C7F8 E1          		       POP HL          ;   bit 0 of A	;   bit 0 of A
376)   C7F9 11 06 00    		       LD DE,6	;
377)   C7FC 19          		       ADD HL,DE	;
378)   C7FD E5          		       PUSH HL         ;SAVE LOC(LIMIT)	;SAVE LOC(LIMIT)
379)   C7FE 19          		       ADD HL,DE	;
380)   C7FF 5E          		       LD E,(HL)	;
381)   C800 23          		       INC HL	;
382)   C801 56          		       LD D,(HL)       ;DE=LOC(C.V.)	;DE=LOC(C.V.)
383)   C802 E1          		       POP HL          ;HL=LOC(LIMIT)	;HL=LOC(LIMIT)
384)   C803 1F          		       RRA	;
385)   C804 38 01       		       JR C,LFI3       ;IF STEP -VE	;IF STEP -VE
386)   C806 EB          		       EX DE,HL	;
387)   C807 E7 26       		LFI3:  DEFW ZCOMP	;
390)   C809 D1          		       POP DE	;
391)   C80A 30 0C       		       JR NC,LFI5      ;IF REQ DO BODY OF LOOP	;IF REQ DO BODY OF LOOP
392)   C80C 01 14 00    		       LD BC,20	;
393)   C80F CD 03 D9    		       CALL UNST	;
394)   C812 FD 74 15    		       LD (IY+FORPTR+1),H	;
395)   C815 FD 75 14    		       LD (IY+FORPTR),L	;
396)   C818 EB          		LFI5:  EX DE,HL	;
397)   C819 5E          		LFI6:  LD E,(HL)	;
398)   C81A 23          		       INC HL	;
399)   C81B 56          		       LD D,(HL)	;
400)   C81C A7          		       AND A           ;clear carry	;clear carry
401)   C81D D5          		       PUSH DE	;
402)   C81E DD E1       		       POP IX	;
403)   C820 C9          		       RET	;
406)   C821 E5          		XIF:   PUSH    HL      ;SAVE PTR.TO OBJ. CODE	;SAVE PTR.TO OBJ. CODE
407)   C822 D7 2E       		       DEFW ZUNST6     ;DE-> RESULT OF COMPARISON	;DE-> RESULT OF COMPARISON
408)   C824 D5          		       PUSH    DE	;
409)   C825 E7 05       		       DEFW ZFPZERO    ;LOAD FACC WITH -1	;LOAD FACC WITH -1
410)   C827 D1          		       POP     DE	;
411)   C828 E7 26       		       DEFW ZCOMP      ;SET Z IF FALSE 	;SET Z IF FALSE
412)   C82A E1          		       POP HL	;
413)   C82B 28 EC       		       JR Z LFI6       ;False - goto next line number	;False - goto next line number
414)   C82D 23          		       INC HL	;
415)   C82E 23          		       INC HL	;
416)   C82F 37          		       SCF	;
417)   C830 9F          		       SBC A,A	;
418)   C831 C9          		       RET	;
425)   C832 D5          		       PUSH DE	;
426)   C833 CD 2C D1    		       CALL GGSP	;
427)   C836 A7          		       AND A	;
428)   C837 ED 52       		       SBC HL,DE	;
429)   C839 19          		       ADD HL,DE	;
430)   C83A D1          		       POP DE	;
431)   C83B C9          		       RET	;
434)   C83C CD A0 D1    		       CALL GFORP	;
435)   C83F DD E5       		       PUSH IX	;
436)   C841 C1          		       POP BC	;
437)   C842 3E 29       		       LD A,41	;
438)   C844 CD 32 C8    		FORST2: CALL XFOR3	;
439)   C847 3F          		       CCF	;
440)   C848 D8          		       RET C           ;if FOR block not found	;if FOR block not found
441)   C849 5E          		       LD E,(HL)	;
442)   C84A 23          		       INC HL	;
443)   C84B 56          		       LD D,(HL)	;
444)   C84C EB          		       EX DE,HL	;
445)   C84D B7          		       OR A	;
446)   C84E ED 42       		       SBC HL,BC	;
447)   C850 EB          		       EX DE,HL	;
448)   C851 28 06       		       JR Z,FORST3	;
449)   C853 11 13 00    		       LD DE,20-1	;
450)   C856 19          		       ADD HL,DE	;
451)   C857 18 EB       		       JR FORST2	;
453)   C859 2B          		FORST3: DEC HL	;
454)   C85A CD 8C C5    		       CALL LDUSTP	;
455)   C85D 11 06 00    		       LD DE,6	;
456)   C860 19          		       ADD HL,DE	;
457)   C861 E5          		       PUSH HL	;
458)   C862 E7 2B       		       DEFW ZLDF       ;FPA=STEP	;FPA=STEP
459)   C864 E1          		       POP HL	;
460)   C865 11 0C 00    		       LD DE,12	;
461)   C868 19          		       ADD HL,DE	;
462)   C869 5E          		       LD E,(HL)	;
463)   C86A 23          		       INC HL	;
464)   C86B 56          		       LD D,(HL)       ;DE=LOC(C.V.)	;DE=LOC(C.V.)
465)   C86C D5          		       PUSH DE	;
466)   C86D E7 16       		       DEFW ZADD	;
467)   C86F 3E 02       		       LD A,2          ;set error code to 2	;set error code to 2
468)   C871 E1          		       POP HL	;
469)   C872 D8          		       RET     C       ;R.IF ADD ERROR	;R.IF ADD ERROR
470)   C873 E7 2D       		       DEFW ZSTF       ;C.V. UPDATED	;C.V. UPDATED
471)   C875 C3 DF C7    		       JP FORIN2	;
473)   C878 D7 0C       		CPUT:  DEFW ZCDEVO	;
474)   C87A DF 18       		CPUT1: DEFW WEXPN	;
475)   C87C D8          		       RET C	;
476)   C87D B7          		       OR A	;
477)   C87E 28 05       		       JR Z CPUT2	;
478)   C880 3E 82       		       LD A,YASC	;
479)   C882 D7 57       		       DEFW ZCMONE	;
480)   C884 D8          		       RET C	;
481)   C885 3E 81       		CPUT2: LD A,YPUT	;
482)   C887 D7 57       		       DEFW ZCMONE	;
483)   C889 D8          		       RET C	;
484)   C88A D7 40       		       DEFW ZCHKCOM	;
485)   C88C 30 EC       		       JR NC CPUT1	;
486)   C88E 18 35       		       JR CDIM2	;
488)   C890 D7 0C       		CGET:  DEFW ZCDEVO	;
489)   C892 DF 53       		CGET1: DEFW WBVARIA	;
490)   C894 2E 86       		       LD L,YGET	;
491)   C896 60          		       LD H,B	;
492)   C897 DF 01       		       DEFW WCM2HL	;
493)   C899 D8          		       RET C	;
494)   C89A D7 40       		       DEFW ZCHKCOM	;
495)   C89C 30 F4       		       JR NC CGET1	;
496)   C89E 18 25       		       JR CDIM2	;
499)   C8A0 D7 19       		       DEFW ZVARIA	;
500)   C8A2 DF 44       		       DEFW WCHKOPN	;
501)   C8A4 DF 1B       		       DEFW WADDSYM	;
502)   C8A6 E5          		       PUSH HL         ;SAVE S.T.ADDR.	;SAVE S.T.ADDR.
503)   C8A7 DF 16       		       DEFW WNUMEXP	;
504)   C8A9 38 1E       		       JR C,CDIM7      ;IF HAVE HAD AN ERROR	;IF HAVE HAD AN ERROR
505)   C8AB D7 40       		       DEFW ZCHKCOM	;
506)   C8AD 26 80       		       LD H,80H	;
507)   C8AF 38 06       		       JR C,CDIM1	;
508)   C8B1 D7 16       		       DEFW ZNUMEXP	;
509)   C8B3 38 14       		       JR C CDIM7	;
510)   C8B5 26 C0       		       LD H,0C0H	;
511)   C8B7 2E F5       		CDIM1: LD L,YDIM	;
512)   C8B9 D7 01       		       DEFW ZCM2HL	;
513)   C8BB E1          		       POP HL	;
514)   C8BC DF 01       		       DEFW WCM2HL	;
515)   C8BE DF 3F       		       DEFW WCHKCLS	;
516)   C8C0 D8          		       RET C	;
517)   C8C1 D7 40       		       DEFW ZCHKCOM	;
518)   C8C3 30 DB       		       JR NC,CDIM	;
519)   C8C5 B7          		CDIM2: OR A	;
520)   C8C6 C3 43 CE    		       JP CDEF8	;
522)   C8C9 E1          		CDIM7: POP HL	;
523)   C8CA C9          		       RET	;
525)   C8CB 7E          		XDIMX: LD A,(HL)	;
526)   C8CC 23          		       INC HL	;
527)   C8CD 5E          		       LD E,(HL)	;
528)   C8CE 23          		       INC HL	;
529)   C8CF 56          		       LD D,(HL)	;
530)   C8D0 23          		       INC HL	;
531)   C8D1 E5          		       PUSH HL	;
532)   C8D2 EB          		       EX DE,HL	;
533)   C8D3 23          		       INC HL	;
534)   C8D4 5E          		       LD E,(HL)	;
535)   C8D5 CD 54 CE    		       CALL TYFN8	;
536)   C8D8 38 EF       		       JR C CDIM7	;
537)   C8DA 4E          		       LD C,(HL)	;
538)   C8DB 2B          		       DEC HL	;
539)   C8DC E5          		       PUSH HL	;
540)   C8DD 16 00       		       LD D,0	;
541)   C8DF FD 7E 2A    		       LD A,(IY+BASFLG)	;
542)   C8E2 E6 01       		       AND 1	;
543)   C8E4 5F          		       LD E,A	;
544)   C8E5 CB 69       		       BIT 5,C	;
545)   C8E7 28 02       		       JR Z,LXDX3	;
546)   C8E9 D7 2F       		       DEFW ZUNSTSS	;
547)   C8EB D5          		LXDX3: PUSH DE         ;2nd dim.	;2nd dim.
548)   C8EC DF 2F       		       DEFW WUNSTSS	;
549)   C8EE 42          		       LD B,D	;
550)   C8EF 4B          		       LD C,E	;
551)   C8F0 D1          		       POP DE	;
552)   C8F1 E1          		       POP HL	;
553)   C8F2 DF 12       		       DEFW WXDIM	;
554)   C8F4 C3 F2 C1    		       JP XRUN1D	;
564)   C8F7 23          		       INC HL	;
565)   C8F8 23          		       INC HL	;
566)   C8F9 7E          		       LD A,(HL)	;
567)   C8FA 23          		       INC HL	;
568)   C8FB B6          		       OR (HL)	;
569)   C8FC 3E 47       		       LD A,71	;
570)   C8FE 37          		       SCF             ;ERROR IF STORAGE ALREADY	;ERROR IF STORAGE ALREADY
571)   C8FF C0          		       RET NZ	;
572)   C900 FD CB 2A FE 		       SET 7,(IY+BASFLG)       ;mustn't change base now	;mustn't change base now
573)   C904 FD CB 2A 46 		       BIT 0,(IY+BASFLG)	;
574)   C908 20 02       		       JR NZ,DIM3	;
575)   C90A 13          		       INC DE	;
576)   C90B 03          		       INC BC	;
577)   C90C 7A          		DIM3:  LD A,D	;
578)   C90D B3          		       OR E	;
579)   C90E 28 02       		       JR Z,DIM2	;
580)   C910 78          		       LD A,B	;
581)   C911 B1          		       OR C	;
582)   C912 3E 49       		DIM2:  LD A,73	;
583)   C914 37          		       SCF	;
584)   C915 C8          		       RET Z           ;dim 0 with base 1	;dim 0 with base 1
585)   C916 E5          		       PUSH HL	;
586)   C917 23          		       INC HL	;
587)   C918 71          		       LD (HL),C	;
588)   C919 23          		       INC HL	;
589)   C91A 70          		       LD (HL),B	;
590)   C91B 23          		       INC HL	;
591)   C91C 73          		       LD (HL),E	;
592)   C91D 23          		       INC HL	;
593)   C91E 72          		       LD (HL),D	;
594)   C91F CD 8E D3    		       CALL LMN1       ;HL*DE -> HL	;HL*DE -> HL
595)   C922 38 03       		       JR C DIM6       ;if overflow	;if overflow
596)   C924 3E 14       		       LD A,20	;
597)   C926 BC          		       CP H	;
598)   C927 3E 48       		DIM6:  LD A,72	;
599)   C929 38 09       		       JR C,DIM8       ;UNLESS DEFINITELY <32768 BYTES	;UNLESS DEFINITELY <32768 BYTES
600)   C92B 44          		       LD B,H          ;NOW MULTIPLY BY 6 TO GET	;NOW MULTIPLY BY 6 TO GET
601)   C92C 4D          		       LD C,L          ;   # BYTES	;   # BYTES
602)   C92D CD 01 D6    		       CALL M6A        ;Now BC = amt store req'd	;Now BC = amt store req'd
603)   C930 1E 1A       		       LD E,ARBAS	;
604)   C932 D7 6E       		       DEFW ZINSS	;
605)   C934 D1          		DIM8:  POP DE	;
606)   C935 D8          		       RET C	;
607)   C936 D5          		       PUSH DE	;
608)   C937 E5          		       PUSH HL	;
609)   C938 36 00       		       LD (HL),0	;
610)   C93A 54          		       LD D,H	;
611)   C93B 5D          		       LD E,L	;
612)   C93C 13          		       INC DE	;
613)   C93D D7 48       		       DEFW ZNOTBC	;
614)   C93F ED B0       		       LDIR            ;clear elements to zero	;clear elements to zero
615)   C941 CD 4F C9    		       CALL GSBAS	;
616)   C944 EB          		       EX DE,HL	;
617)   C945 E1          		       POP HL	;
618)   C946 ED 52       		       SBC HL,DE       ;NB CARRY STILL CLEAR	;NB CARRY STILL CLEAR
619)   C948 EB          		       EX DE,HL	;
620)   C949 B7          		       OR A	;
621)   C94A E1          		       POP HL	;
622)   C94B 72          		       LD (HL),D	;
623)   C94C 2B          		       DEC HL	;
624)   C94D 73          		       LD (HL),E	;
625)   C94E C9          		XREM:  RET	;
628)   C94F FD 6E 1C    		       LD L,(IY+SBAS)	;
629)   C952 FD 66 1D    		       LD H,(IY+SBAS+1)	;
630)   C955 C9          		       RET	;
634)   C956 E7 25       		       DEFW ZRANDOM	;
635)   C958 C9          		       RET	;
638)   C959 D7 2B       		GFNAME: DEFW ZUNST2	;
639)   C95B E5          		       PUSH HL	;
640)   C95C CD B4 CD    		       CALL DELST2	;
641)   C95F EB          		       EX DE,HL	;
642)   C960 C1          		       POP BC	;
643)   C961 11 80 00    		       LD DE,128	;
644)   C964 3A 13 00    		       LD A,(DEV2)	;
645)   C967 C9          		       RET	;
647)   C968 D7 11       		INFILE: DEFW ZGFNAME	;
648)   C96A FD 73 07    		       LD (IY+INCON),E	;
649)   C96D E7 32       		       DEFW ZOPENIN	;
650)   C96F C9          		       RET	;
652)   C970 FD CB 22 D6 		XSAVEH: SET 2,(IY+FLAGS)       ;leave tokens in	;leave tokens in
653)   C974 D7 09       		       DEFW ZXLISN	;
654)   C976 FD CB 22 96 		       RES 2,(IY+FLAGS)	;
655)   C97A DF 3A       		       DEFW WPTEOF	;
656)   C97C C9          		       RET	;
658)   C97D CD 68 C9    		XMERGF: CALL INFILE	;
659)   C980 D4 EB D1    		       CALL NC XMERGE	;
660)   C983 18 12       		       JR XSAVE1	;
662)   C985 CD 68 C9    		XVERFF: CALL INFILE	;
663)   C988 D4 95 CF    		       CALL NC XVERIF	;
664)   C98B 18 0A       		       JR XSAVE1	;
666)   C98D D7 11       		XSAVEF: DEFW ZGFNAME	;
667)   C98F FD 73 06    		       LD (IY+OUTCON),E	;
668)   C992 E7 33       		       DEFW ZOPNOUT	;
669)   C994 D4 70 C9    		       CALL NC XSAVEH	;
670)   C997 1E 80       		XSAVE1: LD E,128	;
671)   C999 30 12       		       JR NC XCLO1	;
672)   C99B F5          		       PUSH AF	;
673)   C99C E7 34       		       DEFW ZCLOSE	;
674)   C99E F1          		       POP AF	;
675)   C99F C9          		       RET	;
678)   C9A0 D7 2F       		       DEFW ZUNSTSS	;
679)   C9A2 3E 00       		       LD A,0	;
680)   C9A4 9A          		       SBC A,D	;
681)   C9A5 3E 5A       		       LD A,90         ;stream number error	;stream number error
682)   C9A7 D8          		       RET C	;
683)   C9A8 AF          		       XOR A	;
684)   C9A9 93          		       SUB E	;
685)   C9AA 3F          		       CCF	;
686)   C9AB 3E 5C       		       LD A,92         ;close stream zero error	;close stream zero error
687)   C9AD EF 34       		XCLO1: DEFW WCLOSE	;
688)   C9AF C9          		       RET	;
690)   C9B0 CD 68 C9    		XLOADF: CALL INFILE	;
691)   C9B3 D4 B8 C9    		       CALL NC XLOADH	;
692)   C9B6 18 DF       		       JR XSAVE1	;
694)   C9B8 D7 56       		XLOADH: DEFW ZXNEW	;
695)   C9BA B7          		       OR A	;
696)   C9BB FD 5E 07    		XLDLP: LD E,(IY+INCON)	;
697)   C9BE DF 4E       		       DEFW WRDLINE	;
698)   C9C0 D8          		       RET C	;
699)   C9C1 D7 38       		       DEFW ZRDSCH	;
700)   C9C3 FE 04       		       CP EOF	;
701)   C9C5 CC 55 D7    		       CALL Z DISPOSE  ; preserves AF	; preserves AF
702)   C9C8 28 1B       		       JR Z XEND	;
703)   C9CA FE 0D       		       CP 0DH	;
704)   C9CC 28 ED       		       JR Z XLDLP	;
705)   C9CE D7 20       		       DEFW ZAMENDL	;
706)   C9D0 18 E9       		       JR XLDLP	;
709)   C9D2 CD 98 D8    		       CALL GTOP	;
710)   C9D5 E5          		       PUSH HL	;
711)   C9D6 DD E1       		       POP IX	;
712)   C9D8 1E 1C       		       LD E,SBAS	;
713)   C9DA D7 07       		       DEFW ZSETS2     ;Set SBAS and LBAS to (B4)	;Set SBAS and LBAS to (B4)
714)   C9DC D7 54       		       DEFW ZINITST    ;Initialise upper store areas	;Initialise upper store areas
716)   C9DE 1E 1F       		       LD E,SOBAS-LBAS	;
717)   C9E0 19          		       ADD HL,DE	;
718)   C9E1 1E 0E       		       LD E,STOP	;
719)   C9E3 D7 07       		       DEFW ZSETS2     ;Initialise STOP and OTOP	;Initialise STOP and OTOP
720)   C9E5 37          		XEND:  SCF	;
721)   C9E6 3E 01       		       LD A,1	;
722)   C9E8 C9          		       RET	;
724)   C9E9 46          		XOPEN: LD B,(HL)       ;control byte	;control byte
725)   C9EA D7 2B       		       DEFW ZUNST2     ;ST addr of FILE$	;ST addr of FILE$
726)   C9EC EB          		       EX DE,HL        ;so HL = USRSTP	;so HL = USRSTP
727)   C9ED D5          		       PUSH DE         ;save FILE$	;save FILE$
728)   C9EE C5          		       PUSH BC         ;save control byte	;save control byte
729)   C9EF 4E          		       LD C,(HL)	;
730)   C9F0 23          		       INC HL	;
731)   C9F1 46          		       LD B,(HL)	;
732)   C9F2 23          		       INC HL          ;HLBC = filename	;HLBC = filename
733)   C9F3 CD 3E D9    		       CALL ASSSTR     ;assign it to FILE$	;assign it to FILE$
734)   C9F6 C1          		       POP BC	;
735)   C9F7 11 00 00    		       LD DE,0	;
736)   C9FA CB 68       		       BIT 5,B	;
737)   C9FC 28 04       		       JR Z LXO1	;
738)   C9FE C5          		       PUSH BC	;
739)   C9FF DF 2F       		       DEFW WUNSTSS	;
740)   CA01 C1          		       POP BC	;
741)   CA02 D5          		LXO1:  PUSH DE	;
742)   CA03 3A 13 00    		       LD A,(DEV2)	;
743)   CA06 5F          		       LD E,A	;
744)   CA07 16 00       		       LD D,0	;
745)   CA09 CB 58       		       BIT 3,B	;
746)   CA0B C5          		       PUSH BC	;
747)   CA0C 28 02       		       JR Z LXO2	;
748)   CA0E DF 2F       		       DEFW WUNSTSS	;
749)   CA10 D5          		LXO2:  PUSH DE	;
750)   CA11 DF 2F       		       DEFW WUNSTSS	;
751)   CA13 C1          		       POP BC	;
752)   CA14 E1          		       POP HL	;
753)   CA15 E3          		       EX (SP),HL	;
754)   CA16 38 0B       		       JR C LXO7	;
755)   CA18 78          		       LD A,B	;
756)   CA19 B2          		       OR D	;
757)   CA1A B4          		       OR H	;
758)   CA1B C6 FF       		       ADD A,255       ;set CY iff A~=0	;set CY iff A~=0
759)   CA1D 3E 5A       		       LD A,90	;
760)   CA1F 38 02       		       JR C LXO7	;
761)   CA21 79          		       LD A,C	;
762)   CA22 55          		       LD D,L	;
763)   CA23 C1          		LXO7:  POP BC	;
764)   CA24 E1          		       POP HL	;
765)   CA25 D8          		       RET C           ;if error via LXO7	;if error via LXO7
766)   CA26 E5          		       PUSH HL	;
767)   CA27 CB 40       		       BIT 0,B	;
768)   CA29 F5          		       PUSH AF	;
769)   CA2A D5          		       PUSH DE	;
770)   CA2B D7 15       		       DEFW ZMKSTAB	;
771)   CA2D D1          		       POP DE	;
772)   CA2E AF          		       XOR A	;
773)   CA2F 93          		       SUB E           ;set CY iff E~=0	;set CY iff E~=0
774)   CA30 EF 34       		       DEFW WCLOSE	;
775)   CA32 F1          		       POP AF	;
776)   CA33 28 03       		       JR Z LXO4	;
777)   CA35 E7 33       		       DEFW ZOPNOUT	;
778)   CA37 11          		       DEFB 11H        ;code for LD DE,.. i.e. skip	;code for LD DE,.. i.e. skip
779)   CA38 E7 32       		LXO4:  DEFW ZOPENIN	;
780)   CA3A DF 2D       		       DEFW WLPSTR1	;
781)   CA3C D1          		       POP DE	;
782)   CA3D D8          		       RET C	;
783)   CA3E CD 36 DC    		       CALL GUSTP	;
784)   CA41 4E          		       LD C,(HL)	;
785)   CA42 23          		       INC HL	;
786)   CA43 46          		       LD B,(HL)	;
787)   CA44 C3 3E D9    		       JP ASSSTR	;
791)   CA47 D7 42       		       DEFW ZCHKHSH	;
792)   CA49 16 E2       		       LD D,YCLOSE	;
793)   CA4B 18 16       		       JR CLET1	;
797)   CA4D D7 16       		       DEFW    ZNUMEXP	;
798)   CA4F DF 40       		       DEFW    WCHKCOM	;
799)   CA51 16 8B       		       LD      D,YPOKE	;
800)   CA53 18 0E       		       JR CLET1	;
802)   CA55 16 A4       		CRESER: LD D,YRESER    ;note carry unset from STATEL	;note carry unset from STATEL
803)   CA57 18 0A       		       JR CLET1	;
808)   CA59 D7 53       		       DEFW ZBVARIA	;
809)   CA5B DF 41       		       DEFW WCHKEQ	;
810)   CA5D CB 70       		       BIT 6,B	;
811)   CA5F 20 07       		       JR NZ,STRLET    ;J. if string -let	;J. if string -let
812)   CA61 16 C9       		       LD D,YLETN	;
813)   CA63 D5          		CLET1: PUSH DE	;
814)   CA64 DF 16       		       DEFW WNUMEXP	;
815)   CA66 18 5A       		       JR LCL6	;
817)   CA68 DF 17       		STRLET: DEFW WSTREXP	;
818)   CA6A D8          		       RET C	;
819)   CA6B 3E C8       		       LD A,YLETS	;
820)   CA6D 21          		       DEFB 21H        ;op-code for LD HL,nn-i.e. skip	;op-code for LD HL,nn-i.e. skip
821)   CA6E 3E DC       		CRAND: LD A,YRAND	;
822)   CA70 21          		       DEFB 21H	;
823)   CA71 3E C1       		CRUN:  LD A,YRUN	;
824)   CA73 21          		       DEFB 21H	;
825)   CA74 3E E4       		CEND:  LD A,YEND	;
826)   CA76 21          		       DEFB 21H	;
827)   CA77 3E A3       		CREPORT: LD A,YREPORT	;
828)   CA79 21          		       DEFB 21H	;
829)   CA7A 3E 8D       		CCONT: LD A,YCONT	;
830)   CA7C 21          		       DEFB 21H	;
831)   CA7D 3E C4       		CRETN: LD A,YRET	;
832)   CA7F 21          		       DEFB 21H	;
833)   CA80 3E E6       		CNEW:  LD A,YNEW	;
834)   CA82 21          		       DEFB 21H	;
835)   CA83 3E E3       		CSTOP: LD A,YSTOP	;
836)   CA85 D7 57       		CSTOP1: DEFW ZCMONE	;
837)   CA87 DF 3E       		       DEFW WCHKCR	;
838)   CA89 C9          		       RET	;
840)   CA8A D7 60       		CLINP: DEFW ZSTCIN	;
841)   CA8C DF 53       		       DEFW WBVARIA	;
842)   CA8E D8          		       RET C	;
843)   CA8F CB 70       		       BIT 6,B	;
844)   CA91 3E 60       		       LD A,96	;
845)   CA93 37          		       SCF	;
846)   CA94 C8          		       RET Z	;
847)   CA95 3E 87       		       LD A,YLINP	;
848)   CA97 18 EC       		       JR CSTOP1	;
850)   CA99 D7 60       		CINPUT: DEFW ZSTCIN	;
851)   CA9B 21 D7 EE    		       LD HL,YSEP+(YENDIN.SHL.8)	;
852)   CA9E 18 07       		       JR CRE3	;
855)   CAA0 3E 8E       		       LD A,YBEGRD	;
856)   CAA2 21 90 8F    		       LD HL,YSEPRD+(YENDRD.SHL.8)	;
857)   CAA5 D7 57       		CRE2:  DEFW ZCMONE	;
858)   CAA7 E5          		CRE3:  PUSH HL	;
859)   CAA8 DF 53       		       DEFW WBVARIA	;
860)   CAAA 38 0A       		       JR C CRE4	;
861)   CAAC CB 70       		       BIT 6,B	;
862)   CAAE 3E D5       		       LD A,YNUMIN	;
863)   CAB0 28 02       		       JR Z CRE1	;
864)   CAB2 3E D6       		       LD A,YSTRIN	;
865)   CAB4 D7 57       		CRE1:  DEFW ZCMONE	;
866)   CAB6 E1          		CRE4:  POP HL	;
867)   CAB7 D8          		       RET C	;
868)   CAB8 D7 40       		       DEFW ZCHKCOM	;
869)   CABA 7D          		       LD A,L	;
870)   CABB 30 E8       		       JR NC CRE2	;
871)   CABD 7C          		       LD A,H	;
872)   CABE 18 C5       		       JR CSTOP1	;
875)   CAC0 D7 17       		LCL5:  DEFW ZSTREXP	;
876)   CAC2 D1          		LCL6:  POP DE	;
877)   CAC3 D8          		       RET C	;
878)   CAC4 7A          		       LD A,D	;
879)   CAC5 18 BE       		       JR CSTOP1	;
881)   CAC7 21 CA 9A    		CMERGE: LD HL,YSTICN+(YMERGE.SHL.8)	;
882)   CACA 18 0D       		       JR LCL2	;
885)   CACC 21 CA 9C    		       LD HL,YSTICN+(YVERIF.SHL.8)	;
886)   CACF 18 08       		       JR LCL2	;
888)   CAD1 21 CB DD    		CSAVE: LD HL,YSTOCN+(YSAVEH.SHL.8)	;
889)   CAD4 18 03       		       JR LCL2	;
891)   CAD6 21 CA DF    		CLOAD: LD HL,YSTICN+(YLOADH.SHL.8)	;
892)   CAD9 D7 42       		LCL2:  DEFW ZCHKHSH	;
893)   CADB 38 06       		       JR C,LCL4               ;if no #	;if no #
894)   CADD E5          		       PUSH HL	;
895)   CADE D7 16       		       DEFW ZNUMEXP	;
896)   CAE0 E1          		       POP HL	;
897)   CAE1 18 4F       		       JR CLOAD8	;
899)   CAE3 24          		LCL4:  INC H   ;H=next code i.e. Y***F	;H=next code i.e. Y***F
900)   CAE4 E5          		       PUSH HL	;
901)   CAE5 D7 3E       		       DEFW ZCHKCR	;
902)   CAE7 38 D7       		       JR C LCL5	;
903)   CAE9 D7 05       		       DEFW ZCPSH0	;
904)   CAEB 18 D5       		       JR LCL6	;
907)   CAED 85 04       		KWGOTO: DEFB TGOTO,4	;
908)   CAEF C6 00 C6 00 		       DEFW YON,YON,YONSUB	;
908)   CAF3 F4 00       		       DEFW YON,YON,YONSUB	;
909)   CAF5 F4          		       DEFB YONSUB	;
911)   CAF6 06 BA       		CNON:  LD B,TERR	;
912)   CAF8 D7 6B       		       DEFW ZCHECK	;
913)   CAFA 30 05       		       JR NC CNL1	;
914)   CAFC 04          		       INC B	;
915)   CAFD D7 6B       		       DEFW ZCHECK	;
916)   CAFF 38 15       		       JR C CON	;
917)   CB01 C5          		CNL1:  PUSH BC	;
918)   CB02 06 B5       		       LD B,TINVTH	;
919)   CB04 D7 6B       		       DEFW ZCHECK	;
920)   CB06 21 ED CA    		       LD HL,KWGOTO	;
921)   CB09 DF 1E       		       DEFW WSCAN	;
922)   CB0B 3E 5D       		       LD A,93	;
923)   CB0D DF 22       		       DEFW WINTIN	;
924)   CB0F C1          		       POP BC	;
925)   CB10 D8          		       RET C	;
926)   CB11 78          		       LD A,B	;
927)   CB12 D6 22       		       SUB TERR-YERR	;
928)   CB14 18 2D       		       JR CREST8	;
931)   CB16 D7 16       		       DEFW ZNUMEXP	;
932)   CB18 D8          		       RET C	;
933)   CB19 06 B5       		       LD B,TINVTH	;
934)   CB1B D7 6B       		       DEFW ZCHECK	;
935)   CB1D 21 ED CA    		       LD HL,KWGOTO	;
936)   CB20 DF 1E       		       DEFW WSCAN	;
937)   CB22 3E 22       		       LD A,34	;
938)   CB24 D8          		       RET C	;
939)   CB25 79          		       LD A,C	;
940)   CB26 D7 57       		       DEFW ZCMONE	;
941)   CB28 DF 06       		CON1:  DEFW WCLABEL	;
942)   CB2A D8          		       RET C	;
943)   CB2B D7 40       		       DEFW ZCHKCOM	;
944)   CB2D 30 F9       		       JR NC,CON1	;
945)   CB2F AF          		       XOR A	;
946)   CB30 67          		       LD H,A	;
947)   CB31 6F          		       LD L,A	;
948)   CB32 DF 01       		CLOAD8: DEFW WCM2HL	;
949)   CB34 DF 3E       		       DEFW WCHKCR	;
950)   CB36 C9          		       RET	;
954)   CB37 D7 3E       		       DEFW    ZCHKCR	;
955)   CB39 21 00 00    		       LD HL,0	;
956)   CB3C 30 03       		       JR NC CREST2	;
957)   CB3E D7 22       		       DEFW ZINTIN	;
958)   CB40 D8          		       RET C	;
959)   CB41 3E 8A       		CREST2: LD A,YREST	;
960)   CB43 D7 02       		CREST8: DEFW ZCMTHRE	;
961)   CB45 DF 3E       		       DEFW WCHKCR	;
962)   CB47 C9          		       RET	;
965)   CB48 D7 0C       		       DEFW ZCDEVO	;
966)   CB4A D8          		       RET C	;
967)   CB4B D7 3E       		       DEFW ZCHKCR	;
968)   CB4D 3E C7       		       LD A,YLIST	;
969)   CB4F 38 07       		       JR C,CLIS1A     ;IF LINE NUMBERS	;IF LINE NUMBERS
970)   CB51 3E CD       		       LD A,YLISTN	;
971)   CB53 D7 57       		       DEFW ZCMONE	;
972)   CB55 C9          		       RET	;
974)   CB56 3E 9E       		CDELET: LD A,YDELET	;
975)   CB58 D7 57       		CLIS1A: DEFW ZCMONE	;
976)   CB5A D8          		       RET C	;
977)   CB5B D7 22       		       DEFW ZINTIN	;
978)   CB5D 30 03       		       JR NC CLI3	;
979)   CB5F 21 00 00    		       LD HL,0	;
980)   CB62 5D          		CLI3:  LD E,L	;
981)   CB63 54          		       LD D,H	;
982)   CB64 D7 38       		       DEFW ZRDSCH	;
983)   CB66 FE 0D       		       CP 0DH	;
984)   CB68 28 0F       		       JR Z CLIST1	;
985)   CB6A FE 82       		       CP TMINUS	;
986)   CB6C 3E 23       		       LD A,35	;
987)   CB6E 37          		       SCF	;
988)   CB6F C0          		       RET NZ	;
989)   CB70 D7 34       		       DEFW ZRDNCH	;
990)   CB72 D7 22       		       DEFW ZINTIN	;
991)   CB74 30 03       		       JR NC CLIST1	;
992)   CB76 21 FF FF    		       LD HL,-1	;
993)   CB79 D7 01       		CLIST1: DEFW ZCM2HL	;
994)   CB7B EB          		       EX DE,HL	;
995)   CB7C 18 B4       		CLIST8: JR CLOAD8	;
998)   CB7E 21 CC CB    		       LD HL,FMTAB	;
999)   CB81 D7 1E       		       DEFW ZSCAN	;
1000)   CB83 3E 0E       		       LD A,14	;
1001)   CB85 C5          		       PUSH BC	;
1002)   CB86 DF 16       		       DEFW WNUMEXP            ;stream number	;stream number
1003)   CB88 E1          		       POP HL	;
1004)   CB89 D8          		       RET C	;
1005)   CB8A D7 40       		       DEFW ZCHKCOM	;
1006)   CB8C 38 29       		       JR C,LCO1       ;no parameters	;no parameters
1007)   CB8E E5          		       PUSH HL	;
1008)   CB8F D7 18       		       DEFW ZEXPN      ;device number or filename	;device number or filename
1009)   CB91 E1          		       POP HL	;
1010)   CB92 D8          		       RET C	;
1011)   CB93 84          		       ADD A,H	;
1012)   CB94 67          		       LD H,A	;
1013)   CB95 CB 64       		       BIT 4,H	;
1014)   CB97 20 1E       		       JR NZ LCO1      ;filename only	;filename only
1015)   CB99 CB DC       		       SET 3,H         ;device found	;device found
1016)   CB9B D7 40       		       DEFW ZCHKCOM	;
1017)   CB9D 38 18       		       JR C LCO1       ;only device found	;only device found
1018)   CB9F E5          		       PUSH HL	;
1019)   CBA0 D7 18       		       DEFW ZEXPN	;
1020)   CBA2 E1          		       POP HL	;
1021)   CBA3 D8          		       RET C	;
1022)   CBA4 84          		       ADD A,H	;
1023)   CBA5 67          		       LD H,A	;
1024)   CBA6 CB 64       		       BIT 4,H	;
1025)   CBA8 20 0D       		       JR NZ LCO1	;
1026)   CBAA CB EC       		       SET 5,H         ;port found (yum yum)	;port found (yum yum)
1027)   CBAC D7 40       		       DEFW ZCHKCOM	;
1028)   CBAE 38 07       		       JR C LCO1       ;no filename	;no filename
1029)   CBB0 E5          		       PUSH HL	;
1030)   CBB1 D7 17       		       DEFW ZSTREXP	;
1031)   CBB3 E1          		       POP HL	;
1032)   CBB4 CB E4       		       SET 4,H	;
1033)   CBB6 D8          		       RET C	;
1034)   CBB7 CB 64       		LCO1:  BIT 4,H	;
1035)   CBB9 20 05       		       JR NZ LCO2	;
1036)   CBBB E5          		       PUSH HL	;
1037)   CBBC D7 05       		       DEFW ZCPSH0	;
1038)   CBBE E1          		       POP HL	;
1039)   CBBF D8          		       RET C	;
1040)   CBC0 2E E1       		LCO2:  LD L,YOPEN	;
1041)   CBC2 E5          		       PUSH HL	;
1042)   CBC3 01 FF C3    		       LD BC,8000H+4000H+1023	;
1043)   CBC6 CD E8 D4    		       CALL VARIA9     ;compile stack ST addr of FILE$	;compile stack ST addr of FILE$
1044)   CBC9 E1          		       POP HL	;
1045)   CBCA 18 B0       		       JR CLIST8	;
1048)   CBCC B1 03       		       DEFB TIN#,3	;
1049)   CBCE 00 00 00 01 		       DEFW 0,256,0	;
1049)   CBD2 00 00       		       DEFW 0,256,0	;
110)   CBD4 FD E5       		       PUSH IY	;
111)   CBD6 E1          		       POP HL	;
112)   CBD7 01 27 00    		       LD BC,CLINNO	;
113)   CBDA 09          		       ADD HL,BC	;
114)   CBDB E5          		       PUSH HL	;
115)   CBDC D7 5E       		       DEFW ZLNTT	;
116)   CBDE E1          		       POP HL	;
117)   CBDF 3E 57       		       LD A,CONTERR	;
118)   CBE1 D8          		       RET C	;
119)   CBE2 7E          		       LD A,(HL)	;
120)   CBE3 23          		       INC HL	;
121)   CBE4 66          		       LD H,(HL)	;
122)   CBE5 6F          		       LD L,A	;
123)   CBE6 E5          		       PUSH HL	;
124)   CBE7 DD E1       		       POP IX	;
125)   CBE9 E5          		       PUSH HL	;
126)   CBEA D7 32       		       DEFW ZSTINST	;
127)   CBEC 06 90       		       LD B,TSTOP	;
128)   CBEE D7 6B       		       DEFW ZCHECK	;
129)   CBF0 E1          		       POP HL	;
130)   CBF1 3E FE       		       LD A,254	;
131)   CBF3 C9          		       RET	;
133)   CBF4 CD 72 C3    		XREPORT: CALL XRESU2	;
134)   CBF7 D8          		       RET C	;
135)   CBF8 21 00 00    		       LD HL,0	;
136)   CBFB 1E 39       		       LD E,ERRLIN	;
137)   CBFD D7 07       		       DEFW ZSETS2	;
138)   CBFF CD D4 CB    		       CALL XCONT	;
139)   CC02 FD 7E 08    		       LD A,(IY+ERRNO)	;
140)   CC05 37          		       SCF	;
141)   CC06 C9          		       RET	;
145)   CC07 D7 2F       		       DEFW ZUNSTSS    ;NO. TO POKE TO E	;NO. TO POKE TO E
146)   CC09 D5          		       PUSH DE	;
147)   CC0A DF 2F       		       DEFW WUNSTSS    ;STORE ADDR.TO DE 	;STORE ADDR.TO DE
148)   CC0C E1          		       POP HL	;
149)   CC0D 3E 00       		       LD A,0	;
150)   CC0F 9C          		       SBC A,H         ;Set CY if already set or	;Set CY if already set or
151)   CC10 3E 26       		       LD A,38         ;number >255. Load poke errno	;number >255. Load poke errno
152)   CC12 D8          		       RET C           ;and ret if poke error.	;and ret if poke error.
153)   CC13 EB          		       EX DE,HL	;
154)   CC14 73          		       LD (HL),E       ;POKE NO. FROM E	;POKE NO. FROM E
155)   CC15 C9          		       RET	;
163)   CC16 D7 16       		       DEFW ZNUMEXP	;
164)   CC18 D8          		       RET C           ;R.IF EXPN.ERROR	;R.IF EXPN.ERROR
165)   CC19 0E 00       		       LD C,0          ;SET PAR. CNT. TO 0	;SET PAR. CNT. TO 0
167)   CC1B D7 3E       		       DEFW ZCHKCR	;
168)   CC1D 30 0B       		       JR NC,CUSR50    ;J.IF FINISHED	;J.IF FINISHED
169)   CC1F C5          		       PUSH BC         ;SAVE PAR.COUNT	;SAVE PAR.COUNT
170)   CC20 D7 40       		       DEFW ZCHKCOM	;
171)   CC22 D4 46 CC    		       CALL NC CONVAR	;
172)   CC25 C1          		       POP BC	;
173)   CC26 D8          		       RET C           ;R.IF ERROR	;R.IF ERROR
174)   CC27 0C          		       INC C	;
175)   CC28 18 F1       		       JR CUSR20	;
182)   CC2A 2E 8C       		       LD L,YUSR	;
183)   CC2C 61          		       LD H,C	;
184)   CC2D D7 01       		       DEFW ZCM2HL	;
185)   CC2F C9          		       RET	;
195)   CC30 7E          		       LD A,(HL)	;
196)   CC31 F5          		       PUSH AF         ;NO. OF PARAMETERS	;NO. OF PARAMETERS
197)   CC32 07          		       RLCA	;
198)   CC33 4F          		       LD C,A	;
199)   CC34 06 00       		       LD B,0	;
200)   CC36 CD 36 DC    		       CALL GUSTP	;
201)   CC39 28 02       		       JR Z,XUSR10	;
202)   CC3B D7 46       		       DEFW ZDLUSS     ;DELETE FROM USER STACK	;DELETE FROM USER STACK
203)   CC3D 2B          		XUSR10: DEC HL	;
204)   CC3E E5          		       PUSH HL	;
205)   CC3F D7 2F       		       DEFW ZUNSTSS	;
206)   CC41 E1          		       POP HL	;
207)   CC42 C1          		       POP BC	;
208)   CC43 D8          		       RET C           ;R.IF ERROR (FIX)	;R.IF ERROR (FIX)
209)   CC44 D5          		       PUSH DE	;
215)   CC45 C9          		       RET     ;ENTER ASSEMBLER INSERT	;ENTER ASSEMBLER INSERT
220)   CC46 D7 1F       		       DEFW ZNCONST	;
221)   CC48 D2 13 C3    		       JP NC,CPSH      ;J.IF NUMERIC CONSTANT	;J.IF NUMERIC CONSTANT
222)   CC4B D7 53       		       DEFW ZBVARIA	;
223)   CC4D C9          		       RET	;
226)   CC4E E5          		XBEGRD: PUSH HL	;
227)   CC4F FD 36 07 7F 		       LD (IY+INCON),127	;
228)   CC53 CD C3 CC    		       CALL GDTLN	;
229)   CC56 D7 64       		       DEFW ZNFIND	;
230)   CC58 38 24       		       JR C STDP7	;
231)   CC5A D7 62       		STDP9: DEFW ZLAST	;
232)   CC5C 28 FC       		       JR Z STDP9	;
233)   CC5E FD 4E 2F    		       LD C,(IY+DTINPT)	;
234)   CC61 FD 46 30    		       LD B,(IY+DTINPT+1)	;
235)   CC64 79          		       LD A,C	;
236)   CC65 B0          		       OR B	;
237)   CC66 28 1A       		       JR Z STDP4	;
238)   CC68 E5          		       PUSH HL	;
239)   CC69 D7 32       		       DEFW ZSTINST	;
240)   CC6B 09          		       ADD HL,BC	;
241)   CC6C CD A3 DA    		       CALL LINPTR	;
242)   CC6F E1          		       POP HL	;
243)   CC70 FD 74 32    		STDP3: LD (IY+DTLN+1),H	;
244)   CC73 FD 75 31    		       LD (IY+DTLN),L	;
245)   CC76 D7 3E       		       DEFW ZCHKCR	;
246)   CC78 30 12       		       JR NC STDP5	;
247)   CC7A B7          		       OR A	;
248)   CC7B C3 F2 C1    		STDP6: JP XRUN1D	;
250)   CC7E D7 65       		STDP7: DEFW ZLLN2	;
251)   CC80 38 0E       		       JR C STDP2	;
252)   CC82 E5          		STDP4: PUSH HL	;
253)   CC83 D7 32       		       DEFW ZSTINST	;
254)   CC85 06 9D       		       LD B,TDATA	;
255)   CC87 D7 6B       		       DEFW ZCHECK	;
256)   CC89 E1          		       POP HL	;
257)   CC8A 30 E4       		       JR NC STDP3	;
258)   CC8C D7 28       		STDP5: DEFW ZNLNT	;
259)   CC8E 30 F2       		       JR NC STDP4	;
260)   CC90 E1          		STDP2: POP HL	;
261)   CC91 3E 63       		       LD A,DATERR	;
262)   CC93 C9          		       RET	;
264)   CC94 D7 40       		XENDRD: DEFW ZCHKCOM	;
265)   CC96 30 03       		       JR NC XRND1	;
266)   CC98 D7 3E       		       DEFW ZCHKCR	;
267)   CC9A D8          		       RET C	;
268)   CC9B CD AA DA    		XRND1: CALL GINPTR	;
269)   CC9E EB          		       EX DE,HL	;
270)   CC9F CD C3 CC    		       CALL GDTLN	;
271)   CCA2 4E          		       LD C,(HL)	;
272)   CCA3 23          		       INC HL	;
273)   CCA4 46          		       LD B,(HL)	;
274)   CCA5 2B          		       DEC HL	;
275)   CCA6 FD 71 31    		       LD (IY+DTLN),C	;
276)   CCA9 FD 70 32    		       LD (IY+DTLN+1),B	;
277)   CCAC D7 32       		       DEFW ZSTINST	;
278)   CCAE EB          		       EX DE,HL	;
279)   CCAF B7          		       OR A	;
280)   CCB0 ED 52       		       SBC HL,DE	;
281)   CCB2 FD 74 30    		XRND2: LD (IY+DTINPT+1),H	;
282)   CCB5 FD 75 2F    		       LD (IY+DTINPT),L	;
283)   CCB8 C9          		       RET	;
285)   CCB9 E5          		XSEPRD: PUSH HL	;
286)   CCBA D7 40       		       DEFW ZCHKCOM	;
287)   CCBC 30 BD       		       JR NC STDP6	;
288)   CCBE CD C3 CC    		       CALL GDTLN	;
289)   CCC1 18 AD       		       JR STDP3	;
291)   CCC3 FD 66 32    		GDTLN: LD H,(IY+DTLN+1)	;
292)   CCC6 FD 6E 31    		       LD L,(IY+DTLN)	;
293)   CCC9 C9          		       RET	;
299)   CCCA 7E          		       LD A,(HL)	;
300)   CCCB FD 77 31    		       LD (IY+DTLN),A	;
301)   CCCE 23          		       INC HL	;
302)   CCCF 7E          		       LD A,(HL)	;
303)   CCD0 FD 77 32    		       LD (IY+DTLN+1),A	;
304)   CCD3 AF          		       XOR A	;
305)   CCD4 67          		       LD H,A	;
306)   CCD5 6F          		       LD L,A	;
307)   CCD6 18 DA       		       JR XRND2	;
309)   CCD8 E5          		XINSTR: PUSH HL	;
310)   CCD9 D7 2F       		       DEFW ZUNSTSS	;
311)   CCDB 38 9E       		       JR C STDP6 	;
312)   CCDD 7A          		       LD A,D	;
313)   CCDE B3          		       OR E	;
314)   CCDF 28 05       		       JR Z XINS8	;
315)   CCE1 42          		       LD B,D	;
316)   CCE2 4B          		       LD C,E	;
317)   CCE3 18 04       		       JR XINS9	;
319)   CCE5 E5          		XINST1: PUSH HL	;
320)   CCE6 01 01 00    		XINS8: LD BC,1	;
321)   CCE9 D7 2B       		XINS9: DEFW ZUNST2	;
322)   CCEB D5          		       PUSH DE	;
323)   CCEC CD B4 CD    		       CALL DELST2	;
324)   CCEF E5          		       PUSH HL	;
325)   CCF0 09          		       ADD HL,BC	;
326)   CCF1 E3          		       EX (SP),HL	;
327)   CCF2 E5          		       PUSH HL	;
328)   CCF3 CD B1 CD    		       CALL DELSTR	;
329)   CCF6 EB          		       EX DE,HL	;
330)   CCF7 ED 42       		       SBC HL,BC       ; carry unset by DELSTR	; carry unset by DELSTR
331)   CCF9 3F          		       CCF	;
332)   CCFA D1          		       POP DE	;
333)   CCFB C1          		       POP BC	;
334)   CCFC 30 11       		       JR NC XINS5	;
335)   CCFE C5          		       PUSH BC	;
336)   CCFF C1          		XINS3: POP BC	;
337)   CD00 03          		       INC BC	;
338)   CD01 CD 36 DC    		       CALL GUSTP	;
339)   CD04 B7          		       OR A	;
340)   CD05 ED 52       		       SBC HL,DE	;
341)   CD07 B7          		       OR A 	;
342)   CD08 ED 42       		       SBC HL,BC	;
343)   CD0A EB          		       EX DE,HL	;
344)   CD0B E3          		       EX (SP),HL	;
345)   CD0C EB          		       EX DE,HL	;
346)   CD0D 19          		       ADD HL,DE	;
347)   CD0E EB          		       EX DE,HL	;
348)   CD0F D1          		XINS5: POP DE	;
349)   CD10 30 46       		       JR NC XASC70	;
350)   CD12 E5          		       PUSH HL	;
351)   CD13 C5          		       PUSH BC	;
352)   CD14 B7          		XINS2: OR A	;
353)   CD15 ED 52       		       SBC HL,DE	;
354)   CD17 28 09       		       JR Z XINS4	;
355)   CD19 19          		       ADD HL,DE       ;restore HL	;restore HL
356)   CD1A 0A          		       LD A,(BC)	;
357)   CD1B BE          		       CP (HL)	;
358)   CD1C 20 E1       		       JR NZ XINS3	;
359)   CD1E 03          		       INC BC	;
360)   CD1F 23          		       INC HL	;
361)   CD20 18 F2       		       JR XINS2	;
363)   CD22 E1          		XINS4: POP HL	;
364)   CD23 C1          		       POP BC	;
365)   CD24 ED 52       		       SBC HL,DE	;
366)   CD26 2B          		       DEC HL	;
367)   CD27 18 1B       		       JR XTOP1	;
369)   CD29 E5          		XFREE: PUSH HL	;
370)   CD2A 21 00 00    		       LD HL,0	;
371)   CD2D D7 25       		       DEFW ZROOMQ	;
372)   CD2F 18 24       		       JR XASC50	;
374)   CD31 E5          		XERRNO: PUSH HL	;
375)   CD32 FD 5E 08    		       LD E,(IY+ERRNO)	;
376)   CD35 18 1C       		       JR XASC99	;
378)   CD37 E5          		XERRLIN: PUSH HL	;
379)   CD38 FD 5E 27    		       LD E,(IY+CLINNO)	;
380)   CD3B FD 56 28    		       LD D,(IY+CLINNO+1)	;
381)   CD3E 18 15       		       JR XASC50	;
383)   CD40 E5          		XTOP:  PUSH HL	;
384)   CD41 CD 98 D8    		       CALL GTOP	;
385)   CD44 EB          		XTOP1: EX DE,HL	;
386)   CD45 18 0E       		       JR XASC50	;
402)   CD47 E5          		       PUSH HL	;
403)   CD48 D7 2B       		       DEFW ZUNST2     ;HL=STRING LENGTH	;HL=STRING LENGTH
405)   CD4A 7C          		       LD A,H	;
406)   CD4B B5          		       OR L	;
407)   CD4C 28 0A       		       JR Z,XASC70     ;J.IF NULL STRING	;J.IF NULL STRING
408)   CD4E CD B4 CD    		       CALL DELST2	;
409)   CD51 1A          		       LD A,(DE)	;
410)   CD52 5F          		       LD E,A	;
411)   CD53 16 00       		XASC99: LD D,0	;
412)   CD55 E7 28       		XASC50: DEFW ZFLT      ;FLOAT VALUE	;FLOAT VALUE
413)   CD57 21          		       DEFB 21H        ;code for LD HL,.. i.e. skip	;code for LD HL,.. i.e. skip
415)   CD58 E7 05       		       DEFW ZFPZERO    ;LOAD 0	;LOAD 0
417)   CD5A 01 06 00    		       LD BC,6	;
418)   CD5D DF 45       		       DEFW WINUSS     ;RESERVE STORAGE	;RESERVE STORAGE
419)   CD5F EF 2D       		       DEFW WSTF       ;STORE RESULT (IF ROOM)	;STORE RESULT (IF ROOM)
420)   CD61 C3 F2 C1    		XASC90: JP XRUN1D      ;CONTINUE WITH REST OF LINE	;CONTINUE WITH REST OF LINE
430)   CD64 E5          		       PUSH HL	;
431)   CD65 CD B1 CD    		       CALL DELSTR	;
432)   CD68 18 EB       		       JR XASC50       ;FLOAT & STACK ANSWER	;FLOAT & STACK ANSWER
443)   CD6A E5          		       PUSH HL	;
444)   CD6B CD 7E CD    		       CALL VALNUM     ;Routine common to VAL & NUM	;Routine common to VAL & NUM
446)   CD6E 3E 5F       		       LD A,95	;
447)   CD70 38 EF       		       JR C,XASC90     ;J.IF ERROR TO XRUN1D	;J.IF ERROR TO XRUN1D
448)   CD72 18 E6       		       JR XASC80       ;STACK ANSWER (VALID NUMBER)	;STACK ANSWER (VALID NUMBER)
459)   CD74 E5          		       PUSH HL	;
460)   CD75 CD 7E CD    		       CALL VALNUM	;
461)   CD78 38 DE       		       JR C XASC70     ;j. if not valid number	;j. if not valid number
462)   CD7A E7 04       		       DEFW ZFPMONE	;
463)   CD7C 18 DC       		       JR XASC80       ;J.IF VALID ANSWER	;J.IF VALID ANSWER
475)   CD7E D7 2B       		       DEFW ZUNST2     ;HL=STRING LENGTH	;HL=STRING LENGTH
477)   CD80 7C          		       LD A,H	;
478)   CD81 B5          		       OR L	;
479)   CD82 37          		       SCF	;
480)   CD83 C8          		       RET Z           ;R.IF NULL STRING 	;R.IF NULL STRING
484)   CD84 44          		       LD B,H	;
485)   CD85 4D          		       LD C,L	;
486)   CD86 CD B4 CD    		       CALL DELST2	;
496)   CD89 62          		       LD H,D	;
497)   CD8A 6B          		       LD L,E	;
498)   CD8B 1B          		       DEC DE	;
499)   CD8C D5          		       PUSH DE         ;ptr to where strinq will be	;ptr to where strinq will be
500)   CD8D ED B0       		       LDIR            ;MOVE STRING DOWN 1 BYTE	;MOVE STRING DOWN 1 BYTE
501)   CD8F EB          		       EX DE,HL        ;HL=ADR.FOR TERMINATOR	;HL=ADR.FOR TERMINATOR
502)   CD90 36 0D       		       LD (HL),0DH     ;INSERT "CR"	;INSERT "CR"
503)   CD92 D1          		       POP DE          ;ptr for maths pack	;ptr for maths pack
504)   CD93 E5          		       PUSH HL         ;ptr to terminator	;ptr to terminator
505)   CD94 E7 2A       		       DEFW ZINP       ;CONVERT TO F.P.	;CONVERT TO F.P.
506)   CD96 E1          		       POP HL	;
507)   CD97 D8          		       RET C           ;R.IF ERROR	;R.IF ERROR
508)   CD98 ED 52       		       SBC HL,DE       ;reached terminator?	;reached terminator?
509)   CD9A C8          		       RET Z           ;if have	;if have
510)   CD9B 37          		       SCF	;
511)   CD9C C9          		       RET	;
528)   CD9D 4E          		       LD C,(HL)	;
529)   CD9E 23          		       INC HL	;
530)   CD9F 46          		       LD B,(HL)	;
531)   CDA0 23          		       INC HL	;
532)   CDA1 E5          		       PUSH HL	;
533)   CDA2 C5          		       PUSH BC         ;SAVE FORMAT	;SAVE FORMAT
534)   CDA3 D7 2E       		       DEFW ZUNST6     ;GET NUMBER	;GET NUMBER
535)   CDA5 EB          		       EX DE,HL	;
536)   CDA6 E7 2B       		       DEFW ZLDF	;
537)   CDA8 C1          		       POP BC          ;RESTORE FORMAT	;RESTORE FORMAT
538)   CDA9 E7 2C       		       DEFW ZOUT	;
539)   CDAB 06 00       		       LD B,0	;
544)   CDAD D7 2D       		       DEFW ZLPSTR1	;
545)   CDAF 18 B0       		       JR XASC90	;
551)   CDB1 D7 2B       		DELSTR: DEFW ZUNST2	;
552)   CDB3 EB          		       EX DE,HL	;
553)   CDB4 19          		DELST2: ADD HL,DE	;
554)   CDB5 C3 8C C5    		       JP LDUSTP	;
557)   CDB8 E3          		       EX (SP),HL      ;save HL below ret. add.	;save HL below ret. add.
558)   CDB9 E5          		       PUSH HL	;
559)   CDBA D7 2F       		       DEFW ZUNSTSS	;
560)   CDBC CD 36 DC    		       CALL GUSTP	;
561)   CDBF 46          		       LD B,(HL)	;
562)   CDC0 23          		       INC HL	;
563)   CDC1 66          		       LD H,(HL)	;
564)   CDC2 68          		       LD L,B	;
565)   CDC3 D0          		       RET NC          ;if no unstss fault	;if no unstss fault
566)   CDC4 18 1E       		       JR STSUB1       ;carry set	;carry set
568)   CDC6 CD B8 CD    		XLEFT: CALL SSTRST	;
569)   CDC9 18 07       		       JR XRT1A	;
571)   CDCB CD B8 CD    		XRIGHT: CALL SSTRST	;
572)   CDCE ED 52       		       SBC HL,DE	;
573)   CDD0 30 03       		       JR NC XRT1      ;if len>=n	;if len>=n
574)   CDD2 21 00 00    		XRT1A: LD HL,0	;
575)   CDD5 23          		XRT1:  INC HL	;
576)   CDD6 EB          		       EX DE,HL	;
577)   CDD7 18 0E       		       JR SSUBIB	;
579)   CDD9 CD B8 CD    		XMID1: CALL SSTRST	;
580)   CDDC 18 09       		       JR SSUBIB	;
591)   CDDE E5          		       PUSH HL	;
592)   CDDF D7 2F       		       DEFW ZUNSTSS    ;DE=NO.CHARS.(TOS)	;DE=NO.CHARS.(TOS)
593)   CDE1 D5          		       PUSH DE	;
594)   CDE2 DF 2F       		       DEFW WUNSTSS    ;DE=1st CHAR POS'N (TOSM)	;DE=1st CHAR POS'N (TOSM)
595)   CDE4 E1          		STSUB1: POP HL	;
596)   CDE5 38 2E       		       JR C,STSUB9     ;J.IF PARAMETER ERROR	;J.IF PARAMETER ERROR
597)   CDE7 E5          		SSUBIB: PUSH HL	;
598)   CDE8 D5          		       PUSH DE	;
599)   CDE9 CD B1 CD    		       CALL DELSTR     ;throw away string	;throw away string
600)   CDEC C1          		       POP BC	;
601)   CDED 2B          		       DEC HL	;
602)   CDEE E3          		       EX (SP),HL	;
609)   CDEF EB          		       EX DE,HL	;
610)   CDF0 B7          		       OR A	;
611)   CDF1 ED 42       		       SBC HL,BC	;
612)   CDF3 01 00 00    		       LD BC,0	;
613)   CDF6 38 11       		       JR C,STSUB8     ;J.IF NULL-STRING REQ'D	;J.IF NULL-STRING REQ'D
619)   CDF8 23          		       INC HL          ;NO.CHARS REMAINING	;NO.CHARS REMAINING
620)   CDF9 ED 52       		       SBC HL,DE       ;SET CY IF TOO MANY REQ'D 	;SET CY IF TOO MANY REQ'D
621)   CDFB EB          		       EX DE,HL	;
622)   CDFC 30 04       		       JR NC,STSUB2    ;J.IF NOT TRUNCATED	;J.IF NOT TRUNCATED
623)   CDFE 19          		       ADD HL,DE	;
624)   CDFF 11 00 00    		       LD DE,0	;
630)   CE02 44          		       LD B,H	;
631)   CE03 4D          		       LD C,L          ;BC=NO.CHARS	;BC=NO.CHARS
632)   CE04 E1          		       POP HL          ;(=USRSTP-1)	;(=USRSTP-1)
634)   CE05 E5          		       PUSH HL         ;=DEST. FOR LAST CHAR OF SUBSTR	;=DEST. FOR LAST CHAR OF SUBSTR
635)   CE06 B7          		       OR A	;
636)   CE07 ED 52       		       SBC HL,DE       ;HL=ADR.LAST CHAR.OF SUBSTR	;HL=ADR.LAST CHAR.OF SUBSTR
638)   CE09 D1          		       POP DE	;
639)   CE0A C5          		       PUSH BC	;
640)   CE0B 03          		       INC BC          ;BC=INCLUSIVE COUNT - 1 (NEVER 0)	;BC=INCLUSIVE COUNT - 1 (NEVER 0)
641)   CE0C ED B8       		       LDDR            ;MOVE REQUIRED CHARS.	;MOVE REQUIRED CHARS.
642)   CE0E EB          		       EX DE,HL        ;HL->WHERE LENGTH IS TO BE	;HL->WHERE LENGTH IS TO BE
643)   CE0F C1          		       POP BC	;
644)   CE10 71          		       LD (HL),C	;
645)   CE11 23          		       INC HL	;
646)   CE12 70          		       LD (HL),B       ;COUNT SET ON STRING	;COUNT SET ON STRING
647)   CE13 2B          		       DEC HL	;
648)   CE14 B7          		       OR A	;
649)   CE15 C3 EF C1    		STSUB9: JP XRUN1C	;
 94)   CE18 D7 59       		       DEFW ZRDFN      ;LOOK FOR 'FN'<NUM.VAR.>	;LOOK FOR 'FN'<NUM.VAR.>
 95)   CE1A D8          		       RET C           ;R.invalid fmt./no room 	;R.invalid fmt./no room
 96)   CE1B 23          		       INC HL	;
 97)   CE1C 78          		       LD A,B	;
 98)   CE1D E6 30       		       AND 030H	;
 99)   CE1F 58          		       LD E,B	;
100)   CE20 FD 77 38    		       LD (IY+FPAR+1),A	;
101)   CE23 28 09       		       JR Z CDEF3	;
102)   CE25 CD 48 CE    		       CALL TYFN	;
103)   CE28 FD 71 37    		       LD (IY+FPAR),C	;
104)   CE2B FD 70 38    		       LD (IY+FPAR+1),B ;save n/t formal param.	;save n/t formal param.
105)   CE2E DF 41       		CDEF3: DEFW WCHKEQ	;
106)   CE30 DF 5A       		       DEFW WCREM      ;COMPILE LEADING RET	;COMPILE LEADING RET
107)   CE32 FD CB 22 E6 		       SET 4,(IY+FLAGS);SET 'COMPILING DEF' FLAG	;SET 'COMPILING DEF' FLAG
108)   CE36 CB 73       		       BIT 6,E         ;what type?	;what type?
109)   CE38 20 03       		       JR NZ CDEF1	;
110)   CE3A DF 16       		       DEFW WNUMEXP	;
111)   CE3C 21          		       DEFB 21H        ;code for LD HL,.. i.e. skip	;code for LD HL,.. i.e. skip
112)   CE3D DF 17       		CDEF1: DEFW WSTREXP	;
113)   CE3F FD CB 22 A6 		       RES 4,(IY+FLAGS)	;
114)   CE43 DF 5A       		CDEF8: DEFW WCREM      ;comp. trail. user ret	;comp. trail. user ret
115)   CE45 DF 3E       		       DEFW WCHKCR	;
116)   CE47 C9          		       RET	;
119)   CE48 D7 44       		TYFN:  DEFW ZCHKOPN	;
120)   CE4A E5          		       PUSH HL	;
121)   CE4B DF 19       		       DEFW WVARIA	;
122)   CE4D E1          		       POP HL	;
123)   CE4E DF 3F       		       DEFW WCHKCLS	;
124)   CE50 D8          		       RET C           ;J.IF NOT '('<VAR.>	;J.IF NOT '('<VAR.>
125)   CE51 78          		       LD A,B	;
126)   CE52 E6 FC       		       AND 00FCH       ;A=TYPE OF VARIA	;A=TYPE OF VARIA
127)   CE54 FE 80       		TYFN8: CP 0080H	;
128)   CE56 28 0B       		       JR Z,TYFN1      ;J.if num.scalar	;J.if num.scalar
129)   CE58 FE C0       		       CP 00C0H	;
130)   CE5A 20 0E       		       JR NZ TYFN3	;
131)   CE5C CB 6B       		       BIT 5,E	;
132)   CE5E 28 0A       		       JR Z TYFN3	;
133)   CE60 CB A6       		       RES 4,(HL)	;
134)   CE62 C9          		       RET	;
136)   CE63 CB 63       		TYFN1: BIT 4,E	;
137)   CE65 28 03       		       JR Z TYFN3	;
138)   CE67 CB AE       		       RES 5,(HL)	;
139)   CE69 C9          		       RET	;
141)   CE6A 37          		TYFN3: SCF	;
142)   CE6B 3E 54       		       LD A,TYFNER	;
143)   CE6D C9          		       RET	;
155)   CE6E D7 35       		       DEFW ZSVINST	;
156)   CE70 06 B8       		       LD B,TFN	;
157)   CE72 D7 6B       		       DEFW ZCHECK	;
158)   CE74 3E 50       		       LD A,RDFNE1	;
159)   CE76 D8          		       RET C	;
160)   CE77 D7 19       		       DEFW  ZVARIA	;
161)   CE79 38 05       		       JR C,RDFNB      ;J.IF NOT <VAR.>	;J.IF NOT <VAR.>
162)   CE7B CB D8       		       SET 3,B         ;set n/t TYPE for Usr.def	;set n/t TYPE for Usr.def
163)   CE7D D7 1B       		       DEFW ZADDSYM	;
164)   CE7F C9          		       RET             ;CY IF NO ROOM & A=10	;CY IF NO ROOM & A=10
168)   CE80 D7 36       		RDFNB: DEFW ZRSINST    ;RESTORE INSTREAM STATE	;RESTORE INSTREAM STATE
169)   CE82 37          		       SCF	;
170)   CE83 3E 51       		       LD A,RDFNE2     ;INVALID FN FORMAT	;INVALID FN FORMAT
171)   CE85 C9          		       RET                       	;
174)   CE86 CD AA DA    		CUFN:  CALL GINPTR	;
175)   CE89 E5          		       PUSH HL	;
176)   CE8A D7 27       		       DEFW ZFLNT      ;HL=-> first lnt entry	;HL=-> first lnt entry
177)   CE8C 38 6A       		FNEXPC: JR C,FNEXPJ	;
178)   CE8E E5          		       PUSH HL	;
179)   CE8F C5          		       PUSH BC	;
180)   CE90 D7 32       		       DEFW ZSTINST	;
181)   CE92 06 A1       		       LD B,TDEF	;
182)   CE94 D7 6B       		       DEFW ZCHECK	;
183)   CE96 DF 59       		       DEFW WRDFN      ;LOOK FOR 'FNnumvar.'	;LOOK FOR 'FNnumvar.'
184)   CE98 30 06       		       JR NC,FNEXPG    ;J.if no error	;J.if no error
185)   CE9A C1          		FNEXPD: POP BC	;
186)   CE9B E1          		       POP HL	;
187)   CE9C D7 28       		       DEFW ZNLNT	;
188)   CE9E 18 EC       		       JR FNEXPC	;
190)   CEA0 23          		FNEXPG: INC HL	;
191)   CEA1 5E          		       LD E,(HL)	;
192)   CEA2 7B          		       LD A,E	;
193)   CEA3 E6 30       		       AND 030H	;
194)   CEA5 28 08       		       JR Z FNEXP2	;
195)   CEA7 C5          		       PUSH BC	;
196)   CEA8 CD 48 CE    		       CALL TYFN	;
197)   CEAB C1          		       POP BC	;
198)   CEAC DA 79 CF    		       JP C XUFNF	;
199)   CEAF D1          		FNEXP2: POP DE	;
200)   CEB0 D5          		       PUSH DE	;
201)   CEB1 7A          		       LD A,D	;
202)   CEB2 B8          		       CP B	;
203)   CEB3 20 E5       		       JR NZ,FNEXPD    ;if n/t does not match	;if n/t does not match
204)   CEB5 79          		       LD A,C	;
205)   CEB6 BB          		       CP E	;
206)   CEB7 20 E1       		       JR NZ,FNEXPD    ;J.IF NOT NAME/TYPE MATCH	;J.IF NOT NAME/TYPE MATCH
207)   CEB9 E5          		       PUSH HL	;
208)   CEBA FD 46 22    		       LD B,(IY+FLAGS)	;
209)   CEBD C5          		       PUSH BC	;
210)   CEBE FD CB 22 EE 		       SET 5,(IY+FLAGS)	;
211)   CEC2 5A          		       LD E,D	;
212)   CEC3 CD 2E CE    		       CALL CDEF3	;
213)   CEC6 C1          		       POP BC	;
214)   CEC7 FD 70 22    		       LD (IY+FLAGS),B	;
215)   CECA D1          		       POP DE	;
216)   CECB C1          		       POP BC	;
217)   CECC E1          		       POP HL	;
218)   CECD E3          		       EX (SP),HL	;
219)   CECE CD A3 DA    		       CALL LINPTR	;
220)   CED1 E1          		       POP HL	;
221)   CED2 30 04       		       JR NC LCFN1	;
222)   CED4 FE 55       		       CP 85	;
223)   CED6 37          		       SCF	;
224)   CED7 C8          		       RET Z           ;return only error 85	;return only error 85
226)   CED8 D7 04       		       DEFW ZCPSH	;
227)   CEDA D8          		       RET C	;
228)   CEDB 1A          		       LD A,(DE)	;
229)   CEDC E6 30       		       AND 030H	;
230)   CEDE 28 13       		       JR Z FNEXP5	;
231)   CEE0 47          		       LD B,A	;
232)   CEE1 D7 44       		       DEFW ZCHKOPN	;
233)   CEE3 0E 94       		       LD C,YNUFN	;
234)   CEE5 CB 68       		       BIT 5,B	;
235)   CEE7 CA 80 D4    		       JP Z NMF7	;
236)   CEEA DF 17       		       DEFW WSTREXP	;
237)   CEEC DF 05       		       DEFW WCPSH0	;
238)   CEEE 0E 97       		       LD C,YSTFN	;
239)   CEF0 C3 89 D4    		       JP NMF1	;
241)   CEF3 3E 96       		FNEXP5: LD A,YNOFN	;
242)   CEF5 D7 57       		       DEFW ZCMONE	;
243)   CEF7 C9          		       RET	;
245)   CEF8 3E 53       		FNEXPJ: LD A,FNERR             	;
246)   CEFA E1          		       POP HL	;
247)   CEFB C9          		       RET	;
249)   CEFC E5          		XSTFN: PUSH HL	;
250)   CEFD CD 36 DC    		       CALL GUSTP	;
251)   CF00 E5          		       PUSH HL	;
252)   CF01 23          		       INC HL	;
253)   CF02 23          		       INC HL	;
254)   CF03 FD 5E 1A    		       LD E,(IY+ARBAS)	;
255)   CF06 FD 56 1B    		       LD D,(IY+ARBAS+1)	;
256)   CF09 4E          		       LD C,(HL)	;
257)   CF0A 23          		       INC HL	;
258)   CF0B 46          		       LD B,(HL)	;
259)   CF0C B7          		       OR A	;
260)   CF0D 23          		       INC HL	;
261)   CF0E ED 52       		       SBC HL,DE	;
262)   CF10 EB          		       EX DE,HL	;
263)   CF11 E1          		       POP HL	;
264)   CF12 78          		       LD A,B	;
265)   CF13 B1          		       OR C	;
266)   CF14 28 03       		       JR Z XSTF1	;
267)   CF16 73          		       LD (HL),E	;
268)   CF17 23          		       INC HL	;
269)   CF18 72          		       LD (HL),D	;
270)   CF19 21 06 00    		XSTF1: LD HL,6	;
271)   CF1C 09          		       ADD HL,BC	;
272)   CF1D E3          		       EX (SP),HL	;
273)   CF1E C1          		       POP BC	;
274)   CF1F 18 08       		       JR XUFN	;
276)   CF21 01 02 00    		XNOFN: LD BC,2	;
277)   CF24 18 03       		       JR XUFN	;
279)   CF26 01 08 00    		XNUFN: LD BC,8	;
283)   CF29 C5          		       PUSH BC	;
284)   CF2A EB          		       EX DE,HL	;
285)   CF2B D7 03       		       DEFW ZCMOBJ	;
286)   CF2D EB          		       EX DE,HL	;
287)   CF2E B7          		       OR A            ;CLEAR CY	;CLEAR CY
288)   CF2F ED 52       		       SBC HL,DE       ;HL=CURR.DISP.IN OBJ.LINE	;HL=CURR.DISP.IN OBJ.LINE
289)   CF31 E5          		       PUSH HL         ;SAVE DISP. ON M/S	;SAVE DISP. ON M/S
290)   CF32 CD 36 DC    		       CALL GUSTP	;
291)   CF35 E5          		       PUSH HL	;
292)   CF36 FD 5E 35    		       LD E,(IY+APAR)	;
293)   CF39 FD 56 36    		       LD D,(IY+APAR+1)	;
294)   CF3C FD 75 35    		       LD (IY+APAR),L	;
295)   CF3F FD 74 36    		       LD (IY+APAR+1),H	;
296)   CF42 DD E5       		       PUSH IX	;
297)   CF44 D5          		       PUSH DE	;
298)   CF45 09          		       ADD HL,BC       ;HL=adr.of line # of DEF	;HL=adr.of line # of DEF
299)   CF46 2B          		       DEC HL	;
300)   CF47 7E          		       LD A,(HL)	;
301)   CF48 2B          		       DEC HL	;
302)   CF49 6E          		       LD L,(HL)	;
303)   CF4A 67          		       LD H,A          ;HL->LNT of DEF	;HL->LNT of DEF
304)   CF4B E5          		       PUSH HL	;
305)   CF4C DD E1       		       POP IX          ;IX=lnt.entry addr of DEF	;IX=lnt.entry addr of DEF
306)   CF4E D7 03       		       DEFW ZCMOBJ	;
307)   CF50 23          		       INC HL          ;skip over YREM	;skip over YREM
308)   CF51 D4 AE C1    		       CALL NC LXR21 	;
309)   CF54 38 1C       		       JR C,XUFND	;
310)   CF56 E1          		       POP HL          ;DE=displ.of APAR	;DE=displ.of APAR
311)   CF57 FD 75 35    		       LD (IY+APAR),L	;
312)   CF5A FD 74 36    		       LD (IY+APAR+1),H	;
313)   CF5D FD 36 2D 00 		       LD (IY+OMOVE+1),0	;
314)   CF61 DD E1       		       POP IX	;
315)   CF63 D7 03       		       DEFW ZCMOBJ	;
316)   CF65 38 12       		       JR C,XUFNF      ;if no room to compile	;if no room to compile
317)   CF67 D1          		       POP DE	;
318)   CF68 C1          		       POP BC	;
319)   CF69 09          		       ADD HL,BC       ;HL->obj code to be 	;HL->obj code to be
320)   CF6A C1          		       POP BC	;
321)   CF6B E5          		       PUSH HL	;
322)   CF6C EB          		       EX DE,HL	;
323)   CF6D D7 46       		       DEFW ZDLUSS     ; dispose of excess in user stack	; dispose of excess in user stack
326)   CF6F C3 F2 C1    		XFRETC: JP XRUN1D                	;
328)   CF72 E1          		XUFND: POP HL	;
329)   CF73 F5          		       PUSH AF	;
330)   CF74 D7 55       		       DEFW ZREPORT	;
331)   CF76 F1          		       POP AF	;
332)   CF77 DD E1       		       POP IX	;
333)   CF79 C1          		XUFNF: POP BC	;
334)   CF7A C1          		       POP BC	;
335)   CF7B C1          		       POP BC	;
336)   CF7C C9          		       RET	;
130)   CF7D 7E          		XERR:  LD A,(HL)	;
131)   CF7E FD 77 39    		       LD (IY+ERRLIN),A	;
132)   CF81 23          		       INC HL	;
133)   CF82 7E          		       LD A,(HL)	;
134)   CF83 FD 77 3A    		       LD (IY+ERRLIN+1),A	;
135)   CF86 C9          		       RET	;
137)   CF87 7E          		XBRK:  LD A,(HL)	;
138)   CF88 FD 77 3B    		       LD (IY+BRKLIN),A	;
139)   CF8B 23          		       INC HL	;
140)   CF8C 7E          		       LD A,(HL)	;
141)   CF8D FD 77 3C    		       LD (IY+BRKLIN+1),A	;
142)   CF90 FD CB 22 8E 		       RES 1,(IY+FLAGS)	;
143)   CF94 C9          		       RET	;
146)   CF95 D7 27       		       DEFW ZFLNT	;
147)   CF97 E5          		LXV2:  PUSH HL	;
148)   CF98 F5          		       PUSH AF	;
149)   CF99 FD 5E 07    		LXV5:  LD E,(IY+INCON) ;here at start of line	;here at start of line
150)   CF9C D7 4E       		       DEFW ZRDLINE	;
151)   CF9E DA 53 D7    		       JP C AMEND8	;
152)   CFA1 CD 55 D7    		       CALL DISPOSE	;
153)   CFA4 D7 38       		       DEFW ZRDSCH	;
154)   CFA6 FE 0D       		       CP 0DH	;
155)   CFA8 28 EF       		       JR Z LXV5	;
156)   CFAA F1          		       POP AF	;
157)   CFAB 38 4E       		       JR C LXV1	;
158)   CFAD D7 22       		       DEFW ZINTIN	;
159)   CFAF 38 4E       		       JR C LXV8	;
160)   CFB1 D1          		       POP DE          ;LNT ptr	;LNT ptr
161)   CFB2 D5          		       PUSH DE	;
162)   CFB3 EB          		       EX DE,HL	;
163)   CFB4 4E          		       LD C,(HL)	;
164)   CFB5 23          		       INC HL	;
165)   CFB6 46          		       LD B,(HL)       ;BC = line number in source	;BC = line number in source
166)   CFB7 EB          		       EX DE,HL        ;HL = line number from instream	;HL = line number from instream
167)   CFB8 B7          		       OR A            ;DE->2nd byte of LNT entry	;DE->2nd byte of LNT entry
168)   CFB9 ED 42       		       SBC HL,BC	;
169)   CFBB 20 42       		       JR NZ LXV8	;
170)   CFBD EB          		       EX DE,HL	;
171)   CFBE 23          		LXV9:  INC HL	;
172)   CFBF 7E          		       LD A,(HL)       ;HL->source ptr in LNT entry	;HL->source ptr in LNT entry
173)   CFC0 23          		       INC HL	;
174)   CFC1 66          		       LD H,(HL)	;
175)   CFC2 6F          		       LD L,A          ;HL-> source	;HL-> source
176)   CFC3 7E          		LXV91: LD A,(HL)       ;advance HL to pt at first	;advance HL to pt at first
177)   CFC4 23          		       INC HL          ;non-space char.	;non-space char.
178)   CFC5 FE 20       		       CP ' '	;
179)   CFC7 28 FA       		       JR Z LXV91	;
180)   CFC9 2B          		       DEC HL	;
181)   CFCA FD 36 2E 00 		       LD (IY+PPFLGS),0	;
182)   CFCE D7 38       		       DEFW ZRDSCH     ;advance instream to first	;advance instream to first
183)   CFD0 D7 67       		LXV3:  DEFW ZTSTPPF    ;non-space char.	;non-space char.
184)   CFD2 38 04       		       JR C LXV0	;
185)   CFD4 FE 3A       		       CP ':'	;
186)   CFD6 28 13       		       JR Z LXV7	;
187)   CFD8 D7 68       		LXV0:  DEFW ZUPDPPF	;
188)   CFDA BE          		       CP (HL)	;
189)   CFDB 20 22       		       JR NZ LXV8	;
190)   CFDD FE 0D       		       CP 0DH	;
191)   CFDF 28 05       		       JR Z LXV4	;
192)   CFE1 23          		       INC HL	;
193)   CFE2 D7 34       		       DEFW ZRDNCH	;
194)   CFE4 18 EA       		       JR LXV3	;
196)   CFE6 E1          		LXV4:  POP HL          ;here if CR in instream	;here if CR in instream
197)   CFE7 D7 28       		       DEFW ZNLNT	;
198)   CFE9 18 AC       		       JR LXV2	;
200)   CFEB 7E          		LXV7:  LD A,(HL)       ;here if colon in instream	;here if colon in instream
201)   CFEC FE 0D       		       CP 0DH	;
202)   CFEE 20 0F       		       JR NZ LXV8	;
203)   CFF0 E1          		       POP HL	;
204)   CFF1 D7 62       		       DEFW ZLAST	;
205)   CFF3 20 0B       		       JR NZ LXVE	;
206)   CFF5 E5          		       PUSH HL         ;LNT ptr	;LNT ptr
207)   CFF6 D7 34       		       DEFW ZRDNCH     ;advance past the colon	;advance past the colon
208)   CFF8 23          		       INC HL	;
209)   CFF9 18 C3       		       JR LXV9	;
211)   CFFB D7 33       		LXV1:  DEFW ZRDCH	;
212)   CFFD FE 04       		       CP EOF	;
213)   CFFF E1          		LXV8:  POP HL	;
214)   D000 3E 5B       		LXVE:  LD A,VERERR	;
215)   D002 37          		       SCF	;
216)   D003 C0          		       RET NZ          ;Note jump to LXVE above	;Note jump to LXVE above
217)   D004 D7 39       		       DEFW ZPTMSG	;
218)   D006 09          		       DEFB 9	;
219)   D007 56 45 52 49 		       DEFM 'VERIFIED'	;
219)   D00B 46 49 45 44 		       DEFM 'VERIFIED'	;
220)   D00F 0D          		       DEFB 13	;
221)   D010 C9          		       RET	;
223)   D011 FD 4E 2E    		TSTPPF: LD C,(IY+PPFLGS)	;
224)   D014 47          		       LD B,A	;
225)   D015 79          		       LD A,C	;
226)   D016 E6 07       		       AND 7	;
227)   D018 28 01       		       JR Z TSTPL1	;
228)   D01A 37          		       SCF	;
229)   D01B CB 59       		TSTPL1: BIT 3,C	;
230)   D01D 78          		       LD A,B	;
231)   D01E C9          		       RET	;
233)   D01F FE 22       		UPDPPF: CP 22H	;
234)   D021 FD 4E 2E    		       LD C,(IY+PPFLGS)	;
235)   D024 20 08       		       JR NZ UPDPL1	;
236)   D026 3E 01       		       LD A,1	;
237)   D028 A9          		       XOR C	;
238)   D029 4F          		       LD C,A	;
239)   D02A 3E 22       		       LD A,22H	;
240)   D02C 18 22       		       JR UPDPL2	;
241)   D02E CB 59       		UPDPL1: BIT 3,C	;
242)   D030 28 0C       		       JR Z UPDPL3	;
243)   D032 FE B4       		       CP TTHEN	;
244)   D034 28 04       		       JR Z UPDPL6	;
245)   D036 FE B5       		       CP TINVTH	;
246)   D038 20 16       		       JR NZ UPDPL2	;
247)   D03A CB 99       		UPDPL6: RES 3,C	;
248)   D03C 18 12       		       JR UPDPL2	;
249)   D03E FE 8E       		UPDPL3: CP TREM	;
250)   D040 28 04       		       JR Z UPDPL4	;
251)   D042 FE 9D       		       CP TDATA	;
252)   D044 20 04       		       JR NZ UPDPL5	;
253)   D046 CB C9       		UPDPL4: SET 1,C	;
254)   D048 18 06       		       JR UPDPL2	;
255)   D04A FE 20       		UPDPL5: CP ' '	;
256)   D04C 28 02       		       JR Z UPDPL2	;
257)   D04E CB D9       		       SET 3,C	;
258)   D050 FD 71 2E    		UPDPL2: LD (IY+PPFLGS),C	;
259)   D053 C9          		       RET	;
263)   D054 D7 3E       		       DEFW ZCHKCR	;
264)   D056 3E 95       		       LD A,YCLEAR	;
265)   D058 D2 85 CA    		       JP NC CSTOP1    ;if no params	;if no params
266)   D05B D7 21       		       DEFW ZINITOB	;
267)   D05D D7 5B       		       DEFW ZTETOLN	;
268)   D05F DD E5       		       PUSH IX	;
269)   D061 D7 19       		LCCL:  DEFW ZVARIA	;
270)   D063 38 47       		       JR C,LCCL21	;
271)   D065 D7 1A       		       DEFW ZFINDVC    ;here if param	;here if param
272)   D067 3E 58       		       LD A,NCLERR     ;BC=name/type,HL->ST entry	;BC=name/type,HL->ST entry
273)   D069 38 41       		       JR C,LCCL21	;
274)   D06B E5          		       PUSH HL	;
275)   D06C 23          		       INC HL	;
276)   D06D 23          		       INC HL          ;HL->ls byte of value	;HL->ls byte of value
277)   D06E 3E 30       		       LD A,030H	;
278)   D070 A0          		       AND B	;
279)   D071 20 40       		       JR NZ,LCCL3     ;jp.if array	;jp.if array
280)   D073 CB 70       		       BIT 6,B	;
281)   D075 28 02       		       JR Z LCCL2      ;if not string	;if not string
282)   D077 D7 4C       		       DEFW ZMKNULL	;
283)   D079 E1          		LCCL2: POP HL          ;here if var/const	;here if var/const
284)   D07A D7 61       		       DEFW ZDLSTAB	;
285)   D07C DF 40       		       DEFW WCHKCOM	;
286)   D07E 30 E1       		       JR NC,LCCL	;
287)   D080 D7 3E       		       DEFW ZCHKCR	;
288)   D082 38 28       		       JR C,LCCL21	;
289)   D084 CD 4F C9    		       CALL GSBAS      ;code to delete constants	;code to delete constants
290)   D087 CD 2E DC    		CCL1:  CALL EXGLB	;
291)   D08A B7          		       OR A	;
292)   D08B ED 52       		       SBC HL,DE	;
293)   D08D 28 19       		       JR Z LCCL8	;
294)   D08F D5          		       PUSH DE	;
295)   D090 EB          		       EX DE,HL	;
296)   D091 23          		       INC HL	;
297)   D092 CB 7E       		       BIT 7,(HL)	;
298)   D094 20 0B       		       JR NZ CCL2	;
299)   D096 CB 76       		       BIT 6,(HL)	;
300)   D098 28 03       		       JR Z CCL3	;
301)   D09A 23          		       INC HL	;
302)   D09B D7 4C       		       DEFW ZMKNULL	;
303)   D09D E1          		CCL3:  POP HL	;
304)   D09E E5          		       PUSH HL	;
305)   D09F D7 61       		       DEFW ZDLSTAB	;
306)   D0A1 E1          		CCL2:  POP HL	;
307)   D0A2 01 08 00    		       LD BC,8	;
308)   D0A5 09          		       ADD HL,BC	;
309)   D0A6 18 DF       		       JR CCL1	;
311)   D0A8 3E 91       		LCCL8: LD A,YCLEA2	;
312)   D0AA D7 57       		       DEFW ZCMONE	;
313)   D0AC DD E1       		LCCL21: POP IX	;
314)   D0AE F5          		SLNTT: PUSH AF         ;LNTOTE saving AF	;LNTOTE saving AF
315)   D0AF D7 5C       		       DEFW ZLNTOTE	;
316)   D0B1 F1          		       POP AF	;
317)   D0B2 C9          		       RET	;
319)   D0B3 D7 44       		LCCL3: DEFW ZCHKOPN    ;here if array	;here if array
320)   D0B5 DF 3F       		       DEFW WCHKCLS	;
321)   D0B7 38 30       		       JR C,LCCL31	;
322)   D0B9 5E          		       LD E,(HL)	;
323)   D0BA 23          		       INC HL	;
324)   D0BB 56          		       LD D,(HL)       ;DE=rel addr.in array area	;DE=rel addr.in array area
325)   D0BC 7A          		       LD A,D	;
326)   D0BD B3          		       OR E	;
327)   D0BE 28 B9       		       JR Z LCCL2	;
328)   D0C0 D5          		       PUSH DE	;
329)   D0C1 C5          		       PUSH BC         ;save name/type	;save name/type
330)   D0C2 FD 46 1D    		       LD B,(IY+SBAS+1)	;
331)   D0C5 FD 4E 1C    		       LD C,(IY+SBAS)	;
332)   D0C8 EB          		       EX DE,HL	;
333)   D0C9 09          		       ADD HL,BC       ;HL=abs addr.in array area	;HL=abs addr.in array area
334)   D0CA E5          		       PUSH HL	;
335)   D0CB EB          		       EX DE,HL	;
336)   D0CC 23          		       INC HL	;
337)   D0CD D7 58       		       DEFW ZELNUM     ;calc no of els	;calc no of els
339)   D0CF D1          		       POP DE	;
340)   D0D0 E3          		       EX (SP),HL      ;HL=name/type,(SP)=# els	;HL=name/type,(SP)=# els
341)   D0D1 CB 74       		       BIT 6,H	;
342)   D0D3 20 17       		       JR NZ,LCCL32	;
343)   D0D5 E1          		LCCL30: POP HL         ;# of els	;# of els
344)   D0D6 D5          		       PUSH DE	;
345)   D0D7 54          		       LD D,H          ;here if not str.array	;here if not str.array
346)   D0D8 5D          		       LD E,L	;
347)   D0D9 29          		       ADD HL,HL	;
348)   D0DA 19          		       ADD HL,DE	;
349)   D0DB 29          		       ADD HL,HL       ;HL=# bytes to move from array	;HL=# bytes to move from array
350)   D0DC 44          		       LD B,H	;
351)   D0DD 4D          		       LD C,L	;
352)   D0DE E1          		       POP HL	;
353)   D0DF 1E 1A       		       LD E,ARBAS	;
354)   D0E1 D7 6F       		       DEFW ZDELT	;
355)   D0E3 D1          		       POP DE	;
356)   D0E4 CD 03 D1    		       CALL ARNULL	;
357)   D0E7 18 90       		       JR LCCL2	;
358)   D0E9 E1          		LCCL31: POP HL	;
359)   D0EA 18 C0       		       JR LCCL21	;
365)   D0EC C1          		       POP BC	;
366)   D0ED C5          		       PUSH BC	;
367)   D0EE D5          		       PUSH DE	;
368)   D0EF EB          		       EX DE,HL	;
369)   D0F0 C5          		LCCL35: PUSH BC	;
370)   D0F1 E5          		       PUSH HL	;
371)   D0F2 D7 4C       		       DEFW ZMKNULL	;
372)   D0F4 E1          		       POP HL	;
373)   D0F5 C1          		       POP BC	;
374)   D0F6 0B          		       DEC BC	;
375)   D0F7 D1          		       POP DE	;
376)   D0F8 78          		       LD A,B	;
377)   D0F9 B1          		       OR C	;
378)   D0FA 28 D9       		       JR Z,LCCL30	;
379)   D0FC D5          		       PUSH DE	;
380)   D0FD 11 06 00    		       LD DE,6	;
381)   D100 19          		       ADD HL,DE	;
382)   D101 18 ED       		       JR LCCL35	;
389)   D103 D5          		       PUSH DE	;
390)   D104 CD 4F C9    		       CALL GSBAS	;
391)   D107 CD 2E DC    		LAR1:  CALL EXGLB	;
392)   D10A EB          		       EX DE,HL	;
393)   D10B A7          		       AND A	;
394)   D10C ED 52       		       SBC HL,DE	;
395)   D10E 19          		       ADD HL,DE	;
396)   D10F D1          		       POP DE	;
397)   D110 C8          		       RET Z	;
398)   D111 23          		       INC HL	;
399)   D112 7E          		       LD A,(HL)	;
400)   D113 E6 30       		       AND 030H	;
401)   D115 28 0E       		       JR Z,LAR3	;
402)   D117 7E          		       LD A,(HL)	;
403)   D118 E6 0C       		       AND 0CH	;
404)   D11A 20 09       		       JR NZ LAR3	;
405)   D11C E5          		       PUSH HL	;
406)   D11D 23          		       INC HL	;
407)   D11E E5          		       PUSH HL	;
408)   D11F DD E1       		       POP IX	;
409)   D121 CD 72 D3    		       CALL MKADJ	;
410)   D124 E1          		       POP HL	;
411)   D125 D5          		LAR3:  PUSH DE	;
412)   D126 11 07 00    		       LD DE,7	;
413)   D129 19          		       ADD HL,DE	;
414)   D12A 18 DB       		       JR LAR1	;
416)   D12C FD 56 17    		GGSP:  LD D,(IY+GSSPTR+1)	;
417)   D12F FD 5E 16    		       LD E,(IY+GSSPTR)	;
418)   D132 C9          		       RET	;
421)   D133 CD A0 D1    		TETOLN: CALL GFORP	;
422)   D136 B7          		TET1:  OR A	;
423)   D137 CD 2C D1    		       CALL GGSP	;
424)   D13A ED 52       		       SBC HL,DE	;
425)   D13C 28 19       		       JR Z TET2	;
426)   D13E 19          		       ADD HL,DE	;
427)   D13F D7 5D       		       DEFW ZTTLN	;
428)   D141 D7 5D       		       DEFW ZTTLN	;
429)   D143 01 0C 00    		       LD BC,12	;
430)   D146 09          		       ADD HL,BC	;
431)   D147 E5          		       PUSH HL	;
432)   D148 7E          		       LD A,(HL)	;
433)   D149 23          		       INC HL	;
434)   D14A 66          		       LD H,(HL)	;
435)   D14B 6F          		       LD L,A	;
436)   D14C 2B          		       DEC HL	;
437)   D14D 56          		       LD D,(HL)	;
438)   D14E 2B          		       DEC HL	;
439)   D14F 5E          		       LD E,(HL)	;
440)   D150 E1          		       POP HL	;
441)   D151 73          		       LD (HL),E	;
442)   D152 23          		       INC HL	;
443)   D153 72          		       LD (HL),D	;
444)   D154 23          		       INC HL	;
445)   D155 18 DF       		       JR TET1	;
447)   D157 EB          		TET2:  EX DE,HL	;
448)   D158 CD 61 D1    		TET3:  CALL CHKSTB	;
449)   D15B C8          		       RET Z	;
450)   D15C 19          		       ADD HL,DE	;
451)   D15D D7 5D       		       DEFW ZTTLN	;
452)   D15F 18 F7       		       JR TET3	;
454)   D161 FD 56 19    		CHKSTB: LD D,(IY+STBAS+1)      ;load string base to DE	;load string base to DE
455)   D164 FD 5E 18    		       LD E,(IY+STBAS)         ;and subtract from HL	;and subtract from HL
456)   D167 B7          		       OR A	;
457)   D168 ED 52       		       SBC HL,DE	;
458)   D16A C9          		       RET	;
460)   D16B CD A0 D1    		LNTOTE: CALL GFORP	;
461)   D16E B7          		LNT1:  OR A	;
462)   D16F CD 2C D1    		       CALL GGSP	;
463)   D172 ED 52       		       SBC HL,DE	;
464)   D174 28 20       		       JR Z LNT2	;
465)   D176 19          		       ADD HL,DE	;
466)   D177 D7 5E       		       DEFW ZLNTT	;
467)   D179 D7 5E       		       DEFW ZLNTT	;
468)   D17B 01 0C 00    		       LD BC,12	;
469)   D17E 09          		       ADD HL,BC	;
470)   D17F E5          		       PUSH HL	;
471)   D180 4E          		       LD C,(HL)	;
472)   D181 23          		       INC HL	;
473)   D182 46          		       LD B,(HL)	;
474)   D183 D7 1B       		       DEFW ZADDSYM	;
475)   D185 23          		       INC HL	;
476)   D186 23          		       INC HL	;
477)   D187 EB          		       EX DE,HL	;
478)   D188 E1          		       POP HL	;
479)   D189 F2 90 D1    		       JP P LNT4	;
480)   D18C 01 F8 FF    		       LD BC,-8	;
481)   D18F 09          		       ADD HL,BC	;
482)   D190 73          		LNT4:  LD (HL),E	;
483)   D191 23          		       INC HL	;
484)   D192 72          		       LD (HL),D	;
485)   D193 23          		       INC HL	;
486)   D194 18 D8       		       JR LNT1	;
488)   D196 EB          		LNT2:  EX DE,HL	;
489)   D197 CD 61 D1    		LNT3:  CALL CHKSTB	;
490)   D19A C8          		       RET Z	;
491)   D19B 19          		       ADD HL,DE	;
492)   D19C D7 5E       		       DEFW ZLNTT	;
493)   D19E 18 F7       		       JR LNT3	;
495)   D1A0 FD 66 15    		GFORP: LD H,(IY+FORPTR+1)	;
496)   D1A3 FD 6E 14    		       LD L,(IY+FORPTR)	;
497)   D1A6 C9          		       RET	;
499)   D1A7 E5          		TTLN:  PUSH HL	;
500)   D1A8 7E          		       LD A,(HL)	;
501)   D1A9 23          		       INC HL	;
502)   D1AA 66          		       LD H,(HL)	;
503)   D1AB 6F          		       LD L,A	;
504)   D1AC 5E          		       LD E,(HL)	;
505)   D1AD 23          		       INC HL	;
506)   D1AE 56          		       LD D,(HL)	;
507)   D1AF 2B          		       DEC HL	;
508)   D1B0 D5          		       PUSH DE	;
509)   D1B1 D7 63       		       DEFW ZLANG	;
510)   D1B3 E1          		       POP HL	;
511)   D1B4 E5          		       PUSH HL	;
512)   D1B5 C5          		       PUSH BC	;
513)   D1B6 D7 64       		       DEFW ZNFIND	;
514)   D1B8 D7 63       		       DEFW ZLANG	;
515)   D1BA 78          		       LD A,B	;
516)   D1BB C1          		       POP BC	;
517)   D1BC 90          		       SUB B	;
518)   D1BD D1          		       POP DE	;
519)   D1BE E1          		TTLN1: POP HL	;
520)   D1BF 73          		       LD (HL),E	;
521)   D1C0 23          		       INC HL	;
522)   D1C1 72          		       LD (HL),D	;
523)   D1C2 23          		       INC HL	;
524)   D1C3 77          		       LD (HL),A	;
525)   D1C4 23          		       INC HL	;
526)   D1C5 C9          		       RET	;
528)   D1C6 E5          		LNTT:  PUSH HL	;
529)   D1C7 5E          		       LD E,(HL)	;
530)   D1C8 23          		       INC HL	;
531)   D1C9 56          		       LD D,(HL)	;
532)   D1CA 23          		       INC HL	;
533)   D1CB 46          		       LD B,(HL)	;
534)   D1CC EB          		       EX DE,HL	;
535)   D1CD C5          		       PUSH BC	;
536)   D1CE D7 64       		       DEFW ZNFIND	;
537)   D1D0 C1          		       POP BC	;
538)   D1D1 38 08       		       JR C LNTT2	;
539)   D1D3 AF          		       XOR A	;
540)   D1D4 B0          		       OR B	;
541)   D1D5 28 04       		       JR Z LNTT2	;
542)   D1D7 D7 62       		LNTT3: DEFW ZLAST	;
543)   D1D9 10 FC       		       DJNZ LNTT3	;
544)   D1DB EB          		LNTT2: EX DE,HL	;
545)   D1DC 18 E0       		       JR TTLN1	;
547)   D1DE CD 56 D2    		XRESER: CALL XTRA	;
548)   D1E1 D7 2F       		       DEFW ZUNSTSS	;
549)   D1E3 42          		       LD B,D	;
550)   D1E4 4B          		       LD C,E	;
551)   D1E5 1E 20       		       LD E,TOP	;
552)   D1E7 DF 6E       		       DEFW WINSS	;
553)   D1E9 18 40       		       JR XDLT2	;
555)   D1EB CD 56 D2    		XMERGE: CALL XTRA	;
556)   D1EE CD BB C9    		       CALL XLDLP	;
557)   D1F1 FE 01       		       CP 1	;
558)   D1F3 28 36       		       JR Z XDLT2	;
559)   D1F5 37          		       SCF	;
560)   D1F6 18 33       		       JR XDLT2	;
562)   D1F8 CD 56 D2    		XDELET: CALL XTRA	;
563)   D1FB E5          		       PUSH HL	;
564)   D1FC 21 55 D2    		       LD HL,CARRET	;
565)   D1FF CD A3 DA    		       CALL LINPTR	;
566)   D202 E1          		       POP HL	;
567)   D203 5E          		       LD E,(HL)	;
568)   D204 23          		       INC HL	;
569)   D205 56          		       LD D,(HL)	;
570)   D206 23          		       INC HL	;
571)   D207 E5          		       PUSH HL	;
572)   D208 EB          		       EX DE,HL	;
573)   D209 D7 29       		       DEFW ZFIND	;
574)   D20B 38 02       		       JR C XDLT1	;
575)   D20D D7 63       		       DEFW ZLANG	;
576)   D20F E3          		XDLT1: EX (SP),HL	;
577)   D210 5E          		       LD E,(HL)	;
578)   D211 23          		       INC HL	;
579)   D212 56          		       LD D,(HL)	;
580)   D213 EB          		       EX DE,HL	;
581)   D214 D7 29       		       DEFW ZFIND	;
582)   D216 D1          		XDLT4: POP DE	;
583)   D217 B7          		       OR A	;
584)   D218 ED 52       		       SBC HL,DE	;
585)   D21A 30 0F       		       JR NC XDLT2	;
586)   D21C 19          		       ADD HL,DE	;
587)   D21D D5          		       PUSH DE	;
588)   D21E E5          		       PUSH HL	;
589)   D21F D7 63       		       DEFW ZLANG	;
590)   D221 E3          		       EX (SP),HL	;
591)   D222 7E          		       LD A,(HL)	;
592)   D223 23          		       INC HL	;
593)   D224 66          		       LD H,(HL)	;
594)   D225 6F          		       LD L,A	;
595)   D226 D7 66       		       DEFW ZLAM1	;
596)   D228 E1          		       POP HL	;
597)   D229 18 EB       		       JR XDLT4	;
599)   D22B F5          		XDLT2: PUSH AF	;
600)   D22C D7 5C       		       DEFW ZLNTOTE	;
601)   D22E 21 02 00    		       LD HL,2	;
602)   D231 39          		       ADD HL,SP	;
603)   D232 D7 5E       		       DEFW ZLNTT	;
604)   D234 C1          		       POP BC	;
605)   D235 DD E1       		       POP IX	;
606)   D237 D1          		       POP DE	;
607)   D238 30 14       		       JR NC XDLT3	;
608)   D23A DD E5       		       PUSH IX	;
609)   D23C E1          		       POP HL	;
610)   D23D D7 65       		       DEFW ZLLN2	;
611)   D23F 3E FE       		       LD A,254	;
612)   D241 30 0A       		       JR NC XDLT9	;
613)   D243 06 03       		       LD B,3	;
614)   D245 11 FA FF    		XDLT8: LD DE,-6	;
615)   D248 DD 19       		       ADD IX,DE	;
616)   D24A 37          		XDLT7: SCF	;
617)   D24B 78          		       LD A,B	;
618)   D24C C9          		       RET	;
620)   D24D 37          		XDLT9: SCF	;
621)   D24E CB 41       		XDLT3: BIT 0,C	;
622)   D250 C8          		       RET Z	;
623)   D251 30 F7       		       JR NC XDLT7	;
624)   D253 18 F0       		       JR XDLT8	;
626)   D255 0D          		CARRET: DEFB 13	;
628)   D256 C1          		XTRA:  POP BC	;
629)   D257 EB          		       EX DE,HL	;
630)   D258 E5          		       PUSH HL	;
631)   D259 DD E5       		       PUSH IX	;
632)   D25B 21 00 00    		       LD HL,0	;
633)   D25E 39          		       ADD HL,SP	;
634)   D25F C5          		       PUSH BC	;
635)   D260 D5          		       PUSH DE	;
636)   D261 D7 5D       		       DEFW ZTTLN	;
637)   D263 D7 5B       		       DEFW ZTETOLN	;
638)   D265 D7 5F       		       DEFW ZXCLE2	;
639)   D267 E1          		       POP HL	;
640)   D268 C9          		       RET	;
642)   D269 E5          		LAST:  PUSH HL	;
643)   D26A D7 28       		       DEFW ZNLNT	;
644)   D26C D1          		       POP DE	;
645)   D26D EB          		       EX DE,HL	;
646)   D26E 9F          		       SBC A,A	;
647)   D26F C0          		       RET NZ	;
648)   D270 1A          		       LD A,(DE)	;
649)   D271 BE          		       CP (HL)	;
650)   D272 C0          		       RET NZ	;
651)   D273 23          		       INC HL	;
652)   D274 13          		       INC DE	;
653)   D275 1A          		       LD A,(DE)	;
654)   D276 BE          		       CP (HL)	;
655)   D277 2B          		       DEC HL 	;
656)   D278 C0          		       RET NZ	;
657)   D279 1B          		       DEC DE	;
658)   D27A EB          		       EX DE,HL	;
659)   D27B C9          		       RET	;
113)   D27C D7 0F       		       DEFW ZQSTR      ;already checked	;already checked
114)   D27E D8          		       RET C           ;R.IF NOT "	;R.IF NOT "
119)   D27F CD 4F C9    		       CALL GSBAS	;
120)   D282 CD 2E DC    		STRCN3: CALL EXGLB	;
121)   D285 B7          		       OR A	;
122)   D286 ED 52       		       SBC HL,DE       ;TOP OF SYM.TAB. - SYM.TAB.PTR.	;TOP OF SYM.TAB. - SYM.TAB.PTR.
123)   D288 28 34       		       JR Z,STRCN6     ;J.IF SYM.TAB.SEARCHED	;J.IF SYM.TAB.SEARCHED
124)   D28A EB          		       EX DE,HL	;
125)   D28B 23          		       INC HL	;
126)   D28C 7E          		       LD A,(HL)	;
127)   D28D 23          		       INC HL	;
128)   D28E E5          		       PUSH HL         ;SAVE SYM.TAB.ADR.	;SAVE SYM.TAB.ADR.
129)   D28F C5          		       PUSH BC         ;SAVE LENGTH	;SAVE LENGTH
130)   D290 FE 40       		       CP 040H	;
131)   D292 20 22       		       JR NZ,STRCN5    ;J.IF NOT STR.CON.	;J.IF NOT STR.CON.
132)   D294 C5          		       PUSH BC	;
133)   D295 D7 15       		       DEFW ZMKSTAB	;
134)   D297 E3          		       EX (SP),HL	;
135)   D298 A7          		       AND A	;
136)   D299 ED 42       		       SBC HL,BC	;
137)   D29B E1          		       POP HL	;
138)   D29C 20 18       		       JR NZ,STRCN5    ;J.IF WRONG LENGTH	;J.IF WRONG LENGTH
139)   D29E D7 36       		       DEFW ZRSINST	;
143)   D2A0 79          		STRCN4: LD A,C	;
144)   D2A1 B0          		       OR B	;
145)   D2A2 D1          		       POP DE	;
146)   D2A3 28 26       		       JR Z,STRCN8     ;J.IF STRINGS MATCH	;J.IF STRINGS MATCH
147)   D2A5 D5          		       PUSH DE	;
148)   D2A6 D7 33       		       DEFW ZRDCH	;
149)   D2A8 FE 22       		       CP 022H	;
150)   D2AA 20 02       		       JR NZ,STRC41	;
151)   D2AC D7 34       		       DEFW ZRDNCH     ;SKIP 1ST QUOTE OF Q IMAGE	;SKIP 1ST QUOTE OF Q IMAGE
152)   D2AE ED A1       		STRC41 CPI	;
153)   D2B0 20 04       		       JR NZ,STRCN5    ;J.IF NOT EQUAL	;J.IF NOT EQUAL
154)   D2B2 D7 34       		       DEFW ZRDNCH	;
155)   D2B4 18 EA       		       JR STRCN4	;
161)   D2B6 C1          		       POP BC	;
162)   D2B7 E1          		       POP HL	;
163)   D2B8 11 06 00    		       LD DE,6	;
164)   D2BB 19          		       ADD HL,DE	;
165)   D2BC 18 C4       		       JR STRCN3	;
171)   D2BE C5          		       PUSH BC         ;SAVE LENGTH	;SAVE LENGTH
172)   D2BF 01 00 40    		       LD BC,4000H     ;name-type for str. con.	;name-type for str. con.
173)   D2C2 D7 1C       		       DEFW ZINSERT    ;ADD NEW SYM.TAB.ENTRY	;ADD NEW SYM.TAB.ENTRY
174)   D2C4 C1          		       POP BC          ;BC=LENGTH	;BC=LENGTH
175)   D2C5 D8          		       RET C           ;R.IF NOT ROOM	;R.IF NOT ROOM
176)   D2C6 23          		       INC HL	;
177)   D2C7 23          		       INC HL	;
178)   D2C8 E5          		       PUSH HL         ;SAVE SYM.TAB.ADR.	;SAVE SYM.TAB.ADR.
179)   D2C9 DF 14       		       DEFW WNEWSTR	;
180)   D2CB E1          		STRCN8: POP HL	;
181)   D2CC D8          		       RET C	;
182)   D2CD D7 34       		       DEFW ZRDNCH	;
183)   D2CF D7 04       		       DEFW ZCPSH	;
184)   D2D1 C9          		       RET	;
189)   D2D2 D7 36       		       DEFW ZRSINST	;
190)   D2D4 79          		       LD A,C	;
191)   D2D5 B0          		       OR      B	;
192)   D2D6 C8          		       RET Z           ;NOTHING TO DO IF NULL STRING	;NOTHING TO DO IF NULL STRING
193)   D2D7 D7 70       		       DEFW ZMKRL      ;make relative if necessary	;make relative if necessary
194)   D2D9 D7 10       		       DEFW ZLDSTR	;
195)   D2DB D8          		       RET C           ;If out of room	;If out of room
196)   D2DC EB          		       EX DE,HL	;
197)   D2DD D7 71       		       DEFW ZMKAB      ;restore	;restore
201)   D2DF D7 33       		       DEFW ZRDCH	;
202)   D2E1 FE 22       		LNS7:  CP 022H	;
203)   D2E3 20 02       		       JR NZ,LNS8	;
204)   D2E5 D7 34       		       DEFW ZRDNCH     ;SKIP 1ST QUOTE OF Q IMAGE	;SKIP 1ST QUOTE OF Q IMAGE
205)   D2E7 77          		LNS8:  LD (HL),A	;
206)   D2E8 D7 34       		       DEFW ZRDNCH	;
207)   D2EA ED A1       		       CPI             ;INCR HL, DECR BC, TEST BC	;INCR HL, DECR BC, TEST BC
208)   D2EC E0          		       RET PO          ;DONE IF BC=0	;DONE IF BC=0
209)   D2ED 18 F2       		       JR LNS7	;
224)   D2EF 5E          		       LD E,(HL)	;
225)   D2F0 23          		       INC HL	;
226)   D2F1 56          		       LD D,(HL)       ;DE=LOC(STRING) (REL)	;DE=LOC(STRING) (REL)
227)   D2F2 23          		       INC HL	;
228)   D2F3 4E          		       LD C,(HL)	;
229)   D2F4 23          		       INC HL	;
230)   D2F5 46          		       LD  B,(HL)      ;BC=SIZE	;BC=SIZE
231)   D2F6 7B          		       LD A,E	;
232)   D2F7 B2          		       OR D	;
233)   D2F8 C8          		       RET Z           ;R.IF NULL	;R.IF NULL
234)   D2F9 FD 6E 1A    		       LD L,(IY+ARBAS)	;
235)   D2FC FD 66 1B    		       LD H,(IY+ARBAS+1)	;
236)   D2FF 19          		       ADD HL,DE       ;HL=LOC(STRING) (ABS)	;HL=LOC(STRING) (ABS)
237)   D300 C9          		       RET	;
248)   D301 DD E5       		       PUSH IX	;
249)   D303 E5          		       PUSH HL	;
250)   D304 D7 15       		       DEFW ZMKSTAB	;
251)   D306 28 19       		       JR Z,@M25       ;IF NULL ALREADY	;IF NULL ALREADY
252)   D308 D5          		       PUSH DE	;
253)   D309 1E 18       		       LD E,STBAS	;
254)   D30B D7 6F       		       DEFW ZDELT	;
255)   D30D E1          		       POP HL	;
256)   D30E E3          		       EX (SP),HL	;
257)   D30F AF          		       XOR A	;
258)   D310 77          		       LD (HL),A	;
259)   D311 23          		       INC HL	;
260)   D312 77          		       LD (HL),A	;
261)   D313 23          		       INC HL	;
262)   D314 77          		       LD  (HL),A	;
263)   D315 23          		       INC HL	;
264)   D316 77          		       LD  (HL),A      ;'SIZE'=0 FOR NULL STRING	;'SIZE'=0 FOR NULL STRING
268)   D317 CD 4F C9    		       CALL GSBAS	;
272)   D31A CD 2E DC    		       CALL EXGLB	;
273)   D31D A7          		       AND A	;
274)   D31E ED 52       		       SBC HL,DE	;
275)   D320 EB          		       EX DE,HL	;
276)   D321 D1          		@M25:  POP DE	;
277)   D322 DD E1       		       POP IX	;
278)   D324 C8          		       RET Z	;
279)   D325 DD E5       		       PUSH IX	;
280)   D327 23          		       INC HL	;
281)   D328 7E          		       LD A,(HL)	;
282)   D329 23          		       INC HL	;
283)   D32A E6 7C       		       AND 7CH	;
284)   D32C FE 40       		       CP 40H	;
285)   D32E 28 33       		       JR Z,LMN6       ;if scalar	;if scalar
286)   D330 E6 4C       		       AND 4CH	;
287)   D332 FE 40       		       CP 40H	;
288)   D334 20 35       		       JR NZ LMN7	;
294)   D336 D5          		       PUSH DE	;
295)   D337 DD E1       		       POP IX	;
296)   D339 E5          		       PUSH HL	;
297)   D33A 5E          		       LD E,(HL)	;
298)   D33B 23          		       INC HL	;
299)   D33C 56          		       LD D,(HL)	;
300)   D33D C5          		       PUSH BC	;
301)   D33E D5          		       PUSH DE	;
302)   D33F 23          		       INC HL	;
303)   D340 D7 58       		       DEFW ZELNUM	;
309)   D342 D1          		       POP DE	;
310)   D343 FD 46 1D    		       LD B,(IY+SBAS+1)	;
311)   D346 FD 4E 1C    		       LD C,(IY+SBAS)	;
312)   D349 EB          		       EX DE,HL	;
313)   D34A 09          		       ADD HL,BC	;
314)   D34B C1          		       POP BC	;
320)   D34C D5          		       PUSH DE	;
321)   D34D E5          		       PUSH HL	;
322)   D34E DD E3       		       EX (SP),IX      ;IX->lowest byte of array area	;IX->lowest byte of array area
323)   D350 D1          		LMN4:  POP DE          ;DE=rel addr. of del'd string	;DE=rel addr. of del'd string
324)   D351 CD 72 D3    		       CALL MKADJ	;
325)   D354 E1          		       POP HL	;
326)   D355 2B          		       DEC HL	;
327)   D356 7C          		       LD A,H	;
328)   D357 B5          		       OR L	;
329)   D358 28 10       		       JR Z,LMN5       ;if no more elements	;if no more elements
330)   D35A E5          		       PUSH HL         	;
331)   D35B D5          		       PUSH DE         ; save addr of del'd string	; save addr of del'd string
332)   D35C 11 06 00    		       LD DE,6	;
333)   D35F DD 19       		       ADD IX,DE	;
334)   D361 18 ED       		       JR LMN4	;
336)   D363 E5          		LMN6:  PUSH HL	;
337)   D364 E5          		       PUSH HL	;
338)   D365 DD E1       		       POP IX	;
339)   D367 CD 72 D3    		       CALL MKADJ	;
340)   D36A E1          		LMN5:  POP HL	;
341)   D36B D5          		LMN7:  PUSH DE	;
342)   D36C 11 06 00    		       LD DE,6	;
343)   D36F 19          		       ADD HL,DE	;
344)   D370 18 A8       		       JR @M2	;
353)   D372 DD 6E 00    		       LD L,(IX+0)	;
354)   D375 DD 66 01    		       LD H,(IX+1)     ;HL:= rel addr in symbol	;HL:= rel addr in symbol
355)   D378 7C          		       LD A,H	;
356)   D379 B5          		       OR L	;
357)   D37A C8          		       RET Z	;
358)   D37B ED 52       		       SBC HL,DE	;
359)   D37D D0          		       RET NC	;
360)   D37E 19          		       ADD HL,DE	;
361)   D37F 09          		       ADD HL,BC	;
362)   D380 DD 75 00    		       LD (IX+0),L	;
363)   D383 DD 74 01    		       LD (IX+1),H	;
364)   D386 C9          		       RET	;
370)   D387 4E          		       LD C,(HL)	;
371)   D388 23          		       INC HL	;
372)   D389 46          		       LD B,(HL)	;
373)   D38A 23          		       INC HL	;
374)   D38B 5E          		       LD E,(HL)	;
375)   D38C 23          		       INC HL	;
376)   D38D 56          		       LD D,(HL)	;
377)   D38E 21 00 00    		LMN1:  LD HL,0         ;BC*DE -> HL	;BC*DE -> HL
378)   D391 09          		LMN2:  ADD HL,BC	;
379)   D392 D8          		       RET C           ;if overflow(not poss.in ELNUM)	;if overflow(not poss.in ELNUM)
380)   D393 1B          		       DEC DE	;
381)   D394 7A          		       LD A,D	;
382)   D395 B3          		       OR E	;
383)   D396 20 F9       		       JR NZ,LMN2	;
384)   D398 C9          		       RET	;
392)   D399 D7 18       		NUMEXP: DEFW ZEXPN     ;COMPILE EXPRESSION	;COMPILE EXPRESSION
393)   D39B D8          		       RET C           ;RETURN IF FAILED	;RETURN IF FAILED
394)   D39C B7          		       OR A	;
395)   D39D C8          		       RET Z           ;RETURN IF NUMERIC	;RETURN IF NUMERIC
396)   D39E 18 05       		       JR @TYPER-$     ;SET ERROR	;SET ERROR
403)   D3A0 D7 18       		STREXP: DEFW ZEXPN     ;COMPILE EXPRESSION	;COMPILE EXPRESSION
404)   D3A2 D8          		       RET C           ;RETURN IF FAILED	;RETURN IF FAILED
405)   D3A3 B7          		       OR A	;
406)   D3A4 C0          		       RET NZ          ;RETURN IF STRING	;RETURN IF STRING
407)   D3A5 3E 14       		@TYPER: LD A,ERRNOT	;
408)   D3A7 37          		       SCF	;
409)   D3A8 C9          		       RET	;
417)   D3A9 01 40 00    		EXPN:  LD BC,64        ;perform stack test	;perform stack test
418)   D3AC E7 35       		       DEFW ZSTKTST    ;64 is plucked from air	;64 is plucked from air
419)   D3AE 3E 55       		       LD A,85         ;return ERR 85 if check	;return ERR 85 if check
420)   D3B0 D8          		       RET C           ;fails	;fails
421)   D3B1 97          		       SUB A                   ;MAKE A ZERO BINDING POWER	;MAKE A ZERO BINDING POWER
422)   D3B2 F5          		       PUSH    AF              ;STACK IT AS TERMINATOR	;STACK IT AS TERMINATOR
423)   D3B3 21 CC DC    		@OPRND: LD     HL,@MONOP       ;SELECT MONADIC OP. LIST	;SELECT MONADIC OP. LIST
424)   D3B6 D7 1E       		       DEFW ZSCAN              ;HAVE WE A MONADIC OP.	;HAVE WE A MONADIC OP.
425)   D3B8 38 03       		       JR      C,@E1-$         ;JUMP IF NOT FOUND	;JUMP IF NOT FOUND
426)   D3BA C5          		       PUSH    BC              ;STACK MONADIC DATA	;STACK MONADIC DATA
427)   D3BB 18 F6       		       JR      @OPRND	;
431)   D3BD D7 44       		@E1:   DEFW ZCHKOPN            ;OPEN BRACKET ?	;OPEN BRACKET ?
432)   D3BF 38 0F       		       JR      C,@E3-$         ;NO	;NO
433)   D3C1 D7 18       		       DEFW ZEXPN              ;COMPILE SUB-EXPRESSION	;COMPILE SUB-EXPRESSION
435)   D3C3 DF 3F       		       DEFW WCHKCLS    ;CHECK IF CLOSED	;CHECK IF CLOSED
436)   D3C5 30 4F       		       JR      NC,@OPRTR-$     ;IF YES - GET OPERATOR	;IF YES - GET OPERATOR
438)   D3C7 47          		@EFAIL: LD     B,A             ;SAVE FAIL CODE	;SAVE FAIL CODE
439)   D3C8 97          		       SUB     A       ;WE'RE LOOKING FOR TERMINATOR = 0	;WE'RE LOOKING FOR TERMINATOR = 0
440)   D3C9 D1          		@EF2:  POP     DE      ;GET OPERATOR OFF STACK	;GET OPERATOR OFF STACK
441)   D3CA BA          		       CP      D               ;IS IT THE LAST	;IS IT THE LAST
442)   D3CB 20 FC       		       JR      NZ,@EF2       ;NO	;NO
443)   D3CD 78          		       LD      A,B             ;YES - GET ERROR CODE	;YES - GET ERROR CODE
444)   D3CE 37          		       SCF	;
445)   D3CF C9          		       RET	;
449)   D3D0 D7 50       		@E3:   DEFW ZSSFNM             ;CHECK FOR STRING FUNCTION	;CHECK FOR STRING FUNCTION
450)   D3D2 38 08       		       JR C,@E32	;
451)   D3D4 D7 51       		       DEFW ZSTRSFN	;
452)   D3D6 FD 36 2B 10 		       LD (IY+@TYPE),10H	;
453)   D3DA 18 38       		       JR @E8	;
455)   D3DC D7 43       		@E32:  DEFW ZCHKQUO            ;OR STRING CONSTANT	;OR STRING CONSTANT
456)   D3DE 38 06       		       JR      C,@E4           ;NOT STRING OPERAND	;NOT STRING OPERAND
457)   D3E0 D7 13       		       DEFW  ZSTRCON	;
458)   D3E2 38 E3       		       JR C,@EFAIL	;
459)   D3E4 18 26       		       JR      @E65            ;GO GET OPERATOR	;GO GET OPERATOR
463)   D3E6 FD 36 2B 00 		@E4:   LD      (IY+@TYPE),0    ;;MUST BE NUMERIC	;;MUST BE NUMERIC
464)   D3EA D7 1F       		       DEFW ZNCONST            ;NUMERIC CONSTANT	;NUMERIC CONSTANT
465)   D3EC 38 06       		       JR      C,@E5-$         ;NO	;NO
466)   D3EE 3E F1       		       LD      A,YPSHFP        ;TO STACK IT	;TO STACK IT
467)   D3F0 D7 02       		       DEFW ZCMTHRE	;
468)   D3F2 18 22       		       JR      @OPRTR-$        ;GO GET OPERATOR	;GO GET OPERATOR
472)   D3F4 D7 4A       		@E5:   DEFW ZASFNM             ;CHECK FOR ARITH FN.	;CHECK FOR ARITH FN.
473)   D3F6 38 08       		       JR C,@E6	;
474)   D3F8 D7 4D       		       DEFW ZNUMFN             ;here if found	;here if found
475)   D3FA FD 36 2B 00 		       LD (IY+@TYPE),0	;
476)   D3FE 18 14       		       JR @E8	;
478)   D400 D7 53       		@E6:   DEFW ZBVARIA            ;IS IT A VARIABLE?	;IS IT A VARIABLE?
479)   D402 3E 15       		       LD A,ERRNOF	;
480)   D404 38 C1       		       JR C,@EFAIL	;
481)   D406 3E C0       		       LD A,YDEREF	;
482)   D408 CB 70       		       BIT 6,B	;
483)   D40A 28 06       		       JR Z,@E7	;
484)   D40C FD 36 2B 10 		@E65:  LD (IY+@TYPE),10H       ;here if string	;here if string
485)   D410 3E F3       		       LD A,YPSHST	;
486)   D412 D7 57       		@E7:   DEFW ZCMONE             ;GET VALUE	;GET VALUE
490)   D414 38 B1       		@E8:   JR C,@EFAIL	;
491)   D416 21 D4 DC    		@OPRTR: LD HL,@DIOP            ;SELECT LIST OF DIADIC OPRS	;SELECT LIST OF DIADIC OPRS
492)   D419 D7 1E       		       DEFW ZSCAN              ;SEARCH FOR IT	;SEARCH FOR IT
493)   D41B E1          		       POP HL                  ;GET LAST OPR	;GET LAST OPR
494)   D41C 38 23       		       JR      C,@E9           ;IF HAVE TERMINATOR	;IF HAVE TERMINATOR
498)   D41E 7C          		       LD A,H	;
499)   D41F F6 0F       		       OR      0FH     ;A=BINDING POWER & "F	;A=BINDING POWER & "F
500)   D421 B8          		       CP      B               ;TIGHTER BINDING	;TIGHTER BINDING
501)   D422 30 1D       		       JR      NC,@E9-$        ;NO	;NO
502)   D424 E5          		       PUSH HL                 ;ELSE PUT IT BACK	;ELSE PUT IT BACK
506)   D425 FD 7E 2B    		       LD      A,(IY+@TYPE)    ;TYPE OF LEFT OPERAND	;TYPE OF LEFT OPERAND
507)   D428 B7          		       OR      A               ;IS IT NUMERIC	;IS IT NUMERIC
508)   D429 28 08       		       JR      Z,@E10-$        ;YES	;YES
509)   D42B 78          		       LD      A,B             ;SAVE BINDING POWER	;SAVE BINDING POWER
510)   D42C CB 11       		       RL      C	;
511)   D42E 17          		       RLA	;
512)   D42F CB 11       		       RL      C	;
513)   D431 17          		       RLA	;
514)   D432 4F          		       LD      C,A             ;TO BOTTOM OF C	;TO BOTTOM OF C
515)   D433 C5          		@E10:  PUSH    BC              ;STACK OPERATOR	;STACK OPERATOR
516)   D434 79          		       LD      A,C	;
517)   D435 FD AE 2B    		       XOR     (IY+@TYPE)  ;CHECK CURRENT & R OPD TYPES	;CHECK CURRENT & R OPD TYPES
518)   D438 CB 67       		       BIT     4,A             ;DO THEY AGREE?	;DO THEY AGREE?
519)   D43A CA B3 D3    		       JP      Z,@OPRND        ;YES GET OPERAND	;YES GET OPERAND
520)   D43D 3E 16       		@E14:  LD      A,ERRNOP        ;TYPE ERROR	;TYPE ERROR
521)   D43F 18 86       		       JR      @EFAIL	;
525)   D441 D7 36       		@E9:   DEFW ZRSINST    ;MOVE BACK BEFORE OPERATOR(IF ANY)	;MOVE BACK BEFORE OPERATOR(IF ANY)
526)   D443 7C          		       LD      A,H             ;BINDING POWER	;BINDING POWER
527)   D444 B7          		       OR      A               ;CHECK IF ZERO	;CHECK IF ZERO
528)   D445 FD 7E 2B    		       LD      A,(IY+@TYPE)    ;GET TYPE OF RESULT	;GET TYPE OF RESULT
529)   D448 C8          		       RET     Z               ;RETURN IF A TERMINATOR	;RETURN IF A TERMINATOR
530)   D449 AD          		       XOR     L               ;DO TYPES AGREE?	;DO TYPES AGREE?
531)   D44A CB 67       		       BIT     4,A	;
532)   D44C 20 EF       		       JR      NZ,@E14         ;NO - ERROR	;NO - ERROR
533)   D44E FD 36 2B 00 		       LD      (IY+@TYPE),0    ;SET TYPE NUMERIC	;SET TYPE NUMERIC
534)   D452 CB 6D       		       BIT     5,L             ;IF RESULT IS NUMERIC	;IF RESULT IS NUMERIC
535)   D454 28 04       		       JR      Z,@E11-$        ;BRANCH IF YES	;BRANCH IF YES
536)   D456 FD 36 2B 10 		       LD      (IY+@TYPE),10H  ;ELSE TYPE=STRING	;ELSE TYPE=STRING
537)   D45A 7D          		@E11:  LD      A,L	;
538)   D45B E6 0F       		       AND     0FH             ;REMOVE TOP 4 BITS	;REMOVE TOP 4 BITS
539)   D45D CB 65       		       BIT     4,L             ;IS OPERATOR NUMERIC	;IS OPERATOR NUMERIC
540)   D45F 28 08       		       JR      Z,@E12-$        ;YES	;YES
541)   D461 FE 0F       		       CP 0FH	;
542)   D463 28 D8       		       JR Z,@E14               ;IF "ERROR" CODE	;IF "ERROR" CODE
546)   D465 C6 E7       		       ADD     A,YSTROP        ;POINTER TO OP. LIST	;POINTER TO OP. LIST
547)   D467 18 A9       		       JR      @E7	;
551)   D469 C6 40       		@E12:  ADD     A,40H           ;SET AS CLASS 1	;SET AS CLASS 1
552)   D46B FE 43       		       CP      43H             ;ASSUMING MONADIC	;ASSUMING MONADIC
553)   D46D 38 A3       		       JR      C,@E7           ;BRANCH IF IT IS	;BRANCH IF IT IS
554)   D46F D6 23       		       SUB 23H         ;MAKE CLASS 2 & ADJ DISPLACEMENT	;MAKE CLASS 2 & ADJ DISPLACEMENT
555)   D471 18 9F       		       JR      @E7             	;
561)   D473 CB 78       		       BIT 7,B	;
562)   D475 C2 86 CE    		       JP NZ CUFN	;
563)   D478 CB 40       		       BIT 0,B         ;1 argument?	;1 argument?
564)   D47A 28 14       		       JR Z NMF9       ;if no - must be class 0 arith	;if no - must be class 0 arith
565)   D47C D7 44       		       DEFW ZCHKOPN    ;compile one	;compile one
566)   D47E CB 48       		       BIT 1,B	;
567)   D480 C5          		NMF7:  PUSH BC         ;save op code	;save op code
568)   D481 28 03       		       JR Z NMF2	;
569)   D483 DF 17       		NMF6:  DEFW WSTREXP	;
570)   D485 21          		       DEFB 21H        ;code for LD HL,.. i.e. skip	;code for LD HL,.. i.e. skip
571)   D486 DF 16       		NMF2:  DEFW WNUMEXP    ;numeric arg.	;numeric arg.
572)   D488 C1          		       POP BC	;
573)   D489 DF 3F       		NMF1:  DEFW WCHKCLS    ;preserves op-code in C	;preserves op-code in C
574)   D48B D8          		NMF4:  RET C           ;if error	;if error
575)   D48C 79          		NMF8:  LD A,C	;
576)   D48D D7 57       		NMF41: DEFW ZCMONE	;
577)   D48F C9          		       RET	;
579)   D490 CB 48       		NMF9:  BIT 1,B         ;for INSTR	;for INSTR
580)   D492 28 F8       		       JR Z NMF8	;
581)   D494 C5          		       PUSH BC	;
582)   D495 D7 44       		       DEFW ZCHKOPN	;
583)   D497 DF 17       		       DEFW WSTREXP	;
584)   D499 DF 40       		       DEFW WCHKCOM	;
585)   D49B DF 17       		       DEFW WSTREXP	;
586)   D49D 18 26       		       JR LSTF3	;
591)   D49F CB 78       		       BIT 7,B         ;is it a user fn?	;is it a user fn?
592)   D4A1 C2 86 CE    		       JP NZ,CUFN      ;jump if it is	;jump if it is
593)   D4A4 79          		       LD A,C          ;Y-code	;Y-code
594)   D4A5 B7          		       OR A	;
595)   D4A6 28 34       		       JR Z LSTF6      ;is it FILE$	;is it FILE$
596)   D4A8 D7 44       		       DEFW ZCHKOPN	;
597)   D4AA D8          		       RET C           ;if no '('	;if no '('
598)   D4AB 79          		       LD A,C          ;Y-code	;Y-code
599)   D4AC C5          		       PUSH BC         ;save fn data	;save fn data
600)   D4AD FE F2       		       CP YSTCHR	;
601)   D4AF 28 D5       		       JR Z NMF2       ;if CHR$ (in 8K BASIC)	;if CHR$ (in 8K BASIC)
602)   D4B1 FE 88       		       CP YSTSTR	;
603)   D4B3 28 1B       		       JR Z LSTF1      ;if STR$	;if STR$
604)   D4B5 FE A9       		       CP YMID	;
605)   D4B7 28 06       		       JR Z LSTF2      ;if MID$	;if MID$
606)   D4B9 D7 17       		       DEFW ZSTREXP    ;here if LEFT$ or RIGHT$	;here if LEFT$ or RIGHT$
607)   D4BB DF 40       		       DEFW WCHKCOM	;
608)   D4BD 18 C7       		       JR NMF2	;
610)   D4BF D7 17       		LSTF2: DEFW ZSTREXP    ;here if MID$	;here if MID$
611)   D4C1 DF 40       		       DEFW WCHKCOM	;
612)   D4C3 DF 16       		       DEFW WNUMEXP	;
613)   D4C5 38 BF       		LSTF3: JR C NMF2       ;if error so far	;if error so far
614)   D4C7 DF 40       		       DEFW WCHKCOM	;
615)   D4C9 30 BB       		       JR NC NMF2      ;if 3 arguments	;if 3 arguments
616)   D4CB C1          		       POP BC	;
617)   D4CC 0C          		       INC C           ;increment to YMID1	;increment to YMID1
618)   D4CD B7          		       OR A            ;clear carry	;clear carry
619)   D4CE 18 B9       		       JR NMF1         ;if 2 arguments	;if 2 arguments
621)   D4D0 D7 16       		LSTF1: DEFW ZNUMEXP	;
622)   D4D2 DF 47       		       DEFW WFORMAT    ;arg for STR$-check for	;arg for STR$-check for
623)   D4D4 E1          		       POP HL          ;formatted conversion	;formatted conversion
624)   D4D5 D8          		       RET C           ;if invalid fmt	;if invalid fmt
625)   D4D6 61          		       LD H,C          ;Compile op-code and	;Compile op-code and
626)   D4D7 D7 01       		       DEFW ZCM2HL     ;lsb of fmt.	;lsb of fmt.
627)   D4D9 48          		       LD C,B	;
628)   D4DA 18 AD       		       JR NMF1         ;Chk ')' and compile	;Chk ')' and compile
631)   D4DC 01 FF C3    		LSTF6: LD BC,8000H+4000H+1023	;
632)   D4DF CD E8 D4    		       CALL VARIA9	;
633)   D4E2 0E F3       		       LD C,YPSHST	;
634)   D4E4 18 A5       		       JR NMF4	;
643)   D4E6 D7 19       		       DEFW ZVARIA	;
644)   D4E8 DF 1B       		VARIA9: DEFW WADDSYM	;
645)   D4EA D8          		       RET     C	;
646)   D4EB FD CB 22 66 		       BIT 4,(IY+FLAGS)	;
647)   D4EF 28 0E       		       JR Z VARIA0     ;if not compiling DEF	;if not compiling DEF
648)   D4F1 79          		       LD A,C	;
649)   D4F2 FD BE 37    		       CP (IY+FPAR)	;
650)   D4F5 20 08       		       JR NZ VARIA0	;
651)   D4F7 78          		       LD A,B	;
652)   D4F8 FD BE 38    		       CP (IY+FPAR+1)	;
653)   D4FB 3E 93       		       LD A,YAATOF	;
654)   D4FD 28 8E       		       JR Z NMF41	;
655)   D4FF 23          		VARIA0: INC    HL	;
656)   D500 23          		       INC     HL	;
657)   D501 D7 04       		       DEFW ZCPSH	;
658)   D503 D8          		       RET     C	;
659)   D504 78          		       LD      A,B	;
660)   D505 E6 30       		       AND     030H	;
661)   D507 C8          		       RET     Z               ;RETURN IF NOT ARRAY	;RETURN IF NOT ARRAY
662)   D508 E5          		       PUSH    HL	;
663)   D509 C5          		       PUSH    BC	;
664)   D50A D7 34       		       DEFW ZRDNCH     ;SKIP (	;SKIP (
665)   D50C D7 16       		       DEFW ZNUMEXP	;
666)   D50E C1          		       POP     BC	;
667)   D50F E1          		       POP     HL	;
668)   D510 D8          		       RET     C               ;RET IF SUB-SCRIPT ERROR	;RET IF SUB-SCRIPT ERROR
669)   D511 D7 40       		       DEFW    ZCHKCOM	;
670)   D513 3E 13       		       LD      A,19	;
671)   D515 30 09       		       JR      NC,VARIA1       ;J.IF 2ND SUB-SCR.	;J.IF 2ND SUB-SCR.
672)   D517 CB 60       		       BIT     4,B	;
673)   D519 C8          		       RET     Z               ;IF 2ND SUB-SCR. MISSING	;IF 2ND SUB-SCR. MISSING
674)   D51A CB A8       		       RES     5,B	;
675)   D51C 3E EF       		       LD      A,YAR1AD	;
676)   D51E 18 0F       		       JR      VARIA2	;
678)   D520 CB 68       		VARIA1: BIT    5,B	;
679)   D522 37          		       SCF	;
680)   D523 C8          		       RET     Z       ;IF 2ND SUB-SCR. NOT WANTED	;IF 2ND SUB-SCR. NOT WANTED
681)   D524 E5          		       PUSH    HL	;
682)   D525 CB A0       		       RES     4,B	;
683)   D527 C5          		       PUSH BC	;
684)   D528 D7 16       		       DEFW ZNUMEXP	;
685)   D52A C1          		       POP     BC	;
686)   D52B E1          		       POP     HL	;
687)   D52C D8          		       RET     C               ;RET IF SUB-SCRIPT ERROR	;RET IF SUB-SCRIPT ERROR
688)   D52D 3E F0       		       LD      A,YAR2AD	;
690)   D52F D7 57       		       DEFW    ZCMONE	;
691)   D531 DF 3F       		       DEFW    WCHKCLS	;
692)   D533 D8          		       RET     C	;
693)   D534 2B          		       DEC     HL	;
694)   D535 70          		       LD      (HL),B  ;IN     CASE    1ST.REF.	;IN     CASE    1ST.REF.
695)   D536 2B          		       DEC     HL	;
696)   D537 C5          		       PUSH    BC	;
697)   D538 11 0A 00    		       LD      DE,     10	;
698)   D53B CB 68       		       BIT     5,B	;
699)   D53D 42          		       LD      B,D	;
700)   D53E 4B          		       LD      C,E	;
701)   D53F 20 06       		       JR      NZ,VARIA3               ;if     2-D	;if     2-D
702)   D541 FD 7E 2A    		       LD      A,(IY+BASFLG)	;
703)   D544 E6 01       		       AND     1	;
704)   D546 5F          		       LD      E,A	;
705)   D547 D7 12       		VARIA3: DEFW   ZXDIM	;
706)   D549 C1          		       POP     BC	;
707)   D54A D0          		       RET     NC	;
708)   D54B FE 47       		       CP      71              ;clear carry unless was error 10	;clear carry unless was error 10
709)   D54D C9          		       RET	;
715)   D54E D7 1D       		       DEFW ZGETVNM	;
716)   D550 3E 1A       		       LD A,26	;
717)   D552 D8          		       RET     C	;
718)   D553 D7 38       		       DEFW ZRDSCH	;
719)   D555 EE 28       		       XOR     '('	;
720)   D557 C0          		       RET     NZ	;
721)   D558 CB E0       		       SET     4,B	;
722)   D55A CB E8       		       SET     5,B	;
723)   D55C C9          		       RET	;
135)   D55D 21 00 00    		       LD HL,0	;
136)   D560 1E 2F       		       LD E,DTINPT	;
137)   D562 D7 07       		       DEFW ZSETS2	;
138)   D564 60          		       LD H,B	;
139)   D565 69          		       LD L,C	;
140)   D566 1E 39       		       LD E,ERRLIN	;
141)   D568 D7 07       		       DEFW ZSETS2	;
142)   D56A FD 70 2A    		       LD  (IY+BASFLG),B	;
143)   D56D FD 70 22    		       LD (IY+FLAGS),B	;
144)   D570 D7 21       		       DEFW ZINITOB    ;obj code has pointers into s.t.	;obj code has pointers into s.t.
145)   D572 CD 2F DC    		       CALL GLBAS	;
146)   D575 1E 12       		       LD E,USRSTP	;
147)   D577 3E 06       		       LD A,6	;
148)   D579 D7 08       		       DEFW ZSETSN	;
149)   D57B C9          		       RET	;
160)   D57C CD 4F C9    		       CALL GSBAS	;
161)   D57F CD 2E DC    		FINDV1: CALL EXGLB     ;DE->start of Sym. Tab.	;DE->start of Sym. Tab.
162)   D582 37          		       SCF	;
163)   D583 ED 52       		       SBC HL,DE	;
164)   D585 D8          		       RET C	;
165)   D586 1A          		       LD A,(DE)	;
166)   D587 13          		       INC  DE	;
167)   D588 B9          		       CP C	;
168)   D589 20 0B       		       JR NZ,FINDV3    ;J. IF LS BYTE NOT MATCHED	;J. IF LS BYTE NOT MATCHED
169)   D58B 1A          		       LD A,(DE)	;
170)   D58C E6 30       		       AND 030H	;
171)   D58E 1A          		       LD A,(DE)	;
172)   D58F 28 02       		       JR Z,FINDV2     ;J.IF NOT ARRAY ENTRY	;J.IF NOT ARRAY ENTRY
173)   D591 F6 30       		       OR 030H         ;SET BOTH ARRAY BITS	;SET BOTH ARRAY BITS
174)   D593 B8          		FINDV2: CP B	;
175)   D594 28 06       		       JR Z,FINDV4     ;J.IF FOUND	;J.IF FOUND
176)   D596 21 07 00    		FINDV3: LD HL,7	;
177)   D599 19          		       ADD HL,DE       ;HL SET FOR NEXT ENTRY	;HL SET FOR NEXT ENTRY
178)   D59A 18 E3       		       JR FINDV1	;
180)   D59C EB          		FINDV4: EX DE,HL	;
181)   D59D 46          		       LD B,(HL)	;
182)   D59E 2B          		       DEC HL          ;HL=LOC(SYM.TAB.ENTRY)	;HL=LOC(SYM.TAB.ENTRY)
183)   D59F C9          		       RET	;
192)   D5A0 D7 1A       		       DEFW ZFINDVC	;
193)   D5A2 D0          		       RET     NC              ;IF ALREADY EXISTS	;IF ALREADY EXISTS
200)   D5A3 C5          		       PUSH    BC	;
201)   D5A4 01 08 00    		       LD      BC,8	;
202)   D5A7 1E 1C       		       LD E,SBAS	;
203)   D5A9 D7 6E       		       DEFW ZINSS	;
204)   D5AB C1          		       POP     BC	;
205)   D5AC D8          		       RET     C	;
206)   D5AD E5          		       PUSH HL	;
207)   D5AE 71          		       LD (HL),C	;
208)   D5AF 23          		       INC     HL	;
209)   D5B0 70          		       LD      (HL),B	;
210)   D5B1 3E 05       		       LD A,5	;
211)   D5B3 23          		LINS3: INC HL	;
212)   D5B4 36 00       		       LD (HL),0       ; CLEAR ALL 6 VALUE BYTES	; CLEAR ALL 6 VALUE BYTES
213)   D5B6 3D          		       DEC A	;
214)   D5B7 F2 B3 D5    		       JP P,LINS3	;
215)   D5BA E1          		       POP HL	;
216)   D5BB C9          		       RET             ; WITH NC (SINCE "RET C") AND M	; WITH NC (SINCE "RET C") AND M
224)   D5BC D7 38       		       DEFW ZRDSCH	;
225)   D5BE CD EF D5    		       CALL LETTER	;
226)   D5C1 D8          		       RET C	;
227)   D5C2 06 00       		       LD B,0	;
228)   D5C4 C5          		       PUSH BC	;
229)   D5C5 CD FC D5    		       CALL M36	;
230)   D5C8 C1          		       POP BC	;
231)   D5C9 09          		       ADD HL,BC	;
232)   D5CA D7 3D       		       DEFW ZDIGIT	;
233)   D5CC 38 07       		       JR      C,GETVN2	;
234)   D5CE C6 1A       		       ADD A,26	;
235)   D5D0 4F          		       LD      C,A	;
236)   D5D1 D7 34       		       DEFW ZRDNCH	;
237)   D5D3 18 09       		       JR GETVN1	;
238)   D5D5 D7 33       		GETVN2: DEFW ZRDCH	;
239)   D5D7 CD EF D5    		       CALL LETTER	;
240)   D5DA 30 02       		       JR NC GETVN1	;
241)   D5DC 0E 24       		       LD C,36	;
242)   D5DE 06 00       		GETVN1: LD     B,0	;
243)   D5E0 09          		       ADD HL,BC	;
244)   D5E1 44          		       LD B,H	;
245)   D5E2 4D          		       LD C,L	;
246)   D5E3 CB F8       		       SET     7,B	;
247)   D5E5 D7 33       		       DEFW ZRDCH	;
248)   D5E7 EE 24       		       XOR     '$'	;
249)   D5E9 C0          		       RET     NZ	;
250)   D5EA CB F0       		       SET     6,B	;
251)   D5EC D7 34       		       DEFW    ZRDNCH	;
252)   D5EE C9          		       RET	;
254)   D5EF E7 2F       		LETTER: DEFW ZTTCAPS	;
255)   D5F1 D6 41       		       SUB     41H	;
256)   D5F3 D8          		       RET     C               ;IF BELOW 'A'	;IF BELOW 'A'
257)   D5F4 FE 1A       		       CP      26	;
258)   D5F6 3F          		       CCF	;
259)   D5F7 D8          		       RET     C               ;IF ABOVE 'Z'	;IF ABOVE 'Z'
260)   D5F8 4F          		       LD C,A	;
261)   D5F9 D7 34       		       DEFW ZRDNCH	;
262)   D5FB C9          		       RET	;
264)   D5FC CD FF D5    		M36:   CALL M6	;
265)   D5FF 60          		M6:    LD H,B	;
266)   D600 69          		       LD L,C	;
271)   D601 29          		       ADD HL,HL	;
272)   D602 09          		       ADD HL,BC	;
273)   D603 29          		       ADD HL,HL	;
274)   D604 44          		       LD B,H	;
275)   D605 4D          		       LD C,L	;
276)   D606 C9          		       RET	;
281)   D607 D7 59       		       DEFW ZRDFN      ;Is it a string user fn.	;Is it a string user fn.
282)   D609 38 07       		       JR C LSTR1	;
283)   D60B CB 70       		       BIT 6,B         ;make sure it is a string	;make sure it is a string
284)   D60D C0          		       RET NZ	;
285)   D60E D7 36       		       DEFW ZRSINST    ;reset input from	;reset input from
287)   D610 37          		       SCF	;
288)   D611 C9          		       RET	;
290)   D612 FE 50       		LSTR1: CP RDFNE1	;
291)   D614 37          		       SCF	;
292)   D615 C0          		       RET NZ	;
293)   D616 21 2A DD    		       LD HL,SSFLST	;
294)   D619 18 0A       		       JR SCAN	;
299)   D61B D7 59       		       DEFW    ZRDFN           ;LOOK FOR 'FN'<NUM.VAR.>	;LOOK FOR 'FN'<NUM.VAR.>
300)   D61D D0          		       RET NC                  ;RET IF NO ERRORS	;RET IF NO ERRORS
301)   D61E FE 50       		       CP      RDFNE1	;
302)   D620 37          		       SCF             ;J.IF NO ROOM/INVALID FN FORMAT	;J.IF NO ROOM/INVALID FN FORMAT
303)   D621 C0          		       RET NZ	;
304)   D622 21 F2 DC    		       LD HL,ASFLST	;
306)   D625 D7 35       		SCAN:  DEFW ZSVINST	;
307)   D627 D7 38       		       DEFW ZRDSCH	;
308)   D629 96          		       SUB (HL)	;
309)   D62A D8          		       RET C	;
310)   D62B 23          		       INC HL	;
311)   D62C BE          		       CP (HL)	;
312)   D62D 3F          		       CCF	;
313)   D62E D8          		       RET C	;
314)   D62F 23          		       INC HL	;
315)   D630 EB          		       EX DE,HL	;
316)   D631 26 00       		       LD H,0	;
317)   D633 6F          		       LD L,A	;
318)   D634 29          		       ADD HL,HL	;
319)   D635 19          		       ADD HL,DE	;
320)   D636 4E          		       LD C,(HL)	;
321)   D637 23          		       INC HL	;
322)   D638 46          		       LD B,(HL)	;
323)   D639 D7 34       		       DEFW ZRDNCH	;
324)   D63B C9          		       RET	;
329)   D63C CD AA DA    		       CALL GINPTR	;
330)   D63F EB          		       EX DE,HL	;
331)   D640 E7 2A       		       DEFW ZINP	;
332)   D642 D8          		       RET C           ;if not arith. const.	;if not arith. const.
333)   D643 EB          		       EX DE,HL	;
334)   D644 CD A3 DA    		       CALL LINPTR	;
335)   D647 CD 4F C9    		       CALL GSBAS      ;Scan S.T.for num.const.in FPA	;Scan S.T.for num.const.in FPA
336)   D64A CD 2E DC    		LOOKU1: CALL EXGLB	;
337)   D64D 37          		       SCF	;
338)   D64E ED 52       		       SBC     HL,DE	;
339)   D650 EB          		       EX      DE,HL	;
340)   D651 38 15       		       JR      C,NCONS1	;
341)   D653 23          		       INC     HL	;
342)   D654 7E          		       LD      A,(HL)	;
343)   D655 23          		       INC     HL	;
344)   D656 E5          		       PUSH HL	;
345)   D657 E6 C0       		       AND     0C0H	;
346)   D659 20 05       		       JR      NZ,LOOKU4	;
347)   D65B 11 00 01    		       LD      DE,FACC	;
348)   D65E E7 26       		       DEFW ZCOMP	;
349)   D660 E1          		LOOKU4: POP HL	;
350)   D661 C8          		       RET Z           ;with carry unset	;with carry unset
351)   D662 11 06 00    		       LD DE,6	;
352)   D665 19          		       ADD     HL,DE	;
353)   D666 18 E2       		       JR      LOOKU1	;
356)   D668 01 00 00    		NCONS1: LD BC,0        ;name-type for numeric const.	;name-type for numeric const.
357)   D66B D7 1C       		       DEFW    ZINSERT	;
358)   D66D 23          		       INC     HL	;
359)   D66E 23          		       INC     HL	;
360)   D66F EF 2D       		       DEFW WSTF       ;HL preserved	;HL preserved
361)   D671 C9          		       RET	;
372)   D672 D7 22       		       DEFW ZINTIN     ;Read line no. to HL	;Read line no. to HL
373)   D674 D8          		       RET C           ;If line no. > 65535	;If line no. > 65535
374)   D675 7C          		       LD A,H	;
375)   D676 B5          		       OR L	;
376)   D677 37          		       SCF	;
377)   D678 3E 5E       		       LD A,94	;
378)   D67A C8          		       RET Z           ;If line number = 0	;If line number = 0
381)   D67B E5          		       PUSH HL	;
382)   D67C D7 64       		       DEFW ZNFIND	;
383)   D67E 38 45       		       JR C,AMEND1     ;J.IF NO OLD LINE	;J.IF NO OLD LINE
384)   D680 E5          		       PUSH HL         ;Else delete old line	;Else delete old line
385)   D681 23          		       INC     HL	;
386)   D682 23          		       INC     HL	;
387)   D683 5E          		       LD      E,(HL)	;
388)   D684 23          		       INC     HL	;
389)   D685 56          		       LD      D,(HL)	;
390)   D686 EB          		       EX      DE,HL	;
391)   D687 3E 0D       		       LD      A,15Q	;
392)   D689 E5          		       PUSH    HL	;
393)   D68A 01 00 00    		       LD      BC,0	;
394)   D68D ED B1       		       CPIR            ;SET BC = -(LINE LENGTH)	;SET BC = -(LINE LENGTH)
395)   D68F 2B          		       DEC HL          ;SET HL -> CR AT END OF LINE	;SET HL -> CR AT END OF LINE
396)   D690 CD 2E DC    		       CALL EXGLB	;
397)   D693 23          		LAM3:  INC     HL      ;   LNT ENTRY	;   LNT ENTRY
398)   D694 23          		       INC     HL      ;MOVE LNT ENTRIES FOR LINES ABOVE	;MOVE LNT ENTRIES FOR LINES ABOVE
399)   D695 D7 6D       		       DEFW ZUPDLNT	;
400)   D697 23          		       INC HL	;
401)   D698 23          		       INC HL	;
402)   D699 D5          		       PUSH DE	;
403)   D69A D7 65       		       DEFW ZLLN2	;
404)   D69C D1          		       POP DE	;
405)   D69D 30 F4       		       JR      NC,LAM3	;
406)   D69F 13          		       INC     DE	;
407)   D6A0 FD 66 0F    		       LD      H,(IY+STOP+1)	;
408)   D6A3 FD 6E 0E    		       LD      L,(IY+STOP)	;
409)   D6A6 A7          		       AND     A	;
410)   D6A7 ED 52       		       SBC     HL,DE	;
411)   D6A9 44          		       LD      B,H	;
412)   D6AA 4D          		       LD      C,L     ;BC:=AMOUNT TO MOVE	;BC:=AMOUNT TO MOVE
413)   D6AB EB          		       EX      DE,HL	;
414)   D6AC D1          		       POP     DE	;
415)   D6AD 28 02       		       JR Z,LAM5       ;IF NOTHING TO MOVE	;IF NOTHING TO MOVE
416)   D6AF ED B0       		       LDIR            ;DELETE SOURCE LINE	;DELETE SOURCE LINE
417)   D6B1 EB          		LAM5:  EX DE,HL	;
418)   D6B2 1E 0E       		       LD E,STOP	;
419)   D6B4 D7 07       		       DEFW ZSETS2	;
420)   D6B6 D7 70       		       DEFW ZMKRL	;
421)   D6B8 E1          		       POP     HL	;
422)   D6B9 01 06 00    		       LD      BC,6	;
423)   D6BC 1E 1E       		       LD E,LBAS	;
424)   D6BE D7 6F       		       DEFW ZDELT	;
425)   D6C0 D7 71       		       DEFW ZMKAB	;
426)   D6C2 E1          		       POP HL	;
427)   D6C3 18 B6       		       JR LAM1	;
430)   D6C5 FD 36 2E 00 		       LD (IY+PPFLGS),0	;
431)   D6C9 D7 33       		       DEFW ZRDCH	;
432)   D6CB FE 0D       		       CP      15Q	;
433)   D6CD CA 54 D7    		       JP      Z,AMEND9        ;IF NEW LINE EMPTY	;IF NEW LINE EMPTY
434)   D6D0 C1          		       POP BC	;
435)   D6D1 FD 66 0F    		       LD H,(IY+STOP+1)	;
436)   D6D4 FD 6E 0E    		       LD L,(IY+STOP)	;
437)   D6D7 E5          		       PUSH HL	;
438)   D6D8 C5          		       PUSH BC	;
439)   D6D9 01 1E 00    		       LD BC,SAFMRG+7	;
440)   D6DC C5          		AMEND2: PUSH BC	;
441)   D6DD E3          		       EX (SP),HL	;
442)   D6DE D7 25       		       DEFW ZROOMQ	;
443)   D6E0 E1          		       POP HL	;
444)   D6E1 38 70       		       JR C,AMEND8             ; IF OUT OF SPACE	; IF OUT OF SPACE
445)   D6E3 03          		       INC BC	;
446)   D6E4 C5          		       PUSH BC	;
447)   D6E5 D7 33       		       DEFW ZRDCH	;
448)   D6E7 D7 67       		       DEFW ZTSTPPF	;
449)   D6E9 38 2A       		       JR C AMEND7	;
450)   D6EB FD CB 2E 66 		       BIT 4,(IY+PPFLGS)	;
451)   D6EF 20 20       		       JR NZ AMENDE	;
452)   D6F1 E5          		       PUSH HL	;
453)   D6F2 D7 67       		       DEFW ZTSTPPF    ;will leave NC	;will leave NC
454)   D6F4 28 12       		       JR Z AMENDD	;
455)   D6F6 D7 6A       		       DEFW ZCODSTK	;
456)   D6F8 3F          		       CCF	;
457)   D6F9 DF 69       		AMENDA: DEFW WCODFTK	;
458)   D6FB 38 13       		       JR C AMENDB	;
459)   D6FD D7 67       		       DEFW ZTSTPPF	;
460)   D6FF 28 0F       		       JR Z AMENDB	;
461)   D701 D7 36       		       DEFW ZRSINST	;
462)   D703 E1          		       POP HL	;
463)   D704 3E B5       		       LD A,TINVTH     ;the remorseless invisible THEN	;the remorseless invisible THEN
464)   D706 18 11       		       JR AMENDC	;
466)   D708 CB 7F       		AMENDD: BIT 7,A	;
467)   D70A 28 ED       		       JR Z AMENDA	;
468)   D70C FD CB 2E E6 		       SET 4,(IY+PPFLGS)	;
469)   D710 E1          		AMENDB: POP HL	;
470)   D711 FE 3A       		AMENDE: CP ':'	;
471)   D713 28 0F       		       JR Z AMEND4	;
472)   D715 47          		AMEND7: LD B,A	;
473)   D716 D7 34       		       DEFW ZRDNCH	;
474)   D718 78          		       LD A,B	;
475)   D719 D7 68       		AMENDC: DEFW ZUPDPPF	;
476)   D71B C1          		       POP BC	;
477)   D71C 77          		       LD      (HL),A	;
478)   D71D 23          		       INC     HL	;
479)   D71E FE 0D       		       CP      15Q	;
480)   D720 28 08       		       JR      Z,AMEND3	;
481)   D722 18 B8       		       JR      AMEND2	;
484)   D724 36 0D       		AMEND4: LD (HL),0DH	;
485)   D726 23          		       INC HL	;
486)   D727 C1          		       POP BC	;
487)   D728 D7 34       		       DEFW ZRDNCH	;
488)   D72A 1E 0E       		AMEND3: LD E,STOP	;
489)   D72C D7 07       		       DEFW ZSETS2	;
490)   D72E D7 70       		       DEFW ZMKRL	;
491)   D730 E1          		       POP     HL	;
492)   D731 E5          		       PUSH    HL	;
493)   D732 D7 64       		       DEFW ZNFIND	;
494)   D734 DF 63       		       DEFW WLANG	;
495)   D736 01 FA FF    		       LD      BC,-6	;
496)   D739 1E 1E       		       LD E,LBAS	;
497)   D73B D7 6F       		       DEFW ZDELT              ;MUST BE ROOM BECAUSE	;MUST BE ROOM BECAUSE
498)   D73D C1          		       POP BC                  ;CHECKED ABOVE	;CHECKED ABOVE
499)   D73E D1          		       POP DE	;
500)   D73F C5          		       PUSH BC	;
501)   D740 E5          		       PUSH HL	;
502)   D741 71          		       LD (HL),C	;
503)   D742 23          		       INC HL	;
504)   D743 70          		       LD (HL),B	;
505)   D744 23          		       INC HL	;
506)   D745 73          		       LD (HL),E	;
507)   D746 23          		       INC HL	;
508)   D747 72          		       LD (HL),D               ;SOURCE ADDR.	;SOURCE ADDR.
509)   D748 23          		       INC HL	;
510)   D749 AF          		       XOR A	;
511)   D74A 77          		       LD (HL),A	;
512)   D74B 23          		       INC HL	;
513)   D74C 77          		       LD (HL),A               ;OBJ. ADDR.	;OBJ. ADDR.
514)   D74D D7 71       		       DEFW ZMKAB	;
515)   D74F E1          		       POP HL	;
516)   D750 C3 C5 D6    		       JP AMEND1	;
518)   D753 E1          		AMEND8: POP HL	;
519)   D754 E1          		AMEND9: POP HL	;
520)   D755 CD A0 D1    		DISPOSE: CALL GFORP	;
521)   D758 FD CB 22 B6 		       RES 6,(IY+FLAGS)	;
522)   D75C C3 8C C5    		       JP LDUSTP	;
524)   D75F 21 56 DE    		CODFTK: LD HL,KWDS	;
525)   D762 18 03       		       JR CODTOK	;
527)   D764 21 20 DF    		CODSTK: LD HL,OKWDS	;
528)   D767 4E          		CODTOK: LD C,(HL)	;
529)   D768 23          		       INC HL	;
530)   D769 46          		       LD B,(HL)	;
531)   D76A 23          		       INC HL	;
532)   D76B D7 35       		       DEFW ZSVINST    ;important for invisible THEN	;important for invisible THEN
533)   D76D D5          		       PUSH DE	;
534)   D76E EB          		       EX DE,HL	;
535)   D76F CD AA DA    		       CALL GINPTR	;
536)   D772 EB          		       EX DE,HL	;
537)   D773 D5          		CODL1: PUSH DE	;
538)   D774 1A          		CODL8: LD A,(DE)	;
539)   D775 CB 7F       		       BIT 7,A	;
540)   D777 20 0F       		       JR NZ CODL3	;
541)   D779 FE 61       		       CP 'a'	;
542)   D77B 38 06       		       JR C CODL9	;
543)   D77D FE 7B       		       CP 'z'+1	;
544)   D77F 30 02       		       JR NC CODL9	;
545)   D781 C6 E0       		       ADD A,'A'-'a'	;
546)   D783 AE          		CODL9: XOR (HL)	;
547)   D784 E6 7F       		       AND 7FH	;
548)   D786 28 13       		       JR Z CODL2	;
549)   D788 CB 7E       		CODL3: BIT 7,(HL)	;
550)   D78A 23          		       INC HL	;
551)   D78B 28 FB       		       JR Z CODL3	;
552)   D78D E3          		       EX (SP),HL	;
553)   D78E CD A3 DA    		       CALL LINPTR	;
554)   D791 E3          		       EX (SP),HL	;
555)   D792 D1          		       POP DE	;
556)   D793 0C          		       INC C	;
557)   D794 10 DD       		       DJNZ CODL1	;
558)   D796 D7 33       		       DEFW ZRDCH	;
559)   D798 37          		       SCF	;
560)   D799 D1          		       POP DE	;
561)   D79A C9          		       RET	;
563)   D79B CB 7E       		CODL2: BIT 7,(HL)	;
564)   D79D 23          		       INC HL	;
565)   D79E 79          		       LD A,C	;
566)   D79F 20 03       		       JR NZ CODL4	;
567)   D7A1 13          		       INC DE	;
568)   D7A2 18 D0       		       JR CODL8	;
570)   D7A4 EB          		CODL4: EX DE,HL	;
571)   D7A5 CD A3 DA    		       CALL LINPTR	;
572)   D7A8 D1          		       POP DE	;
573)   D7A9 D1          		       POP DE	;
574)   D7AA C9          		       RET	;
579)   D7AB FD CB 22 86 		       RES 0,(IY+FLAGS)	;
581)   D7AF FD 7E 22    		       LD A,(IY+FLAGS)	;
582)   D7B2 FD 56 0F    		       LD D,(IY+STOP+1)	;
583)   D7B5 FD 5E 0E    		       LD E,(IY+STOP)	;
584)   D7B8 0F          		       RRCA	;
585)   D7B9 30 2A       		       JR NC LI4       ;if no obj. code to preserve	;if no obj. code to preserve
586)   D7BB D5          		       PUSH DE         ;save STOP ptr	;save STOP ptr
587)   D7BC F5          		       PUSH AF         ;to fix Basil's bug	;to fix Basil's bug
588)   D7BD CD 93 C1    		       CALL GOPTR      ;obj. ptr for cur. line to HL	;obj. ptr for cur. line to HL
589)   D7C0 F1          		       POP AF	;
590)   D7C1 2B          		       DEC HL	;
591)   D7C2 B7          		       OR A            ;clear CY	;clear CY
592)   D7C3 46          		       LD B,(HL)	;
593)   D7C4 2B          		       DEC HL          ;HL -> obj. record for cur. line	;HL -> obj. record for cur. line
594)   D7C5 4E          		       LD C,(HL)       ;BC = obj. record size	;BC = obj. record size
595)   D7C6 CB 57       		       BIT 2,A         ;test bit 3 as shifted	;test bit 3 as shifted
596)   D7C8 20 0D       		       JR NZ LI2       ;if compiling	;if compiling
597)   D7CA EB          		       EX DE,HL        ;so HL->STOP,DE->obj. record	;so HL->STOP,DE->obj. record
598)   D7CB ED 52       		       SBC HL,DE       ;HL= -dist. obj. is to be moved	;HL= -dist. obj. is to be moved
599)   D7CD FD 74 2D    		       LD (IY+OMOVE+1),H	;
600)   D7D0 FD 75 2C    		       LD (IY+OMOVE),L	;
601)   D7D3 19          		       ADD HL,DE       ;so HL-> STOP	;so HL-> STOP
602)   D7D4 EB          		       EX DE,HL        ;so HL->obj. record,DE->STOP	;so HL->obj. record,DE->STOP
603)   D7D5 18 0C       		       JR LI3	;
607)   D7D7 E5          		       PUSH HL         ;save obj. record ptr	;save obj. record ptr
608)   D7D8 44          		       LD B,H	;
609)   D7D9 4D          		       LD C,L	;
610)   D7DA CD 3D DC    		       CALL GOTOP	;
611)   D7DD ED 42       		       SBC HL,BC       ;so HL = length of record	;so HL = length of record
612)   D7DF E3          		       EX (SP),HL      ;so HL->obj. rec.,TOS = length	;so HL->obj. rec.,TOS = length
613)   D7E0 C1          		       POP BC          ;BC = length	;BC = length
614)   D7E1 28 02       		       JR Z LI4        ;if length = 0	;if length = 0
615)   D7E3 ED B0       		LI3:   LDIR            ;copy record to new position	;copy record to new position
616)   D7E5 FD 72 11    		LI4:   LD (IY+OTOP+1),D	;
617)   D7E8 FD 73 10    		       LD (IY+OTOP),E	;
618)   D7EB CD 2F DC    		       CALL GLBAS      ;now adjust line no. tab. entries	;now adjust line no. tab. entries
619)   D7EE D7 65       		       DEFW ZLLN2	;
620)   D7F0 38 0C       		       JR C LI6        ;if there aren't any	;if there aren't any
621)   D7F2 D7 28       		LI5:   DEFW ZNLNT	;
622)   D7F4 2B          		       DEC HL	;
623)   D7F5 36 00       		       LD (HL),0	;
624)   D7F7 2B          		       DEC HL          ;clear obj. ptr in prev. entry	;clear obj. ptr in prev. entry
625)   D7F8 36 00       		       LD (HL),0	;
626)   D7FA 23          		       INC HL	;
627)   D7FB 23          		       INC HL	;
628)   D7FC 30 F4       		       JR NC LI5	;
629)   D7FE 07          		LI6:   RLCA            ;here when all LNT entries clear	;here when all LNT entries clear
630)   D7FF D0          		       RET NC          ;if no current line	;if no current line
631)   D800 E1          		       POP HL          ;else rewrite LNT entry for	;else rewrite LNT entry for
632)   D801 23          		LOPTR: INC HL          ;cur. line (object now at STOP)	;cur. line (object now at STOP)
633)   D802 23          		       INC HL	;
634)   D803 DD 74 05    		LOPTR1: LD (IX+5),H	;
635)   D806 DD 75 04    		       LD (IX+4),L	;
636)   D809 C9          		       RET	;
643)   D80A 21 00 00    		       LD HL,0	;
644)   D80D D7 38       		       DEFW ZRDSCH	;
645)   D80F DF 3D       		       DEFW WDIGIT	;
646)   D811 38 16       		       JR C,RDLNN6     ;J.IF 1st CHAR.NOT DIGIT	;J.IF 1st CHAR.NOT DIGIT
647)   D813 C5          		       PUSH BC	;
648)   D814 4D          		RDLNN1: LD C,L	;
649)   D815 44          		       LD B,H          ;BC=ACCUMULATED VALUE	;BC=ACCUMULATED VALUE
650)   D816 6F          		       LD L,A	;
651)   D817 26 00       		       LD H,0          ;HL=VALUE OF NEW DIGIT	;HL=VALUE OF NEW DIGIT
652)   D819 3E 0A       		       LD A,10	;
653)   D81B 09          		RDLNN2: ADD HL,BC	;
654)   D81C 38 0A       		       JR C,RDLNN3     ;J.IF INTEGER OVERFLOW	;J.IF INTEGER OVERFLOW
655)   D81E 3D          		       DEC A	;
656)   D81F 20 FA       		       JR NZ,RDLNN2	;
657)   D821 D7 34       		       DEFW ZRDNCH     ;HL=NEW ACCUMULATED VALUE	;HL=NEW ACCUMULATED VALUE
658)   D823 D7 3D       		       DEFW ZDIGIT	;
659)   D825 30 ED       		       JR NC,RDLNN1	;
660)   D827 3F          		       CCF	;
661)   D828 C1          		RDLNN3: POP BC	;
662)   D829 3E 04       		RDLNN6 LD A,4          ;IN CASE ERROR	;IN CASE ERROR
663)   D82B C9          		       RET	;
673)   D82C 11 14 00    		       LD DE,SAFETY	;
674)   D82F 19          		       ADD HL,DE	;
675)   D830 CD 3A D8    		NCROOM: CALL ROOMQ	;
676)   D833 D0          		       RET     NC	;
677)   D834 E5          		       PUSH    HL	;
678)   D835 C5          		       PUSH    BC	;
679)   D836 D7 21       		       DEFW ZINITOB	;
680)   D838 C1          		       POP     BC	;
681)   D839 E1          		       POP     HL	;
685)   D83A E5          		       PUSH    HL	;
686)   D83B CD 3D DC    		       CALL GOTOP	;
687)   D83E EB          		       EX DE,HL	;
688)   D83F CD 36 DC    		       CALL GUSTP	;
689)   D842 B7          		       OR      A	;
690)   D843 ED 52       		       SBC     HL,DE	;
691)   D845 D1          		       POP     DE	;
692)   D846 ED 52       		       SBC     HL,DE	;
693)   D848 EB          		       EX      DE,HL	;
694)   D849 3E 0A       		       LD A,10                 ; ERROR CODE IF CY SET	; ERROR CODE IF CY SET
695)   D84B C9          		       RET	;
700)   D84C 01 00 04    		       LD BC,256*4+0	;
704)   D84F E5          		LPH2:  PUSH HL	;
705)   D850 78          		       LD A,B	;
706)   D851 21 01 00    		       LD HL,1	;
707)   D854 29          		LPH3:  ADD HL,HL	;
708)   D855 54          		       LD D,H	;
709)   D856 5D          		       LD E,L	;
710)   D857 29          		       ADD HL,HL	;
711)   D858 29          		       ADD HL,HL	;
712)   D859 19          		       ADD HL,DE       ;NB CLEARS CARRY	;NB CLEARS CARRY
713)   D85A 3D          		       DEC A	;
714)   D85B 20 F7       		       JR NZ,LPH3	;
715)   D85D EB          		       EX DE,HL        ;DE := 10**B	;DE := 10**B
716)   D85E E1          		       POP HL	;
717)   D85F 3C          		LPH4:  INC A           ;DIVIDE BY DE, QUOTIENT IN A	;DIVIDE BY DE, QUOTIENT IN A
718)   D860 ED 52       		       SBC HL,DE	;
719)   D862 30 FB       		       JR NC,LPH4	;
720)   D864 19          		       ADD HL,DE       ;RESTORE AFTER ONE SUBTR'N TOO	;RESTORE AFTER ONE SUBTR'N TOO
721)   D865 3D          		       DEC A           ;   MANY	;   MANY
722)   D866 28 02       		       JR Z,LPH5       ;IF ZERO DIGIT	;IF ZERO DIGIT
723)   D868 0E 30       		       LD C,'0'        ;CHAR FOR ANY FUTURE ZEROES ELSE	;CHAR FOR ANY FUTURE ZEROES ELSE
724)   D86A 81          		LPH5:  ADD A,C	;
725)   D86B 28 03       		       JR Z,LPH6	;
726)   D86D D7 3C       		       DEFW ZPTCHAR	;
727)   D86F D8          		       RET C	;
728)   D870 10 DD       		LPH6   DJNZ LPH2	;
729)   D872 7D          		       LD A,L	;
730)   D873 C6 30       		       ADD A,'0'	;
731)   D875 D7 3C       		       DEFW ZPTCHAR	;
732)   D877 C9          		       RET	;
740)   D878 CD 2F DC    		       CALL GLBAS	;
741)   D87B C5          		       PUSH BC	;
742)   D87C D7 63       		       DEFW ZLANG	;
743)   D87E C1          		       POP BC	;
744)   D87F 18 0E       		       JR LLN2	;
746)   D881 06 00       		LANG:  LD B,0	;
747)   D883 04          		LANG1: INC B	;
748)   D884 D7 65       		       DEFW ZLLN2	;
749)   D886 D8          		       RET C	;
750)   D887 D7 62       		       DEFW ZLAST	;
751)   D889 28 F8       		       JR Z LANG1	;
757)   D88B 11 06 00    		       LD DE,6	;
758)   D88E 19          		       ADD HL,DE	;
759)   D88F EB          		LLN2:  EX DE,HL	;
760)   D890 CD 98 D8    		       CALL GTOP	;
761)   D893 37          		       SCF	;
762)   D894 ED 52       		       SBC HL,DE       ;SET CY IF ADDR. GE (B4)	;SET CY IF ADDR. GE (B4)
763)   D896 EB          		       EX DE,HL	;
764)   D897 C9          		       RET	;
766)   D898 FD 66 21    		GTOP:  LD H,(IY+TOP+1)	;
767)   D89B FD 6E 20    		       LD L,(IY+TOP)	;
768)   D89E C9          		       RET	;
770)   D89F E5          		NFIND: PUSH HL	;
771)   D8A0 CD 2F DC    		       CALL GLBAS	;
772)   D8A3 D7 65       		       DEFW ZLLN2	;
773)   D8A5 18 03       		       JR LF1	;
784)   D8A7 E5          		       PUSH HL	;
785)   D8A8 D7 27       		       DEFW ZFLNT	;
786)   D8AA C1          		LF1:   POP BC	;
787)   D8AB D8          		LF2:   RET C           ;IF OFF END OF TABLE	;IF OFF END OF TABLE
788)   D8AC 5E          		       LD E,(HL)       ;ELSE CY IS CLEAR	;ELSE CY IS CLEAR
789)   D8AD 23          		       INC HL	;
790)   D8AE 56          		       LD D,(HL)	;
791)   D8AF 2B          		       DEC HL	;
792)   D8B0 EB          		       EX DE,HL	;
793)   D8B1 ED 42       		       SBC HL,BC	;
794)   D8B3 EB          		       EX DE,HL	;
795)   D8B4 C8          		       RET Z           ;IF FOUND	;IF FOUND
796)   D8B5 3F          		       CCF	;
797)   D8B6 D8          		       RET C           ;IF GONE PAST WHERE IT WOULD BE	;IF GONE PAST WHERE IT WOULD BE
798)   D8B7 D7 28       		       DEFW ZNLNT      ;ELSE TRY NEXT	;ELSE TRY NEXT
799)   D8B9 18 F0       		       JR LF2	;
 83)   D8BB D5          		       PUSH DE	;
 84)   D8BC CD C1 D8    		       CALL UNST2	;
 85)   D8BF D1          		       POP     DE	;
 86)   D8C0 C9          		       RET	;
 89)   D8C1 CD 36 DC    		       CALL GUSTP	;
 90)   D8C4 5E          		       LD E,(HL)       ;PICK UP CONTENTS OF 2 BYTES	;PICK UP CONTENTS OF 2 BYTES
 91)   D8C5 23          		       INC HL          ;   JUST POPPED	;   JUST POPPED
 92)   D8C6 56          		       LD D,(HL)	;
 93)   D8C7 23          		       INC HL	;
 94)   D8C8 CD 8C C5    		       CALL LDUSTP	;
 95)   D8CB EB          		       EX DE,HL	;
 96)   D8CC C9          		       RET	;
103)   D8CD E5          		       PUSH HL	;
104)   D8CE CD C1 D8    		       CALL UNST2	;
105)   D8D1 EB          		       EX DE,HL	;
106)   D8D2 18 05       		       JR LXPF6	;
108)   D8D4 5E          		XPSHFP: LD E,(HL)      ; PUSHFP called from obj code	; PUSHFP called from obj code
109)   D8D5 23          		       INC HL	;
110)   D8D6 56          		       LD D,(HL)	;
111)   D8D7 23          		       INC HL	;
112)   D8D8 E5          		       PUSH HL	;
113)   D8D9 CD F1 D8    		LXPF6: CALL PUSHFP	;
114)   D8DC C3 F2 C1    		       JP XRUN1D	;
118)   D8DF CD 36 DC    		       CALL GUSTP	;
119)   D8E2 EB          		       EX DE,HL	;
120)   D8E3 21 08 00    		       LD HL,8	;
121)   D8E6 19          		       ADD HL,DE	;
122)   D8E7 CD 8C C5    		       CALL LDUSTP	;
123)   D8EA 2B          		       DEC HL	;
124)   D8EB 7E          		       LD A,(HL)	;
125)   D8EC 2B          		       DEC HL	;
126)   D8ED 6E          		       LD L,(HL)	;
127)   D8EE 67          		       LD H,A	;
128)   D8EF 18 08       		       JR PSHFP8	;
133)   D8F1 D5          		       PUSH DE	;
134)   D8F2 01 06 00    		       LD BC,6	;
135)   D8F5 D7 45       		       DEFW ZINUSS	;
136)   D8F7 D1          		       POP DE	;
137)   D8F8 D8          		       RET C	;
138)   D8F9 EB          		PSHFP8: EX DE,HL	;
139)   D8FA 01 06 00    		       LD BC,6	;
140)   D8FD ED B0       		       LDIR	;
141)   D8FF C9          		       RET	;
145)   D900 01 06 00    		       LD BC,6	;
149)   D903 CD 36 DC    		       CALL GUSTP	;
150)   D906 54          		       LD D,H	;
151)   D907 5D          		       LD E,L	;
152)   D908 09          		       ADD HL,BC	;
153)   D909 C3 8C C5    		       JP LDUSTP	;
158)   D90C E5          		XPSHST: PUSH HL	;
159)   D90D D7 2B       		       DEFW ZUNST2	;
160)   D90F CD 15 D9    		       CALL PUSHST	;
161)   D912 C3 F2 C1    		       JP XRUN1D	;
165)   D915 D7 15       		       DEFW ZMKSTAB	;
166)   D917 C5          		LPSTR1: PUSH BC	;
167)   D918 03          		       INC BC	;
168)   D919 03          		       INC BC	;
169)   D91A E5          		       PUSH HL	;
170)   D91B D7 45       		       DEFW ZINUSS	;
171)   D91D D1          		       POP DE	;
172)   D91E C1          		       POP BC	;
173)   D91F D8          		       RET C	;
174)   D920 71          		       LD (HL),C	;
175)   D921 23          		       INC HL	;
176)   D922 70          		       LD (HL),B	;
177)   D923 23          		       INC HL	;
178)   D924 EB          		       EX DE,HL	;
179)   D925 78          		       LD A,B	;
180)   D926 B1          		       OR C	;
181)   D927 C8          		       RET Z	;
182)   D928 ED B0       		       LDIR	;
183)   D92A C9          		       RET	;
188)   D92B CD 36 DC    		       CALL GUSTP      ;HL=loc(string on stack)	;HL=loc(string on stack)
189)   D92E 4E          		       LD C,(HL)	;
190)   D92F 23          		       INC HL	;
191)   D930 46          		       LD B,(HL)               ;BC=length(string)	;BC=length(string)
192)   D931 23          		       INC HL                  ;HL=loc(str.)	;HL=loc(str.)
193)   D932 09          		       ADD HL,BC               ;HL=loc(var. on stack)	;HL=loc(var. on stack)
194)   D933 5E          		       LD E,(HL)	;
195)   D934 23          		       INC HL	;
196)   D935 56          		       LD D,(HL)               ;DE=loc(var.s.t.entry)+2	;DE=loc(var.s.t.entry)+2
197)   D936 CD 3E D9    		       CALL ASSSTR	;
198)   D939 23          		       INC HL	;
199)   D93A 23          		       INC HL	;
200)   D93B C3 8C C5    		STRA1: JP LDUSTP	;
202)   D93E EB          		ASSSTR: EX DE,HL               ;HL=" " " " " " " " " " "	;HL=" " " " " " " " " " "
203)   D93F E5          		       PUSH HL	;
204)   D940 C5          		       PUSH BC	;
205)   D941 D7 4C       		       DEFW ZMKNULL            ;make destn.null	;make destn.null
206)   D943 C1          		       POP BC	;
207)   D944 E1          		       POP HL	;
208)   D945 79          		       LD A,C	;
209)   D946 B0          		       OR B	;
210)   D947 28 0C       		       JR Z,STRAS1             ;if source null	;if source null
213)   D949 D7 10       		       DEFW ZLDSTR	;
214)   D94B D8          		       RET C	;
217)   D94C CD 36 DC    		       CALL GUSTP              ;NB source string will	;NB source string will
218)   D94F 23          		       INC HL                  ;   have been moved	;   have been moved
219)   D950 23          		       INC HL                  ;   by INSTR	;   by INSTR
220)   D951 ED B0       		       LDIR	;
221)   D953 18 E6       		       JR STRA1	;
224)   D955 CD 36 DC    		       CALL GUSTP	;
225)   D958 23          		       INC HL	;
226)   D959 23          		       INC HL	;
227)   D95A 18 DF       		       JR STRA1	;
232)   D95C E5          		       PUSH HL	;
233)   D95D D7 2F       		       DEFW ZUNSTSS	;
234)   D95F CD 65 D9    		       CALL STCH2	;
235)   D962 C3 F2 C1    		STCH1: JP XRUN1D	;
237)   D965 D5          		STCH2: PUSH DE	;
238)   D966 01 03 00    		       LD BC,3	;
239)   D969 DF 45       		       DEFW WINUSS	;
240)   D96B D1          		       POP DE	;
241)   D96C D8          		       RET C	;
242)   D96D 36 01       		       LD (HL),1	;
243)   D96F 23          		       INC HL	;
244)   D970 36 00       		       LD (HL),0	;
245)   D972 23          		       INC HL	;
246)   D973 73          		       LD (HL),E	;
247)   D974 C9          		       RET	;
252)   D975 06 01       		STRGT: LD B,1	;
253)   D977 3A          		       DEFB 3AH	;
254)   D978 06 05       		STRGE: LD B,5	;
255)   D97A 3A          		       DEFB 3AH	;
256)   D97B 06 02       		STRLT: LD B,2	;
257)   D97D 3A          		       DEFB 3AH	;
258)   D97E 06 06       		STRLE: LD B,6	;
259)   D980 3A          		       DEFB 3AH	;
260)   D981 06 03       		STRNE: LD B,3	;
261)   D983 3A          		       DEFB 3AH	;
262)   D984 06 04       		STREQ: LD B,4	;
267)   D986 E5          		       PUSH HL	;
268)   D987 C5          		       PUSH BC	;
269)   D988 D7 2B       		       DEFW ZUNST2	;
270)   D98A D5          		       PUSH DE         ; addr of 2nd string	; addr of 2nd string
271)   D98B E5          		       PUSH HL         ; length of 2nd string	; length of 2nd string
272)   D98C CD B4 CD    		       CALL DELST2	;
273)   D98F D7 2B       		       DEFW ZUNST2	;
274)   D991 44          		       LD B,H          ;   left opd of comparison)	;   left opd of comparison)
275)   D992 4D          		       LD C,L	;
276)   D993 CD B4 CD    		       CALL DELST2	;
277)   D996 E1          		       POP HL	;
278)   D997 A7          		       AND A	;
279)   D998 ED 42       		       SBC HL,BC	;
280)   D99A 09          		       ADD HL,BC	;
281)   D99B 38 02       		       JR C,LSC3	;
282)   D99D 60          		       LD H,B	;
283)   D99E 69          		       LD L,C	;
284)   D99F C1          		LSC3:  POP BC	;
285)   D9A0 EB          		       EX DE,HL	;
286)   D9A1 F5          		       PUSH AF         ; remember which string is longer	; remember which string is longer
287)   D9A2 7A          		LSC5:  LD A,D	;
288)   D9A3 B3          		       OR E            ; here DE = # chars left, HL ->	; here DE = # chars left, HL ->
289)   D9A4 28 09       		       JR Z,LSC6       ;   left opd, BC -> right opd	;   left opd, BC -> right opd
290)   D9A6 0A          		       LD A,(BC)	;
291)   D9A7 BE          		       CP (HL)	;
292)   D9A8 20 07       		       JR NZ,LSC7	;
293)   D9AA 03          		       INC BC	;
294)   D9AB 23          		       INC HL	;
295)   D9AC 1B          		       DEC DE	;
296)   D9AD 18 F3       		       JR LSC5	;
298)   D9AF F1          		LSC6:  POP AF          ; here if all chars the same:	; here if all chars the same:
299)   D9B0 E5          		       PUSH HL	;
300)   D9B1 E1          		LSC7:  POP HL	;
301)   D9B2 3F          		       CCF             ;compare lengths	;compare lengths
304)   D9B3 C1          		       POP     BC      ;B=REQUIRED CONDITION CODE	;B=REQUIRED CONDITION CODE
305)   D9B4 E7 2E       		       DEFW ZRELBOO	;
306)   D9B6 EB          		       EX DE,HL	;
307)   D9B7 D7 2C       		       DEFW ZPUSHFP	;
308)   D9B9 C3 F2 C1    		LSC8:  JP XRUN1D	;
316)   D9BC E5          		       PUSH HL	;
317)   D9BD D7 2B       		       DEFW ZUNST2	;
318)   D9BF D5          		       PUSH DE	;
319)   D9C0 EB          		       EX DE,HL        ;DE=length of first string	;DE=length of first string
321)   D9C1 19          		       ADD HL,DE       ;HL points to length of second 	;HL points to length of second
322)   D9C2 E5          		       PUSH HL	;
323)   D9C3 4E          		       LD C,(HL)	;
324)   D9C4 23          		       INC HL	;
325)   D9C5 46          		       LD B,(HL)       ;BC=length of second string	;BC=length of second string
326)   D9C6 EB          		       EX DE,HL	;
327)   D9C7 09          		       ADD HL,BC	;
328)   D9C8 EB          		       EX DE,HL        ;DE=length of final string	;DE=length of final string
329)   D9C9 72          		       LD (HL),D	;
330)   D9CA 2B          		       DEC HL	;
331)   D9CB 73          		       LD (HL),E       ;insert new length	;insert new length
332)   D9CC E5          		       PUSH HL	;
333)   D9CD 23          		       INC HL	;
334)   D9CE 23          		       INC HL	;
335)   D9CF 09          		       ADD HL,BC       ;HL=end of 2nd string	;HL=end of 2nd string
336)   D9D0 44          		       LD B,H	;
337)   D9D1 4D          		       LD C,L	;
338)   D9D2 E3          		       EX (SP),HL	;
339)   D9D3 D7 4F       		       DEFW ZRDLN2     ;reverse second string and	;reverse second string and
341)   D9D5 E1          		       POP HL	;
342)   D9D6 C1          		       POP BC	;
343)   D9D7 E3          		       EX (SP),HL	;
344)   D9D8 E5          		       PUSH HL	;
345)   D9D9 D7 4F       		       DEFW ZRDLN2     ;reverse first string	;reverse first string
346)   D9DB E1          		       POP HL	;
347)   D9DC C1          		       POP BC	;
348)   D9DD D7 4F       		       DEFW ZRDLN2     ;reverse answer	;reverse answer
349)   D9DF 18 D8       		       JR LSC8         ;jump to XRUN1D	;jump to XRUN1D
355)   D9E1 46          		XGET:  LD B,(HL)	;
356)   D9E2 23          		       INC HL	;
357)   D9E3 E5          		       PUSH HL	;
358)   D9E4 FD 5E 06    		       LD E,(IY+OUTCON)	;
359)   D9E7 E7 31       		       DEFW ZINPUT	;
360)   D9E9 CB 70       		       BIT 6,B	;
361)   D9EB 5F          		       LD E,A	;
362)   D9EC 16 00       		       LD D,0	;
363)   D9EE 28 08       		       JR Z XGET1	;
364)   D9F0 D4 65 D9    		       CALL NC STCH2	;
365)   D9F3 D4 2B D9    		       CALL NC STRASS	;
366)   D9F6 18 C1       		       JR LSC8	;
368)   D9F8 EF 28       		XGET1: DEFW WFLT	;
369)   D9FA E5          		       PUSH HL	;
370)   D9FB DF 2B       		       DEFW WUNST2	;
371)   D9FD D1          		       POP DE	;
372)   D9FE D4 F9 D8    		       CALL NC PSHFP8	;
373)   DA01 18 B6       		       JR LSC8	;
375)   DA03 E5          		XPUT:  PUSH HL	;
376)   DA04 D7 2F       		       DEFW ZUNSTSS	;
377)   DA06 3E 00       		       LD A,0	;
378)   DA08 9A          		       SBC A,D	;
379)   DA09 3E 62       		       LD A,98	;
380)   DA0B 38 AC       		       JR C LSC8	;
381)   DA0D 7B          		       LD A,E	;
382)   DA0E DF 3C       		       DEFW WPTCHAR	;
383)   DA10 18 A7       		       JR LSC8	;
391)   DA12 D7 2F       		       DEFW ZUNSTSS    ;DE=S.S.	;DE=S.S.
392)   DA14 D8          		       RET C           ;R. IF S-S .LT. 0 OR .GT. 65535	;R. IF S-S .LT. 0 OR .GT. 65535
393)   DA15 D7 2A       		       DEFW ZPOP       ;HL=LOC(BASE(REL))	;HL=LOC(BASE(REL))
394)   DA17 23          		       INC HL	;
395)   DA18 23          		       INC HL	;
396)   DA19 D7 30       		       DEFW ZCHKSS     ;CHECK S.S. IN RANGE	;CHECK S.S. IN RANGE
397)   DA1B 2B          		       DEC HL	;
398)   DA1C 2B          		       DEC HL	;
399)   DA1D D8          		       RET C	;
400)   DA1E 18 48       		       JR MKABS1	;
404)   DA20 CD 00 D9    		       CALL UNST6	;
405)   DA23 EB          		       EX DE,HL	;
406)   DA24 E7 29       		       DEFW ZROUND	;
407)   DA26 3E 06       		       LD A,6	;
408)   DA28 C9          		       RET	;
412)   DA29 FD CB 2A 46 		       BIT 0,(IY+BASFLG)	;
413)   DA2D 28 01       		       JR Z,LCSS2	;
414)   DA2F 1B          		       DEC DE	;
415)   DA30 E5          		LCSS2: PUSH HL	;
416)   DA31 7E          		       LD A,(HL)	;
417)   DA32 23          		       INC HL	;
418)   DA33 66          		       LD H,(HL)	;
419)   DA34 6F          		       LD L,A	;
420)   DA35 37          		       SCF	;
421)   DA36 ED 52       		       SBC HL,DE       ;limit-value-1	;limit-value-1
422)   DA38 E1          		       POP HL	;
423)   DA39 3E 07       		       LD A,7	;
424)   DA3B C9          		       RET	;
429)   DA3C D7 2F       		       DEFW ZUNSTSS	;
430)   DA3E D5          		       PUSH DE         ; 2ND SUBSCRIPT	; 2ND SUBSCRIPT
431)   DA3F DF 2F       		       DEFW WUNSTSS	;
432)   DA41 C1          		       POP BC          ; BC := 2ND SS	; BC := 2ND SS
433)   DA42 D8          		       RET C           ; IF SS < 0 OR > 65535	; IF SS < 0 OR > 65535
434)   DA43 D7 2A       		       DEFW ZPOP       ; HL := BASE(REL)	; HL := BASE(REL)
435)   DA45 E5          		       PUSH HL	;
436)   DA46 23          		       INC HL	;
437)   DA47 23          		       INC HL	;
438)   DA48 D7 30       		       DEFW ZCHKSS     ; 1ST SS IN RANGE	; 1ST SS IN RANGE
439)   DA4A C5          		       PUSH BC	;
440)   DA4B 42          		       LD B,D	;
441)   DA4C 4B          		       LD C,E	;
442)   DA4D D1          		       POP DE          ;DE=2ND S.S.	;DE=2ND S.S.
443)   DA4E 23          		       INC HL	;
444)   DA4F 23          		       INC HL          ;HL=LOC(2ND DIM)	;HL=LOC(2ND DIM)
445)   DA50 DF 30       		       DEFW WCHKSS     ;CHECK 2ND S.S. IN RANGE	;CHECK 2ND S.S. IN RANGE
446)   DA52 E1          		       POP HL          ;HL=LOC(BASE(REL))	;HL=LOC(BASE(REL))
447)   DA53 D8          		       RET C	;
455)   DA54 E5          		       PUSH HL	;
456)   DA55 D5          		       PUSH DE	;
457)   DA56 23          		       INC HL	;
458)   DA57 23          		       INC HL	;
459)   DA58 23          		       INC HL	;
460)   DA59 23          		       INC HL          ;HL=LOC(2ND DIM)	;HL=LOC(2ND DIM)
461)   DA5A 5E          		       LD E,(HL)	;
462)   DA5B 23          		       INC HL	;
463)   DA5C 56          		       LD D,(HL)       ;DE=2ND DIM	;DE=2ND DIM
464)   DA5D E1          		       POP HL          ;HL=2ND S.S.	;HL=2ND S.S.
465)   DA5E 79          		MKAB21: LD A,C	;
466)   DA5F B0          		       OR B	;
467)   DA60 28 04       		       JR Z,MKAB22	;
468)   DA62 19          		       ADD HL,DE	;
469)   DA63 0B          		       DEC BC	;
470)   DA64 18 F8       		       JR MKAB21	;
474)   DA66 EB          		       EX DE,HL        ;DE=DISP	;DE=DISP
475)   DA67 E1          		       POP HL          ;HL=LOC(BASE)	;HL=LOC(BASE)
479)   DA68 4E          		       LD C,(HL)	;
480)   DA69 23          		       INC HL	;
481)   DA6A 46          		       LD B,(HL)	;
482)   DA6B CD 4F C9    		       CALL GSBAS              ;HL=SBAS	;HL=SBAS
483)   DA6E 09          		       ADD HL,BC               ;HL=BASE(ABS.)	;HL=BASE(ABS.)
484)   DA6F 06 06       		       LD B,6	;
485)   DA71 19          		MKAB11: ADD HL,DE	;
486)   DA72 10 FD       		       DJNZ MKAB11	;
488)   DA74 E5          		       PUSH HL	;
489)   DA75 01 02 00    		       LD BC,2	;
490)   DA78 D7 45       		       DEFW ZINUSS	;
491)   DA7A C1          		       POP BC	;
492)   DA7B D8          		       RET C           ;IF NO ROOM	;IF NO ROOM
493)   DA7C 71          		       LD (HL),C	;
494)   DA7D 23          		       INC HL	;
495)   DA7E 70          		       LD (HL),B	;
496)   DA7F C9          		       RET	;
498)   DA80 E5          		XPUSH3: PUSH HL	;
499)   DA81 01 01 00    		       LD BC,1	;
500)   DA84 D7 45       		       DEFW ZINUSS	;
501)   DA86 E1          		       POP HL	;
502)   DA87 D8          		       RET C	;
503)   DA88 5E          		XPUSH2: LD E,(HL)      ; PUSH2 called from obj code	; PUSH2 called from obj code
504)   DA89 23          		       INC HL	;
505)   DA8A 56          		       LD D,(HL)	;
506)   DA8B 23          		       INC HL	;
507)   DA8C E5          		       PUSH HL	;
508)   DA8D EB          		       EX DE,HL	;
509)   DA8E CD 74 DA    		LXP21: CALL PUSH2	;
510)   DA91 C3 F2 C1    		       JP XRUN1D	;
515)   DA94 E5          		       PUSH HL	;
516)   DA95 FD 6E 35    		       LD L,(IY+APAR)	;
517)   DA98 FD 66 36    		       LD H,(IY+APAR+1)	;
518)   DA9B 18 F1       		       JR LXP21	;
150)   DA9D 23          		       INC HL          ;HL -> LNT entry	;HL -> LNT entry
151)   DA9E 23          		       INC HL	;
152)   DA9F 7E          		       LD A,(HL)	;
153)   DAA0 23          		       INC HL	;
154)   DAA1 66          		       LD H,(HL)	;
155)   DAA2 6F          		       LD L,A	;
158)   DAA3 FD 75 09    		       LD (IY+INPTR),L	;
159)   DAA6 FD 74 0A    		       LD (IY+INPTR+1),H	;
160)   DAA9 C9          		       RET	;
163)   DAAA FD 6E 09    		       LD L,(IY+INPTR)	;
164)   DAAD FD 66 0A    		       LD H,(IY+INPTR+1)	;
165)   DAB0 C9          		       RET	;
167)   DAB1 FD CB 22 76 		MKRL:  BIT 6,(IY+FLAGS)	;
168)   DAB5 C8          		       RET Z	;
169)   DAB6 E5          		       PUSH HL	;
170)   DAB7 CD 36 DC    		       CALL GUSTP	;
171)   DABA EB          		       EX DE,HL	;
172)   DABB CD AA DA    		       CALL GINPTR	;
173)   DABE B7          		       OR A	;
174)   DABF ED 52       		       SBC HL,DE	;
175)   DAC1 18 57       		       JR RSL1	;
177)   DAC3 FD CB 22 76 		MKAB:  BIT 6,(IY+FLAGS)	;
178)   DAC7 C8          		       RET Z	;
179)   DAC8 E5          		       PUSH HL	;
180)   DAC9 CD AA DA    		       CALL GINPTR	;
181)   DACC EB          		       EX DE,HL	;
182)   DACD CD 36 DC    		       CALL GUSTP	;
183)   DAD0 19          		       ADD HL,DE	;
184)   DAD1 18 47       		       JR RSL1	;
187)   DAD3 FD 73 07    		       LD (IY+INCON),E	;
188)   DAD6 CD 36 DC    		       CALL GUSTP	;
189)   DAD9 44          		       LD B,H	;
190)   DADA 4D          		       LD C,L	;
191)   DADB E5          		RDLIN1: PUSH HL	;
192)   DADC D5          		       PUSH DE	;
193)   DADD 21 01 00    		       LD HL,1         ;or whatever safe margin 	;or whatever safe margin
194)   DAE0 D7 24       		       DEFW ZNCROOM	;
195)   DAE2 D1          		       POP DE	;
196)   DAE3 DF 6C       		       DEFW WNBKTST    ;check for break	;check for break
197)   DAE5 EF 31       		       DEFW WINPUT     ;input char if OK	;input char if OK
198)   DAE7 E1          		       POP HL	;
199)   DAE8 D8          		       RET C           ;ret if error of any kind	;ret if error of any kind
200)   DAE9 2B          		       DEC HL          ;HL is now where char is to go	;HL is now where char is to go
201)   DAEA CD 8C C5    		       CALL LDUSTP	;
202)   DAED 77          		       LD (HL),A	;
203)   DAEE EE 0D       		       XOR 15Q	;
204)   DAF0 20 E9       		       JR NZ RDLIN1    ;if not CR loop	;if not CR loop
205)   DAF2 CD A3 DA    		       CALL LINPTR     ;set up INPTR	;set up INPTR
206)   DAF5 FD CB 22 F6 		       SET 6,(IY+FLAGS)	;
207)   DAF9 0B          		RDLIN2: DEC BC	;
208)   DAFA B7          		       OR A	;
209)   DAFB ED 42       		       SBC HL,BC       ;finished?	;finished?
210)   DAFD D0          		       RET NC	;
211)   DAFE 09          		       ADD HL,BC       ;restore HL	;restore HL
212)   DAFF 0A          		       LD A,(BC)	;
213)   DB00 56          		       LD D,(HL)       ;do swap	;do swap
214)   DB01 77          		       LD (HL),A	;
215)   DB02 7A          		       LD A,D	;
216)   DB03 02          		       LD (BC),A	;
217)   DB04 23          		       INC HL	;
218)   DB05 18 F2       		       JR RDLIN2       ;loop round	;loop round
221)   DB07 E5          		       PUSH HL	;
222)   DB08 CD AA DA    		       CALL GINPTR	;
223)   DB0B FD 75 0C    		       LD (IY+SVINPT),L	;
224)   DB0E FD 74 0D    		       LD (IY+SVINPT+1),H	;
225)   DB11 E1          		       POP HL	;
226)   DB12 C9          		       RET	;
229)   DB13 E5          		       PUSH HL	;
230)   DB14 FD 6E 0C    		       LD L,(IY+SVINPT)	;
231)   DB17 FD 66 0D    		       LD H,(IY+SVINPT+1)	;
232)   DB1A CD A3 DA    		RSL1:  CALL LINPTR	;
233)   DB1D E1          		       POP HL	;
234)   DB1E C9          		       RET	;
237)   DB1F E5          		       PUSH HL	;
238)   DB20 CD AA DA    		       CALL GINPTR	;
239)   DB23 7E          		       LD A,(HL)	;
240)   DB24 E1          		       POP HL	;
241)   DB25 C9          		       RET	;
244)   DB26 E5          		       PUSH HL	;
245)   DB27 CD AA DA    		       CALL GINPTR	;
246)   DB2A 7E          		       LD A,(HL)	;
247)   DB2B FE 0D       		       CP 15Q	;
248)   DB2D 28 06       		       JR Z RDNC1	;
249)   DB2F 23          		       INC HL	;
250)   DB30 CD A3 DA    		       CALL LINPTR	;
251)   DB33 7E          		       LD A,(HL)	;
252)   DB34 B7          		       OR A	;
253)   DB35 E1          		RDNC1: POP HL	;
254)   DB36 C9          		       RET	;
256)   DB37 CD 1F DB    		RDSCH: CALL RDCH	;
257)   DB3A 18 03       		       JR RDNSC1	;
259)   DB3C CD 26 DB    		RDNSCH: CALL RDNCH	;
260)   DB3F FE 20       		RDNSC1: CP ' '	;
261)   DB41 28 F9       		       JR Z,RDNSCH     ;ignore space	;ignore space
262)   DB43 FE 0A       		       CP 12Q	;
263)   DB45 28 F5       		       JR Z,RDNSCH     ;ignore line feed	;ignore line feed
264)   DB47 A7          		       AND     A	;
265)   DB48 C9          		       RET	;
288)   DB49 AF          		PTMSG: XOR A	;
289)   DB4A FD 77 06    		       LD (IY+OUTCON),A	;
290)   DB4D E1          		       POP     HL	;
291)   DB4E 46          		       LD      B,(HL)	;
292)   DB4F 23          		       INC     HL	;
293)   DB50 38 03       		TEXOT1: JR C TEXOT2	;
294)   DB52 7E          		       LD      A,(HL)	;
295)   DB53 DF 3C       		       DEFW WPTCHAR	;
296)   DB55 23          		TEXOT2: INC    HL	;
297)   DB56 10 F8       		       DJNZ    TEXOT1	;
298)   DB58 E9          		       JP (HL)	;
302)   DB59 3E 04       		       LD A,4	;
303)   DB5B D7 3C       		       DEFW ZPTCHAR	;
304)   DB5D D8          		       RET C	;
306)   DB5E 3E 0D       		       LD A,15Q	;
308)   DB60 D5          		       PUSH DE	;
309)   DB61 FD 5E 06    		       LD E,(IY+OUTCON)	;
310)   DB64 E7 30       		       DEFW ZOUTPUT	;
311)   DB66 D1          		       POP DE	;
312)   DB67 C9          		       RET	;
327)   DB68 B7          		NBKTST: OR A	;
328)   DB69 FD CB 22 4E 		       BIT 1,(IY+FLAGS)	;
329)   DB6D C0          		       RET NZ	;
330)   DB6E E7 36       		       DEFW ZBRKTST	;
331)   DB70 D0          		       RET NC	;
332)   DB71 FD 77 08    		       LD (IY+ERRNO),A	;
333)   DB74 AF          		XSTOP: XOR A	;
334)   DB75 37          		       SCF	;
335)   DB76 C9          		       RET	;
337)   DB77 E5          		UPDLNT: PUSH HL	;
338)   DB78 D5          		       PUSH DE	;
339)   DB79 5E          		       LD E,(HL)	;
340)   DB7A 23          		       INC HL	;
341)   DB7B 56          		       LD D,(HL)	;
342)   DB7C CD 3D DC    		       CALL GOTOP	;
343)   DB7F B7          		       OR A	;
344)   DB80 ED 52       		       SBC HL,DE	;
345)   DB82 EB          		       EX DE,HL	;
346)   DB83 D1          		       POP DE	;
347)   DB84 38 0E       		       JR C UPDL8	;
348)   DB86 ED 52       		       SBC HL,DE	;
349)   DB88 38 0A       		       JR C UPDL8	;
350)   DB8A 19          		       ADD HL,DE	;
351)   DB8B 09          		       ADD HL,BC	;
352)   DB8C EB          		       EX DE,HL	;
353)   DB8D E3          		       EX (SP),HL	;
354)   DB8E 73          		       LD (HL),E	;
355)   DB8F 23          		       INC HL	;
356)   DB90 72          		       LD (HL),D	;
357)   DB91 23          		       INC HL	;
358)   DB92 D1          		       POP DE	;
359)   DB93 C9          		       RET	;
361)   DB94 E1          		UPDL8: POP HL	;
362)   DB95 23          		       INC HL	;
363)   DB96 23          		       INC HL	;
364)   DB97 C9          		       RET	;
366)   DB98 E5          		MKSPC: PUSH HL	;
367)   DB99 D5          		       PUSH DE	;
368)   DB9A C5          		       PUSH BC	;
369)   DB9B 60          		       LD H,B	;
370)   DB9C 69          		       LD L,C	;
371)   DB9D D7 23       		       DEFW ZCHROOM	;
372)   DB9F 38 2C       		       JR C MKL1	;
373)   DBA1 C5          		       PUSH BC	;
374)   DBA2 CD E3 DB    		       CALL GSBRAM	;
375)   DBA5 2B          		       DEC HL	;
376)   DBA6 EB          		       EX DE,HL	;
377)   DBA7 E1          		       POP HL	;
378)   DBA8 E5          		       PUSH HL	;
379)   DBA9 19          		       ADD HL,DE	;
380)   DBAA EB          		       EX DE,HL	;
381)   DBAB ED B8       		       LDDR	;
382)   DBAD C1          		MKL2:  POP BC	;
383)   DBAE FD E5       		       PUSH IY	;
384)   DBB0 FD 09       		       ADD IY,BC	;
385)   DBB2 CD 2F DC    		       CALL GLBAS	;
386)   DBB5 D7 65       		MKL3:  DEFW ZLLN2	;
387)   DBB7 D1          		       POP DE	;
388)   DBB8 38 09       		       JR C MKL4	;
389)   DBBA 23          		       INC HL	;
390)   DBBB 23          		       INC HL	;
391)   DBBC D7 6D       		       DEFW ZUPDLNT	;
392)   DBBE D7 6D       		       DEFW ZUPDLNT	;
393)   DBC0 D5          		       PUSH DE	;
394)   DBC1 18 F2       		       JR MKL3	;
395)   DBC3 21 0E 00    		MKL4:  LD HL,STOP	;
396)   DBC6 19          		       ADD HL,DE	;
397)   DBC7 09          		       ADD HL,BC	;
398)   DBC8 D7 6D       		       DEFW ZUPDLNT	;
399)   DBCA D7 6D       		       DEFW ZUPDLNT	;
400)   DBCC B7          		       OR A	;
401)   DBCD C1          		MKL1:  POP BC	;
402)   DBCE D1          		       POP DE	;
403)   DBCF E1          		       POP HL	;
404)   DBD0 C9          		       RET	;
406)   DBD1 E5          		RETSPC: PUSH HL	;
407)   DBD2 D5          		       PUSH DE	;
408)   DBD3 C5          		       PUSH BC	;
409)   DBD4 CD BA DC    		       CALL NEGBC	;
410)   DBD7 C5          		       PUSH BC	;
411)   DBD8 CD E3 DB    		       CALL GSBRAM	;
412)   DBDB E1          		       POP HL	;
413)   DBDC E5          		       PUSH HL	;
414)   DBDD 19          		       ADD HL,DE	;
415)   DBDE EB          		       EX DE,HL	;
416)   DBDF ED B0       		       LDIR	;
417)   DBE1 18 CA       		       JR MKL2	;
419)   DBE3 CD 3D DC    		GSBRAM: CALL GOTOP	;
420)   DBE6 FD E5       		       PUSH IY	;
421)   DBE8 D1          		       POP DE	;
422)   DBE9 E5          		       PUSH HL	;
423)   DBEA B7          		       OR A	;
424)   DBEB ED 52       		       SBC HL,DE	;
425)   DBED E3          		       EX (SP),HL	;
426)   DBEE C1          		       POP BC	;
427)   DBEF C9          		       RET	;
446)   DBF0 D6 30       		       SUB     030H	;
447)   DBF2 D8          		       RET C	;
448)   DBF3 FE 0A       		       CP      10	;
449)   DBF5 3F          		       CCF	;
450)   DBF6 C9          		       RET	;
452)   DBF7 D7 38       		CHECK: DEFW ZRDSCH     ;Chris's bit	;Chris's bit
453)   DBF9 B8          		       CP B	;
454)   DBFA 18 2D       		       JR CHKL1	;
457)   DBFC C5          		       PUSH BC	;
458)   DBFD 01 35 0D    		       LD BC,0DH*256+53	;
459)   DC00 18 22       		       JR CHK	;
462)   DC02 C5          		       PUSH    BC	;
463)   DC03 01 39 29    		       LD      BC,')'*256+57	;
464)   DC06 18 1C       		       JR      CHK-$	;
467)   DC08 C5          		       PUSH    BC	;
468)   DC09 01 34 2C    		       LD      BC,02CH*256+52	;
469)   DC0C 18 16       		       JR      CHK-$	;
471)   DC0E C5          		CHKEQ: PUSH    BC	;
472)   DC0F 01 37 8C    		       LD      BC,TEQ.SHL.8+55	;
473)   DC12 18 10       		       JR      CHK	;
476)   DC14 C5          		       PUSH    BC	;
477)   DC15 01 36 B3    		       LD      BC,THASH.SHL.8+54	;
478)   DC18 18 0A       		       JR      CHK-$	;
481)   DC1A C5          		       PUSH    BC	;
482)   DC1B 01 32 22    		       LD      BC,022H*256+50	;
483)   DC1E 18 04       		       JR      CHK-$	;
486)   DC20 C5          		       PUSH    BC	;
487)   DC21 01 38 28    		       LD      BC,'('*256+56	;
490)   DC24 D7 38       		       DEFW ZRDSCH	;
491)   DC26 B8          		       CP      B	;
492)   DC27 79          		       LD      A,C	;
493)   DC28 C1          		       POP     BC	;
494)   DC29 37          		CHKL1: SCF	;
495)   DC2A C0          		       RET     NZ	;
496)   DC2B D7 34       		       DEFW ZRDNCH	;
497)   DC2D C9          		       RET	;
527)   DC2E EB          		EXGLB: EX DE,HL	;
528)   DC2F FD 6E 1E    		GLBAS: LD L,(IY+LBAS)	;
529)   DC32 FD 66 1F    		       LD H,(IY+LBAS+1)	;
530)   DC35 C9          		       RET	;
532)   DC36 FD 6E 12    		GUSTP: LD L,(IY+USRSTP)	;
533)   DC39 FD 66 13    		       LD H,(IY+USRSTP+1)	;
534)   DC3C C9          		       RET	;
536)   DC3D FD 66 11    		GOTOP: LD H,(IY+OTOP+1)	;
537)   DC40 FD 6E 10    		       LD L,(IY+OTOP)	;
538)   DC43 C9          		       RET	;
542)   DC44 01 08 00    		       LD BC,8	;
543)   DC47 1E 1C       		       LD E,SBAS	;
544)   DC49 18 1B       		       JR DELT	;
548)   DC4B 60          		       LD H,B	;
549)   DC4C 69          		       LD L,C	;
550)   DC4D CD 2C D8    		       CALL CHROOM	;
551)   DC50 D8          		       RET C	;
552)   DC51 CD 36 DC    		       CALL GUSTP	;
553)   DC54 CD BA DC    		       CALL NEGBC	;
554)   DC57 09          		       ADD HL,BC	;
555)   DC58 CD 8C C5    		       CALL LDUSTP	;
556)   DC5B 54          		       LD D,H	;
557)   DC5C 5D          		       LD E,L	;
558)   DC5D B7          		       OR A	;
559)   DC5E C9          		       RET	;
561)   DC5F CD B0 DC    		INSS:  CALL GETS	;
562)   DC62 18 02       		       JR DELT	;
565)   DC64 1E 12       		       LD E,USRSTP	;
575)   DC66 D5          		       PUSH    DE	;
576)   DC67 E5          		       PUSH    HL	;
577)   DC68 78          		       LD      A,B	;
578)   DC69 17          		       RLA	;
579)   DC6A 30 0B       		       JR      NC,LDEL3        ;IF DELETING	;IF DELETING
580)   DC6C AF          		       XOR     A               ;ELSE CHECK ENOUGH ROOM	;ELSE CHECK ENOUGH ROOM
581)   DC6D 67          		       LD      H,A	;
582)   DC6E 6F          		       LD      L,A	;
583)   DC6F ED 42       		       SBC     HL,BC	;
584)   DC71 D7 23       		       DEFW ZCHROOM	;
585)   DC73 E1          		       POP     HL	;
586)   DC74 38 38       		       JR      C,LDEL8 	;
587)   DC76 E5          		       PUSH    HL	;
588)   DC77 FD 56 13    		LDEL3: LD      D,(IY+USRSTP+1) ;HERE WITH CARRY CLEAR IF	;HERE WITH CARRY CLEAR IF
589)   DC7A FD 5E 12    		       LD      E,(IY+USRSTP)   ;  OK TO PROCEED	;  OK TO PROCEED
590)   DC7D ED 52       		       SBC     HL,DE	;
591)   DC7F 28 17       		       JR Z,LDEL52             ;IF NOTHING TO MOVE	;IF NOTHING TO MOVE
592)   DC81 C5          		       PUSH BC                 ;SAVE BC	;SAVE BC
593)   DC82 C5          		       PUSH BC	;
594)   DC83 E3          		       EX (SP),HL              ;SWAP BC AND HL	;SWAP BC AND HL
595)   DC84 C1          		       POP BC	;
596)   DC85 CB 7C       		       BIT 7,H	;
597)   DC87 20 0A       		       JR      NZ,LDEL4	;
598)   DC89 EB          		       EX      DE,HL           ;HERE IF DELETING	;HERE IF DELETING
599)   DC8A 09          		       ADD     HL,BC           ;COPY FROM TOP DOWNWARDS	;COPY FROM TOP DOWNWARDS
600)   DC8B 2B          		       DEC     HL	;
601)   DC8C EB          		       EX      DE,HL	;
602)   DC8D 19          		       ADD     HL,DE	;
603)   DC8E EB          		       EX      DE,HL	;
604)   DC8F ED B8       		       LDDR	;
605)   DC91 18 04       		       JR      LDEL5	;
607)   DC93 19          		LDEL4: ADD     HL,DE           ;HERE IF INSERTING	;HERE IF INSERTING
608)   DC94 EB          		       EX      DE,HL	;
609)   DC95 ED B0       		       LDIR	;
610)   DC97 C1          		LDEL5: POP     BC	;
611)   DC98 E1          		LDEL52: POP    HL	;
612)   DC99 09          		       ADD     HL,BC	;
613)   DC9A D1          		       POP     DE	;
614)   DC9B FD E5       		       PUSH    IY      ;NOW ADD BC TO EACH POINTER	;NOW ADD BC TO EACH POINTER
615)   DC9D E3          		       EX      (SP),HL	;
616)   DC9E 16 00       		       LD      D,0	;
617)   DCA0 19          		       ADD     HL,DE   ;HL->1ST PTR TO MOVE	;HL->1ST PTR TO MOVE
618)   DCA1 7B          		       LD      A,E	;
619)   DCA2 D6 10       		       SUB     USRSTP-2        ;NB. CLEARS CY	;NB. CLEARS CY
620)   DCA4 1F          		       RRA                     ;A:=#PTRS TO MOVE	;A:=#PTRS TO MOVE
621)   DCA5 CD C2 DC    		LDEL6: CALL UP@HL	;
622)   DCA8 2B          		       DEC     HL	;
623)   DCA9 2B          		       DEC     HL	;
624)   DCAA D6 01       		       SUB     1               ;CLEARS CY	;CLEARS CY
625)   DCAC 20 F7       		       JR      NZ,LDEL6	;
626)   DCAE E1          		LDEL8: POP     HL	;
627)   DCAF C9          		       RET	;
632)   DCB0 FD E5       		       PUSH    IY	;
633)   DCB2 E1          		       POP     HL	;
634)   DCB3 16 00       		       LD      D,0	;
635)   DCB5 19          		       ADD     HL,DE	;
636)   DCB6 7E          		       LD      A,(HL)	;
637)   DCB7 23          		       INC     HL	;
638)   DCB8 66          		       LD      H,(HL)	;
639)   DCB9 6F          		       LD      L,A	;
641)   DCBA 0B          		       DEC BC	;
643)   DCBB 79          		       LD      A,C	;
644)   DCBC 2F          		       CPL	;
645)   DCBD 4F          		       LD      C,A	;
646)   DCBE 78          		       LD      A,B	;
647)   DCBF 2F          		       CPL	;
648)   DCC0 47          		       LD      B,A	;
649)   DCC1 C9          		       RET	;
654)   DCC2 5E          		       LD E,(HL)	;
655)   DCC3 23          		       INC HL	;
656)   DCC4 56          		       LD D,(HL)	;
657)   DCC5 EB          		UPDE:  EX DE,HL        ;Add BC to DE and store	;Add BC to DE and store
658)   DCC6 09          		       ADD HL,BC       ;result at (HL),(HL-1)	;result at (HL),(HL-1)
659)   DCC7 EB          		       EX DE,HL	;
660)   DCC8 72          		       LD (HL),D	;
661)   DCC9 2B          		       DEC HL	;
662)   DCCA 73          		       LD (HL),E	;
663)   DCCB C9          		       RET	;
 48)   DCCC 80 03       		@MONOP: DEFB 80H,3             ;# ENTRIES	;# ENTRIES
 49)   DCCE 02 40       		       DEFW  (4*4096)+2	;
 51)   DCD0 00 90       		       DEFW  (9.SHL.12)+0	;
 53)   DCD2 01 90       		       DEFW  (9.SHL.12)+1	;
 57)   DCD4 81 0E       		@DIOP: DEFB  81H,14    ;# ENTRIES	;# ENTRIES
 58)   DCD6 03 6C       		       DEFW  (6*4096)+BIT11+BIT10+(0*64)+3	;
 60)   DCD8 C4 67       		       DEFW  (6*4096)+(ERROR*64)+4	;
 62)   DCDA C5 77       		       DEFW  (7*4096)+(ERROR*64)+5	;
 64)   DCDC C6 77       		       DEFW  (7*4096)+(ERROR*64)+6	;
 66)   DCDE C7 87       		       DEFW  (8.SHL.12)+(ERROR*64)+7	;
 68)   DCE0 1F 6C       		       DEFW  (6*4096)+BIT11+BIT10+(0*64)+ERROR	;
 70)   DCE2 C8 37       		       DEFW  (3*4096)+(ERROR*64)+8	;
 72)   DCE4 C9 27       		       DEFW  (2*4096)+(ERROR*64)+9	;
 74)   DCE6 0D 55       		       DEFW    (5*4096)+BIT10+(4*64)+13	;
 76)   DCE8 4E 55       		       DEFW    (5*4096)+BIT10+(5*64)+14	;
 78)   DCEA 8F 55       		       DEFW    (5*4096)+BIT10+(6*64)+15	;
 80)   DCEC 4A 54       		       DEFW  (5*4096)+BIT10+(1*64)+10	;
 82)   DCEE 8B 54       		       DEFW  (5*4096)+BIT10+(2*64)+11	;
 84)   DCF0 CC 54       		       DEFW  (5*4096)+BIT10+(3*64)+12	;
105)   DCF2 8F 1B       		       DEFB 80H+15,27  ;# ENTRIES	;# ENTRIES
109)   DCF4 00 08       		       DEFW    AFB0	;
111)   DCF6 01 08       		       DEFW    AFB0+1	;
113)   DCF8 02 08       		       DEFW    AFB0+2	;
117)   DCFA 43 09       		       DEFW    AFB1	;
119)   DCFC 44 09       		       DEFW    AFB1+1	;
121)   DCFE 45 09       		       DEFW    AFB1+2	;
123)   DD00 46 09       		       DEFW    AFB1+3	;
125)   DD02 47 09       		       DEFW    AFB1+4	;
127)   DD04 48 09       		       DEFW    AFB1+5	;
129)   DD06 49 09       		       DEFW    AFB1+6	;
131)   DD08 4A 09       		       DEFW    AFB1+7	;
133)   DD0A 4B 09       		       DEFW    AFB1+8	;
135)   DD0C 4C 09       		       DEFW    AFB1+9	;
141)   DD0E 04 08       		       DEFW AFB+4	;
143)   DD10 05 08       		       DEFW AFB+5	;
151)   DD12 82 0B       		       DEFW    AFBS+YASC	;
153)   DD14 83 0B       		       DEFW    AFBS+YASC+1	;
155)   DD16 84 0B       		       DEFW    AFBS+YASC+2	;
157)   DD18 85 0B       		       DEFW    AFBS+YASC+3	;
161)   DD1A 4D 09       		       DEFW AFBA	;
163)   DD1C 4E 09       		       DEFW AFBA+1	;
165)   DD1E 4F 09       		       DEFW    AFBA+2	;
173)   DD20 A0 08       		       DEFW BIT11+YERRNO	;
175)   DD22 A7 0A       		       DEFW BIT11+BIT9+YINSTR	;
177)   DD24 A2 08       		       DEFW BIT11+YERRLIN	;
179)   DD26 A5 08       		       DEFW BIT11+YTOP	;
181)   DD28 A6 08       		       DEFW BIT11+YFREE	;
193)   DD2A AA 06       		       DEFB 80H+42,6           ;# ENTRIES	;# ENTRIES
195)   DD2C F2 4B       		       DEFW SFBA+BIT8+BIT9+YSTCHR	;
197)   DD2E 88 49       		       DEFW    SFBA+BIT8+YSTSTR	;
199)   DD30 89 4A       		       DEFW    SFBA+BIT9+YRIGHT	;
201)   DD32 00 48       		       DEFW SFBA+0     ;this has a dummy Y-code	;this has a dummy Y-code
203)   DD34 A1 4A       		       DEFW SFBA+BIT9+YLEFT	;
205)   DD36 A9 4A       		       DEFW SFBA+BIT9+YMID	;
209)   DD38 80 2D       		KWDLIS: DEFB 80H,45	;
210)   DD3A 59 CA       		       DEFW CLET	;
212)   DD3C 48 CB       		       DEFW CLIST	;
214)   DD3E 80 CA       		       DEFW CNEW	;
216)   DD40 B6 C4       		       DEFW CPRINT	;
218)   DD42 71 CA       		       DEFW CRUN	;
220)   DD44 AD C3       		       DEFW CGOTO	;
221)   DD46 AD C3       		       DEFW CGOTO	;
223)   DD48 AA C3       		       DEFW CGOSUB	;
224)   DD4A AA C3       		       DEFW CGOSUB	;
226)   DD4C B6 C3       		       DEFW CIF	;
228)   DD4E 99 CA       		       DEFW CINPUT	;
230)   DD50 27 C7       		       DEFW CFOR	;
232)   DD52 A8 C7       		       DEFW CNEXT	;
234)   DD54 7D CA       		       DEFW CRETN	;
236)   DD56 0C C3       		       DEFW CREM	;
238)   DD58 74 CA       		       DEFW CEND	;
240)   DD5A 83 CA       		       DEFW CSTOP	;
242)   DD5C A0 C8       		       DEFW CDIM	;
244)   DD5E F6 CA       		       DEFW CNON	;
246)   DD60 F0 C2       		       DEFW COPT	;
248)   DD62 D1 CA       		       DEFW CSAVE	;
250)   DD64 D6 CA       		       DEFW CLOAD	;
252)   DD66 6E CA       		       DEFW CRAND	;
254)   DD68 7E CB       		       DEFW COPEN	;
256)   DD6A 47 CA       		       DEFW CCLOSE	;
258)   DD6C B6 C4       		       DEFW CPRINT	;
259)   DD6E 7D CA       		       DEFW CRETN	;
261)   DD70 37 CB       		       DEFW    CREST	;
263)   DD72 A0 CA       		       DEFW    CREAD	;
265)   DD74 0C C3       		       DEFW    CREM    ;Data line executes same as Rem	;Data line executes same as Rem
266)   DD76 4D CA       		       DEFW    CPOKE	;
268)   DD78 16 CC       		       DEFW    CUSR	;
270)   DD7A 7A CA       		       DEFW    CCONT	;
272)   DD7C 18 CE       		       DEFW    CDEF	;
274)   DD7E 54 D0       		       DEFW    CCLEAR	;
276)   DD80 C7 CA       		       DEFW CMERGE	;
278)   DD82 CC CA       		       DEFW CVERIF	;
280)   DD84 90 C8       		       DEFW CGET	;
282)   DD86 9F C3       		       DEFW CRESU	;
284)   DD88 56 CB       		       DEFW CDELET	;
286)   DD8A 78 C8       		       DEFW CPUT	;
288)   DD8C 8A CA       		       DEFW CLINP	;
290)   DD8E 77 CA       		       DEFW CREPORT	;
292)   DD90 7A CA       		       DEFW CCONT	;
293)   DD92 55 CA       		       DEFW CRESER	;
 17)   DD94 CD D8       		       DEFW XDEREF	;
 21)   DD96 94 C3       		       DEFW XRUN	;
 25)   DD98 6A C3       		       DEFW XGOTO	;
 29)   DD9A 49 C3       		       DEFW XGOSUB	;
 33)   DD9C 76 C3       		       DEFW XRET	;
 37)   DD9E 21 C8       		       DEFW XIF	;
 41)   DDA0 DF C3       		       DEFW XON	;
 45)   DDA2 11 C4       		       DEFW XLIST	;
 49)   DDA4 2B D9       		       DEFW STRASS	;
 53)   DDA6 DF D8       		       DEFW NUMASS	;
 57)   DDA8 58 C6       		       DEFW XSTICN	;
 61)   DDAA 57 C5       		       DEFW XSTOCN	;
 65)   DDAC 62 C5       		       DEFW XSTDFO	;
 69)   DDAE 09 C4       		       DEFW XLISTN	;
 73)   DDB0 DD C5       		       DEFW XPTAB	;
 77)   DDB2 7F C5       		       DEFW XPSTR	;
 81)   DDB4 6A C5       		       DEFW XPFFF	;
 85)   DDB6 BA C5       		       DEFW XPCOM	;
 89)   DDB8 5E DB       		       DEFW PTNL	;
 93)   DDBA 62 C6       		       DEFW XQSTR	;
 97)   DDBC 6B C6       		       DEFW XQDEF	;
101)   DDBE 9F C6       		       DEFW XNUMIN	;
105)   DDC0 B4 C6       		       DEFW XSTRIN	;
109)   DDC2 81 C6       		       DEFW XSEP	;
113)   DDC4 B0 C7       		       DEFW XFOR1	;
117)   DDC6 BB C7       		       DEFW XFOR2	;
121)   DDC8 88 DA       		       DEFW XPUSH2	;
125)   DDCA 3C C8       		       DEFW XNEXT	;
129)   DDCC 56 C9       		       DEFW XRAND	;
133)   DDCE 70 C9       		       DEFW XSAVEH	;
137)   DDD0 8D C9       		       DEFW XSAVEF	;
141)   DDD2 B8 C9       		       DEFW XLOADH	;
145)   DDD4 B0 C9       		       DEFW XLOADF	;
149)   DDD6 E9 C9       		       DEFW XOPEN	;
153)   DDD8 A0 C9       		       DEFW XCLOSE	;
157)   DDDA 74 DB       		       DEFW XSTOP	;
161)   DDDC E5 C9       		       DEFW XEND	;
165)   DDDE 4E C9       		       DEFW XREM	;
169)   DDE0 D2 C9       		       DEFW XNEW	;
173)   DDE2 BC D9       		       DEFW STRADD             ;STRING CONCATENATE	;STRING CONCATENATE
180)   DDE4 84 D9       		       DEFW STREQ              ;STRING RELATIONS	;STRING RELATIONS
181)   DDE6 75 D9       		       DEFW STRGT	;
182)   DDE8 7B D9       		       DEFW STRLT	;
183)   DDEA 81 D9       		       DEFW STRNE	;
184)   DDEC 7E D9       		       DEFW STRLE	;
185)   DDEE 78 D9       		       DEFW STRGE	;
189)   DDF0 7A C6       		       DEFW XENDIN     ; CHECK FOR NL AT END OF I/P	; CHECK FOR NL AT END OF I/P
193)   DDF2 D9 C1       		       DEFW XAR1AD             ;PUSH VALUE OF 1D ELEMENT	;PUSH VALUE OF 1D ELEMENT
197)   DDF4 D3 C1       		       DEFW XAR2AD             ;PUSH VALUE OF 2D ELEMENT	;PUSH VALUE OF 2D ELEMENT
201)   DDF6 D4 D8       		       DEFW XPSHFP             ;PUSH VALUE @ NEXT 2 	;PUSH VALUE @ NEXT 2
206)   DDF8 5C D9       		       DEFW XSTCHRS             ;CONVERT VALUE TO STRING	;CONVERT VALUE TO STRING
210)   DDFA 0C D9       		       DEFW XPSHST             ;PUSH STRING @ NEXT 2	;PUSH STRING @ NEXT 2
214)   DDFC D7 C3       		       DEFW XONSUB	;
218)   DDFE CB C8       		       DEFW XDIMX	;
229)   DE00 64 C3       		       DEFW XRESU1	;
233)   DE02 03 DA       		       DEFW XPUT	;
237)   DE04 47 CD       		       DEFW    XASC    ;string parameters	;string parameters
241)   DE06 64 CD       		       DEFW    XLEN	;
245)   DE08 6A CD       		       DEFW    XVAL	;
249)   DE0A 74 CD       		       DEFW    XNUM	;
253)   DE0C E1 D9       		       DEFW    XGET	;
257)   DE0E 41 C6       		       DEFW    XLINP	;
261)   DE10 9D CD       		       DEFW    XSTSTRS	;
265)   DE12 CB CD       		       DEFW    XRIGHT	;
269)   DE14 CA CC       		       DEFW    XREST	;
273)   DE16 07 CC       		       DEFW    XPOKE	;
277)   DE18 30 CC       		       DEFW    XUSR	;
281)   DE1A D4 CB       		       DEFW    XCONT	;
285)   DE1C 4E CC       		       DEFW    XBEGRD	;
289)   DE1E 94 CC       		       DEFW    XENDRD	;
293)   DE20 B9 CC       		       DEFW    XSEPRD	;
297)   DE22 AB D7       		       DEFW XCLEA2	;
301)   DE24 5E C3       		       DEFW XRESU	;
305)   DE26 94 DA       		       DEFW XAATOF	;
309)   DE28 26 CF       		       DEFW XNUFN	;
313)   DE2A 5D D5       		       DEFW INITST	;
317)   DE2C 21 CF       		       DEFW XNOFN	;
321)   DE2E FC CE       		       DEFW XSTFN	;
325)   DE30 7D CF       		       DEFW XERR	;
329)   DE32 87 CF       		       DEFW XBRK	;
333)   DE34 EB D1       		       DEFW XMERGE	;
337)   DE36 7D C9       		       DEFW XMERGF	;
341)   DE38 95 CF       		       DEFW XVERIF	;
345)   DE3A 85 C9       		       DEFW XVERFF	;
349)   DE3C F8 D1       		       DEFW XDELET	;
353)   DE3E 80 DA       		       DEFW XPUSH3	;
357)   DE40 31 CD       		       DEFW XERRNO	;
361)   DE42 C6 CD       		       DEFW XLEFT	;
365)   DE44 37 CD       		       DEFW XERRLIN	;
369)   DE46 F4 CB       		       DEFW XREPORT	;
373)   DE48 DE D1       		       DEFW XRESER	;
377)   DE4A 40 CD       		       DEFW XTOP	;
381)   DE4C 29 CD       		       DEFW XFREE	;
385)   DE4E D8 CC       		       DEFW XINSTR	;
389)   DE50 E5 CC       		       DEFW XINST1	;
393)   DE52 DE CD       		       DEFW XMID	;
397)   DE54 D9 CD       		       DEFW XMID1	;
 13)   DE56 80          		KWDS:  DEFB 80H        ;base of tokens	;base of tokens
 14)   DE57 2D          		       DEFB 45 ;size of list	;size of list
 16)   DE58 4C 45       		       DEFM 'LE'	;
 17)   DE5A D4          		       DEFB 'T'+80H	;
 19)   DE5B 4C 49 53    		       DEFM 'LIS'	;
 20)   DE5E D4          		       DEFB 'T'+80H	;
 22)   DE5F 4E 45       		       DEFM 'NE'	;
 23)   DE61 D7          		       DEFB 'W'+80H	;
 25)   DE62 50 52 49 4E 		       DEFM 'PRIN'	;
 26)   DE66 D4          		       DEFB 'T'+80H	;
 28)   DE67 52 55       		       DEFM 'RU'	;
 29)   DE69 CE          		       DEFB 'N'+80H	;
 31)   DE6A 47 4F 54    		       DEFM 'GOT'	;
 32)   DE6D CF          		       DEFB 'O'+80H	;
 34)   DE6E 47 4F 20 54 		       DEFM 'GO T'	;
 35)   DE72 CF          		       DEFB 'O'+80H	;
 37)   DE73 47 4F 53 55 		       DEFM 'GOSU'	;
 38)   DE77 C2          		       DEFB 'B'+80H	;
 40)   DE78 47 4F 20 53 		       DEFM 'GO SU'	;
 40)   DE7C 55          		       DEFM 'GO SU'	;
 41)   DE7D C2          		       DEFB 'B'+80H	;
 43)   DE7E 49          		       DEFM 'I'	;
 44)   DE7F C6          		       DEFB 'F'+80H	;
 46)   DE80 49 4E 50 55 		       DEFM 'INPU'	;
 47)   DE84 D4          		       DEFB 'T'+80H	;
 49)   DE85 46 4F       		       DEFM 'FO'	;
 50)   DE87 D2          		       DEFB 'R'+80H	;
 52)   DE88 4E 45 58    		       DEFM 'NEX'	;
 53)   DE8B D4          		       DEFB 'T'+80H	;
 55)   DE8C 52 45 54 55 		       DEFM 'RETUR'	;
 55)   DE90 52          		       DEFM 'RETUR'	;
 56)   DE91 CE          		       DEFB 'N'+80H	;
 58)   DE92 52 45       		       DEFM 'RE'	;
 59)   DE94 CD          		       DEFB 'M'+80H	;
 61)   DE95 45 4E       		       DEFM 'EN'	;
 62)   DE97 C4          		       DEFB 'D'+80H	;
 64)   DE98 53 54 4F    		       DEFM 'STO'	;
 65)   DE9B D0          		       DEFB 'P'+80H	;
 67)   DE9C 44 49       		       DEFM 'DI'	;
 68)   DE9E CD          		       DEFB 'M'+80H	;
 70)   DE9F 4F          		       DEFM 'O'	;
 71)   DEA0 CE          		       DEFB 'N'+80H	;
 73)   DEA1 4F 50 54 49 		       DEFM 'OPTIO'	;
 73)   DEA5 4F          		       DEFM 'OPTIO'	;
 74)   DEA6 CE          		       DEFB 'N'+80H	;
 76)   DEA7 53 41 56    		       DEFM 'SAV'	;
 77)   DEAA C5          		       DEFB 'E'+80H	;
 79)   DEAB 4C 4F 41    		       DEFM 'LOA'	;
 80)   DEAE C4          		       DEFB 'D'+80H	;
 82)   DEAF 52 41 4E 44 		       DEFM 'RANDOMIZ'	;
 82)   DEB3 4F 4D 49 5A 		       DEFM 'RANDOMIZ'	;
 83)   DEB7 C5          		       DEFB 'E'+80H	;
 85)   DEB8 4F 50 45    		       DEFM 'OPE'	;
 86)   DEBB CE          		       DEFB 'N'+80H	;
 88)   DEBC 43 4C 4F 53 		       DEFM 'CLOS'	;
 89)   DEC0 C5          		       DEFB 'E'+80H	;
 91)   DEC1 BF          		       DEFB '?'+80H	;
 93)   DEC2 52 45       		       DEFM 'RE'	;
 94)   DEC4 D4          		       DEFB 'T'+80H	;
 96)   DEC5 52 45 53 54 		       DEFM    'RESTOR'	;
 96)   DEC9 4F 52       		       DEFM    'RESTOR'	;
 97)   DECB C5          		       DEFB 'E'+80H	;
 99)   DECC 52 45 41    		       DEFM    'REA'	;
100)   DECF C4          		       DEFB 'D'+80H	;
102)   DED0 44 41 54    		       DEFM    'DAT'	;
103)   DED3 C1          		       DEFB 'A'+80H	;
105)   DED4 50 4F 4B    		       DEFM    'POK'	;
106)   DED7 C5          		       DEFB 'E'+80H	;
108)   DED8 43 41 4C    		       DEFM    'CAL'	;
109)   DEDB CC          		       DEFB 'L'+80H	;
111)   DEDC 43 4F 4E 54 		       DEFM    'CONTINU'	;
111)   DEE0 49 4E 55    		       DEFM    'CONTINU'	;
112)   DEE3 C5          		       DEFB 'E'+80H	;
114)   DEE4 44 45       		       DEFM    'DE'	;
115)   DEE6 C6          		       DEFB 'F'+80H	;
117)   DEE7 43 4C 45 41 		       DEFM    'CLEA'	;
118)   DEEB D2          		       DEFB 'R'+80H	;
120)   DEEC 4D 45 52 47 		       DEFM 'MERG'	;
121)   DEF0 C5          		       DEFB 'E'+80H	;
123)   DEF1 56 45 52 49 		       DEFM 'VERIF'	;
123)   DEF5 46          		       DEFM 'VERIF'	;
124)   DEF6 D9          		       DEFB 'Y'+80H	;
126)   DEF7 47 45       		       DEFM 'GE'	;
127)   DEF9 D4          		       DEFB 'T'+80H	;
129)   DEFA 52 45 53 55 		       DEFM 'RESUM'	;
129)   DEFE 4D          		       DEFM 'RESUM'	;
130)   DEFF C5          		       DEFB 'E'+80H	;
132)   DF00 44 45 4C 45 		       DEFM 'DELET'	;
132)   DF04 54          		       DEFM 'DELET'	;
133)   DF05 C5          		       DEFB 'E'+80H	;
135)   DF06 50 55       		       DEFM 'PU'	;
136)   DF08 D4          		       DEFB 'T'+80H	;
138)   DF09 4C 49 4E 50 		       DEFM 'LINPU'	;
138)   DF0D 55          		       DEFM 'LINPU'	;
139)   DF0E D4          		       DEFB 'T'+80H	;
141)   DF0F 52 45 50 4F 		       DEFM 'REPOR'	;
141)   DF13 52          		       DEFM 'REPOR'	;
142)   DF14 D4          		       DEFB 'T'+80H	;
144)   DF15 43 4F 4E    		       DEFM 'CON'	;
145)   DF18 D4          		       DEFB 'T'+80H	;
147)   DF19 52 45 53 45 		       DEFM 'RESERV'	;
147)   DF1D 52 56       		       DEFM 'RESERV'	;
148)   DF1F C5          		       DEFB 'E'+80H	;
150)   DF20 80 3C       		OKWDS: DEFB 80H,60 ;number of entries	;number of entries
154)   DF22 4E 4F       		       DEFM  'NO'      ;LOGICAL NOT	;LOGICAL NOT
155)   DF24 D4          		       DEFB 'T'+80H	;
161)   DF25 AB          		       DEFB  '+'+80H	;
163)   DF26 AD          		       DEFB  '-'+80H	;
165)   DF27 AA          		       DEFB  '*'+80H	;
167)   DF28 AF          		       DEFB  '/'+80H	;
169)   DF29 DE          		       DEFB  '^'+80H	;
171)   DF2A A6          		       DEFB  '&'+80H   ;AS ALTERNATIVE TO '+'	;AS ALTERNATIVE TO '+'
173)   DF2B 41 4E       		       DEFM  'AN'	;
174)   DF2D C4          		       DEFB 'D'+80H	;
176)   DF2E 4F D2       		       DEFB  'O','R'+80H	;
178)   DF30 3C BE       		       DEFB    '<','>'+80H	;
180)   DF32 3C BD       		       DEFB    '<','='+80H	;
182)   DF34 3E BD       		       DEFB    '>','='+80H	;
184)   DF36 BD          		       DEFB  '='+80H	;
186)   DF37 BE          		       DEFB '>'+80H	;
188)   DF38 BC          		       DEFB  '<'+80H	;
191)   DF39 52 4E       		       DEFM    'RN'	;
192)   DF3B C4          		       DEFB 'D'+80H	;
194)   DF3C 50          		       DEFM    'P'	;
195)   DF3D C9          		       DEFB 'I'+80H	;
197)   DF3E 50 4F       		       DEFM    'PO'	;
198)   DF40 D3          		       DEFB 'S'+80H	;
201)   DF41 41 42       		       DEFM    'AB'	;
202)   DF43 D3          		       DEFB 'S'+80H	;
204)   DF44 41 54       		       DEFM    'AT'	;
205)   DF46 CE          		       DEFB 'N'+80H	;
207)   DF47 43 4F       		       DEFM    'CO'	;
208)   DF49 D3          		       DEFB 'S'+80H	;
210)   DF4A 45 58       		       DEFM    'EX'	;
211)   DF4C D0          		       DEFB 'P'+80H	;
213)   DF4D 49 4E       		       DEFM    'IN'	;
214)   DF4F D4          		       DEFB 'T'+80H	;
216)   DF50 4C 4F       		       DEFM    'LO'	;
217)   DF52 C7          		       DEFB 'G'+80H	;
219)   DF53 53 47       		       DEFM    'SG'	;
220)   DF55 CE          		       DEFB 'N'+80H	;
222)   DF56 53 49       		       DEFM    'SI'	;
223)   DF58 CE          		       DEFB 'N'+80H	;
225)   DF59 53 51       		       DEFM    'SQ'	;
226)   DF5B D2          		       DEFB 'R'+80H	;
228)   DF5C 54 41       		       DEFM    'TA'	;
229)   DF5E CE          		       DEFB 'N'+80H	;
234)   DF5F 54 52 55    		       DEFM 'TRU'	;
235)   DF62 C5          		       DEFB 'E'+80H	;
237)   DF63 46 41 4C 53 		       DEFM 'FALS'	;
238)   DF67 C5          		       DEFB 'E'+80H	;
244)   DF68 41 53       		       DEFM    'AS'	;
245)   DF6A C3          		       DEFB 'C'+80H	;
247)   DF6B 4C 45       		       DEFM    'LE'	;
248)   DF6D CE          		       DEFB 'N'+80H	;
250)   DF6E 56 41       		       DEFM    'VA'	;
251)   DF70 CC          		       DEFB 'L'+80H	;
253)   DF71 4E 55       		       DEFM    'NU'	;
254)   DF73 CD          		       DEFB 'M'+80H	;
257)   DF74 41 53       		       DEFM 'AS'	;
258)   DF76 CE          		       DEFB 'N'+80H	;
260)   DF77 41 43       		       DEFM 'AC'	;
261)   DF79 D3          		       DEFB 'S'+80H	;
263)   DF7A 50 45 45    		       DEFM    'PEE'	;
264)   DF7D CB          		       DEFB 'K'+80H	;
266)   DF7E 45 52 52 4E 		       DEFM 'ERRN'	;
267)   DF82 CF          		       DEFB 'O'+80H	;
269)   DF83 49 4E 53 54 		       DEFM 'INST'	;
270)   DF87 D2          		       DEFB 'R'+80H	;
272)   DF88 45 52 52 4C 		       DEFM 'ERRLI'	;
272)   DF8C 49          		       DEFM 'ERRLI'	;
273)   DF8D CE          		       DEFB 'N'+80H	;
275)   DF8E 54 4F       		       DEFM 'TO'	;
276)   DF90 D0          		       DEFB 'P'+80H	;
278)   DF91 46 52 45    		       DEFM 'FRE'	;
279)   DF94 C5          		       DEFB 'E'+80H	;
286)   DF95 43 48 52    		       DEFM    'CHR'	;
287)   DF98 A4          		       DEFB '$'+80H	;
289)   DF99 53 54 52    		       DEFM    'STR'	;
290)   DF9C A4          		       DEFB '$'+80H	;
292)   DF9D 52 49 47 48 		       DEFM    'RIGHT'	;
292)   DFA1 54          		       DEFM    'RIGHT'	;
293)   DFA2 A4          		       DEFB '$'+80H	;
295)   DFA3 46 49 4C 45 		       DEFM 'FILE'	;
296)   DFA7 A4          		       DEFB '$'+80H	;
298)   DFA8 4C 45 46 54 		       DEFM 'LEFT'	;
299)   DFAC A4          		       DEFB '$'+80H	;
301)   DFAD 4D 49 44    		       DEFM 'MID'	;
302)   DFB0 A4          		       DEFB '$'+80H	;
304)   DFB1 42 41 53    		       DEFM 'BAS'      ;affects MOD2	;affects MOD2
305)   DFB4 C5          		       DEFB 'E'+80H	;
307)   DFB5 49 4E       		       DEFM 'IN'       ;affects MOD4	;affects MOD4
308)   DFB7 A3          		       DEFB '#'+80H	;
310)   DFB8 4F 55 54    		       DEFM 'OUT'	;
311)   DFBB A3          		       DEFB '#'+80H	;
313)   DFBC A3          		       DEFB '#'+80H	;
315)   DFBD 54 48 45    		       DEFM 'THE'      ;affects MOD5D and MOD2	;affects MOD5D and MOD2
316)   DFC0 CE          		       DEFB 'N'+80H    ;is 80H+40	;is 80H+40
318)   DFC1 80          		       DEFB 80H        ;the supreme invisible THEN	;the supreme invisible THEN
320)   DFC2 54          		       DEFM 'T'	;
321)   DFC3 CF          		       DEFB 'O'+80H	;
323)   DFC4 53 54 45    		       DEFM 'STE'	;
324)   DFC7 D0          		       DEFB 'P'+80H    ;affects MOD4	;affects MOD4
326)   DFC8 46 CE       		       DEFB 'F','N'+80H        ;affects MOD5A	;affects MOD5A
328)   DFCA 54 41       		       DEFM 'TA'       ;affects MOD3	;affects MOD3
329)   DFCC C2          		       DEFB 'B'+80H	;
331)   DFCD 45 52 52 4F 		       DEFM 'ERRO'     ;affects MOD2	;affects MOD2
332)   DFD1 D2          		       DEFB 'R'+80H	;
334)   DFD2 42 52 45 41 		       DEFM 'BREA'	;
335)   DFD6 CB          		       DEFB 'K'+80H	;
  1)   DFD7 00 00 00 00 		DS 0E000H-$	;
  1)   DFDB 00 00 00 00 		DS 0E000H-$	;
  1)   DFDF 00 00 00 00 		DS 0E000H-$	;
  1)   DFE3 00 00 00 00 		DS 0E000H-$	;
  1)   DFE7 00 00 00 00 		DS 0E000H-$	;
  1)   DFEB 00 00 00 00 		DS 0E000H-$	;
  1)   DFEF 00 00 00 00 		DS 0E000H-$	;
  1)   DFF3 00 00 00 00 		DS 0E000H-$	;
  1)   DFF7 00 00 00 00 		DS 0E000H-$	;
  1)   DFFB 00 00 00 00 		DS 0E000H-$	;
  1)   DFFF 00          		DS 0E000H-$	;
